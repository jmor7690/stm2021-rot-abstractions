theory DeviceManagement_TLS_model begin

// Function signature and definition of the equational theory E

functions: activateCredential/3 [private], adec/2, aenc/2, fst/1,
           makeCredential/3, nil/0, pair/2, pk/1, sign/2, snd/1, swstate/0, true/0,
           verify/3, verifyCredential/3 [private]
equations:
    activateCredential(n, k, makeCredential(pk(k), m, n)) = m,
    adec(aenc(x.1, pk(x.2)), x.2) = x.1,
    fst(<x.1, x.2>) = x.1,
    snd(<x.1, x.2>) = x.2,
    verify(sign(x.1, x.2), x.1, pk(x.2)) = true,
    verifyCredential(n, k, makeCredential(pk(k), m, n)) = true

heuristic: p

restriction RestrictionTpmCommand:
  "∀ c #t1.
    (TPM_ReceiveCommand( c ) @ #t1) ⇒
    ((∃ #t2. (TPM_SendCommand( c ) @ #t2) ∧ (#t2 < #t1)) ∧
     (¬(∃ #t3. (TPM_ReceiveCommand( c ) @ #t3) ∧ (¬(#t3 = #t1)))))"

lemma RouterFinishes:
  exists-trace "∃ #t1. RouterFinish( ) @ #t1"
/*
guarded formula characterizing all satisfying traces:
"∃ #t1. (RouterFinish( ) @ #t1)"
*/
simplify
solve( state_1111111111111211111111111111111111111111111( ~RouterID,
                                                          ~ServerID, ~ak_h, ~ak_sk, ~ssk_nms, ~tid, csr,
                                                          signature_cert_tls, skae, tls_h, tls_sh, tls_spk
       ) ▶₀ #t1 )
  case eventRouterCommitRouterIDServerIDtlsspksignaturecerttls_0_111111111111121111111111111111111111111111
  solve( ((#vr.19 < #vr.53) ∧
          (∃ #t2.
            (Unlock_5( '5', ~n, 'device' ) @ #t2)
           ∧
            (#vr.19 < #t2) ∧
            (#t2 < #vr.53) ∧
            (∀ #t0 pp. (Unlock( pp, ~n, 'device' ) @ #t0) ⇒ #t0 = #t2) ∧
            (∀ pp lpp #t0.
              (Lock( pp, lpp, 'device' ) @ #t0)
             ⇒
              ((#t0 < #vr.19) ∨ (#t0 = #vr.19) ∨ (#t2 < #t0))) ∧
            (∀ pp lpp #t0.
              (Unlock( pp, lpp, 'device' ) @ #t0)
             ⇒
              ((#t0 < #vr.19) ∨ (#t2 < #t0) ∨ (#t2 = #t0)))))  ∥
         (#vr.53 < #vr.19) )
    case case_2
    solve( state_111111111111111111111121111111111( ~RouterID.1, ~ServerID.1,
                                                    ~ak_h.1, ~ak_sk.1, ~k_h.2, ~k_sk.2, ~ssk_nms.1,
                                                    authPolicy.1, ~n.1
           ) ▶₀ #t2 )
      case TpmCreateOutkhpkksk_0_11111111111111111111112111111111
      solve( TPM_SendCommand( <'TPM2_Sign', k_sh, k_h.1, m> ) @ #t2.1 )
        case eventTPMSendCommandTPMSigntlsshtlshtlsspkskae_0_111111111111121111111111111111111
        solve( state_111111111111121111111111111111111( ~RouterID.1, ~ServerID.1,
                                                        ~ak_h.1, ~ak_sk.1, ~ssk_nms.1, ~tid.1, skae, k_h.1,
                                                        k_sh, tls_spk
               ) ▶₀ #t2.1 )
          case ifverifyskaetlsspkswstatenilTPMCCPolicyPCRnilpkaksktrue_0_11111111111112111111111111111111
          solve( (#vr.46 < #t2.3)  ∥ (#vr.46 = #t2.3) )
            case case_2
            solve( (#vr.48 < #t2.4)  ∥ (#vr.48 = #t2.4) )
              case case_2
              solve( TPM_SendCommand( <'TPM2_Create', authPolicy> ) @ #t2.4 )
                case eventTPMSendCommandTPMCreateswstatenilTPMCCPolicyPCRnil_0_11111111111112111
                solve( state_11111111111112111( ~RouterID.1, ~ServerID.1, ~ak_h.1,
                                                ~ak_sk.1, ~ssk_nms.1, ~tid.1
                       ) ▶₀ #t2.4 )
                  case outTPMPCRExtendswstate_0_1111111111111211
                  solve( TPM_SendCommand( <'TPM2_Create', <swstate, nil>, 
                                           'TPM_CC_PolicyPCR', nil>
                         ) @ #t2.6 )
                    case eventTPMSendCommandTPMCreateswstatenilTPMCCPolicyPCRnil_0_11111111111112111
                    solve( state_11111111111112111( ~RouterID.1, ~ServerID.1, ~ak_h.1,
                                                    ~ak_sk.1, ~ssk_nms.1, ~tid.1
                           ) ▶₀ #t2.5 )
                      case outTPMPCRExtendswstate_0_1111111111111211
                      solve( TPM_SendCommand( <'TPM2_Create', <swstate, nil>, 
                                               'TPM_CC_PolicyPCR', nil>
                             ) @ #t2.6 )
                        case eventTPMSendCommandTPMCreateswstatenilTPMCCPolicyPCRnil_0_11111111111112111
                        solve( state_11111111111112111( ~RouterID.1, ~ServerID.1, ~ak_h.1,
                                                        ~ak_sk.1, ~ssk_nms.1, ~tid.1
                               ) ▶₀ #t2.5 )
                          case outTPMPCRExtendswstate_0_1111111111111211
                          solve( !KU( sign(pk(~k_sk), ~ssk_nms) ) @ #vk.6 )
                            case outtlsspksigntlsspkssknms_0_11111111111121111111111
                            solve( !KU( sign(<pk(~k_sk), <swstate, nil>, 'TPM_CC_PolicyPCR', nil>,
                                             ~ak_sk)
                                   ) @ #vk.8 )
                              case outsignobjpkobjapask_0_11111111111111111111211111111
                              solve( (#vr.89 < #vr.49)  ∥ (#t2 < #vr.89) )
                                case case_2
                                solve( TPM_SendCommand( <'TPM2_Certify', obj_sh, obj_h, a_h> ) @ #t2.7 )
                                  case eventTPMSendCommandTPMCertifytlsshtlshakh_0_111111111111121111111111111
                                  solve( state_111111111111121111111111111( ~RouterID.1, ~ServerID.1,
                                                                            ~ak_h.1, ~ak_sk.1, ~ssk_nms.1,
                                                                            ~tid.1, obj_h, obj_sh, tls_spk
                                         ) ▶₀ #t2.5 )
                                    case outTPMPolicyPCRtlssh_0_11111111111112111111111111
                                    solve( (#vr.41 < #t2.9)  ∥ (#vr.41 = #t2.9) )
                                      case case_2
                                      solve( (#t2.3 < #t2.10)  ∥ (#t2.3 = #t2.10) )
                                        case case_2
                                        solve( (#vr.33 < #t2.9)  ∥ (#vr.33 = #t2.9) )
                                          case case_2
                                          solve( (#t2.8 < #t2.10)  ∥ (#t2.8 = #t2.10)  ∥ (#vr.85 < #t2.8) )
                                            case case_2
                                            solve( Unlock_4( '4', ~n.2, 'device' ) @ #t2.9 )
                                              case unlockdevice_0_111111111111111111112111111111
                                              solve( state_111111111111111111112111111111( ~RouterID.1,
                                                                                           ~ServerID.1,
                                                                                           ~ak_h.1, ~ak_sk.1,
                                                                                           ~ssk_nms.1, a_h,
                                                                                           a_sk, obj_ap,
                                                                                           obj_h, obj_pd,
                                                                                           obj_pk, obj_sh,
                                                                                           ~n.2
                                                     ) ▶₀ #t2.8 )
                                                case outsignobjpkobjapask_0_11111111111111111111211111111
                                                solve( (#t2.3 < #t2.14)  ∥ (#t2.3 = #t2.14) )
                                                  case case_2
                                                  solve( (#t2.6 < #t2.13)  ∥ (#t2.6 = #t2.13) )
                                                    case case_2
                                                    solve( (#t2.7 < #t2.12)  ∥ (#t2.7 = #t2.12) )
                                                      case case_2
                                                      solve( (#t2.9 < #t2.12)  ∥ (#t2.9 = #t2.12) )
                                                        case case_2
                                                        solve( TPM_SendCommand( <'TPM2_Create', 
                                                                                 <swstate, nil>, 
                                                                                 'TPM_CC_PolicyPCR', nil>
                                                               ) @ #t2.10 )
                                                          case eventTPMSendCommandTPMCreateswstatenilTPMCCPolicyPCRnil_0_11111111111112111
                                                          solve( state_11111111111112111( ~RouterID.1,
                                                                                          ~ServerID.1,
                                                                                          ~ak_h.1, ~ak_sk.1,
                                                                                          ~ssk_nms.1, ~tid.1
                                                                 ) ▶₀ #t2.9 )
                                                            case outTPMPCRExtendswstate_0_1111111111111211
                                                            solve( TPM_SendCommand( <'TPM2_Certify', k_sh, 
                                                                                     ~k_h, ~ak_h>
                                                                   ) @ #t2.10 )
                                                              case eventTPMSendCommandTPMCertifytlsshtlshakh_0_111111111111121111111111111
                                                              solve( state_111111111111121111111111111( ~RouterID.1,
                                                                                                        ~ServerID.1,
                                                                                                        ~ak_h,
                                                                                                        ~ak_sk.1,
                                                                                                        ~ssk_nms.1,
                                                                                                        ~tid.1,
                                                                                                        ~k_h,
                                                                                                        k_sh,
                                                                                                        tls_spk
                                                                     ) ▶₀ #t2.9 )
                                                                case outTPMPolicyPCRtlssh_0_11111111111112111111111111
                                                                solve( TPM_SendCommand( <'TPM2_Create', 
                                                                                         <swstate, nil>, 
                                                                                         'TPM_CC_PolicyPCR', 
                                                                                         nil>
                                                                       ) @ #t2.10 )
                                                                  case eventTPMSendCommandTPMCreateswstatenilTPMCCPolicyPCRnil_0_11111111111112111
                                                                  solve( state_11111111111112111( ~RouterID.1,
                                                                                                  ~ServerID.1,
                                                                                                  ~ak_h.1,
                                                                                                  ~ak_sk.1,
                                                                                                  ~ssk_nms.1,
                                                                                                  ~tid.1
                                                                         ) ▶₀ #t2.9 )
                                                                    case outTPMPCRExtendswstate_0_1111111111111211
                                                                    solve( Insert( <'privatePart', ~k_h>,
                                                                                   k_sk.1
                                                                           ) @ #t2.2 )
                                                                      case insertprivatePartkhksk_0_111111111111111111111121111111
                                                                      solve( Insert( <'authPolicy', ~k_h>,
                                                                                     k_ap
                                                                             ) @ #t2.3 )
                                                                        case insertauthPolicykhauthPolicy_0_11111111111111111111112111111
                                                                        solve( Insert( <'policyDigest', k_sh>,
                                                                                       <<swstate, nil>, 
                                                                                        'TPM_CC_PolicyPCR', 
                                                                                        nil>
                                                                               ) @ #t2.9 )
                                                                          case insertpolicyDigestshpcrLTPMCCPolicyPCRpL_0_111111111111111111111112111111
                                                                          solve( state_111111111111111111111112111111( ~RouterID.1,
                                                                                                                       ~ServerID.1,
                                                                                                                       ~ak_h.1,
                                                                                                                       ~ak_sk.1,
                                                                                                                       ~ssk_nms.1,
                                                                                                                       nil,
                                                                                                                       <
                                                                                                                        swstate, 
                                                                                                                        nil
                                                                                                                       >,
                                                                                                                       k_sh,
                                                                                                                       lock
                                                                                 ) ▶₀ #t2.9 )
                                                                            case eventPolicyPCRshpL_0_11111111111111111111111211111
                                                                            solve( (#vr.95 < #vr.46)  ∥
                                                                                   (#t2 < #vr.95) )
                                                                              case case_2
                                                                              solve( (#vr.29 < #t2.13)  ∥
                                                                                     (#vr.29 = #t2.13) )
                                                                                case case_1
                                                                                solve( state_1111111111111111111111121111111( ~RouterID.1,
                                                                                                                              ~ServerID.1,
                                                                                                                              ~ak_h.1,
                                                                                                                              ~ak_sk.1,
                                                                                                                              ~ssk_nms.1,
                                                                                                                              pL,
                                                                                                                              pcrL,
                                                                                                                              s_h,
                                                                                                                              ~n.3
                                                                                       ) ▶₀ #t2.10 )
                                                                                  case insertpolicyDigestshpcrLTPMCCPolicyPCRpL_0_111111111111111111111112111111
                                                                                  solve( (#vr.29 < #t2.16)  ∥
                                                                                         (#vr.29 = #t2.16) )
                                                                                    case case_1
                                                                                    solve( (#t2.13 < #t2.16)  ∥
                                                                                           (#t2.13 = #t2.16) )
                                                                                      case case_2
                                                                                      solve( (#t2.12 < #t2.15)  ∥
                                                                                             (#t2.12 =
                                                                                              #t2.15) )
                                                                                        case case_2
                                                                                        solve( TPM_SendCommand( <
                                                                                                                 'TPM2_PolicyPCR', 
                                                                                                                 k_sh
                                                                                                                >
                                                                                               ) @ #t2.11 )
                                                                                          case eventTPMSendCommandTPMPolicyPCRtlssh_0_1111111111111211111111111
                                                                                          solve( state_1111111111111211111111111( ~RouterID.1,
                                                                                                                                  ~ServerID.1,
                                                                                                                                  ~ak_h.1,
                                                                                                                                  ~ak_sk.1,
                                                                                                                                  ~ssk_nms.1,
                                                                                                                                  ~tid.1,
                                                                                                                                  tls_h,
                                                                                                                                  k_sh,
                                                                                                                                  tls_spk
                                                                                                 ) ▶₀ #t2.11 )
                                                                                            case eventGenerateTLStidtlsspk_0_111111111111121111111111
                                                                                            solve( TPM_SendCommand( <
                                                                                                                     'TPM2_PolicyPCR', 
                                                                                                                     k_sh
                                                                                                                    >
                                                                                                   ) @ #t2.14 )
                                                                                              case eventTPMSendCommandTPMPolicyPCRtlssh_0_1111111111111211111111111
                                                                                              solve( state_1111111111111211111111111( ~RouterID.1,
                                                                                                                                      ~ServerID.1,
                                                                                                                                      ~ak_h.1,
                                                                                                                                      ~ak_sk.1,
                                                                                                                                      ~ssk_nms.1,
                                                                                                                                      ~tid.1,
                                                                                                                                      tls_h,
                                                                                                                                      k_sh,
                                                                                                                                      tls_spk
                                                                                                     ) ▶₀ #t2.12 )
                                                                                                case eventGenerateTLStidtlsspk_0_111111111111121111111111
                                                                                                solve( TPM_SendCommand( <
                                                                                                                         'TPM2_Create', 
                                                                                                                         <
                                                                                                                          swstate, 
                                                                                                                          nil
                                                                                                                         >, 
                                                                                                                         'TPM_CC_PolicyPCR', 
                                                                                                                         nil
                                                                                                                        >
                                                                                                       ) @ #t2.14 )
                                                                                                  case eventTPMSendCommandTPMCreateswstatenilTPMCCPolicyPCRnil_0_11111111111112111
                                                                                                  solve( state_11111111111112111( ~RouterID.1,
                                                                                                                                  ~ServerID.1,
                                                                                                                                  ~ak_h.1,
                                                                                                                                  ~ak_sk.1,
                                                                                                                                  ~ssk_nms.1,
                                                                                                                                  ~tid.1
                                                                                                         ) ▶₀ #t2.12 )
                                                                                                    case outTPMPCRExtendswstate_0_1111111111111211
                                                                                                    solve( TPM_SendCommand( <
                                                                                                                             'TPM2_Create', 
                                                                                                                             <
                                                                                                                              swstate, 
                                                                                                                              nil
                                                                                                                             >, 
                                                                                                                             'TPM_CC_PolicyPCR', 
                                                                                                                             nil
                                                                                                                            >
                                                                                                           ) @ #t2.14 )
                                                                                                      case eventTPMSendCommandTPMCreateswstatenilTPMCCPolicyPCRnil_0_11111111111112111
                                                                                                      solve( state_11111111111112111( ~RouterID.1,
                                                                                                                                      ~ServerID.1,
                                                                                                                                      ~ak_h.1,
                                                                                                                                      ~ak_sk.1,
                                                                                                                                      ~ssk_nms.1,
                                                                                                                                      ~tid.1
                                                                                                             ) ▶₀ #t2.12 )
                                                                                                        case outTPMPCRExtendswstate_0_1111111111111211
                                                                                                        solve( Insert( <
                                                                                                                        'privatePart', 
                                                                                                                        ~ak_h
                                                                                                                       >,
                                                                                                                       ~ak_sk
                                                                                                               ) @ #t2.7 )
                                                                                                          case insertprivatePartakhaksk_0_111111111111111
                                                                                                          solve( Insert( <
                                                                                                                          'publicPart', 
                                                                                                                          ~k_h
                                                                                                                         >,
                                                                                                                         pk(~k_sk)
                                                                                                                 ) @ #t2.6 )
                                                                                                            case insertpublicPartkhpkksk_0_1111111111111111111111211111111
                                                                                                            solve( Insert( <
                                                                                                                            'policyDigest', 
                                                                                                                            k_sh
                                                                                                                           >,
                                                                                                                           nil
                                                                                                                   ) @ #t2.12 )
                                                                                                              case insertpolicyDigestshnil_0_11111111111111111111121111
                                                                                                              solve( state_11111111111111111111121111( ~RouterID.1,
                                                                                                                                                       ~ServerID.1,
                                                                                                                                                       ~ak_h.1,
                                                                                                                                                       ~ak_sk.1,
                                                                                                                                                       ~s_h,
                                                                                                                                                       ~ssk_nms.1,
                                                                                                                                                       lock
                                                                                                                     ) ▶₀ #t2.12 )
                                                                                                                case lockdevice_0_1111111111111111111112111
                                                                                                                solve( (#vr.103 < #vr.45)  ∥
                                                                                                                       (#t2 < #vr.103) )
                                                                                                                  case case_2
                                                                                                                  solve( state_11111111111111111111121111111( ~RouterID.1,
                                                                                                                                                              ~ServerID.1,
                                                                                                                                                              ~ak_h.1,
                                                                                                                                                              ~ak_sk.1,
                                                                                                                                                              ~s_h.1,
                                                                                                                                                              ~ssk_nms.1,
                                                                                                                                                              ~n.4
                                                                                                                         ) ▶₀ #t2.13 )
                                                                                                                    case outsh_0_1111111111111111111112111111
                                                                                                                    solve( TPM_SendCommand( 'TPM2_StartAuthSession'
                                                                                                                           ) @ #t2.15 )
                                                                                                                      case eventTPMSendCommandTPMStartAuthSession_0_111111111111121111111
                                                                                                                      solve( state_111111111111121111111( ~RouterID.1,
                                                                                                                                                          ~ServerID.1,
                                                                                                                                                          ~ak_h.1,
                                                                                                                                                          ~ak_sk.1,
                                                                                                                                                          ~ssk_nms.1,
                                                                                                                                                          ~tid.1,
                                                                                                                                                          tls_h,
                                                                                                                                                          tls_spk
                                                                                                                             ) ▶₀ #t2.14 )
                                                                                                                        case eventHasKeyTLSRouterIDtlsspk_0_11111111111112111111
                                                                                                                        solve( TPM_SendCommand( 'TPM2_StartAuthSession'
                                                                                                                               ) @ #t2.16 )
                                                                                                                          case eventTPMSendCommandTPMStartAuthSession_0_111111111111121111111
                                                                                                                          solve( state_111111111111121111111( ~RouterID.1,
                                                                                                                                                              ~ServerID.1,
                                                                                                                                                              ~ak_h.1,
                                                                                                                                                              ~ak_sk.1,
                                                                                                                                                              ~ssk_nms.1,
                                                                                                                                                              ~tid.1,
                                                                                                                                                              tls_h,
                                                                                                                                                              tls_spk
                                                                                                                                 ) ▶₀ #t2.15 )
                                                                                                                            case eventHasKeyTLSRouterIDtlsspk_0_11111111111112111111
                                                                                                                            solve( TPM_SendCommand( <
                                                                                                                                                     'TPM2_Create', 
                                                                                                                                                     <
                                                                                                                                                      swstate, 
                                                                                                                                                      nil
                                                                                                                                                     >, 
                                                                                                                                                     'TPM_CC_PolicyPCR', 
                                                                                                                                                     nil
                                                                                                                                                    >
                                                                                                                                   ) @ #t2.16 )
                                                                                                                              case eventTPMSendCommandTPMCreateswstatenilTPMCCPolicyPCRnil_0_11111111111112111
                                                                                                                              solve( state_11111111111112111( ~RouterID.1,
                                                                                                                                                              ~ServerID.1,
                                                                                                                                                              ~ak_h.1,
                                                                                                                                                              ~ak_sk.1,
                                                                                                                                                              ~ssk_nms.1,
                                                                                                                                                              ~tid.1
                                                                                                                                     ) ▶₀ #t2.15 )
                                                                                                                                case outTPMPCRExtendswstate_0_1111111111111211
                                                                                                                                solve( TPM_SendCommand( <
                                                                                                                                                         'TPM2_Create', 
                                                                                                                                                         <
                                                                                                                                                          swstate, 
                                                                                                                                                          nil
                                                                                                                                                         >, 
                                                                                                                                                         'TPM_CC_PolicyPCR', 
                                                                                                                                                         nil
                                                                                                                                                        >
                                                                                                                                       ) @ #t2.16 )
                                                                                                                                  case eventTPMSendCommandTPMCreateswstatenilTPMCCPolicyPCRnil_0_11111111111112111
                                                                                                                                  solve( state_11111111111112111( ~RouterID.1,
                                                                                                                                                                  ~ServerID.1,
                                                                                                                                                                  ~ak_h.1,
                                                                                                                                                                  ~ak_sk.1,
                                                                                                                                                                  ~ssk_nms.1,
                                                                                                                                                                  ~tid.1
                                                                                                                                         ) ▶₀ #t2.15 )
                                                                                                                                    case outTPMPCRExtendswstate_0_1111111111111211
                                                                                                                                    solve( Insert( 'PCR',
                                                                                                                                                   <
                                                                                                                                                    swstate, 
                                                                                                                                                    nil
                                                                                                                                                   >
                                                                                                                                           ) @ #t2.15 )
                                                                                                                                      case insertPCRvaluepcr_0_1111111111111111111111111111
                                                                                                                                      solve( state_1111111111111111111111111111( ~RouterID.1,
                                                                                                                                                                                 ~ServerID.1,
                                                                                                                                                                                 ~ak_h.1,
                                                                                                                                                                                 ~ak_sk.1,
                                                                                                                                                                                 ~ssk_nms.1,
                                                                                                                                                                                 lock,
                                                                                                                                                                                 nil,
                                                                                                                                                                                 swstate
                                                                                                                                             ) ▶₀ #t2.15 )
                                                                                                                                        case lookupPCRaspcr_0_111111111111111111111111111
                                                                                                                                        solve( (#vr.113 < #vr.44)  ∥
                                                                                                                                               (#t2 < #vr.113) )
                                                                                                                                          case case_1
                                                                                                                                          solve( (#vr.28 < #t2.18)  ∥
                                                                                                                                                 (#vr.28 =
                                                                                                                                                  #t2.18) )
                                                                                                                                            case case_2
                                                                                                                                            solve( state_11111111111111111111111111111( ~RouterID.1,
                                                                                                                                                                                        ~ServerID.1,
                                                                                                                                                                                        ~ak_h.1,
                                                                                                                                                                                        ~ak_sk.1,
                                                                                                                                                                                        ~ssk_nms.1,
                                                                                                                                                                                        ~n.5,
                                                                                                                                                                                        pcr,
                                                                                                                                                                                        value
                                                                                                                                                   ) ▶₀ #t2.16 )
                                                                                                                                              case insertPCRvaluepcr_0_1111111111111111111111111111
                                                                                                                                              solve( (#t2.17 < #t2.20)  ∥
                                                                                                                                                     (#t2.17 =
                                                                                                                                                      #t2.20) )
                                                                                                                                                case case_2
                                                                                                                                                solve( TPM_SendCommand( <
                                                                                                                                                                         'TPM2_PCR_Extend', 
                                                                                                                                                                         swstate
                                                                                                                                                                        >
                                                                                                                                                       ) @ #t2.18 )
                                                                                                                                                  case eventTPMSendCommandTPMPCRExtendswstate_0_111111111111121
                                                                                                                                                  solve( state_111111111111121( ~RouterID.1,
                                                                                                                                                                                ~ServerID.1,
                                                                                                                                                                                ~ak_h.1,
                                                                                                                                                                                ~ak_sk.1,
                                                                                                                                                                                ~ssk_nms.1,
                                                                                                                                                                                ~tid.1
                                                                                                                                                         ) ▶₀ #t2.18 )
                                                                                                                                                    case newtid_0_11111111111112
                                                                                                                                                    solve( TPM_SendCommand( <
                                                                                                                                                                             'TPM2_PCR_Extend', 
                                                                                                                                                                             swstate
                                                                                                                                                                            >
                                                                                                                                                           ) @ #t2.19 )
                                                                                                                                                      case eventTPMSendCommandTPMPCRExtendswstate_0_111111111111121
                                                                                                                                                      solve( state_111111111111121( ~RouterID.1,
                                                                                                                                                                                    ~ServerID.1,
                                                                                                                                                                                    ~ak_h.1,
                                                                                                                                                                                    ~ak_sk.1,
                                                                                                                                                                                    ~ssk_nms.1,
                                                                                                                                                                                    ~tid.1
                                                                                                                                                             ) ▶₀ #t2.19 )
                                                                                                                                                        case newtid_0_11111111111112
                                                                                                                                                        solve( Insert( 'PCR',
                                                                                                                                                                       nil
                                                                                                                                                               ) @ #t2.17 )
                                                                                                                                                          case insertPCRnil_0_11111111111111111
                                                                                                                                                          solve( !KU( pk(~k_sk)
                                                                                                                                                                 ) @ #vk.8 )
                                                                                                                                                            case outTPMSigntlsshtlshtlsspkskae_0_1111111111111211111111111111111111
                                                                                                                                                            solve( TPM_SendCommand( <
                                                                                                                                                                                     'TPM2_Create', 
                                                                                                                                                                                     <
                                                                                                                                                                                      swstate, 
                                                                                                                                                                                      nil
                                                                                                                                                                                     >, 
                                                                                                                                                                                     'TPM_CC_PolicyPCR', 
                                                                                                                                                                                     nil
                                                                                                                                                                                    >
                                                                                                                                                                   ) @ #t2.19 )
                                                                                                                                                              case eventTPMSendCommandTPMCreateswstatenilTPMCCPolicyPCRnil_0_11111111111112111
                                                                                                                                                              solve( state_11111111111112111( ~RouterID.1,
                                                                                                                                                                                              ~ServerID.1,
                                                                                                                                                                                              ~ak_h.1,
                                                                                                                                                                                              ~ak_sk.1,
                                                                                                                                                                                              ~ssk_nms.1,
                                                                                                                                                                                              ~tid.1
                                                                                                                                                                     ) ▶₀ #t2.19 )
                                                                                                                                                                case outTPMPCRExtendswstate_0_1111111111111211
                                                                                                                                                                solve( !KU( ~k_h
                                                                                                                                                                       ) @ #vk.14 )
                                                                                                                                                                  case outTPMCertifytlsshtlshakh_0_1111111111111211111111111111
                                                                                                                                                                  solve( TPM_SendCommand( <
                                                                                                                                                                                           'TPM2_Create', 
                                                                                                                                                                                           <
                                                                                                                                                                                            swstate, 
                                                                                                                                                                                            nil
                                                                                                                                                                                           >, 
                                                                                                                                                                                           'TPM_CC_PolicyPCR', 
                                                                                                                                                                                           nil
                                                                                                                                                                                          >
                                                                                                                                                                         ) @ #t2.19 )
                                                                                                                                                                    case eventTPMSendCommandTPMCreateswstatenilTPMCCPolicyPCRnil_0_11111111111112111
                                                                                                                                                                    solve( state_11111111111112111( ~RouterID.1,
                                                                                                                                                                                                    ~ServerID.1,
                                                                                                                                                                                                    ~ak_h.1,
                                                                                                                                                                                                    ~ak_sk.1,
                                                                                                                                                                                                    ~ssk_nms.1,
                                                                                                                                                                                                    ~tid.1
                                                                                                                                                                           ) ▶₀ #t2.19 )
                                                                                                                                                                      case outTPMPCRExtendswstate_0_1111111111111211
                                                                                                                                                                      solve( !KU( sign(<
                                                                                                                                                                                        pk(~k_sk), 
                                                                                                                                                                                        sign(<
                                                                                                                                                                                              pk(~k_sk), 
                                                                                                                                                                                              <
                                                                                                                                                                                               swstate, 
                                                                                                                                                                                               nil
                                                                                                                                                                                              >, 
                                                                                                                                                                                              'TPM_CC_PolicyPCR', 
                                                                                                                                                                                              nil
                                                                                                                                                                                             >,
                                                                                                                                                                                             ~ak_sk)
                                                                                                                                                                                       >,
                                                                                                                                                                                       ~k_sk)
                                                                                                                                                                             ) @ #vk.25 )
                                                                                                                                                                        case outtlsspkskaecsr_0_11111111111112111111111111111111111111
                                                                                                                                                                        solve( (#t2.22 < #t2.3)  ∥
                                                                                                                                                                               (#t2.22 =
                                                                                                                                                                                #t2.3)  ∥
                                                                                                                                                                               (#vr.80 < #t2.22) )
                                                                                                                                                                          case case_2
                                                                                                                                                                          solve( (#t2.22 < #t2.9)  ∥
                                                                                                                                                                                 (#t2.22 =
                                                                                                                                                                                  #t2.9)  ∥
                                                                                                                                                                                 (#vr.81 < #t2.22) )
                                                                                                                                                                            case case_2
                                                                                                                                                                            solve( (#t2.2 < #t2.21)  ∥
                                                                                                                                                                                   (#t2.2 =
                                                                                                                                                                                    #t2.21) )
                                                                                                                                                                              case case_2
                                                                                                                                                                              solve( TPM_SendCommand( <
                                                                                                                                                                                                       'TPM2_Sign', 
                                                                                                                                                                                                       ~s_h, 
                                                                                                                                                                                                       ~k_h, 
                                                                                                                                                                                                       pk(~k_sk), 
                                                                                                                                                                                                       sign(<
                                                                                                                                                                                                             pk(~k_sk), 
                                                                                                                                                                                                             <
                                                                                                                                                                                                              swstate, 
                                                                                                                                                                                                              nil
                                                                                                                                                                                                             >, 
                                                                                                                                                                                                             'TPM_CC_PolicyPCR', 
                                                                                                                                                                                                             nil
                                                                                                                                                                                                            >,
                                                                                                                                                                                                            ~ak_sk)
                                                                                                                                                                                                      >
                                                                                                                                                                                     ) @ #t2.19 )
                                                                                                                                                                                case eventTPMSendCommandTPMSigntlsshtlshtlsspkskae_0_111111111111121111111111111111111
                                                                                                                                                                                solve( state_111111111111121111111111111111111( ~RouterID.1,
                                                                                                                                                                                                                                ~ServerID.1,
                                                                                                                                                                                                                                ~ak_h.1,
                                                                                                                                                                                                                                ~ak_sk.1,
                                                                                                                                                                                                                                ~ssk_nms.1,
                                                                                                                                                                                                                                ~tid.1,
                                                                                                                                                                                                                                sign(<
                                                                                                                                                                                                                                      pk(~k_sk), 
                                                                                                                                                                                                                                      <
                                                                                                                                                                                                                                       swstate, 
                                                                                                                                                                                                                                       nil
                                                                                                                                                                                                                                      >, 
                                                                                                                                                                                                                                      'TPM_CC_PolicyPCR', 
                                                                                                                                                                                                                                      nil
                                                                                                                                                                                                                                     >,
                                                                                                                                                                                                                                     ~ak_sk),
                                                                                                                                                                                                                                ~k_h,
                                                                                                                                                                                                                                ~s_h,
                                                                                                                                                                                                                                pk(~k_sk)
                                                                                                                                                                                       ) ▶₀ #t2.19 )
                                                                                                                                                                                  case ifverifyskaetlsspkswstatenilTPMCCPolicyPCRnilpkaksktrue_0_11111111111112111111111111111111
                                                                                                                                                                                  solve( TPM_SendCommand( <
                                                                                                                                                                                                           'TPM2_Create', 
                                                                                                                                                                                                           <
                                                                                                                                                                                                            swstate, 
                                                                                                                                                                                                            nil
                                                                                                                                                                                                           >, 
                                                                                                                                                                                                           'TPM_CC_PolicyPCR', 
                                                                                                                                                                                                           nil
                                                                                                                                                                                                          >
                                                                                                                                                                                         ) @ #t2.19 )
                                                                                                                                                                                    case eventTPMSendCommandTPMCreateswstatenilTPMCCPolicyPCRnil_0_11111111111112111
                                                                                                                                                                                    solve( state_11111111111112111( ~RouterID.1,
                                                                                                                                                                                                                    ~ServerID.1,
                                                                                                                                                                                                                    ~ak_h.1,
                                                                                                                                                                                                                    ~ak_sk.1,
                                                                                                                                                                                                                    ~ssk_nms.1,
                                                                                                                                                                                                                    ~tid.1
                                                                                                                                                                                           ) ▶₀ #t2.19 )
                                                                                                                                                                                      case outTPMPCRExtendswstate_0_1111111111111211
                                                                                                                                                                                      solve( TPM_SendCommand( <
                                                                                                                                                                                                               'TPM2_Create', 
                                                                                                                                                                                                               <
                                                                                                                                                                                                                swstate, 
                                                                                                                                                                                                                nil
                                                                                                                                                                                                               >, 
                                                                                                                                                                                                               'TPM_CC_PolicyPCR', 
                                                                                                                                                                                                               nil
                                                                                                                                                                                                              >
                                                                                                                                                                                             ) @ #t2.19 )
                                                                                                                                                                                        case eventTPMSendCommandTPMCreateswstatenilTPMCCPolicyPCRnil_0_11111111111112111
                                                                                                                                                                                        solve( state_11111111111112111( ~RouterID.1,
                                                                                                                                                                                                                        ~ServerID.1,
                                                                                                                                                                                                                        ~ak_h.1,
                                                                                                                                                                                                                        ~ak_sk.1,
                                                                                                                                                                                                                        ~ssk_nms.1,
                                                                                                                                                                                                                        ~tid.1
                                                                                                                                                                                               ) ▶₀ #t2.19 )
                                                                                                                                                                                          case outTPMPCRExtendswstate_0_1111111111111211
                                                                                                                                                                                          solve( !KU( ~ak_h
                                                                                                                                                                                                 ) @ #vk.27 )
                                                                                                                                                                                            case outTPMCertifytlsshtlshakh_0_1111111111111211111111111111
                                                                                                                                                                                            solve( TPM_SendCommand( <
                                                                                                                                                                                                                     'TPM2_Create', 
                                                                                                                                                                                                                     <
                                                                                                                                                                                                                      swstate, 
                                                                                                                                                                                                                      nil
                                                                                                                                                                                                                     >, 
                                                                                                                                                                                                                     'TPM_CC_PolicyPCR', 
                                                                                                                                                                                                                     nil
                                                                                                                                                                                                                    >
                                                                                                                                                                                                   ) @ #t2.19 )
                                                                                                                                                                                              case eventTPMSendCommandTPMCreateswstatenilTPMCCPolicyPCRnil_0_11111111111112111
                                                                                                                                                                                              solve( state_11111111111112111( ~RouterID.1,
                                                                                                                                                                                                                              ~ServerID.1,
                                                                                                                                                                                                                              ~ak_h.1,
                                                                                                                                                                                                                              ~ak_sk.1,
                                                                                                                                                                                                                              ~ssk_nms.1,
                                                                                                                                                                                                                              ~tid.1
                                                                                                                                                                                                     ) ▶₀ #t2.19 )
                                                                                                                                                                                                case outTPMPCRExtendswstate_0_1111111111111211
                                                                                                                                                                                                solve( !KU( ~s_h
                                                                                                                                                                                                       ) @ #vk.16 )
                                                                                                                                                                                                  case outsh_0_1111111111111111111112111111
                                                                                                                                                                                                  solve( TPM_SendCommand( 'TPM2_StartAuthSession'
                                                                                                                                                                                                         ) @ #t2.19 )
                                                                                                                                                                                                    case eventTPMSendCommandTPMStartAuthSession_0_111111111111121111111
                                                                                                                                                                                                    solve( state_111111111111121111111( ~RouterID.1,
                                                                                                                                                                                                                                        ~ServerID.1,
                                                                                                                                                                                                                                        ~ak_h.1,
                                                                                                                                                                                                                                        ~ak_sk.1,
                                                                                                                                                                                                                                        ~ssk_nms.1,
                                                                                                                                                                                                                                        ~tid.1,
                                                                                                                                                                                                                                        tls_h,
                                                                                                                                                                                                                                        tls_spk
                                                                                                                                                                                                           ) ▶₀ #t2.19 )
                                                                                                                                                                                                      case eventHasKeyTLSRouterIDtlsspk_0_11111111111112111111
                                                                                                                                                                                                      solve( TPM_SendCommand( <
                                                                                                                                                                                                                               'TPM2_Create', 
                                                                                                                                                                                                                               <
                                                                                                                                                                                                                                swstate, 
                                                                                                                                                                                                                                nil
                                                                                                                                                                                                                               >, 
                                                                                                                                                                                                                               'TPM_CC_PolicyPCR', 
                                                                                                                                                                                                                               nil
                                                                                                                                                                                                                              >
                                                                                                                                                                                                             ) @ #t2.19 )
                                                                                                                                                                                                        case eventTPMSendCommandTPMCreateswstatenilTPMCCPolicyPCRnil_0_11111111111112111
                                                                                                                                                                                                        solve( state_11111111111112111( ~RouterID.1,
                                                                                                                                                                                                                                        ~ServerID.1,
                                                                                                                                                                                                                                        ~ak_h.1,
                                                                                                                                                                                                                                        ~ak_sk.1,
                                                                                                                                                                                                                                        ~ssk_nms.1,
                                                                                                                                                                                                                                        ~tid.1
                                                                                                                                                                                                               ) ▶₀ #t2.19 )
                                                                                                                                                                                                          case outTPMPCRExtendswstate_0_1111111111111211
                                                                                                                                                                                                          SOLVED // trace found
                                                                                                                                                                                                        qed
                                                                                                                                                                                                      qed
                                                                                                                                                                                                    qed
                                                                                                                                                                                                  qed
                                                                                                                                                                                                qed
                                                                                                                                                                                              qed
                                                                                                                                                                                            qed
                                                                                                                                                                                          qed
                                                                                                                                                                                        qed
                                                                                                                                                                                      qed
                                                                                                                                                                                    qed
                                                                                                                                                                                  qed
                                                                                                                                                                                qed
                                                                                                                                                                              qed
                                                                                                                                                                            qed
                                                                                                                                                                          qed
                                                                                                                                                                        qed
                                                                                                                                                                      qed
                                                                                                                                                                    qed
                                                                                                                                                                  qed
                                                                                                                                                                qed
                                                                                                                                                              qed
                                                                                                                                                            qed
                                                                                                                                                          qed
                                                                                                                                                        qed
                                                                                                                                                      qed
                                                                                                                                                    qed
                                                                                                                                                  qed
                                                                                                                                                qed
                                                                                                                                              qed
                                                                                                                                            qed
                                                                                                                                          qed
                                                                                                                                        qed
                                                                                                                                      qed
                                                                                                                                    qed
                                                                                                                                  qed
                                                                                                                                qed
                                                                                                                              qed
                                                                                                                            qed
                                                                                                                          qed
                                                                                                                        qed
                                                                                                                      qed
                                                                                                                    qed
                                                                                                                  qed
                                                                                                                qed
                                                                                                              qed
                                                                                                            qed
                                                                                                          qed
                                                                                                        qed
                                                                                                      qed
                                                                                                    qed
                                                                                                  qed
                                                                                                qed
                                                                                              qed
                                                                                            qed
                                                                                          qed
                                                                                        qed
                                                                                      qed
                                                                                    qed
                                                                                  qed
                                                                                qed
                                                                              qed
                                                                            qed
                                                                          qed
                                                                        qed
                                                                      qed
                                                                    qed
                                                                  qed
                                                                qed
                                                              qed
                                                            qed
                                                          qed
                                                        qed
                                                      qed
                                                    qed
                                                  qed
                                                qed
                                              qed
                                            qed
                                          qed
                                        qed
                                      qed
                                    qed
                                  qed
                                qed
                              qed
                            qed
                          qed
                        qed
                      qed
                    qed
                  qed
                qed
              qed
            qed
          qed
        qed
      qed
    qed
  qed
qed

lemma ServerFinishes:
  exists-trace "∃ #t1. ServerFinish( ) @ #t1"
/*
guarded formula characterizing all satisfying traces:
"∃ #t1. (ServerFinish( ) @ #t1)"
*/
simplify
solve( state_111111111111211111111111( ~RouterID, ~ServerID, ~ak_h,
                                       ~ak_sk, ~ssk_nms, csr, skae, tls_spk
       ) ▶₀ #t1 )
  case outtlsspksigntlsspkssknms_0_11111111111121111111111
  solve( !KU( sign(<pk(x), <swstate, nil>, 'TPM_CC_PolicyPCR', nil>,
                   ~ak_sk)
         ) @ #vk.3 )
    case outsignobjpkobjapask_0_11111111111111111111211111111
    solve( TPM_SendCommand( <'TPM2_Certify', obj_sh, obj_h, a_h> ) @ #t2 )
      case eventTPMSendCommandTPMCertifytlsshtlshakh_0_111111111111121111111111111
      solve( state_111111111111121111111111111( ~RouterID.1, ~ServerID.1,
                                                ~ak_h.1, ~ak_sk.1, ~ssk_nms.1, ~tid, obj_h, obj_sh, tls_spk
             ) ▶₀ #t2 )
        case outTPMPolicyPCRtlssh_0_11111111111112111111111111
        solve( (#vr.55 < #t2.3)  ∥ (#vr.55 = #t2.3) )
          case case_2
          solve( (#vr.58 < #t2.4)  ∥ (#vr.58 = #t2.4) )
            case case_2
            solve( (#vr.41 < #t2.4)  ∥ (#vr.41 = #t2.4) )
              case case_2
              solve( state_111111111111111111111121111111111( ~RouterID.1, ~ServerID.1,
                                                              ~ak_h.1, ~ak_sk.1, ~k_h.1, ~k_sk.1, ~ssk_nms.1,
                                                              authPolicy, ~n
                     ) ▶₀ #t2.1 )
                case TpmCreateOutkhpkksk_0_11111111111111111111112111111111
                solve( TPM_SendCommand( <'TPM2_Create', authPolicy> ) @ #t2.6 )
                  case eventTPMSendCommandTPMCreateswstatenilTPMCCPolicyPCRnil_0_11111111111112111
                  solve( state_11111111111112111( ~RouterID.1, ~ServerID.1, ~ak_h.1,
                                                  ~ak_sk.1, ~ssk_nms.1, ~tid.1
                         ) ▶₀ #t2.5 )
                    case outTPMPCRExtendswstate_0_1111111111111211
                    solve( TPM_SendCommand( <'TPM2_Create', <swstate, nil>, 
                                             'TPM_CC_PolicyPCR', nil>
                           ) @ #t2.7 )
                      case eventTPMSendCommandTPMCreateswstatenilTPMCCPolicyPCRnil_0_11111111111112111
                      solve( state_11111111111112111( ~RouterID.1, ~ServerID.1, ~ak_h.1,
                                                      ~ak_sk.1, ~ssk_nms.1, ~tid.1
                             ) ▶₀ #t2.6 )
                        case outTPMPCRExtendswstate_0_1111111111111211
                        solve( !KU( sign(<pk(x), 
                                          sign(<pk(x), <swstate, nil>, 'TPM_CC_PolicyPCR', nil>, ~ak_sk)>,
                                         x)
                               ) @ #vk.4 )
                          case outtlsspkskaecsr_0_11111111111112111111111111111111111111
                          solve( TPM_SendCommand( <'TPM2_Sign', k_sh, k_h.1, pk(x), 
                                                   sign(<pk(x), <swstate, nil>, 'TPM_CC_PolicyPCR', nil>,
                                                        ~ak_sk)
                                                  >
                                 ) @ #t2.8 )
                            case eventTPMSendCommandTPMSigntlsshtlshtlsspkskae_0_111111111111121111111111111111111
                            solve( state_111111111111121111111111111111111( ~RouterID.1, ~ServerID.1,
                                                                            ~ak_h.1, ~ak_sk.1, ~ssk_nms.1,
                                                                            ~tid.1,
                                                                            sign(<pk(x), <swstate, nil>, 
                                                                                  'TPM_CC_PolicyPCR', nil>,
                                                                                 ~ak_sk),
                                                                            k_h.1, k_sh, pk(x)
                                   ) ▶₀ #t2.6 )
                              case ifverifyskaetlsspkswstatenilTPMCCPolicyPCRnilpkaksktrue_0_11111111111112111111111111111111
                              solve( (#vr.54 < #t2.10)  ∥ (#vr.54 = #t2.10) )
                                case case_2
                                solve( (#t2.3 < #t2.11)  ∥ (#t2.3 = #t2.11) )
                                  case case_2
                                  solve( (#t2.11 < #t2.8)  ∥ (#t2.11 = #t2.8)  ∥ (#vr.31 < #t2.11) )
                                    case case_2
                                    solve( TPM_SendCommand( <'TPM2_Create', <swstate, nil>, 
                                                             'TPM_CC_PolicyPCR', nil>
                                           ) @ #t2.10 )
                                      case eventTPMSendCommandTPMCreateswstatenilTPMCCPolicyPCRnil_0_11111111111112111
                                      solve( state_11111111111112111( ~RouterID.1, ~ServerID.1, ~ak_h.1,
                                                                      ~ak_sk.1, ~ssk_nms.1, ~tid.1
                                             ) ▶₀ #t2.8 )
                                        case outTPMPCRExtendswstate_0_1111111111111211
                                        solve( Unlock_4( '4', ~n.1, 'device' ) @ #t2.9 )
                                          case unlockdevice_0_111111111111111111112111111111
                                          solve( state_111111111111111111112111111111( ~RouterID.1,
                                                                                       ~ServerID.1, ~ak_h.1,
                                                                                       ~ak_sk.1, ~ssk_nms.1,
                                                                                       a_h, a_sk, obj_ap,
                                                                                       obj_h, obj_pd, obj_pk,
                                                                                       obj_sh, ~n.1
                                                 ) ▶₀ #t2.8 )
                                            case outsignobjpkobjapask_0_11111111111111111111211111111
                                            solve( (#t2.2 < #t2.13)  ∥ (#t2.2 = #t2.13) )
                                              case case_2
                                              solve( (#t2.3 < #t2.13)  ∥ (#t2.3 = #t2.13) )
                                                case case_2
                                                solve( (#t2.4 < #t2.12)  ∥ (#t2.4 = #t2.12) )
                                                  case case_2
                                                  solve( (#t2.9 < #t2.12)  ∥ (#t2.9 = #t2.12) )
                                                    case case_2
                                                    solve( TPM_SendCommand( <'TPM2_Create', <swstate, nil>, 
                                                                             'TPM_CC_PolicyPCR', nil>
                                                           ) @ #t2.10 )
                                                      case eventTPMSendCommandTPMCreateswstatenilTPMCCPolicyPCRnil_0_11111111111112111
                                                      solve( state_11111111111112111( ~RouterID.1,
                                                                                      ~ServerID.1, ~ak_h.1,
                                                                                      ~ak_sk.1, ~ssk_nms.1,
                                                                                      ~tid.1
                                                             ) ▶₀ #t2.9 )
                                                        case outTPMPCRExtendswstate_0_1111111111111211
                                                        solve( TPM_SendCommand( <'TPM2_Certify', k_sh, ~k_h, 
                                                                                 ~ak_h>
                                                               ) @ #t2.10 )
                                                          case eventTPMSendCommandTPMCertifytlsshtlshakh_0_111111111111121111111111111
                                                          solve( state_111111111111121111111111111( ~RouterID.1,
                                                                                                    ~ServerID.1,
                                                                                                    ~ak_h,
                                                                                                    ~ak_sk.1,
                                                                                                    ~ssk_nms.1,
                                                                                                    ~tid.1,
                                                                                                    ~k_h,
                                                                                                    k_sh,
                                                                                                    tls_spk
                                                                 ) ▶₀ #t2.9 )
                                                            case outTPMPolicyPCRtlssh_0_11111111111112111111111111
                                                            solve( TPM_SendCommand( <'TPM2_Create', 
                                                                                     <swstate, nil>, 
                                                                                     'TPM_CC_PolicyPCR', nil>
                                                                   ) @ #t2.10 )
                                                              case eventTPMSendCommandTPMCreateswstatenilTPMCCPolicyPCRnil_0_11111111111112111
                                                              solve( state_11111111111112111( ~RouterID.1,
                                                                                              ~ServerID.1,
                                                                                              ~ak_h.1,
                                                                                              ~ak_sk.1,
                                                                                              ~ssk_nms.1,
                                                                                              ~tid.1
                                                                     ) ▶₀ #t2.9 )
                                                                case outTPMPCRExtendswstate_0_1111111111111211
                                                                solve( Insert( <'privatePart', ~ak_h>, ~ak_sk
                                                                       ) @ #t2.4 )
                                                                  case insertprivatePartakhaksk_0_111111111111111
                                                                  solve( Insert( <'publicPart', ~k_h>,
                                                                                 pk(~k_sk)
                                                                         ) @ #t2.2 )
                                                                    case insertpublicPartkhpkksk_0_1111111111111111111111211111111
                                                                    solve( Insert( <'authPolicy', ~k_h>,
                                                                                   <<swstate, nil>, 
                                                                                    'TPM_CC_PolicyPCR', nil>
                                                                           ) @ #t2.3 )
                                                                      case insertauthPolicykhauthPolicy_0_11111111111111111111112111111
                                                                      solve( Insert( <'policyDigest', k_sh>,
                                                                                     <<swstate, nil>, 
                                                                                      'TPM_CC_PolicyPCR', nil>
                                                                             ) @ #t2.9 )
                                                                        case insertpolicyDigestshpcrLTPMCCPolicyPCRpL_0_111111111111111111111112111111
                                                                        solve( state_111111111111111111111112111111( ~RouterID.1,
                                                                                                                     ~ServerID.1,
                                                                                                                     ~ak_h.1,
                                                                                                                     ~ak_sk.1,
                                                                                                                     ~ssk_nms.1,
                                                                                                                     nil,
                                                                                                                     <
                                                                                                                      swstate, 
                                                                                                                      nil
                                                                                                                     >,
                                                                                                                     k_sh,
                                                                                                                     lock
                                                                               ) ▶₀ #t2.9 )
                                                                          case eventPolicyPCRshpL_0_11111111111111111111111211111
                                                                          solve( (#vr.91 < #vr.56)  ∥
                                                                                 (#t2.1 < #vr.91) )
                                                                            case case_2
                                                                            solve( (#vr.39 < #t2.13)  ∥
                                                                                   (#vr.39 = #t2.13) )
                                                                              case case_1
                                                                              solve( state_1111111111111111111111121111111( ~RouterID.1,
                                                                                                                            ~ServerID.1,
                                                                                                                            ~ak_h.1,
                                                                                                                            ~ak_sk.1,
                                                                                                                            ~ssk_nms.1,
                                                                                                                            pL,
                                                                                                                            pcrL,
                                                                                                                            s_h,
                                                                                                                            ~n.2
                                                                                     ) ▶₀ #t2.10 )
                                                                                case insertpolicyDigestshpcrLTPMCCPolicyPCRpL_0_111111111111111111111112111111
                                                                                solve( (#vr.39 < #t2.16)  ∥
                                                                                       (#vr.39 = #t2.16) )
                                                                                  case case_1
                                                                                  solve( (#t2.13 < #t2.16)  ∥
                                                                                         (#t2.13 = #t2.16) )
                                                                                    case case_2
                                                                                    solve( (#t2.12 < #t2.15)  ∥
                                                                                           (#t2.12 = #t2.15) )
                                                                                      case case_2
                                                                                      solve( TPM_SendCommand( <
                                                                                                               'TPM2_PolicyPCR', 
                                                                                                               k_sh
                                                                                                              >
                                                                                             ) @ #t2.11 )
                                                                                        case eventTPMSendCommandTPMPolicyPCRtlssh_0_1111111111111211111111111
                                                                                        solve( state_1111111111111211111111111( ~RouterID.1,
                                                                                                                                ~ServerID.1,
                                                                                                                                ~ak_h.1,
                                                                                                                                ~ak_sk.1,
                                                                                                                                ~ssk_nms.1,
                                                                                                                                ~tid.1,
                                                                                                                                tls_h,
                                                                                                                                k_sh,
                                                                                                                                tls_spk
                                                                                               ) ▶₀ #t2.11 )
                                                                                          case eventGenerateTLStidtlsspk_0_111111111111121111111111
                                                                                          solve( TPM_SendCommand( <
                                                                                                                   'TPM2_PolicyPCR', 
                                                                                                                   k_sh
                                                                                                                  >
                                                                                                 ) @ #t2.14 )
                                                                                            case eventTPMSendCommandTPMPolicyPCRtlssh_0_1111111111111211111111111
                                                                                            solve( state_1111111111111211111111111( ~RouterID.1,
                                                                                                                                    ~ServerID.1,
                                                                                                                                    ~ak_h.1,
                                                                                                                                    ~ak_sk.1,
                                                                                                                                    ~ssk_nms.1,
                                                                                                                                    ~tid.1,
                                                                                                                                    tls_h,
                                                                                                                                    k_sh,
                                                                                                                                    tls_spk
                                                                                                   ) ▶₀ #t2.12 )
                                                                                              case eventGenerateTLStidtlsspk_0_111111111111121111111111
                                                                                              solve( TPM_SendCommand( <
                                                                                                                       'TPM2_Create', 
                                                                                                                       <
                                                                                                                        swstate, 
                                                                                                                        nil
                                                                                                                       >, 
                                                                                                                       'TPM_CC_PolicyPCR', 
                                                                                                                       nil
                                                                                                                      >
                                                                                                     ) @ #t2.14 )
                                                                                                case eventTPMSendCommandTPMCreateswstatenilTPMCCPolicyPCRnil_0_11111111111112111
                                                                                                solve( state_11111111111112111( ~RouterID.1,
                                                                                                                                ~ServerID.1,
                                                                                                                                ~ak_h.1,
                                                                                                                                ~ak_sk.1,
                                                                                                                                ~ssk_nms.1,
                                                                                                                                ~tid.1
                                                                                                       ) ▶₀ #t2.12 )
                                                                                                  case outTPMPCRExtendswstate_0_1111111111111211
                                                                                                  solve( TPM_SendCommand( <
                                                                                                                           'TPM2_Create', 
                                                                                                                           <
                                                                                                                            swstate, 
                                                                                                                            nil
                                                                                                                           >, 
                                                                                                                           'TPM_CC_PolicyPCR', 
                                                                                                                           nil
                                                                                                                          >
                                                                                                         ) @ #t2.14 )
                                                                                                    case eventTPMSendCommandTPMCreateswstatenilTPMCCPolicyPCRnil_0_11111111111112111
                                                                                                    solve( state_11111111111112111( ~RouterID.1,
                                                                                                                                    ~ServerID.1,
                                                                                                                                    ~ak_h.1,
                                                                                                                                    ~ak_sk.1,
                                                                                                                                    ~ssk_nms.1,
                                                                                                                                    ~tid.1
                                                                                                           ) ▶₀ #t2.12 )
                                                                                                      case outTPMPCRExtendswstate_0_1111111111111211
                                                                                                      solve( Insert( <
                                                                                                                      'privatePart', 
                                                                                                                      ~k_h
                                                                                                                     >,
                                                                                                                     ~k_sk
                                                                                                             ) @ #t2.7 )
                                                                                                        case insertprivatePartkhksk_0_111111111111111111111121111111
                                                                                                        solve( Insert( <
                                                                                                                        'authPolicy', 
                                                                                                                        ~k_h
                                                                                                                       >,
                                                                                                                       k_ap
                                                                                                               ) @ #t2.3 )
                                                                                                          case insertauthPolicykhauthPolicy_0_11111111111111111111112111111
                                                                                                          solve( Insert( <
                                                                                                                          'policyDigest', 
                                                                                                                          k_sh
                                                                                                                         >,
                                                                                                                         nil
                                                                                                                 ) @ #t2.12 )
                                                                                                            case insertpolicyDigestshnil_0_11111111111111111111121111
                                                                                                            solve( state_11111111111111111111121111( ~RouterID.1,
                                                                                                                                                     ~ServerID.1,
                                                                                                                                                     ~ak_h.1,
                                                                                                                                                     ~ak_sk.1,
                                                                                                                                                     ~s_h,
                                                                                                                                                     ~ssk_nms.1,
                                                                                                                                                     lock
                                                                                                                   ) ▶₀ #t2.12 )
                                                                                                              case lockdevice_0_1111111111111111111112111
                                                                                                              solve( (#vr.99 < #vr.55)  ∥
                                                                                                                     (#t2.1 < #vr.99) )
                                                                                                                case case_2
                                                                                                                solve( state_11111111111111111111121111111( ~RouterID.1,
                                                                                                                                                            ~ServerID.1,
                                                                                                                                                            ~ak_h.1,
                                                                                                                                                            ~ak_sk.1,
                                                                                                                                                            ~s_h.1,
                                                                                                                                                            ~ssk_nms.1,
                                                                                                                                                            ~n.3
                                                                                                                       ) ▶₀ #t2.13 )
                                                                                                                  case outsh_0_1111111111111111111112111111
                                                                                                                  solve( TPM_SendCommand( 'TPM2_StartAuthSession'
                                                                                                                         ) @ #t2.15 )
                                                                                                                    case eventTPMSendCommandTPMStartAuthSession_0_111111111111121111111
                                                                                                                    solve( state_111111111111121111111( ~RouterID.1,
                                                                                                                                                        ~ServerID.1,
                                                                                                                                                        ~ak_h.1,
                                                                                                                                                        ~ak_sk.1,
                                                                                                                                                        ~ssk_nms.1,
                                                                                                                                                        ~tid.1,
                                                                                                                                                        tls_h,
                                                                                                                                                        tls_spk
                                                                                                                           ) ▶₀ #t2.14 )
                                                                                                                      case eventHasKeyTLSRouterIDtlsspk_0_11111111111112111111
                                                                                                                      solve( TPM_SendCommand( 'TPM2_StartAuthSession'
                                                                                                                             ) @ #t2.16 )
                                                                                                                        case eventTPMSendCommandTPMStartAuthSession_0_111111111111121111111
                                                                                                                        solve( state_111111111111121111111( ~RouterID.1,
                                                                                                                                                            ~ServerID.1,
                                                                                                                                                            ~ak_h.1,
                                                                                                                                                            ~ak_sk.1,
                                                                                                                                                            ~ssk_nms.1,
                                                                                                                                                            ~tid.1,
                                                                                                                                                            tls_h,
                                                                                                                                                            tls_spk
                                                                                                                               ) ▶₀ #t2.15 )
                                                                                                                          case eventHasKeyTLSRouterIDtlsspk_0_11111111111112111111
                                                                                                                          solve( TPM_SendCommand( <
                                                                                                                                                   'TPM2_Create', 
                                                                                                                                                   <
                                                                                                                                                    swstate, 
                                                                                                                                                    nil
                                                                                                                                                   >, 
                                                                                                                                                   'TPM_CC_PolicyPCR', 
                                                                                                                                                   nil
                                                                                                                                                  >
                                                                                                                                 ) @ #t2.16 )
                                                                                                                            case eventTPMSendCommandTPMCreateswstatenilTPMCCPolicyPCRnil_0_11111111111112111
                                                                                                                            solve( state_11111111111112111( ~RouterID.1,
                                                                                                                                                            ~ServerID.1,
                                                                                                                                                            ~ak_h.1,
                                                                                                                                                            ~ak_sk.1,
                                                                                                                                                            ~ssk_nms.1,
                                                                                                                                                            ~tid.1
                                                                                                                                   ) ▶₀ #t2.15 )
                                                                                                                              case outTPMPCRExtendswstate_0_1111111111111211
                                                                                                                              solve( TPM_SendCommand( <
                                                                                                                                                       'TPM2_Create', 
                                                                                                                                                       <
                                                                                                                                                        swstate, 
                                                                                                                                                        nil
                                                                                                                                                       >, 
                                                                                                                                                       'TPM_CC_PolicyPCR', 
                                                                                                                                                       nil
                                                                                                                                                      >
                                                                                                                                     ) @ #t2.16 )
                                                                                                                                case eventTPMSendCommandTPMCreateswstatenilTPMCCPolicyPCRnil_0_11111111111112111
                                                                                                                                solve( state_11111111111112111( ~RouterID.1,
                                                                                                                                                                ~ServerID.1,
                                                                                                                                                                ~ak_h.1,
                                                                                                                                                                ~ak_sk.1,
                                                                                                                                                                ~ssk_nms.1,
                                                                                                                                                                ~tid.1
                                                                                                                                       ) ▶₀ #t2.15 )
                                                                                                                                  case outTPMPCRExtendswstate_0_1111111111111211
                                                                                                                                  solve( Insert( 'PCR',
                                                                                                                                                 <
                                                                                                                                                  swstate, 
                                                                                                                                                  nil
                                                                                                                                                 >
                                                                                                                                         ) @ #t2.15 )
                                                                                                                                    case insertPCRvaluepcr_0_1111111111111111111111111111
                                                                                                                                    solve( state_1111111111111111111111111111( ~RouterID.1,
                                                                                                                                                                               ~ServerID.1,
                                                                                                                                                                               ~ak_h.1,
                                                                                                                                                                               ~ak_sk.1,
                                                                                                                                                                               ~ssk_nms.1,
                                                                                                                                                                               lock,
                                                                                                                                                                               nil,
                                                                                                                                                                               swstate
                                                                                                                                           ) ▶₀ #t2.15 )
                                                                                                                                      case lookupPCRaspcr_0_111111111111111111111111111
                                                                                                                                      solve( (#vr.109 < #vr.54)  ∥
                                                                                                                                             (#t2.1 < #vr.109) )
                                                                                                                                        case case_1
                                                                                                                                        solve( (#vr.39 < #t2.18)  ∥
                                                                                                                                               (#vr.39 =
                                                                                                                                                #t2.18) )
                                                                                                                                          case case_2
                                                                                                                                          solve( state_11111111111111111111111111111( ~RouterID.1,
                                                                                                                                                                                      ~ServerID.1,
                                                                                                                                                                                      ~ak_h.1,
                                                                                                                                                                                      ~ak_sk.1,
                                                                                                                                                                                      ~ssk_nms.1,
                                                                                                                                                                                      ~n.4,
                                                                                                                                                                                      pcr,
                                                                                                                                                                                      value
                                                                                                                                                 ) ▶₀ #t2.16 )
                                                                                                                                            case insertPCRvaluepcr_0_1111111111111111111111111111
                                                                                                                                            solve( (#t2.17 < #t2.20)  ∥
                                                                                                                                                   (#t2.17 =
                                                                                                                                                    #t2.20) )
                                                                                                                                              case case_2
                                                                                                                                              solve( TPM_SendCommand( <
                                                                                                                                                                       'TPM2_PCR_Extend', 
                                                                                                                                                                       swstate
                                                                                                                                                                      >
                                                                                                                                                     ) @ #t2.18 )
                                                                                                                                                case eventTPMSendCommandTPMPCRExtendswstate_0_111111111111121
                                                                                                                                                solve( state_111111111111121( ~RouterID.1,
                                                                                                                                                                              ~ServerID.1,
                                                                                                                                                                              ~ak_h.1,
                                                                                                                                                                              ~ak_sk.1,
                                                                                                                                                                              ~ssk_nms.1,
                                                                                                                                                                              ~tid.1
                                                                                                                                                       ) ▶₀ #t2.18 )
                                                                                                                                                  case newtid_0_11111111111112
                                                                                                                                                  solve( TPM_SendCommand( <
                                                                                                                                                                           'TPM2_PCR_Extend', 
                                                                                                                                                                           swstate
                                                                                                                                                                          >
                                                                                                                                                         ) @ #t2.19 )
                                                                                                                                                    case eventTPMSendCommandTPMPCRExtendswstate_0_111111111111121
                                                                                                                                                    solve( state_111111111111121( ~RouterID.1,
                                                                                                                                                                                  ~ServerID.1,
                                                                                                                                                                                  ~ak_h.1,
                                                                                                                                                                                  ~ak_sk.1,
                                                                                                                                                                                  ~ssk_nms.1,
                                                                                                                                                                                  ~tid.1
                                                                                                                                                           ) ▶₀ #t2.19 )
                                                                                                                                                      case newtid_0_11111111111112
                                                                                                                                                      solve( Insert( 'PCR',
                                                                                                                                                                     nil
                                                                                                                                                             ) @ #t2.17 )
                                                                                                                                                        case insertPCRnil_0_11111111111111111
                                                                                                                                                        solve( !KU( pk(~k_sk)
                                                                                                                                                               ) @ #vk.7 )
                                                                                                                                                          case outTPMSigntlsshtlshtlsspkskae_0_1111111111111211111111111111111111
                                                                                                                                                          solve( TPM_SendCommand( <
                                                                                                                                                                                   'TPM2_Create', 
                                                                                                                                                                                   <
                                                                                                                                                                                    swstate, 
                                                                                                                                                                                    nil
                                                                                                                                                                                   >, 
                                                                                                                                                                                   'TPM_CC_PolicyPCR', 
                                                                                                                                                                                   nil
                                                                                                                                                                                  >
                                                                                                                                                                 ) @ #t2.19 )
                                                                                                                                                            case eventTPMSendCommandTPMCreateswstatenilTPMCCPolicyPCRnil_0_11111111111112111
                                                                                                                                                            solve( state_11111111111112111( ~RouterID.1,
                                                                                                                                                                                            ~ServerID.1,
                                                                                                                                                                                            ~ak_h.1,
                                                                                                                                                                                            ~ak_sk.1,
                                                                                                                                                                                            ~ssk_nms.1,
                                                                                                                                                                                            ~tid.1
                                                                                                                                                                   ) ▶₀ #t2.19 )
                                                                                                                                                              case outTPMPCRExtendswstate_0_1111111111111211
                                                                                                                                                              solve( !KU( ~ak_h
                                                                                                                                                                     ) @ #vk.15 )
                                                                                                                                                                case outTPMCertifytlsshtlshakh_0_1111111111111211111111111111
                                                                                                                                                                solve( TPM_SendCommand( <
                                                                                                                                                                                         'TPM2_Create', 
                                                                                                                                                                                         <
                                                                                                                                                                                          swstate, 
                                                                                                                                                                                          nil
                                                                                                                                                                                         >, 
                                                                                                                                                                                         'TPM_CC_PolicyPCR', 
                                                                                                                                                                                         nil
                                                                                                                                                                                        >
                                                                                                                                                                       ) @ #t2.19 )
                                                                                                                                                                  case eventTPMSendCommandTPMCreateswstatenilTPMCCPolicyPCRnil_0_11111111111112111
                                                                                                                                                                  solve( state_11111111111112111( ~RouterID.1,
                                                                                                                                                                                                  ~ServerID.1,
                                                                                                                                                                                                  ~ak_h.1,
                                                                                                                                                                                                  ~ak_sk.1,
                                                                                                                                                                                                  ~ssk_nms.1,
                                                                                                                                                                                                  ~tid.1
                                                                                                                                                                         ) ▶₀ #t2.19 )
                                                                                                                                                                    case outTPMPCRExtendswstate_0_1111111111111211
                                                                                                                                                                    solve( !KU( ~k_h
                                                                                                                                                                           ) @ #vk.15 )
                                                                                                                                                                      case outTPMCertifytlsshtlshakh_0_1111111111111211111111111111
                                                                                                                                                                      solve( TPM_SendCommand( <
                                                                                                                                                                                               'TPM2_Create', 
                                                                                                                                                                                               <
                                                                                                                                                                                                swstate, 
                                                                                                                                                                                                nil
                                                                                                                                                                                               >, 
                                                                                                                                                                                               'TPM_CC_PolicyPCR', 
                                                                                                                                                                                               nil
                                                                                                                                                                                              >
                                                                                                                                                                             ) @ #t2.19 )
                                                                                                                                                                        case eventTPMSendCommandTPMCreateswstatenilTPMCCPolicyPCRnil_0_11111111111112111
                                                                                                                                                                        solve( state_11111111111112111( ~RouterID.1,
                                                                                                                                                                                                        ~ServerID.1,
                                                                                                                                                                                                        ~ak_h.1,
                                                                                                                                                                                                        ~ak_sk.1,
                                                                                                                                                                                                        ~ssk_nms.1,
                                                                                                                                                                                                        ~tid.1
                                                                                                                                                                               ) ▶₀ #t2.19 )
                                                                                                                                                                          case outTPMPCRExtendswstate_0_1111111111111211
                                                                                                                                                                          solve( !KU( ~s_h
                                                                                                                                                                                 ) @ #vk.14 )
                                                                                                                                                                            case outsh_0_1111111111111111111112111111
                                                                                                                                                                            solve( TPM_SendCommand( 'TPM2_StartAuthSession'
                                                                                                                                                                                   ) @ #t2.19 )
                                                                                                                                                                              case eventTPMSendCommandTPMStartAuthSession_0_111111111111121111111
                                                                                                                                                                              solve( state_111111111111121111111( ~RouterID.1,
                                                                                                                                                                                                                  ~ServerID.1,
                                                                                                                                                                                                                  ~ak_h.1,
                                                                                                                                                                                                                  ~ak_sk.1,
                                                                                                                                                                                                                  ~ssk_nms.1,
                                                                                                                                                                                                                  ~tid.1,
                                                                                                                                                                                                                  tls_h,
                                                                                                                                                                                                                  tls_spk
                                                                                                                                                                                     ) ▶₀ #t2.19 )
                                                                                                                                                                                case eventHasKeyTLSRouterIDtlsspk_0_11111111111112111111
                                                                                                                                                                                solve( TPM_SendCommand( <
                                                                                                                                                                                                         'TPM2_Create', 
                                                                                                                                                                                                         <
                                                                                                                                                                                                          swstate, 
                                                                                                                                                                                                          nil
                                                                                                                                                                                                         >, 
                                                                                                                                                                                                         'TPM_CC_PolicyPCR', 
                                                                                                                                                                                                         nil
                                                                                                                                                                                                        >
                                                                                                                                                                                       ) @ #t2.19 )
                                                                                                                                                                                  case eventTPMSendCommandTPMCreateswstatenilTPMCCPolicyPCRnil_0_11111111111112111
                                                                                                                                                                                  solve( state_11111111111112111( ~RouterID.1,
                                                                                                                                                                                                                  ~ServerID.1,
                                                                                                                                                                                                                  ~ak_h.1,
                                                                                                                                                                                                                  ~ak_sk.1,
                                                                                                                                                                                                                  ~ssk_nms.1,
                                                                                                                                                                                                                  ~tid.1
                                                                                                                                                                                         ) ▶₀ #t2.19 )
                                                                                                                                                                                    case outTPMPCRExtendswstate_0_1111111111111211
                                                                                                                                                                                    SOLVED // trace found
                                                                                                                                                                                  qed
                                                                                                                                                                                qed
                                                                                                                                                                              qed
                                                                                                                                                                            qed
                                                                                                                                                                          qed
                                                                                                                                                                        qed
                                                                                                                                                                      qed
                                                                                                                                                                    qed
                                                                                                                                                                  qed
                                                                                                                                                                qed
                                                                                                                                                              qed
                                                                                                                                                            qed
                                                                                                                                                          qed
                                                                                                                                                        qed
                                                                                                                                                      qed
                                                                                                                                                    qed
                                                                                                                                                  qed
                                                                                                                                                qed
                                                                                                                                              qed
                                                                                                                                            qed
                                                                                                                                          qed
                                                                                                                                        qed
                                                                                                                                      qed
                                                                                                                                    qed
                                                                                                                                  qed
                                                                                                                                qed
                                                                                                                              qed
                                                                                                                            qed
                                                                                                                          qed
                                                                                                                        qed
                                                                                                                      qed
                                                                                                                    qed
                                                                                                                  qed
                                                                                                                qed
                                                                                                              qed
                                                                                                            qed
                                                                                                          qed
                                                                                                        qed
                                                                                                      qed
                                                                                                    qed
                                                                                                  qed
                                                                                                qed
                                                                                              qed
                                                                                            qed
                                                                                          qed
                                                                                        qed
                                                                                      qed
                                                                                    qed
                                                                                  qed
                                                                                qed
                                                                              qed
                                                                            qed
                                                                          qed
                                                                        qed
                                                                      qed
                                                                    qed
                                                                  qed
                                                                qed
                                                              qed
                                                            qed
                                                          qed
                                                        qed
                                                      qed
                                                    qed
                                                  qed
                                                qed
                                              qed
                                            qed
                                          qed
                                        qed
                                      qed
                                    qed
                                  qed
                                qed
                              qed
                            qed
                          qed
                        qed
                      qed
                    qed
                  qed
                qed
              qed
            qed
          qed
        qed
      qed
    qed
  qed
qed

lemma AvailabilityKey:
  all-traces
  "∀ label id1 id2 k1 k2 #t1 #t2.
    (((¬(id1 = id2)) ∧ (HasKey( label, id1, k1 ) @ #t1)) ∧
     (HasKey( label, id2, k2 ) @ #t2)) ⇒
    (k1 = k2)"
/*
guarded formula characterizing all counter-examples:
"∃ label id1 id2 k1 k2 #t1 #t2.
  (HasKey( label, id1, k1 ) @ #t1) ∧ (HasKey( label, id2, k2 ) @ #t2)
 ∧
  (¬(id1 = id2)) ∧ (¬(k1 = k2))"
*/
simplify
solve( HasKey( label, id1, k1 ) @ #t1 )
  case eventHasKeyAKRouterIDpkaksk_0_1111111111111211111111111111111
  solve( state_1111111111111211111111111111111( ~RouterID, ~ServerID,
                                                ~ak_h, ~ak_sk, ~ssk_nms, ~tid, skae, tls_h, tls_sh, tls_spk
         ) ▶₀ #t1 )
    case eventRouterUseTLStlsspk_0_111111111111121111111111111111
    solve( HasKey( 'AK', id2, k2 ) @ #t2.1 )
      case eventHasKeyAKRouterIDpkaksk_0_1111111111111211111111111111111
      solve( state_1111111111111211111111111111111( ~RouterID.1, ~ServerID.1,
                                                    ~ak_h.1, ~ak_sk.1, ~ssk_nms.1, ~tid.1, skae.1, tls_h,
                                                    tls_sh.1, tls_spk
             ) ▶₀ #t2 )
        case eventRouterUseTLStlsspk_0_111111111111121111111111111111
        by contradiction /* from formulas */
      qed
    next
      case eventHasKeyAKServerIDpkaksk_0_1111111111112111111
      solve( state_1111111111112111111( ~RouterID.1, ~ServerID.1, ~ak_h.1,
                                        ~ak_sk.1, ~ssk_nms.1, csr, skae.1, tls_spk
             ) ▶₀ #t2 )
        case eventHasKeyTLSServerIDtlsspk_0_111111111111211111
        by contradiction /* from formulas */
      qed
    qed
  qed
next
  case eventHasKeyAKServerIDpkaksk_0_1111111111112111111
  solve( state_1111111111112111111( ~RouterID, ~ServerID, ~ak_h, ~ak_sk,
                                    ~ssk_nms, csr, skae, tls_spk
         ) ▶₀ #t1 )
    case eventHasKeyTLSServerIDtlsspk_0_111111111111211111
    solve( HasKey( 'AK', id2, k2 ) @ #t2 )
      case eventHasKeyAKRouterIDpkaksk_0_1111111111111211111111111111111
      solve( state_1111111111111211111111111111111( ~RouterID.1, ~ServerID.1,
                                                    ~ak_h.1, ~ak_sk.1, ~ssk_nms.1, ~tid, skae, tls_h, tls_sh,
                                                    tls_spk
             ) ▶₀ #t2 )
        case eventRouterUseTLStlsspk_0_111111111111121111111111111111
        by contradiction /* from formulas */
      qed
    next
      case eventHasKeyAKServerIDpkaksk_0_1111111111112111111
      solve( state_1111111111112111111( ~RouterID.1, ~ServerID.1, ~ak_h.1,
                                        ~ak_sk.1, ~ssk_nms.1, csr, skae, tls_spk
             ) ▶₀ #t2 )
        case eventHasKeyTLSServerIDtlsspk_0_111111111111211111
        by contradiction /* from formulas */
      qed
    qed
  qed
next
  case eventHasKeyNMSRouterIDpkssknms_0_111111111111121111111111111111111111111
  solve( state_111111111111121111111111111111111111111( ~RouterID,
                                                        ~ServerID, ~ak_h, ~ak_sk, ~ssk_nms, ~tid, csr, skae,
                                                        tls_h, tls_sh, tls_spk
         ) ▶₀ #t1 )
    case outtlsspkskaecsr_0_11111111111112111111111111111111111111
    solve( ((#vr.15 < #vr.49) ∧
            (∃ #t2.
              (Unlock_5( '5', ~n, 'device' ) @ #t2)
             ∧
              (#vr.15 < #t2) ∧
              (#t2 < #vr.49) ∧
              (∀ #t0 pp. (Unlock( pp, ~n, 'device' ) @ #t0) ⇒ #t0 = #t2) ∧
              (∀ pp lpp #t0.
                (Lock( pp, lpp, 'device' ) @ #t0)
               ⇒
                ((#t0 < #vr.15) ∨ (#t0 = #vr.15) ∨ (#t2 < #t0))) ∧
              (∀ pp lpp #t0.
                (Unlock( pp, lpp, 'device' ) @ #t0)
               ⇒
                ((#t0 < #vr.15) ∨ (#t2 < #t0) ∨ (#t2 = #t0)))))  ∥
           (#vr.49 < #vr.15) )
      case case_1
      solve( HasKey( 'NMS', id2, k2 ) @ #t2.6 )
        case eventHasKeyNMSRouterIDpkssknms_0_111111111111121111111111111111111111111
        solve( state_111111111111121111111111111111111111111( ~RouterID.1,
                                                              ~ServerID.1, ~ak_h.1, ~ak_sk.1, ~ssk_nms.1,
                                                              ~tid.1, csr, skae, tls_h, tls_sh.1, tls_spk
               ) ▶₀ #t2 )
          case outtlsspkskaecsr_0_11111111111112111111111111111111111111
          by contradiction /* from formulas */
        qed
      next
        case eventHasKeyNMSServerIDpkssknms_0_11111111111121111111
        solve( state_11111111111121111111( ~RouterID.1, ~ServerID.1, ~ak_h.1,
                                           ~ak_sk.1, ~ssk_nms.1, csr, skae, tls_spk
               ) ▶₀ #t2 )
          case eventHasKeyAKServerIDpkaksk_0_1111111111112111111
          by contradiction /* from formulas */
        qed
      qed
    next
      case case_2
      solve( state_111111111111111111111121111111111( ~RouterID.1, ~ServerID.1,
                                                      ~ak_h.1, ~ak_sk.1, ~k_h.2, ~k_sk.2, ~ssk_nms.1,
                                                      authPolicy.1, ~n.1
             ) ▶₀ #t2 )
        case TpmCreateOutkhpkksk_0_11111111111111111111112111111111
        solve( HasKey( 'NMS', id2, k2 ) @ #t2.7 )
          case eventHasKeyNMSRouterIDpkssknms_0_111111111111121111111111111111111111111
          solve( state_111111111111121111111111111111111111111( ~RouterID.1,
                                                                ~ServerID.1, ~ak_h.1, ~ak_sk.1, ~ssk_nms.1,
                                                                ~tid.1, csr, skae, tls_h, tls_sh.1, tls_spk
                 ) ▶₀ #t2.1 )
            case outtlsspkskaecsr_0_11111111111112111111111111111111111111
            by contradiction /* from formulas */
          qed
        next
          case eventHasKeyNMSServerIDpkssknms_0_11111111111121111111
          solve( state_11111111111121111111( ~RouterID.1, ~ServerID.1, ~ak_h.1,
                                             ~ak_sk.1, ~ssk_nms.1, csr, skae, tls_spk
                 ) ▶₀ #t2.1 )
            case eventHasKeyAKServerIDpkaksk_0_1111111111112111111
            by contradiction /* from formulas */
          qed
        qed
      qed
    qed
  qed
next
  case eventHasKeyNMSServerIDpkssknms_0_11111111111121111111
  solve( state_11111111111121111111( ~RouterID, ~ServerID, ~ak_h, ~ak_sk,
                                     ~ssk_nms, csr, skae, tls_spk
         ) ▶₀ #t1 )
    case eventHasKeyAKServerIDpkaksk_0_1111111111112111111
    solve( HasKey( 'NMS', id2, k2 ) @ #t2 )
      case eventHasKeyNMSRouterIDpkssknms_0_111111111111121111111111111111111111111
      solve( state_111111111111121111111111111111111111111( ~RouterID.1,
                                                            ~ServerID.1, ~ak_h.1, ~ak_sk.1, ~ssk_nms.1, ~tid,
                                                            csr, skae, tls_h, tls_sh, tls_spk
             ) ▶₀ #t2 )
        case outtlsspkskaecsr_0_11111111111112111111111111111111111111
        by contradiction /* from formulas */
      qed
    next
      case eventHasKeyNMSServerIDpkssknms_0_11111111111121111111
      solve( state_11111111111121111111( ~RouterID.1, ~ServerID.1, ~ak_h.1,
                                         ~ak_sk.1, ~ssk_nms.1, csr, skae, tls_spk
             ) ▶₀ #t2 )
        case eventHasKeyAKServerIDpkaksk_0_1111111111112111111
        by contradiction /* from formulas */
      qed
    qed
  qed
next
  case eventHasKeyTLSRouterIDtlsspk_0_11111111111112111111
  solve( state_11111111111112111111( ~RouterID, ~ServerID, ~ak_h, ~ak_sk,
                                     ~ssk_nms, ~tid, tls_h, k1
         ) ▶₀ #t1 )
    case TpmCreateOuttlshtlsspk_0_1111111111111211111
    solve( HasKey( 'TLS', id2, k2 ) @ #t2.1 )
      case eventHasKeyTLSRouterIDtlsspk_0_11111111111112111111
      solve( state_11111111111112111111( ~RouterID.1, ~ServerID.1, ~ak_h.1,
                                         ~ak_sk.1, ~ssk_nms.1, ~tid.1, tls_h, k2
             ) ▶₀ #t2 )
        case TpmCreateOuttlshtlsspk_0_1111111111111211111
        by contradiction /* from formulas */
      qed
    next
      case eventHasKeyTLSServerIDtlsspk_0_111111111111211111
      solve( state_111111111111211111( ~RouterID.1, ~ServerID.1, ~ak_h.1,
                                       ~ak_sk.1, ~ssk_nms.1, csr, skae, k2
             ) ▶₀ #t2 )
        case eventReceiveValueCSRServerIDcsr_0_11111111111121111
        solve( TPM_SendCommand( <'TPM2_Create', authPolicy> ) @ #t2.1 )
          case eventTPMSendCommandTPMCreateswstatenilTPMCCPolicyPCRnil_0_11111111111112111
          solve( state_11111111111112111( ~RouterID.1, ~ServerID.1, ~ak_h.1,
                                          ~ak_sk.1, ~ssk_nms.1, ~tid.1
                 ) ▶₀ #t2.1 )
            case outTPMPCRExtendswstate_0_1111111111111211
            solve( !KU( sign(<pk(x), <swstate, nil>, 'TPM_CC_PolicyPCR', nil>,
                             ~ak_sk)
                   ) @ #vk.6 )
              case c_sign
              solve( !KU( sign(<pk(x), 
                                sign(<pk(x), <swstate, nil>, 'TPM_CC_PolicyPCR', nil>, ~ak_sk)>,
                               x)
                     ) @ #vk.8 )
                case c_sign
                by solve( !KU( ~ak_sk ) @ #vk.14 )
              next
                case outsignobjpkobjapask_0_11111111111111111111211111111
                solve( ((#vr.9 < #vr.52) ∧
                        (∃ #t2.
                          (Unlock_2( '2', ~n, 'device' ) @ #t2)
                         ∧
                          (#vr.9 < #t2) ∧
                          (#t2 < #vr.52) ∧
                          (∀ #t0 pp. (Unlock( pp, ~n, 'device' ) @ #t0) ⇒ #t0 = #t2) ∧
                          (∀ pp lpp #t0.
                            (Lock( pp, lpp, 'device' ) @ #t0)
                           ⇒
                            ((#t0 < #vr.9) ∨ (#t0 = #vr.9) ∨ (#t2 < #t0))) ∧
                          (∀ pp lpp #t0.
                            (Unlock( pp, lpp, 'device' ) @ #t0)
                           ⇒
                            ((#t0 < #vr.9) ∨ (#t2 < #t0) ∨ (#t2 = #t0)))))  ∥
                       (#vr.52 < #vr.9) )
                  case case_1
                  solve( state_111111111111111111111121111111111( ~RouterID.1, ~ServerID.1,
                                                                  ~ak_h.1, ~ak_sk.1, ~k_h.1, ~k_sk.1,
                                                                  ~ssk_nms.1, authPolicy, ~n
                         ) ▶₀ #t2.2 )
                    case TpmCreateOutkhpkksk_0_11111111111111111111112111111111
                    solve( TPM_SendCommand( <'TPM2_Certify', obj_sh, obj_h, a_h> ) @ #t2.3 )
                      case eventTPMSendCommandTPMCertifytlsshtlshakh_0_111111111111121111111111111
                      solve( state_111111111111121111111111111( ~RouterID.1, ~ServerID.1,
                                                                ~ak_h.1, ~ak_sk.1, ~ssk_nms.1, ~tid.1, obj_h,
                                                                obj_sh, tls_spk
                             ) ▶₀ #t2.3 )
                        case outTPMPolicyPCRtlssh_0_11111111111112111111111111
                        solve( (#vr.3 < #t2.5)  ∥ (#vr.3 = #t2.5) )
                          case case_1
                          solve( (#vr.7 < #t2.6)  ∥ (#vr.7 = #t2.6) )
                            case case_1
                            solve( (#vr.37 < #t2.5)  ∥ (#vr.37 = #t2.5) )
                              case case_1
                              solve( TPM_SendCommand( <'TPM2_Create', <swstate, nil>, 
                                                       'TPM_CC_PolicyPCR', nil>
                                     ) @ #t2.8 )
                                case eventTPMSendCommandTPMCreateswstatenilTPMCCPolicyPCRnil_0_11111111111112111
                                solve( state_11111111111112111( ~RouterID.1, ~ServerID.1, ~ak_h.1,
                                                                ~ak_sk.1, ~ssk_nms.1, ~tid.1
                                       ) ▶₀ #t2.4 )
                                  case outTPMPCRExtendswstate_0_1111111111111211
                                  solve( TPM_SendCommand( <'TPM2_Create', <swstate, nil>, 
                                                           'TPM_CC_PolicyPCR', nil>
                                         ) @ #t2.8 )
                                    case eventTPMSendCommandTPMCreateswstatenilTPMCCPolicyPCRnil_0_11111111111112111
                                    solve( state_11111111111112111( ~RouterID.1, ~ServerID.1, ~ak_h.1,
                                                                    ~ak_sk.1, ~ssk_nms.1, ~tid.1
                                           ) ▶₀ #t2.4 )
                                      case outTPMPCRExtendswstate_0_1111111111111211
                                      by solve( !KU( ~ak_sk ) @ #vk.14 )
                                    qed
                                  qed
                                qed
                              qed
                            next
                              case case_2
                              solve( TPM_SendCommand( <'TPM2_Create', <swstate, nil>, 
                                                       'TPM_CC_PolicyPCR', nil>
                                     ) @ #t2.8 )
                                case eventTPMSendCommandTPMCreateswstatenilTPMCCPolicyPCRnil_0_11111111111112111
                                solve( state_11111111111112111( ~RouterID.1, ~ServerID.1, ~ak_h.1,
                                                                ~ak_sk.1, ~ssk_nms.1, ~tid.1
                                       ) ▶₀ #t2.5 )
                                  case outTPMPCRExtendswstate_0_1111111111111211
                                  solve( TPM_SendCommand( <'TPM2_Create', <swstate, nil>, 
                                                           'TPM_CC_PolicyPCR', nil>
                                         ) @ #t2.8 )
                                    case eventTPMSendCommandTPMCreateswstatenilTPMCCPolicyPCRnil_0_11111111111112111
                                    solve( state_11111111111112111( ~RouterID.1, ~ServerID.1, ~ak_h.1,
                                                                    ~ak_sk.1, ~ssk_nms.1, ~tid.1
                                           ) ▶₀ #t2.5 )
                                      case outTPMPCRExtendswstate_0_1111111111111211
                                      by solve( !KU( ~ak_sk ) @ #vk.14 )
                                    qed
                                  qed
                                qed
                              qed
                            qed
                          next
                            case case_2
                            solve( (#vr.36 < #t2.6)  ∥ (#vr.36 = #t2.6) )
                              case case_1
                              solve( TPM_SendCommand( <'TPM2_Create', <swstate, nil>, 
                                                       'TPM_CC_PolicyPCR', nil>
                                     ) @ #t2.8 )
                                case eventTPMSendCommandTPMCreateswstatenilTPMCCPolicyPCRnil_0_11111111111112111
                                solve( state_11111111111112111( ~RouterID.1, ~ServerID.1, ~ak_h.1,
                                                                ~ak_sk.1, ~ssk_nms.1, ~tid.1
                                       ) ▶₀ #t2.5 )
                                  case outTPMPCRExtendswstate_0_1111111111111211
                                  solve( TPM_SendCommand( <'TPM2_Create', <swstate, nil>, 
                                                           'TPM_CC_PolicyPCR', nil>
                                         ) @ #t2.8 )
                                    case eventTPMSendCommandTPMCreateswstatenilTPMCCPolicyPCRnil_0_11111111111112111
                                    solve( state_11111111111112111( ~RouterID.1, ~ServerID.1, ~ak_h.1,
                                                                    ~ak_sk.1, ~ssk_nms.1, ~tid.1
                                           ) ▶₀ #t2.5 )
                                      case outTPMPCRExtendswstate_0_1111111111111211
                                      by solve( !KU( ~ak_sk ) @ #vk.14 )
                                    qed
                                  qed
                                qed
                              qed
                            next
                              case case_2
                              solve( TPM_SendCommand( <'TPM2_Create', <swstate, nil>, 
                                                       'TPM_CC_PolicyPCR', nil>
                                     ) @ #t2.8 )
                                case eventTPMSendCommandTPMCreateswstatenilTPMCCPolicyPCRnil_0_11111111111112111
                                solve( state_11111111111112111( ~RouterID.1, ~ServerID.1, ~ak_h.1,
                                                                ~ak_sk.1, ~ssk_nms.1, ~tid.1
                                       ) ▶₀ #t2.6 )
                                  case outTPMPCRExtendswstate_0_1111111111111211
                                  solve( TPM_SendCommand( <'TPM2_Create', <swstate, nil>, 
                                                           'TPM_CC_PolicyPCR', nil>
                                         ) @ #t2.8 )
                                    case eventTPMSendCommandTPMCreateswstatenilTPMCCPolicyPCRnil_0_11111111111112111
                                    solve( state_11111111111112111( ~RouterID.1, ~ServerID.1, ~ak_h.1,
                                                                    ~ak_sk.1, ~ssk_nms.1, ~tid.1
                                           ) ▶₀ #t2.6 )
                                      case outTPMPCRExtendswstate_0_1111111111111211
                                      by solve( !KU( ~ak_sk ) @ #vk.14 )
                                    qed
                                  qed
                                qed
                              qed
                            qed
                          qed
                        next
                          case case_2
                          solve( (#vr.7 < #t2.5)  ∥ (#vr.7 = #t2.5) )
                            case case_1
                            solve( (#vr.37 < #t2.4)  ∥ (#vr.37 = #t2.4) )
                              case case_1
                              solve( TPM_SendCommand( <'TPM2_Create', <swstate, nil>, 
                                                       'TPM_CC_PolicyPCR', nil>
                                     ) @ #t2.7 )
                                case eventTPMSendCommandTPMCreateswstatenilTPMCCPolicyPCRnil_0_11111111111112111
                                solve( state_11111111111112111( ~RouterID.1, ~ServerID.1, ~ak_h.1,
                                                                ~ak_sk.1, ~ssk_nms.1, ~tid.1
                                       ) ▶₀ #t2.4 )
                                  case outTPMPCRExtendswstate_0_1111111111111211
                                  solve( TPM_SendCommand( <'TPM2_Create', <swstate, nil>, 
                                                           'TPM_CC_PolicyPCR', nil>
                                         ) @ #t2.7 )
                                    case eventTPMSendCommandTPMCreateswstatenilTPMCCPolicyPCRnil_0_11111111111112111
                                    solve( state_11111111111112111( ~RouterID.1, ~ServerID.1, ~ak_h.1,
                                                                    ~ak_sk.1, ~ssk_nms.1, ~tid.1
                                           ) ▶₀ #t2.4 )
                                      case outTPMPCRExtendswstate_0_1111111111111211
                                      by solve( !KU( ~ak_sk ) @ #vk.14 )
                                    qed
                                  qed
                                qed
                              qed
                            next
                              case case_2
                              solve( TPM_SendCommand( <'TPM2_Create', <swstate, nil>, 
                                                       'TPM_CC_PolicyPCR', nil>
                                     ) @ #t2.7 )
                                case eventTPMSendCommandTPMCreateswstatenilTPMCCPolicyPCRnil_0_11111111111112111
                                solve( state_11111111111112111( ~RouterID.1, ~ServerID.1, ~ak_h.1,
                                                                ~ak_sk.1, ~ssk_nms.1, ~tid.1
                                       ) ▶₀ #t2.5 )
                                  case outTPMPCRExtendswstate_0_1111111111111211
                                  solve( TPM_SendCommand( <'TPM2_Create', <swstate, nil>, 
                                                           'TPM_CC_PolicyPCR', nil>
                                         ) @ #t2.7 )
                                    case eventTPMSendCommandTPMCreateswstatenilTPMCCPolicyPCRnil_0_11111111111112111
                                    solve( state_11111111111112111( ~RouterID.1, ~ServerID.1, ~ak_h.1,
                                                                    ~ak_sk.1, ~ssk_nms.1, ~tid.1
                                           ) ▶₀ #t2.5 )
                                      case outTPMPCRExtendswstate_0_1111111111111211
                                      by solve( !KU( ~ak_sk ) @ #vk.14 )
                                    qed
                                  qed
                                qed
                              qed
                            qed
                          next
                            case case_2
                            solve( (#vr.36 < #t2.5)  ∥ (#vr.36 = #t2.5) )
                              case case_1
                              solve( TPM_SendCommand( <'TPM2_Create', <swstate, nil>, 
                                                       'TPM_CC_PolicyPCR', nil>
                                     ) @ #t2.7 )
                                case eventTPMSendCommandTPMCreateswstatenilTPMCCPolicyPCRnil_0_11111111111112111
                                solve( state_11111111111112111( ~RouterID.1, ~ServerID.1, ~ak_h.1,
                                                                ~ak_sk.1, ~ssk_nms.1, ~tid.1
                                       ) ▶₀ #t2.5 )
                                  case outTPMPCRExtendswstate_0_1111111111111211
                                  solve( TPM_SendCommand( <'TPM2_Create', <swstate, nil>, 
                                                           'TPM_CC_PolicyPCR', nil>
                                         ) @ #t2.7 )
                                    case eventTPMSendCommandTPMCreateswstatenilTPMCCPolicyPCRnil_0_11111111111112111
                                    solve( state_11111111111112111( ~RouterID.1, ~ServerID.1, ~ak_h.1,
                                                                    ~ak_sk.1, ~ssk_nms.1, ~tid.1
                                           ) ▶₀ #t2.5 )
                                      case outTPMPCRExtendswstate_0_1111111111111211
                                      by solve( !KU( ~ak_sk ) @ #vk.14 )
                                    qed
                                  qed
                                qed
                              qed
                            next
                              case case_2
                              solve( TPM_SendCommand( <'TPM2_Create', <swstate, nil>, 
                                                       'TPM_CC_PolicyPCR', nil>
                                     ) @ #t2.7 )
                                case eventTPMSendCommandTPMCreateswstatenilTPMCCPolicyPCRnil_0_11111111111112111
                                solve( state_11111111111112111( ~RouterID.1, ~ServerID.1, ~ak_h.1,
                                                                ~ak_sk.1, ~ssk_nms.1, ~tid.1
                                       ) ▶₀ #t2.6 )
                                  case outTPMPCRExtendswstate_0_1111111111111211
                                  solve( TPM_SendCommand( <'TPM2_Create', <swstate, nil>, 
                                                           'TPM_CC_PolicyPCR', nil>
                                         ) @ #t2.7 )
                                    case eventTPMSendCommandTPMCreateswstatenilTPMCCPolicyPCRnil_0_11111111111112111
                                    solve( state_11111111111112111( ~RouterID.1, ~ServerID.1, ~ak_h.1,
                                                                    ~ak_sk.1, ~ssk_nms.1, ~tid.1
                                           ) ▶₀ #t2.6 )
                                      case outTPMPCRExtendswstate_0_1111111111111211
                                      by solve( !KU( ~ak_sk ) @ #vk.14 )
                                    qed
                                  qed
                                qed
                              qed
                            qed
                          qed
                        qed
                      qed
                    qed
                  qed
                next
                  case case_2
                  solve( TPM_SendCommand( <'TPM2_Certify', obj_sh, obj_h, a_h> ) @ #t2.2 )
                    case eventTPMSendCommandTPMCertifytlsshtlshakh_0_111111111111121111111111111
                    solve( state_111111111111121111111111111( ~RouterID.1, ~ServerID.1,
                                                              ~ak_h.1, ~ak_sk.1, ~ssk_nms.1, ~tid.1, obj_h,
                                                              obj_sh, tls_spk
                           ) ▶₀ #t2.2 )
                      case outTPMPolicyPCRtlssh_0_11111111111112111111111111
                      by contradiction /* cyclic */
                    qed
                  qed
                qed
              next
                case outtlsspkskaecsr_0_11111111111112111111111111111111111111
                solve( ((#vr.9 < #vr.62) ∧
                        (∃ #t2.
                          (Unlock_2( '2', ~n, 'device' ) @ #t2)
                         ∧
                          (#vr.9 < #t2) ∧
                          (#t2 < #vr.62) ∧
                          (∀ #t0 pp. (Unlock( pp, ~n, 'device' ) @ #t0) ⇒ #t0 = #t2) ∧
                          (∀ pp lpp #t0.
                            (Lock( pp, lpp, 'device' ) @ #t0)
                           ⇒
                            ((#t0 < #vr.9) ∨ (#t0 = #vr.9) ∨ (#t2 < #t0))) ∧
                          (∀ pp lpp #t0.
                            (Unlock( pp, lpp, 'device' ) @ #t0)
                           ⇒
                            ((#t0 < #vr.9) ∨ (#t2 < #t0) ∨ (#t2 = #t0)))))  ∥
                       (#vr.62 < #vr.9) )
                  case case_1
                  solve( state_111111111111111111111121111111111( ~RouterID.1, ~ServerID.1,
                                                                  ~ak_h.1, ~ak_sk.1, ~k_h.2, ~k_sk.1,
                                                                  ~ssk_nms.1, authPolicy, ~n
                         ) ▶₀ #t2.2 )
                    case TpmCreateOutkhpkksk_0_11111111111111111111112111111111
                    solve( TPM_SendCommand( <'TPM2_Sign', k_sh, k_h.1, pk(x), 
                                             sign(<pk(x), <swstate, nil>, 'TPM_CC_PolicyPCR', nil>, ~ak_sk)>
                           ) @ #t2.3 )
                      case eventTPMSendCommandTPMSigntlsshtlshtlsspkskae_0_111111111111121111111111111111111
                      solve( state_111111111111121111111111111111111( ~RouterID.1, ~ServerID.1,
                                                                      ~ak_h.1, ~ak_sk.1, ~ssk_nms.1, ~tid.1,
                                                                      sign(<pk(x), <swstate, nil>, 
                                                                            'TPM_CC_PolicyPCR', nil>,
                                                                           ~ak_sk),
                                                                      k_h.1, k_sh, pk(x)
                             ) ▶₀ #t2.3 )
                        case ifverifyskaetlsspkswstatenilTPMCCPolicyPCRnilpkaksktrue_0_11111111111112111111111111111111
                        by contradiction /* from formulas */
                      qed
                    qed
                  qed
                next
                  case case_2
                  solve( TPM_SendCommand( <'TPM2_Sign', k_sh, k_h.1, pk(x), 
                                           sign(<pk(x), <swstate, nil>, 'TPM_CC_PolicyPCR', nil>, ~ak_sk)>
                         ) @ #t2.2 )
                    case eventTPMSendCommandTPMSigntlsshtlshtlsspkskae_0_111111111111121111111111111111111
                    solve( state_111111111111121111111111111111111( ~RouterID.1, ~ServerID.1,
                                                                    ~ak_h.1, ~ak_sk.1, ~ssk_nms.1, ~tid.1,
                                                                    sign(<pk(x), <swstate, nil>, 
                                                                          'TPM_CC_PolicyPCR', nil>,
                                                                         ~ak_sk),
                                                                    k_h.1, k_sh, pk(x)
                           ) ▶₀ #t2.2 )
                      case ifverifyskaetlsspkswstatenilTPMCCPolicyPCRnilpkaksktrue_0_11111111111112111111111111111111
                      by contradiction /* cyclic */
                    qed
                  qed
                qed
              qed
            next
              case outsignobjpkobjapask_0_11111111111111111111211111111
              solve( ((#vr.9 < #vr.52) ∧
                      (∃ #t2.
                        (Unlock_2( '2', ~n, 'device' ) @ #t2)
                       ∧
                        (#vr.9 < #t2) ∧
                        (#t2 < #vr.52) ∧
                        (∀ #t0 pp. (Unlock( pp, ~n, 'device' ) @ #t0) ⇒ #t0 = #t2) ∧
                        (∀ pp lpp #t0.
                          (Lock( pp, lpp, 'device' ) @ #t0)
                         ⇒
                          ((#t0 < #vr.9) ∨ (#t0 = #vr.9) ∨ (#t2 < #t0))) ∧
                        (∀ pp lpp #t0.
                          (Unlock( pp, lpp, 'device' ) @ #t0)
                         ⇒
                          ((#t0 < #vr.9) ∨ (#t2 < #t0) ∨ (#t2 = #t0)))))  ∥
                     (#vr.52 < #vr.9) )
                case case_1
                solve( state_111111111111111111111121111111111( ~RouterID.1, ~ServerID.1,
                                                                ~ak_h.1, ~ak_sk.1, ~k_h.1, ~k_sk.1,
                                                                ~ssk_nms.1, authPolicy, ~n
                       ) ▶₀ #t2.2 )
                  case TpmCreateOutkhpkksk_0_11111111111111111111112111111111
                  solve( TPM_SendCommand( <'TPM2_Certify', obj_sh, obj_h, a_h> ) @ #t2.3 )
                    case eventTPMSendCommandTPMCertifytlsshtlshakh_0_111111111111121111111111111
                    solve( state_111111111111121111111111111( ~RouterID.1, ~ServerID.1,
                                                              ~ak_h.1, ~ak_sk.1, ~ssk_nms.1, ~tid.1, obj_h,
                                                              obj_sh, tls_spk
                           ) ▶₀ #t2.3 )
                      case outTPMPolicyPCRtlssh_0_11111111111112111111111111
                      solve( (#vr.3 < #t2.5)  ∥ (#vr.3 = #t2.5) )
                        case case_1
                        solve( (#vr.7 < #t2.6)  ∥ (#vr.7 = #t2.6) )
                          case case_1
                          solve( (#vr.37 < #t2.5)  ∥ (#vr.37 = #t2.5) )
                            case case_1
                            solve( TPM_SendCommand( <'TPM2_Create', <swstate, nil>, 
                                                     'TPM_CC_PolicyPCR', nil>
                                   ) @ #t2.8 )
                              case eventTPMSendCommandTPMCreateswstatenilTPMCCPolicyPCRnil_0_11111111111112111
                              solve( state_11111111111112111( ~RouterID.1, ~ServerID.1, ~ak_h.1,
                                                              ~ak_sk.1, ~ssk_nms.1, ~tid.1
                                     ) ▶₀ #t2.4 )
                                case outTPMPCRExtendswstate_0_1111111111111211
                                solve( TPM_SendCommand( <'TPM2_Create', <swstate, nil>, 
                                                         'TPM_CC_PolicyPCR', nil>
                                       ) @ #t2.8 )
                                  case eventTPMSendCommandTPMCreateswstatenilTPMCCPolicyPCRnil_0_11111111111112111
                                  solve( state_11111111111112111( ~RouterID.1, ~ServerID.1, ~ak_h.1,
                                                                  ~ak_sk.1, ~ssk_nms.1, ~tid.1
                                         ) ▶₀ #t2.4 )
                                    case outTPMPCRExtendswstate_0_1111111111111211
                                    solve( !KU( sign(<pk(x), 
                                                      sign(<pk(x), <swstate, nil>, 'TPM_CC_PolicyPCR', nil>,
                                                           ~ak_sk)
                                                     >,
                                                     x)
                                           ) @ #vk.7 )
                                      case c_sign
                                      solve( Insert( <'privatePart', ~ak_h>, ~ak_sk ) @ #t2.5 )
                                        case insertprivatePartakhaksk_0_111111111111111
                                        solve( state_111111111111111( ~RouterID.1, ~ServerID.1, ~ak_h, ~ak_sk,
                                                                      ~ssk_nms.1
                                               ) ▶₀ #t2.4 )
                                          case insertauthPolicyakhnil_0_11111111111111
                                          by contradiction /* cyclic */
                                        qed
                                      next
                                        case insertprivatePartkhksk_0_111111111111111111111121111111
                                        by solve( state_111111111111111111111121111111( ~RouterID.1,
                                                                                        ~ServerID.1, ~ak_h.1,
                                                                                        ~ak_sk.1, ~ak_h,
                                                                                        ~ak_sk, ~ssk_nms.1,
                                                                                        authPolicy, lock
                                                  ) ▶₀ #t2.4 )
                                      qed
                                    next
                                      case outsignobjpkobjapask_0_11111111111111111111211111111
                                      solve( ((#vr.52 < #vr.70) ∧
                                              (∃ #t2.
                                                (Unlock_4( '4', ~n.1, 'device' ) @ #t2)
                                               ∧
                                                (#vr.52 < #t2) ∧
                                                (#t2 < #vr.70) ∧
                                                (∀ #t0 pp. (Unlock( pp, ~n.1, 'device' ) @ #t0) ⇒ #t0 = #t2) ∧
                                                (∀ pp lpp #t0.
                                                  (Lock( pp, lpp, 'device' ) @ #t0)
                                                 ⇒
                                                  ((#t0 < #vr.52) ∨ (#t0 = #vr.52) ∨ (#t2 < #t0))) ∧
                                                (∀ pp lpp #t0.
                                                  (Unlock( pp, lpp, 'device' ) @ #t0)
                                                 ⇒
                                                  ((#t0 < #vr.52) ∨ (#t2 < #t0) ∨ (#t2 = #t0)))))  ∥
                                             (#vr.70 < #vr.52)  ∥ (#vr.52 = #vr.70) )
                                        case case_1
                                        solve( TPM_SendCommand( <'TPM2_Certify', obj_sh.1, obj_h, a_h>
                                               ) @ #t2.8 )
                                          case eventTPMSendCommandTPMCertifytlsshtlshakh_0_111111111111121111111111111
                                          by solve( state_111111111111121111111111111( ~RouterID.1,
                                                                                       ~ServerID.1, ~ak_h.1,
                                                                                       ~ak_sk.1, ~ssk_nms.1,
                                                                                       ~tid.1, obj_h,
                                                                                       obj_sh.1, tls_spk
                                                    ) ▶₀ #t2.4 )
                                        qed
                                      next
                                        case case_2
                                        solve( (#vr.70 < #vr.9)  ∥ (#t2.2 < #vr.70) )
                                          case case_1
                                          solve( TPM_SendCommand( <'TPM2_Certify', obj_sh.1, obj_h, a_h>
                                                 ) @ #t2.8 )
                                            case eventTPMSendCommandTPMCertifytlsshtlshakh_0_111111111111121111111111111
                                            by solve( state_111111111111121111111111111( ~RouterID.1,
                                                                                         ~ServerID.1, ~ak_h.1,
                                                                                         ~ak_sk.1, ~ssk_nms.1,
                                                                                         ~tid.1, obj_h,
                                                                                         obj_sh.1, tls_spk
                                                      ) ▶₀ #t2.4 )
                                          qed
                                        next
                                          case case_2
                                          solve( TPM_SendCommand( <'TPM2_Certify', obj_sh.1, obj_h, a_h>
                                                 ) @ #t2.8 )
                                            case eventTPMSendCommandTPMCertifytlsshtlshakh_0_111111111111121111111111111
                                            by solve( state_111111111111121111111111111( ~RouterID.1,
                                                                                         ~ServerID.1, ~ak_h.1,
                                                                                         ~ak_sk.1, ~ssk_nms.1,
                                                                                         ~tid.1, obj_h,
                                                                                         obj_sh.1, tls_spk
                                                      ) ▶₀ #t2.4 )
                                          qed
                                        qed
                                      qed
                                    next
                                      case outtlsspkskaecsr_0_11111111111112111111111111111111111111
                                      solve( TPM_SendCommand( <'TPM2_Sign', k_sh, k_h.1, pk(x), 
                                                               sign(<pk(x), <swstate, nil>, 
                                                                     'TPM_CC_PolicyPCR', nil>,
                                                                    ~ak_sk)
                                                              >
                                             ) @ #t2.9 )
                                        case eventTPMSendCommandTPMSigntlsshtlshtlsspkskae_0_111111111111121111111111111111111
                                        solve( state_111111111111121111111111111111111( ~RouterID.1,
                                                                                        ~ServerID.1, ~ak_h.1,
                                                                                        ~ak_sk.1, ~ssk_nms.1,
                                                                                        ~tid.1,
                                                                                        sign(<pk(x), 
                                                                                              <swstate, nil>, 
                                                                                              'TPM_CC_PolicyPCR', 
                                                                                              nil>,
                                                                                             ~ak_sk),
                                                                                        k_h.1, k_sh, pk(x)
                                               ) ▶₀ #t2.4 )
                                          case ifverifyskaetlsspkswstatenilTPMCCPolicyPCRnilpkaksktrue_0_11111111111112111111111111111111
                                          by contradiction /* from formulas */
                                        qed
                                      qed
                                    qed
                                  qed
                                qed
                              qed
                            qed
                          next
                            case case_2
                            solve( TPM_SendCommand( <'TPM2_Create', <swstate, nil>, 
                                                     'TPM_CC_PolicyPCR', nil>
                                   ) @ #t2.8 )
                              case eventTPMSendCommandTPMCreateswstatenilTPMCCPolicyPCRnil_0_11111111111112111
                              solve( state_11111111111112111( ~RouterID.1, ~ServerID.1, ~ak_h.1,
                                                              ~ak_sk.1, ~ssk_nms.1, ~tid.1
                                     ) ▶₀ #t2.5 )
                                case outTPMPCRExtendswstate_0_1111111111111211
                                solve( TPM_SendCommand( <'TPM2_Create', <swstate, nil>, 
                                                         'TPM_CC_PolicyPCR', nil>
                                       ) @ #t2.8 )
                                  case eventTPMSendCommandTPMCreateswstatenilTPMCCPolicyPCRnil_0_11111111111112111
                                  solve( state_11111111111112111( ~RouterID.1, ~ServerID.1, ~ak_h.1,
                                                                  ~ak_sk.1, ~ssk_nms.1, ~tid.1
                                         ) ▶₀ #t2.5 )
                                    case outTPMPCRExtendswstate_0_1111111111111211
                                    solve( !KU( sign(<pk(x), 
                                                      sign(<pk(x), <swstate, nil>, 'TPM_CC_PolicyPCR', nil>,
                                                           ~ak_sk)
                                                     >,
                                                     x)
                                           ) @ #vk.7 )
                                      case c_sign
                                      solve( Insert( <'privatePart', ~ak_h>, ~ak_sk ) @ #t2.4 )
                                        case insertprivatePartakhaksk_0_111111111111111
                                        solve( Insert( <'publicPart', ~k_h>, pk(x) ) @ #t2.5 )
                                          case insertpublicPartakhpkaksk_0_1111111111111111
                                          by solve( state_1111111111111111( ~RouterID.1, ~ServerID.1, ~k_h,
                                                                            ~ak_sk.1, ~ssk_nms.1
                                                    ) ▶₀ #t2.5 )
                                        next
                                          case insertpublicPartkhpkksk_0_1111111111111111111111211111111
                                          solve( state_1111111111111111111111211111111( ~RouterID.1,
                                                                                        ~ServerID.1, ~ak_h.1,
                                                                                        ~ak_sk.1, ~k_h,
                                                                                        ~k_sk.1, ~ssk_nms.1,
                                                                                        authPolicy, lock
                                                 ) ▶₀ #t2.5 )
                                            case insertprivatePartkhksk_0_111111111111111111111121111111
                                            by contradiction /* cyclic */
                                          qed
                                        qed
                                      qed
                                    next
                                      case outsignobjpkobjapask_0_11111111111111111111211111111
                                      solve( ((#vr.51 < #vr.69) ∧
                                              (∃ #t2.
                                                (Unlock_4( '4', ~n.1, 'device' ) @ #t2)
                                               ∧
                                                (#vr.51 < #t2) ∧
                                                (#t2 < #vr.69) ∧
                                                (∀ #t0 pp. (Unlock( pp, ~n.1, 'device' ) @ #t0) ⇒ #t0 = #t2) ∧
                                                (∀ pp lpp #t0.
                                                  (Lock( pp, lpp, 'device' ) @ #t0)
                                                 ⇒
                                                  ((#t0 < #vr.51) ∨ (#t0 = #vr.51) ∨ (#t2 < #t0))) ∧
                                                (∀ pp lpp #t0.
                                                  (Unlock( pp, lpp, 'device' ) @ #t0)
                                                 ⇒
                                                  ((#t0 < #vr.51) ∨ (#t2 < #t0) ∨ (#t2 = #t0)))))  ∥
                                             (#vr.69 < #vr.51)  ∥ (#vr.51 = #vr.69) )
                                        case case_1
                                        solve( TPM_SendCommand( <'TPM2_Certify', obj_sh.1, obj_h, a_h>
                                               ) @ #t2.8 )
                                          case eventTPMSendCommandTPMCertifytlsshtlshakh_0_111111111111121111111111111
                                          by solve( state_111111111111121111111111111( ~RouterID.1,
                                                                                       ~ServerID.1, ~ak_h.1,
                                                                                       ~ak_sk.1, ~ssk_nms.1,
                                                                                       ~tid.1, obj_h,
                                                                                       obj_sh.1, tls_spk
                                                    ) ▶₀ #t2.5 )
                                        qed
                                      next
                                        case case_2
                                        solve( (#vr.69 < #vr.9)  ∥ (#t2.2 < #vr.69) )
                                          case case_1
                                          solve( TPM_SendCommand( <'TPM2_Certify', obj_sh.1, obj_h, a_h>
                                                 ) @ #t2.8 )
                                            case eventTPMSendCommandTPMCertifytlsshtlshakh_0_111111111111121111111111111
                                            by solve( state_111111111111121111111111111( ~RouterID.1,
                                                                                         ~ServerID.1, ~ak_h.1,
                                                                                         ~ak_sk.1, ~ssk_nms.1,
                                                                                         ~tid.1, obj_h,
                                                                                         obj_sh.1, tls_spk
                                                      ) ▶₀ #t2.5 )
                                          qed
                                        next
                                          case case_2
                                          solve( TPM_SendCommand( <'TPM2_Certify', obj_sh.1, obj_h, a_h>
                                                 ) @ #t2.8 )
                                            case eventTPMSendCommandTPMCertifytlsshtlshakh_0_111111111111121111111111111
                                            by solve( state_111111111111121111111111111( ~RouterID.1,
                                                                                         ~ServerID.1, ~ak_h.1,
                                                                                         ~ak_sk.1, ~ssk_nms.1,
                                                                                         ~tid.1, obj_h,
                                                                                         obj_sh.1, tls_spk
                                                      ) ▶₀ #t2.5 )
                                          qed
                                        qed
                                      qed
                                    next
                                      case outtlsspkskaecsr_0_11111111111112111111111111111111111111
                                      solve( TPM_SendCommand( <'TPM2_Sign', k_sh, k_h.1, pk(x), 
                                                               sign(<pk(x), <swstate, nil>, 
                                                                     'TPM_CC_PolicyPCR', nil>,
                                                                    ~ak_sk)
                                                              >
                                             ) @ #t2.9 )
                                        case eventTPMSendCommandTPMSigntlsshtlshtlsspkskae_0_111111111111121111111111111111111
                                        solve( state_111111111111121111111111111111111( ~RouterID.1,
                                                                                        ~ServerID.1, ~ak_h.1,
                                                                                        ~ak_sk.1, ~ssk_nms.1,
                                                                                        ~tid.1,
                                                                                        sign(<pk(x), 
                                                                                              <swstate, nil>, 
                                                                                              'TPM_CC_PolicyPCR', 
                                                                                              nil>,
                                                                                             ~ak_sk),
                                                                                        k_h.1, k_sh, pk(x)
                                               ) ▶₀ #t2.5 )
                                          case ifverifyskaetlsspkswstatenilTPMCCPolicyPCRnilpkaksktrue_0_11111111111112111111111111111111
                                          by contradiction /* from formulas */
                                        qed
                                      qed
                                    qed
                                  qed
                                qed
                              qed
                            qed
                          qed
                        next
                          case case_2
                          solve( (#vr.36 < #t2.6)  ∥ (#vr.36 = #t2.6) )
                            case case_1
                            solve( TPM_SendCommand( <'TPM2_Create', <swstate, nil>, 
                                                     'TPM_CC_PolicyPCR', nil>
                                   ) @ #t2.8 )
                              case eventTPMSendCommandTPMCreateswstatenilTPMCCPolicyPCRnil_0_11111111111112111
                              solve( state_11111111111112111( ~RouterID.1, ~ServerID.1, ~ak_h.1,
                                                              ~ak_sk.1, ~ssk_nms.1, ~tid.1
                                     ) ▶₀ #t2.5 )
                                case outTPMPCRExtendswstate_0_1111111111111211
                                solve( TPM_SendCommand( <'TPM2_Create', <swstate, nil>, 
                                                         'TPM_CC_PolicyPCR', nil>
                                       ) @ #t2.8 )
                                  case eventTPMSendCommandTPMCreateswstatenilTPMCCPolicyPCRnil_0_11111111111112111
                                  solve( state_11111111111112111( ~RouterID.1, ~ServerID.1, ~ak_h.1,
                                                                  ~ak_sk.1, ~ssk_nms.1, ~tid.1
                                         ) ▶₀ #t2.5 )
                                    case outTPMPCRExtendswstate_0_1111111111111211
                                    solve( !KU( sign(<pk(x), 
                                                      sign(<pk(x), <swstate, nil>, 'TPM_CC_PolicyPCR', nil>,
                                                           ~ak_sk)
                                                     >,
                                                     x)
                                           ) @ #vk.7 )
                                      case c_sign
                                      solve( Insert( <'privatePart', ~ak_h>, ~ak_sk ) @ #t2.6 )
                                        case insertprivatePartakhaksk_0_111111111111111
                                        solve( state_111111111111111( ~RouterID.1, ~ServerID.1, ~ak_h, ~ak_sk,
                                                                      ~ssk_nms.1
                                               ) ▶₀ #t2.5 )
                                          case insertauthPolicyakhnil_0_11111111111111
                                          by contradiction /* cyclic */
                                        qed
                                      next
                                        case insertprivatePartkhksk_0_111111111111111111111121111111
                                        by solve( state_111111111111111111111121111111( ~RouterID.1,
                                                                                        ~ServerID.1, ~ak_h.1,
                                                                                        ~ak_sk.1, ~ak_h,
                                                                                        ~ak_sk, ~ssk_nms.1,
                                                                                        authPolicy, lock
                                                  ) ▶₀ #t2.5 )
                                      qed
                                    next
                                      case outsignobjpkobjapask_0_11111111111111111111211111111
                                      solve( ((#vr.51 < #vr.69) ∧
                                              (∃ #t2.
                                                (Unlock_4( '4', ~n.1, 'device' ) @ #t2)
                                               ∧
                                                (#vr.51 < #t2) ∧
                                                (#t2 < #vr.69) ∧
                                                (∀ #t0 pp. (Unlock( pp, ~n.1, 'device' ) @ #t0) ⇒ #t0 = #t2) ∧
                                                (∀ pp lpp #t0.
                                                  (Lock( pp, lpp, 'device' ) @ #t0)
                                                 ⇒
                                                  ((#t0 < #vr.51) ∨ (#t0 = #vr.51) ∨ (#t2 < #t0))) ∧
                                                (∀ pp lpp #t0.
                                                  (Unlock( pp, lpp, 'device' ) @ #t0)
                                                 ⇒
                                                  ((#t0 < #vr.51) ∨ (#t2 < #t0) ∨ (#t2 = #t0)))))  ∥
                                             (#vr.69 < #vr.51)  ∥ (#vr.51 = #vr.69) )
                                        case case_1
                                        solve( TPM_SendCommand( <'TPM2_Certify', obj_sh.1, obj_h, a_h>
                                               ) @ #t2.8 )
                                          case eventTPMSendCommandTPMCertifytlsshtlshakh_0_111111111111121111111111111
                                          by solve( state_111111111111121111111111111( ~RouterID.1,
                                                                                       ~ServerID.1, ~ak_h.1,
                                                                                       ~ak_sk.1, ~ssk_nms.1,
                                                                                       ~tid.1, obj_h,
                                                                                       obj_sh.1, tls_spk
                                                    ) ▶₀ #t2.5 )
                                        qed
                                      next
                                        case case_2
                                        solve( (#vr.69 < #vr.8)  ∥ (#t2.2 < #vr.69) )
                                          case case_1
                                          solve( TPM_SendCommand( <'TPM2_Certify', obj_sh.1, obj_h, a_h>
                                                 ) @ #t2.8 )
                                            case eventTPMSendCommandTPMCertifytlsshtlshakh_0_111111111111121111111111111
                                            by solve( state_111111111111121111111111111( ~RouterID.1,
                                                                                         ~ServerID.1, ~ak_h.1,
                                                                                         ~ak_sk.1, ~ssk_nms.1,
                                                                                         ~tid.1, obj_h,
                                                                                         obj_sh.1, tls_spk
                                                      ) ▶₀ #t2.5 )
                                          qed
                                        next
                                          case case_2
                                          solve( TPM_SendCommand( <'TPM2_Certify', obj_sh.1, obj_h, a_h>
                                                 ) @ #t2.8 )
                                            case eventTPMSendCommandTPMCertifytlsshtlshakh_0_111111111111121111111111111
                                            by solve( state_111111111111121111111111111( ~RouterID.1,
                                                                                         ~ServerID.1, ~ak_h.1,
                                                                                         ~ak_sk.1, ~ssk_nms.1,
                                                                                         ~tid.1, obj_h,
                                                                                         obj_sh.1, tls_spk
                                                      ) ▶₀ #t2.5 )
                                          qed
                                        qed
                                      qed
                                    next
                                      case outtlsspkskaecsr_0_11111111111112111111111111111111111111
                                      solve( TPM_SendCommand( <'TPM2_Sign', k_sh, k_h.1, pk(x), 
                                                               sign(<pk(x), <swstate, nil>, 
                                                                     'TPM_CC_PolicyPCR', nil>,
                                                                    ~ak_sk)
                                                              >
                                             ) @ #t2.9 )
                                        case eventTPMSendCommandTPMSigntlsshtlshtlsspkskae_0_111111111111121111111111111111111
                                        solve( state_111111111111121111111111111111111( ~RouterID.1,
                                                                                        ~ServerID.1, ~ak_h.1,
                                                                                        ~ak_sk.1, ~ssk_nms.1,
                                                                                        ~tid.1,
                                                                                        sign(<pk(x), 
                                                                                              <swstate, nil>, 
                                                                                              'TPM_CC_PolicyPCR', 
                                                                                              nil>,
                                                                                             ~ak_sk),
                                                                                        k_h.1, k_sh, pk(x)
                                               ) ▶₀ #t2.5 )
                                          case ifverifyskaetlsspkswstatenilTPMCCPolicyPCRnilpkaksktrue_0_11111111111112111111111111111111
                                          by contradiction /* from formulas */
                                        qed
                                      qed
                                    qed
                                  qed
                                qed
                              qed
                            qed
                          next
                            case case_2
                            solve( TPM_SendCommand( <'TPM2_Create', <swstate, nil>, 
                                                     'TPM_CC_PolicyPCR', nil>
                                   ) @ #t2.8 )
                              case eventTPMSendCommandTPMCreateswstatenilTPMCCPolicyPCRnil_0_11111111111112111
                              solve( state_11111111111112111( ~RouterID.1, ~ServerID.1, ~ak_h.1,
                                                              ~ak_sk.1, ~ssk_nms.1, ~tid.1
                                     ) ▶₀ #t2.6 )
                                case outTPMPCRExtendswstate_0_1111111111111211
                                solve( TPM_SendCommand( <'TPM2_Create', <swstate, nil>, 
                                                         'TPM_CC_PolicyPCR', nil>
                                       ) @ #t2.8 )
                                  case eventTPMSendCommandTPMCreateswstatenilTPMCCPolicyPCRnil_0_11111111111112111
                                  solve( state_11111111111112111( ~RouterID.1, ~ServerID.1, ~ak_h.1,
                                                                  ~ak_sk.1, ~ssk_nms.1, ~tid.1
                                         ) ▶₀ #t2.6 )
                                    case outTPMPCRExtendswstate_0_1111111111111211
                                    solve( !KU( sign(<pk(x), 
                                                      sign(<pk(x), <swstate, nil>, 'TPM_CC_PolicyPCR', nil>,
                                                           ~ak_sk)
                                                     >,
                                                     x)
                                           ) @ #vk.7 )
                                      case c_sign
                                      solve( Insert( <'privatePart', ~ak_h>, ~ak_sk ) @ #t2.5 )
                                        case insertprivatePartakhaksk_0_111111111111111
                                        solve( Insert( <'publicPart', ~k_h>, pk(x) ) @ #t2.6 )
                                          case insertpublicPartakhpkaksk_0_1111111111111111
                                          by solve( state_1111111111111111( ~RouterID.1, ~ServerID.1, ~k_h,
                                                                            ~ak_sk.1, ~ssk_nms.1
                                                    ) ▶₀ #t2.6 )
                                        next
                                          case insertpublicPartkhpkksk_0_1111111111111111111111211111111
                                          solve( state_1111111111111111111111211111111( ~RouterID.1,
                                                                                        ~ServerID.1, ~ak_h.1,
                                                                                        ~ak_sk.1, ~k_h,
                                                                                        ~k_sk.1, ~ssk_nms.1,
                                                                                        authPolicy, lock
                                                 ) ▶₀ #t2.6 )
                                            case insertprivatePartkhksk_0_111111111111111111111121111111
                                            by contradiction /* cyclic */
                                          qed
                                        qed
                                      qed
                                    next
                                      case outsignobjpkobjapask_0_11111111111111111111211111111
                                      solve( ((#vr.50 < #vr.68) ∧
                                              (∃ #t2.
                                                (Unlock_4( '4', ~n.1, 'device' ) @ #t2)
                                               ∧
                                                (#vr.50 < #t2) ∧
                                                (#t2 < #vr.68) ∧
                                                (∀ #t0 pp. (Unlock( pp, ~n.1, 'device' ) @ #t0) ⇒ #t0 = #t2) ∧
                                                (∀ pp lpp #t0.
                                                  (Lock( pp, lpp, 'device' ) @ #t0)
                                                 ⇒
                                                  ((#t0 < #vr.50) ∨ (#t0 = #vr.50) ∨ (#t2 < #t0))) ∧
                                                (∀ pp lpp #t0.
                                                  (Unlock( pp, lpp, 'device' ) @ #t0)
                                                 ⇒
                                                  ((#t0 < #vr.50) ∨ (#t2 < #t0) ∨ (#t2 = #t0)))))  ∥
                                             (#vr.68 < #vr.50)  ∥ (#vr.50 = #vr.68) )
                                        case case_1
                                        solve( TPM_SendCommand( <'TPM2_Certify', obj_sh.1, obj_h, a_h>
                                               ) @ #t2.8 )
                                          case eventTPMSendCommandTPMCertifytlsshtlshakh_0_111111111111121111111111111
                                          by solve( state_111111111111121111111111111( ~RouterID.1,
                                                                                       ~ServerID.1, ~ak_h.1,
                                                                                       ~ak_sk.1, ~ssk_nms.1,
                                                                                       ~tid.1, obj_h,
                                                                                       obj_sh.1, tls_spk
                                                    ) ▶₀ #t2.6 )
                                        qed
                                      next
                                        case case_2
                                        solve( (#vr.68 < #vr.8)  ∥ (#t2.2 < #vr.68) )
                                          case case_1
                                          solve( TPM_SendCommand( <'TPM2_Certify', obj_sh.1, obj_h, a_h>
                                                 ) @ #t2.8 )
                                            case eventTPMSendCommandTPMCertifytlsshtlshakh_0_111111111111121111111111111
                                            by solve( state_111111111111121111111111111( ~RouterID.1,
                                                                                         ~ServerID.1, ~ak_h.1,
                                                                                         ~ak_sk.1, ~ssk_nms.1,
                                                                                         ~tid.1, obj_h,
                                                                                         obj_sh.1, tls_spk
                                                      ) ▶₀ #t2.6 )
                                          qed
                                        next
                                          case case_2
                                          solve( TPM_SendCommand( <'TPM2_Certify', obj_sh.1, obj_h, a_h>
                                                 ) @ #t2.8 )
                                            case eventTPMSendCommandTPMCertifytlsshtlshakh_0_111111111111121111111111111
                                            by solve( state_111111111111121111111111111( ~RouterID.1,
                                                                                         ~ServerID.1, ~ak_h.1,
                                                                                         ~ak_sk.1, ~ssk_nms.1,
                                                                                         ~tid.1, obj_h,
                                                                                         obj_sh.1, tls_spk
                                                      ) ▶₀ #t2.6 )
                                          qed
                                        qed
                                      qed
                                    next
                                      case outtlsspkskaecsr_0_11111111111112111111111111111111111111
                                      solve( TPM_SendCommand( <'TPM2_Sign', k_sh, k_h.1, pk(x), 
                                                               sign(<pk(x), <swstate, nil>, 
                                                                     'TPM_CC_PolicyPCR', nil>,
                                                                    ~ak_sk)
                                                              >
                                             ) @ #t2.9 )
                                        case eventTPMSendCommandTPMSigntlsshtlshtlsspkskae_0_111111111111121111111111111111111
                                        solve( state_111111111111121111111111111111111( ~RouterID.1,
                                                                                        ~ServerID.1, ~ak_h.1,
                                                                                        ~ak_sk.1, ~ssk_nms.1,
                                                                                        ~tid.1,
                                                                                        sign(<pk(x), 
                                                                                              <swstate, nil>, 
                                                                                              'TPM_CC_PolicyPCR', 
                                                                                              nil>,
                                                                                             ~ak_sk),
                                                                                        k_h.1, k_sh, pk(x)
                                               ) ▶₀ #t2.6 )
                                          case ifverifyskaetlsspkswstatenilTPMCCPolicyPCRnilpkaksktrue_0_11111111111112111111111111111111
                                          by contradiction /* from formulas */
                                        qed
                                      qed
                                    qed
                                  qed
                                qed
                              qed
                            qed
                          qed
                        qed
                      next
                        case case_2
                        solve( (#vr.7 < #t2.5)  ∥ (#vr.7 = #t2.5) )
                          case case_1
                          solve( (#vr.37 < #t2.4)  ∥ (#vr.37 = #t2.4) )
                            case case_1
                            solve( TPM_SendCommand( <'TPM2_Create', <swstate, nil>, 
                                                     'TPM_CC_PolicyPCR', nil>
                                   ) @ #t2.7 )
                              case eventTPMSendCommandTPMCreateswstatenilTPMCCPolicyPCRnil_0_11111111111112111
                              solve( state_11111111111112111( ~RouterID.1, ~ServerID.1, ~ak_h.1,
                                                              ~ak_sk.1, ~ssk_nms.1, ~tid.1
                                     ) ▶₀ #t2.4 )
                                case outTPMPCRExtendswstate_0_1111111111111211
                                solve( TPM_SendCommand( <'TPM2_Create', <swstate, nil>, 
                                                         'TPM_CC_PolicyPCR', nil>
                                       ) @ #t2.7 )
                                  case eventTPMSendCommandTPMCreateswstatenilTPMCCPolicyPCRnil_0_11111111111112111
                                  solve( state_11111111111112111( ~RouterID.1, ~ServerID.1, ~ak_h.1,
                                                                  ~ak_sk.1, ~ssk_nms.1, ~tid.1
                                         ) ▶₀ #t2.4 )
                                    case outTPMPCRExtendswstate_0_1111111111111211
                                    solve( !KU( sign(<pk(x), 
                                                      sign(<pk(x), <swstate, nil>, 'TPM_CC_PolicyPCR', nil>,
                                                           ~ak_sk)
                                                     >,
                                                     x)
                                           ) @ #vk.7 )
                                      case c_sign
                                      solve( Insert( <'privatePart', ~ak_h>, ~ak_sk ) @ #t2.4 )
                                        case insertprivatePartakhaksk_0_111111111111111
                                        solve( state_111111111111111( ~RouterID.1, ~ServerID.1, ~ak_h, ~ak_sk,
                                                                      ~ssk_nms.1
                                               ) ▶₀ #t2.4 )
                                          case insertauthPolicyakhnil_0_11111111111111
                                          by contradiction /* cyclic */
                                        qed
                                      next
                                        case insertprivatePartkhksk_0_111111111111111111111121111111
                                        by solve( state_111111111111111111111121111111( ~RouterID.1,
                                                                                        ~ServerID.1, ~ak_h.1,
                                                                                        ~ak_sk.1, ~ak_h,
                                                                                        ~ak_sk, ~ssk_nms.1,
                                                                                        authPolicy, lock
                                                  ) ▶₀ #t2.4 )
                                      qed
                                    next
                                      case outsignobjpkobjapask_0_11111111111111111111211111111
                                      solve( ((#vr.52 < #vr.70) ∧
                                              (∃ #t2.
                                                (Unlock_4( '4', ~n.1, 'device' ) @ #t2)
                                               ∧
                                                (#vr.52 < #t2) ∧
                                                (#t2 < #vr.70) ∧
                                                (∀ #t0 pp. (Unlock( pp, ~n.1, 'device' ) @ #t0) ⇒ #t0 = #t2) ∧
                                                (∀ pp lpp #t0.
                                                  (Lock( pp, lpp, 'device' ) @ #t0)
                                                 ⇒
                                                  ((#t0 < #vr.52) ∨ (#t0 = #vr.52) ∨ (#t2 < #t0))) ∧
                                                (∀ pp lpp #t0.
                                                  (Unlock( pp, lpp, 'device' ) @ #t0)
                                                 ⇒
                                                  ((#t0 < #vr.52) ∨ (#t2 < #t0) ∨ (#t2 = #t0)))))  ∥
                                             (#vr.70 < #vr.52)  ∥ (#vr.52 = #vr.70) )
                                        case case_1
                                        solve( TPM_SendCommand( <'TPM2_Certify', obj_sh.1, obj_h, a_h>
                                               ) @ #t2.7 )
                                          case eventTPMSendCommandTPMCertifytlsshtlshakh_0_111111111111121111111111111
                                          by solve( state_111111111111121111111111111( ~RouterID.1,
                                                                                       ~ServerID.1, ~ak_h.1,
                                                                                       ~ak_sk.1, ~ssk_nms.1,
                                                                                       ~tid.1, obj_h,
                                                                                       obj_sh.1, tls_spk
                                                    ) ▶₀ #t2.4 )
                                        qed
                                      next
                                        case case_2
                                        solve( (#vr.70 < #vr.9)  ∥ (#t2.2 < #vr.70) )
                                          case case_1
                                          solve( TPM_SendCommand( <'TPM2_Certify', obj_sh.1, obj_h, a_h>
                                                 ) @ #t2.7 )
                                            case eventTPMSendCommandTPMCertifytlsshtlshakh_0_111111111111121111111111111
                                            by solve( state_111111111111121111111111111( ~RouterID.1,
                                                                                         ~ServerID.1, ~ak_h.1,
                                                                                         ~ak_sk.1, ~ssk_nms.1,
                                                                                         ~tid.1, obj_h,
                                                                                         obj_sh.1, tls_spk
                                                      ) ▶₀ #t2.4 )
                                          qed
                                        next
                                          case case_2
                                          solve( TPM_SendCommand( <'TPM2_Certify', obj_sh.1, obj_h, a_h>
                                                 ) @ #t2.7 )
                                            case eventTPMSendCommandTPMCertifytlsshtlshakh_0_111111111111121111111111111
                                            by solve( state_111111111111121111111111111( ~RouterID.1,
                                                                                         ~ServerID.1, ~ak_h.1,
                                                                                         ~ak_sk.1, ~ssk_nms.1,
                                                                                         ~tid.1, obj_h,
                                                                                         obj_sh.1, tls_spk
                                                      ) ▶₀ #t2.4 )
                                          qed
                                        qed
                                      qed
                                    next
                                      case outtlsspkskaecsr_0_11111111111112111111111111111111111111
                                      solve( TPM_SendCommand( <'TPM2_Sign', k_sh, k_h.1, pk(x), 
                                                               sign(<pk(x), <swstate, nil>, 
                                                                     'TPM_CC_PolicyPCR', nil>,
                                                                    ~ak_sk)
                                                              >
                                             ) @ #t2.8 )
                                        case eventTPMSendCommandTPMSigntlsshtlshtlsspkskae_0_111111111111121111111111111111111
                                        solve( state_111111111111121111111111111111111( ~RouterID.1,
                                                                                        ~ServerID.1, ~ak_h.1,
                                                                                        ~ak_sk.1, ~ssk_nms.1,
                                                                                        ~tid.1,
                                                                                        sign(<pk(x), 
                                                                                              <swstate, nil>, 
                                                                                              'TPM_CC_PolicyPCR', 
                                                                                              nil>,
                                                                                             ~ak_sk),
                                                                                        k_h.1, k_sh, pk(x)
                                               ) ▶₀ #t2.4 )
                                          case ifverifyskaetlsspkswstatenilTPMCCPolicyPCRnilpkaksktrue_0_11111111111112111111111111111111
                                          by contradiction /* from formulas */
                                        qed
                                      qed
                                    qed
                                  qed
                                qed
                              qed
                            qed
                          next
                            case case_2
                            solve( TPM_SendCommand( <'TPM2_Create', <swstate, nil>, 
                                                     'TPM_CC_PolicyPCR', nil>
                                   ) @ #t2.7 )
                              case eventTPMSendCommandTPMCreateswstatenilTPMCCPolicyPCRnil_0_11111111111112111
                              solve( state_11111111111112111( ~RouterID.1, ~ServerID.1, ~ak_h.1,
                                                              ~ak_sk.1, ~ssk_nms.1, ~tid.1
                                     ) ▶₀ #t2.5 )
                                case outTPMPCRExtendswstate_0_1111111111111211
                                solve( TPM_SendCommand( <'TPM2_Create', <swstate, nil>, 
                                                         'TPM_CC_PolicyPCR', nil>
                                       ) @ #t2.7 )
                                  case eventTPMSendCommandTPMCreateswstatenilTPMCCPolicyPCRnil_0_11111111111112111
                                  solve( state_11111111111112111( ~RouterID.1, ~ServerID.1, ~ak_h.1,
                                                                  ~ak_sk.1, ~ssk_nms.1, ~tid.1
                                         ) ▶₀ #t2.5 )
                                    case outTPMPCRExtendswstate_0_1111111111111211
                                    solve( !KU( sign(<pk(x), 
                                                      sign(<pk(x), <swstate, nil>, 'TPM_CC_PolicyPCR', nil>,
                                                           ~ak_sk)
                                                     >,
                                                     x)
                                           ) @ #vk.7 )
                                      case c_sign
                                      solve( Insert( <'privatePart', ~ak_h>, ~ak_sk ) @ #t2.4 )
                                        case insertprivatePartakhaksk_0_111111111111111
                                        solve( Insert( <'publicPart', ~k_h>, pk(x) ) @ #vr.3 )
                                          case insertpublicPartkhpkksk_0_1111111111111111111111211111111
                                          by contradiction /* from formulas */
                                        qed
                                      qed
                                    next
                                      case outsignobjpkobjapask_0_11111111111111111111211111111
                                      solve( ((#vr.51 < #vr.69) ∧
                                              (∃ #t2.
                                                (Unlock_4( '4', ~n.1, 'device' ) @ #t2)
                                               ∧
                                                (#vr.51 < #t2) ∧
                                                (#t2 < #vr.69) ∧
                                                (∀ #t0 pp. (Unlock( pp, ~n.1, 'device' ) @ #t0) ⇒ #t0 = #t2) ∧
                                                (∀ pp lpp #t0.
                                                  (Lock( pp, lpp, 'device' ) @ #t0)
                                                 ⇒
                                                  ((#t0 < #vr.51) ∨ (#t0 = #vr.51) ∨ (#t2 < #t0))) ∧
                                                (∀ pp lpp #t0.
                                                  (Unlock( pp, lpp, 'device' ) @ #t0)
                                                 ⇒
                                                  ((#t0 < #vr.51) ∨ (#t2 < #t0) ∨ (#t2 = #t0)))))  ∥
                                             (#vr.69 < #vr.51)  ∥ (#vr.51 = #vr.69) )
                                        case case_1
                                        solve( TPM_SendCommand( <'TPM2_Certify', obj_sh.1, obj_h, a_h>
                                               ) @ #t2.7 )
                                          case eventTPMSendCommandTPMCertifytlsshtlshakh_0_111111111111121111111111111
                                          by solve( state_111111111111121111111111111( ~RouterID.1,
                                                                                       ~ServerID.1, ~ak_h.1,
                                                                                       ~ak_sk.1, ~ssk_nms.1,
                                                                                       ~tid.1, obj_h,
                                                                                       obj_sh.1, tls_spk
                                                    ) ▶₀ #t2.5 )
                                        qed
                                      next
                                        case case_2
                                        solve( (#vr.69 < #vr.9)  ∥ (#t2.2 < #vr.69) )
                                          case case_1
                                          solve( TPM_SendCommand( <'TPM2_Certify', obj_sh.1, obj_h, a_h>
                                                 ) @ #t2.7 )
                                            case eventTPMSendCommandTPMCertifytlsshtlshakh_0_111111111111121111111111111
                                            by solve( state_111111111111121111111111111( ~RouterID.1,
                                                                                         ~ServerID.1, ~ak_h.1,
                                                                                         ~ak_sk.1, ~ssk_nms.1,
                                                                                         ~tid.1, obj_h,
                                                                                         obj_sh.1, tls_spk
                                                      ) ▶₀ #t2.5 )
                                          qed
                                        next
                                          case case_2
                                          solve( TPM_SendCommand( <'TPM2_Certify', obj_sh.1, obj_h, a_h>
                                                 ) @ #t2.7 )
                                            case eventTPMSendCommandTPMCertifytlsshtlshakh_0_111111111111121111111111111
                                            by solve( state_111111111111121111111111111( ~RouterID.1,
                                                                                         ~ServerID.1, ~ak_h.1,
                                                                                         ~ak_sk.1, ~ssk_nms.1,
                                                                                         ~tid.1, obj_h,
                                                                                         obj_sh.1, tls_spk
                                                      ) ▶₀ #t2.5 )
                                          qed
                                        qed
                                      qed
                                    next
                                      case outtlsspkskaecsr_0_11111111111112111111111111111111111111
                                      solve( TPM_SendCommand( <'TPM2_Sign', k_sh, k_h.1, pk(x), 
                                                               sign(<pk(x), <swstate, nil>, 
                                                                     'TPM_CC_PolicyPCR', nil>,
                                                                    ~ak_sk)
                                                              >
                                             ) @ #t2.8 )
                                        case eventTPMSendCommandTPMSigntlsshtlshtlsspkskae_0_111111111111121111111111111111111
                                        solve( state_111111111111121111111111111111111( ~RouterID.1,
                                                                                        ~ServerID.1, ~ak_h.1,
                                                                                        ~ak_sk.1, ~ssk_nms.1,
                                                                                        ~tid.1,
                                                                                        sign(<pk(x), 
                                                                                              <swstate, nil>, 
                                                                                              'TPM_CC_PolicyPCR', 
                                                                                              nil>,
                                                                                             ~ak_sk),
                                                                                        k_h.1, k_sh, pk(x)
                                               ) ▶₀ #t2.5 )
                                          case ifverifyskaetlsspkswstatenilTPMCCPolicyPCRnilpkaksktrue_0_11111111111112111111111111111111
                                          by contradiction /* from formulas */
                                        qed
                                      qed
                                    qed
                                  qed
                                qed
                              qed
                            qed
                          qed
                        next
                          case case_2
                          solve( (#vr.36 < #t2.5)  ∥ (#vr.36 = #t2.5) )
                            case case_1
                            solve( TPM_SendCommand( <'TPM2_Create', <swstate, nil>, 
                                                     'TPM_CC_PolicyPCR', nil>
                                   ) @ #t2.7 )
                              case eventTPMSendCommandTPMCreateswstatenilTPMCCPolicyPCRnil_0_11111111111112111
                              solve( state_11111111111112111( ~RouterID.1, ~ServerID.1, ~ak_h.1,
                                                              ~ak_sk.1, ~ssk_nms.1, ~tid.1
                                     ) ▶₀ #t2.5 )
                                case outTPMPCRExtendswstate_0_1111111111111211
                                solve( TPM_SendCommand( <'TPM2_Create', <swstate, nil>, 
                                                         'TPM_CC_PolicyPCR', nil>
                                       ) @ #t2.7 )
                                  case eventTPMSendCommandTPMCreateswstatenilTPMCCPolicyPCRnil_0_11111111111112111
                                  solve( state_11111111111112111( ~RouterID.1, ~ServerID.1, ~ak_h.1,
                                                                  ~ak_sk.1, ~ssk_nms.1, ~tid.1
                                         ) ▶₀ #t2.5 )
                                    case outTPMPCRExtendswstate_0_1111111111111211
                                    solve( !KU( sign(<pk(x), 
                                                      sign(<pk(x), <swstate, nil>, 'TPM_CC_PolicyPCR', nil>,
                                                           ~ak_sk)
                                                     >,
                                                     x)
                                           ) @ #vk.7 )
                                      case c_sign
                                      solve( Insert( <'privatePart', ~ak_h>, ~ak_sk ) @ #t2.5 )
                                        case insertprivatePartakhaksk_0_111111111111111
                                        solve( state_111111111111111( ~RouterID.1, ~ServerID.1, ~ak_h, ~ak_sk,
                                                                      ~ssk_nms.1
                                               ) ▶₀ #t2.5 )
                                          case insertauthPolicyakhnil_0_11111111111111
                                          by contradiction /* cyclic */
                                        qed
                                      next
                                        case insertprivatePartkhksk_0_111111111111111111111121111111
                                        by solve( state_111111111111111111111121111111( ~RouterID.1,
                                                                                        ~ServerID.1, ~ak_h.1,
                                                                                        ~ak_sk.1, ~ak_h,
                                                                                        ~ak_sk, ~ssk_nms.1,
                                                                                        authPolicy, lock
                                                  ) ▶₀ #t2.5 )
                                      qed
                                    next
                                      case outsignobjpkobjapask_0_11111111111111111111211111111
                                      solve( ((#vr.51 < #vr.69) ∧
                                              (∃ #t2.
                                                (Unlock_4( '4', ~n.1, 'device' ) @ #t2)
                                               ∧
                                                (#vr.51 < #t2) ∧
                                                (#t2 < #vr.69) ∧
                                                (∀ #t0 pp. (Unlock( pp, ~n.1, 'device' ) @ #t0) ⇒ #t0 = #t2) ∧
                                                (∀ pp lpp #t0.
                                                  (Lock( pp, lpp, 'device' ) @ #t0)
                                                 ⇒
                                                  ((#t0 < #vr.51) ∨ (#t0 = #vr.51) ∨ (#t2 < #t0))) ∧
                                                (∀ pp lpp #t0.
                                                  (Unlock( pp, lpp, 'device' ) @ #t0)
                                                 ⇒
                                                  ((#t0 < #vr.51) ∨ (#t2 < #t0) ∨ (#t2 = #t0)))))  ∥
                                             (#vr.69 < #vr.51)  ∥ (#vr.51 = #vr.69) )
                                        case case_1
                                        solve( TPM_SendCommand( <'TPM2_Certify', obj_sh.1, obj_h, a_h>
                                               ) @ #t2.7 )
                                          case eventTPMSendCommandTPMCertifytlsshtlshakh_0_111111111111121111111111111
                                          by solve( state_111111111111121111111111111( ~RouterID.1,
                                                                                       ~ServerID.1, ~ak_h.1,
                                                                                       ~ak_sk.1, ~ssk_nms.1,
                                                                                       ~tid.1, obj_h,
                                                                                       obj_sh.1, tls_spk
                                                    ) ▶₀ #t2.5 )
                                        qed
                                      next
                                        case case_2
                                        solve( (#vr.69 < #vr.8)  ∥ (#t2.2 < #vr.69) )
                                          case case_1
                                          solve( TPM_SendCommand( <'TPM2_Certify', obj_sh.1, obj_h, a_h>
                                                 ) @ #t2.7 )
                                            case eventTPMSendCommandTPMCertifytlsshtlshakh_0_111111111111121111111111111
                                            by solve( state_111111111111121111111111111( ~RouterID.1,
                                                                                         ~ServerID.1, ~ak_h.1,
                                                                                         ~ak_sk.1, ~ssk_nms.1,
                                                                                         ~tid.1, obj_h,
                                                                                         obj_sh.1, tls_spk
                                                      ) ▶₀ #t2.5 )
                                          qed
                                        next
                                          case case_2
                                          solve( TPM_SendCommand( <'TPM2_Certify', obj_sh.1, obj_h, a_h>
                                                 ) @ #t2.7 )
                                            case eventTPMSendCommandTPMCertifytlsshtlshakh_0_111111111111121111111111111
                                            by solve( state_111111111111121111111111111( ~RouterID.1,
                                                                                         ~ServerID.1, ~ak_h.1,
                                                                                         ~ak_sk.1, ~ssk_nms.1,
                                                                                         ~tid.1, obj_h,
                                                                                         obj_sh.1, tls_spk
                                                      ) ▶₀ #t2.5 )
                                          qed
                                        qed
                                      qed
                                    next
                                      case outtlsspkskaecsr_0_11111111111112111111111111111111111111
                                      solve( TPM_SendCommand( <'TPM2_Sign', k_sh, k_h.1, pk(x), 
                                                               sign(<pk(x), <swstate, nil>, 
                                                                     'TPM_CC_PolicyPCR', nil>,
                                                                    ~ak_sk)
                                                              >
                                             ) @ #t2.8 )
                                        case eventTPMSendCommandTPMSigntlsshtlshtlsspkskae_0_111111111111121111111111111111111
                                        solve( state_111111111111121111111111111111111( ~RouterID.1,
                                                                                        ~ServerID.1, ~ak_h.1,
                                                                                        ~ak_sk.1, ~ssk_nms.1,
                                                                                        ~tid.1,
                                                                                        sign(<pk(x), 
                                                                                              <swstate, nil>, 
                                                                                              'TPM_CC_PolicyPCR', 
                                                                                              nil>,
                                                                                             ~ak_sk),
                                                                                        k_h.1, k_sh, pk(x)
                                               ) ▶₀ #t2.5 )
                                          case ifverifyskaetlsspkswstatenilTPMCCPolicyPCRnilpkaksktrue_0_11111111111112111111111111111111
                                          by contradiction /* from formulas */
                                        qed
                                      qed
                                    qed
                                  qed
                                qed
                              qed
                            qed
                          next
                            case case_2
                            solve( TPM_SendCommand( <'TPM2_Create', <swstate, nil>, 
                                                     'TPM_CC_PolicyPCR', nil>
                                   ) @ #t2.7 )
                              case eventTPMSendCommandTPMCreateswstatenilTPMCCPolicyPCRnil_0_11111111111112111
                              solve( state_11111111111112111( ~RouterID.1, ~ServerID.1, ~ak_h.1,
                                                              ~ak_sk.1, ~ssk_nms.1, ~tid.1
                                     ) ▶₀ #t2.6 )
                                case outTPMPCRExtendswstate_0_1111111111111211
                                solve( TPM_SendCommand( <'TPM2_Create', <swstate, nil>, 
                                                         'TPM_CC_PolicyPCR', nil>
                                       ) @ #t2.7 )
                                  case eventTPMSendCommandTPMCreateswstatenilTPMCCPolicyPCRnil_0_11111111111112111
                                  solve( state_11111111111112111( ~RouterID.1, ~ServerID.1, ~ak_h.1,
                                                                  ~ak_sk.1, ~ssk_nms.1, ~tid.1
                                         ) ▶₀ #t2.6 )
                                    case outTPMPCRExtendswstate_0_1111111111111211
                                    solve( !KU( sign(<pk(x), 
                                                      sign(<pk(x), <swstate, nil>, 'TPM_CC_PolicyPCR', nil>,
                                                           ~ak_sk)
                                                     >,
                                                     x)
                                           ) @ #vk.7 )
                                      case c_sign
                                      solve( Insert( <'privatePart', ~ak_h>, ~ak_sk ) @ #t2.5 )
                                        case insertprivatePartakhaksk_0_111111111111111
                                        solve( Insert( <'publicPart', ~k_h>, pk(x) ) @ #vr.3 )
                                          case insertpublicPartkhpkksk_0_1111111111111111111111211111111
                                          by contradiction /* from formulas */
                                        qed
                                      qed
                                    next
                                      case outsignobjpkobjapask_0_11111111111111111111211111111
                                      solve( ((#vr.50 < #vr.68) ∧
                                              (∃ #t2.
                                                (Unlock_4( '4', ~n.1, 'device' ) @ #t2)
                                               ∧
                                                (#vr.50 < #t2) ∧
                                                (#t2 < #vr.68) ∧
                                                (∀ #t0 pp. (Unlock( pp, ~n.1, 'device' ) @ #t0) ⇒ #t0 = #t2) ∧
                                                (∀ pp lpp #t0.
                                                  (Lock( pp, lpp, 'device' ) @ #t0)
                                                 ⇒
                                                  ((#t0 < #vr.50) ∨ (#t0 = #vr.50) ∨ (#t2 < #t0))) ∧
                                                (∀ pp lpp #t0.
                                                  (Unlock( pp, lpp, 'device' ) @ #t0)
                                                 ⇒
                                                  ((#t0 < #vr.50) ∨ (#t2 < #t0) ∨ (#t2 = #t0)))))  ∥
                                             (#vr.68 < #vr.50)  ∥ (#vr.50 = #vr.68) )
                                        case case_1
                                        solve( TPM_SendCommand( <'TPM2_Certify', obj_sh.1, obj_h, a_h>
                                               ) @ #t2.7 )
                                          case eventTPMSendCommandTPMCertifytlsshtlshakh_0_111111111111121111111111111
                                          by solve( state_111111111111121111111111111( ~RouterID.1,
                                                                                       ~ServerID.1, ~ak_h.1,
                                                                                       ~ak_sk.1, ~ssk_nms.1,
                                                                                       ~tid.1, obj_h,
                                                                                       obj_sh.1, tls_spk
                                                    ) ▶₀ #t2.6 )
                                        qed
                                      next
                                        case case_2
                                        solve( (#vr.68 < #vr.8)  ∥ (#t2.2 < #vr.68) )
                                          case case_1
                                          solve( TPM_SendCommand( <'TPM2_Certify', obj_sh.1, obj_h, a_h>
                                                 ) @ #t2.7 )
                                            case eventTPMSendCommandTPMCertifytlsshtlshakh_0_111111111111121111111111111
                                            by solve( state_111111111111121111111111111( ~RouterID.1,
                                                                                         ~ServerID.1, ~ak_h.1,
                                                                                         ~ak_sk.1, ~ssk_nms.1,
                                                                                         ~tid.1, obj_h,
                                                                                         obj_sh.1, tls_spk
                                                      ) ▶₀ #t2.6 )
                                          qed
                                        next
                                          case case_2
                                          solve( TPM_SendCommand( <'TPM2_Certify', obj_sh.1, obj_h, a_h>
                                                 ) @ #t2.7 )
                                            case eventTPMSendCommandTPMCertifytlsshtlshakh_0_111111111111121111111111111
                                            by solve( state_111111111111121111111111111( ~RouterID.1,
                                                                                         ~ServerID.1, ~ak_h.1,
                                                                                         ~ak_sk.1, ~ssk_nms.1,
                                                                                         ~tid.1, obj_h,
                                                                                         obj_sh.1, tls_spk
                                                      ) ▶₀ #t2.6 )
                                          qed
                                        qed
                                      qed
                                    next
                                      case outtlsspkskaecsr_0_11111111111112111111111111111111111111
                                      solve( TPM_SendCommand( <'TPM2_Sign', k_sh, k_h.1, pk(x), 
                                                               sign(<pk(x), <swstate, nil>, 
                                                                     'TPM_CC_PolicyPCR', nil>,
                                                                    ~ak_sk)
                                                              >
                                             ) @ #t2.8 )
                                        case eventTPMSendCommandTPMSigntlsshtlshtlsspkskae_0_111111111111121111111111111111111
                                        solve( state_111111111111121111111111111111111( ~RouterID.1,
                                                                                        ~ServerID.1, ~ak_h.1,
                                                                                        ~ak_sk.1, ~ssk_nms.1,
                                                                                        ~tid.1,
                                                                                        sign(<pk(x), 
                                                                                              <swstate, nil>, 
                                                                                              'TPM_CC_PolicyPCR', 
                                                                                              nil>,
                                                                                             ~ak_sk),
                                                                                        k_h.1, k_sh, pk(x)
                                               ) ▶₀ #t2.6 )
                                          case ifverifyskaetlsspkswstatenilTPMCCPolicyPCRnilpkaksktrue_0_11111111111112111111111111111111
                                          by contradiction /* from formulas */
                                        qed
                                      qed
                                    qed
                                  qed
                                qed
                              qed
                            qed
                          qed
                        qed
                      qed
                    qed
                  qed
                qed
              next
                case case_2
                solve( TPM_SendCommand( <'TPM2_Certify', obj_sh, obj_h, a_h> ) @ #t2.2 )
                  case eventTPMSendCommandTPMCertifytlsshtlshakh_0_111111111111121111111111111
                  solve( state_111111111111121111111111111( ~RouterID.1, ~ServerID.1,
                                                            ~ak_h.1, ~ak_sk.1, ~ssk_nms.1, ~tid.1, obj_h,
                                                            obj_sh, tls_spk
                         ) ▶₀ #t2.2 )
                    case outTPMPolicyPCRtlssh_0_11111111111112111111111111
                    by contradiction /* cyclic */
                  qed
                qed
              qed
            next
              case outtlsspkskaecsr_0_11111111111112111111111111111111111111
              solve( ((#vr.9 < #vr.62) ∧
                      (∃ #t2.
                        (Unlock_2( '2', ~n, 'device' ) @ #t2)
                       ∧
                        (#vr.9 < #t2) ∧
                        (#t2 < #vr.62) ∧
                        (∀ #t0 pp. (Unlock( pp, ~n, 'device' ) @ #t0) ⇒ #t0 = #t2) ∧
                        (∀ pp lpp #t0.
                          (Lock( pp, lpp, 'device' ) @ #t0)
                         ⇒
                          ((#t0 < #vr.9) ∨ (#t0 = #vr.9) ∨ (#t2 < #t0))) ∧
                        (∀ pp lpp #t0.
                          (Unlock( pp, lpp, 'device' ) @ #t0)
                         ⇒
                          ((#t0 < #vr.9) ∨ (#t2 < #t0) ∨ (#t2 = #t0)))))  ∥
                     (#vr.62 < #vr.9) )
                case case_1
                solve( state_111111111111111111111121111111111( ~RouterID.1, ~ServerID.1,
                                                                ~ak_h.1, ~ak_sk.1, ~k_h.2, ~k_sk.1,
                                                                ~ssk_nms.1, authPolicy, ~n
                       ) ▶₀ #t2.2 )
                  case TpmCreateOutkhpkksk_0_11111111111111111111112111111111
                  solve( TPM_SendCommand( <'TPM2_Sign', k_sh, k_h.1, pk(x), 
                                           <swstate, nil>, 'TPM_CC_PolicyPCR', nil>
                         ) @ #t2.3 )
                    case eventTPMSendCommandTPMSigntlsshtlshtlsspkskae_0_111111111111121111111111111111111
                    by solve( state_111111111111121111111111111111111( ~RouterID.1,
                                                                       ~ServerID.1, ~ak_h.1, ~ak_sk.1,
                                                                       ~ssk_nms.1, ~tid.1,
                                                                       <<swstate, nil>, 'TPM_CC_PolicyPCR', 
                                                                        nil>,
                                                                       k_h.1, k_sh, pk(x)
                              ) ▶₀ #t2.3 )
                  qed
                qed
              next
                case case_2
                solve( TPM_SendCommand( <'TPM2_Sign', k_sh, k_h.1, pk(x), 
                                         <swstate, nil>, 'TPM_CC_PolicyPCR', nil>
                       ) @ #t2.2 )
                  case eventTPMSendCommandTPMSigntlsshtlshtlsspkskae_0_111111111111121111111111111111111
                  by solve( state_111111111111121111111111111111111( ~RouterID.1,
                                                                     ~ServerID.1, ~ak_h.1, ~ak_sk.1,
                                                                     ~ssk_nms.1, ~tid.1,
                                                                     <<swstate, nil>, 'TPM_CC_PolicyPCR', nil
                                                                     >,
                                                                     k_h.1, k_sh, pk(x)
                            ) ▶₀ #t2.2 )
                qed
              qed
            qed
          qed
        qed
      qed
    qed
  qed
next
  case eventHasKeyTLSServerIDtlsspk_0_111111111111211111
  solve( state_111111111111211111( ~RouterID, ~ServerID, ~ak_h, ~ak_sk,
                                   ~ssk_nms, csr, skae, k1
         ) ▶₀ #t1 )
    case eventReceiveValueCSRServerIDcsr_0_11111111111121111
    solve( HasKey( 'TLS', id2, k2 ) @ #t2 )
      case eventHasKeyTLSRouterIDtlsspk_0_11111111111112111111
      solve( state_11111111111112111111( ~RouterID.1, ~ServerID.1, ~ak_h.1,
                                         ~ak_sk.1, ~ssk_nms.1, ~tid, tls_h, k2
             ) ▶₀ #t2 )
        case TpmCreateOuttlshtlsspk_0_1111111111111211111
        solve( TPM_SendCommand( <'TPM2_Create', authPolicy> ) @ #t2.1 )
          case eventTPMSendCommandTPMCreateswstatenilTPMCCPolicyPCRnil_0_11111111111112111
          solve( state_11111111111112111( ~RouterID.1, ~ServerID.1, ~ak_h.1,
                                          ~ak_sk.1, ~ssk_nms.1, ~tid.1
                 ) ▶₀ #t2.1 )
            case outTPMPCRExtendswstate_0_1111111111111211
            solve( !KU( sign(<pk(x), <swstate, nil>, 'TPM_CC_PolicyPCR', nil>,
                             ~ak_sk)
                   ) @ #vk.3 )
              case c_sign
              solve( !KU( sign(<pk(x), 
                                sign(<pk(x), <swstate, nil>, 'TPM_CC_PolicyPCR', nil>, ~ak_sk)>,
                               x)
                     ) @ #vk.5 )
                case c_sign
                by solve( !KU( ~ak_sk ) @ #vk.14 )
              next
                case outsignobjpkobjapask_0_11111111111111111111211111111
                solve( ((#vr.29 < #vr.52) ∧
                        (∃ #t2.
                          (Unlock_2( '2', ~n, 'device' ) @ #t2)
                         ∧
                          (#vr.29 < #t2) ∧
                          (#t2 < #vr.52) ∧
                          (∀ #t0 pp. (Unlock( pp, ~n, 'device' ) @ #t0) ⇒ #t0 = #t2) ∧
                          (∀ pp lpp #t0.
                            (Lock( pp, lpp, 'device' ) @ #t0)
                           ⇒
                            ((#t0 < #vr.29) ∨ (#t0 = #vr.29) ∨ (#t2 < #t0))) ∧
                          (∀ pp lpp #t0.
                            (Unlock( pp, lpp, 'device' ) @ #t0)
                           ⇒
                            ((#t0 < #vr.29) ∨ (#t2 < #t0) ∨ (#t2 = #t0)))))  ∥
                       (#vr.52 < #vr.29) )
                  case case_1
                  solve( state_111111111111111111111121111111111( ~RouterID.1, ~ServerID.1,
                                                                  ~ak_h.1, ~ak_sk.1, ~k_h.1, ~k_sk.1,
                                                                  ~ssk_nms.1, authPolicy, ~n
                         ) ▶₀ #t2.2 )
                    case TpmCreateOutkhpkksk_0_11111111111111111111112111111111
                    solve( TPM_SendCommand( <'TPM2_Certify', obj_sh, obj_h, a_h> ) @ #t2.3 )
                      case eventTPMSendCommandTPMCertifytlsshtlshakh_0_111111111111121111111111111
                      solve( state_111111111111121111111111111( ~RouterID.1, ~ServerID.1,
                                                                ~ak_h.1, ~ak_sk.1, ~ssk_nms.1, ~tid.1, obj_h,
                                                                obj_sh, tls_spk
                             ) ▶₀ #t2.3 )
                        case outTPMPolicyPCRtlssh_0_11111111111112111111111111
                        solve( (#vr.23 < #t2.5)  ∥ (#vr.23 = #t2.5) )
                          case case_1
                          solve( (#vr.27 < #t2.6)  ∥ (#vr.27 = #t2.6) )
                            case case_1
                            solve( (#vr.44 < #t2.4)  ∥ (#vr.44 = #t2.4) )
                              case case_1
                              solve( TPM_SendCommand( <'TPM2_Create', <swstate, nil>, 
                                                       'TPM_CC_PolicyPCR', nil>
                                     ) @ #t2.8 )
                                case eventTPMSendCommandTPMCreateswstatenilTPMCCPolicyPCRnil_0_11111111111112111
                                solve( state_11111111111112111( ~RouterID.1, ~ServerID.1, ~ak_h.1,
                                                                ~ak_sk.1, ~ssk_nms.1, ~tid.1
                                       ) ▶₀ #t2.4 )
                                  case outTPMPCRExtendswstate_0_1111111111111211
                                  solve( TPM_SendCommand( <'TPM2_Create', <swstate, nil>, 
                                                           'TPM_CC_PolicyPCR', nil>
                                         ) @ #t2.8 )
                                    case eventTPMSendCommandTPMCreateswstatenilTPMCCPolicyPCRnil_0_11111111111112111
                                    solve( state_11111111111112111( ~RouterID.1, ~ServerID.1, ~ak_h.1,
                                                                    ~ak_sk.1, ~ssk_nms.1, ~tid.1
                                           ) ▶₀ #t2.4 )
                                      case outTPMPCRExtendswstate_0_1111111111111211
                                      by solve( !KU( ~ak_sk ) @ #vk.14 )
                                    qed
                                  qed
                                qed
                              qed
                            next
                              case case_2
                              solve( TPM_SendCommand( <'TPM2_Create', <swstate, nil>, 
                                                       'TPM_CC_PolicyPCR', nil>
                                     ) @ #t2.8 )
                                case eventTPMSendCommandTPMCreateswstatenilTPMCCPolicyPCRnil_0_11111111111112111
                                solve( state_11111111111112111( ~RouterID.1, ~ServerID.1, ~ak_h.1,
                                                                ~ak_sk.1, ~ssk_nms.1, ~tid.1
                                       ) ▶₀ #t2.5 )
                                  case outTPMPCRExtendswstate_0_1111111111111211
                                  solve( TPM_SendCommand( <'TPM2_Create', <swstate, nil>, 
                                                           'TPM_CC_PolicyPCR', nil>
                                         ) @ #t2.8 )
                                    case eventTPMSendCommandTPMCreateswstatenilTPMCCPolicyPCRnil_0_11111111111112111
                                    solve( state_11111111111112111( ~RouterID.1, ~ServerID.1, ~ak_h.1,
                                                                    ~ak_sk.1, ~ssk_nms.1, ~tid.1
                                           ) ▶₀ #t2.5 )
                                      case outTPMPCRExtendswstate_0_1111111111111211
                                      by solve( !KU( ~ak_sk ) @ #vk.14 )
                                    qed
                                  qed
                                qed
                              qed
                            qed
                          next
                            case case_2
                            solve( (#vr.43 < #t2.5)  ∥ (#vr.43 = #t2.5) )
                              case case_1
                              solve( TPM_SendCommand( <'TPM2_Create', <swstate, nil>, 
                                                       'TPM_CC_PolicyPCR', nil>
                                     ) @ #t2.8 )
                                case eventTPMSendCommandTPMCreateswstatenilTPMCCPolicyPCRnil_0_11111111111112111
                                solve( state_11111111111112111( ~RouterID.1, ~ServerID.1, ~ak_h.1,
                                                                ~ak_sk.1, ~ssk_nms.1, ~tid.1
                                       ) ▶₀ #t2.5 )
                                  case outTPMPCRExtendswstate_0_1111111111111211
                                  solve( TPM_SendCommand( <'TPM2_Create', <swstate, nil>, 
                                                           'TPM_CC_PolicyPCR', nil>
                                         ) @ #t2.8 )
                                    case eventTPMSendCommandTPMCreateswstatenilTPMCCPolicyPCRnil_0_11111111111112111
                                    solve( state_11111111111112111( ~RouterID.1, ~ServerID.1, ~ak_h.1,
                                                                    ~ak_sk.1, ~ssk_nms.1, ~tid.1
                                           ) ▶₀ #t2.5 )
                                      case outTPMPCRExtendswstate_0_1111111111111211
                                      by solve( !KU( ~ak_sk ) @ #vk.14 )
                                    qed
                                  qed
                                qed
                              qed
                            next
                              case case_2
                              solve( TPM_SendCommand( <'TPM2_Create', <swstate, nil>, 
                                                       'TPM_CC_PolicyPCR', nil>
                                     ) @ #t2.8 )
                                case eventTPMSendCommandTPMCreateswstatenilTPMCCPolicyPCRnil_0_11111111111112111
                                solve( state_11111111111112111( ~RouterID.1, ~ServerID.1, ~ak_h.1,
                                                                ~ak_sk.1, ~ssk_nms.1, ~tid.1
                                       ) ▶₀ #t2.6 )
                                  case outTPMPCRExtendswstate_0_1111111111111211
                                  solve( TPM_SendCommand( <'TPM2_Create', <swstate, nil>, 
                                                           'TPM_CC_PolicyPCR', nil>
                                         ) @ #t2.8 )
                                    case eventTPMSendCommandTPMCreateswstatenilTPMCCPolicyPCRnil_0_11111111111112111
                                    solve( state_11111111111112111( ~RouterID.1, ~ServerID.1, ~ak_h.1,
                                                                    ~ak_sk.1, ~ssk_nms.1, ~tid.1
                                           ) ▶₀ #t2.6 )
                                      case outTPMPCRExtendswstate_0_1111111111111211
                                      by solve( !KU( ~ak_sk ) @ #vk.14 )
                                    qed
                                  qed
                                qed
                              qed
                            qed
                          qed
                        next
                          case case_2
                          solve( (#vr.26 < #t2.6)  ∥ (#vr.26 = #t2.6) )
                            case case_1
                            solve( (#vr.43 < #t2.5)  ∥ (#vr.43 = #t2.5) )
                              case case_1
                              solve( TPM_SendCommand( <'TPM2_Create', <swstate, nil>, 
                                                       'TPM_CC_PolicyPCR', nil>
                                     ) @ #t2.8 )
                                case eventTPMSendCommandTPMCreateswstatenilTPMCCPolicyPCRnil_0_11111111111112111
                                solve( state_11111111111112111( ~RouterID.1, ~ServerID.1, ~ak_h.1,
                                                                ~ak_sk.1, ~ssk_nms.1, ~tid.1
                                       ) ▶₀ #t2.5 )
                                  case outTPMPCRExtendswstate_0_1111111111111211
                                  solve( TPM_SendCommand( <'TPM2_Create', <swstate, nil>, 
                                                           'TPM_CC_PolicyPCR', nil>
                                         ) @ #t2.8 )
                                    case eventTPMSendCommandTPMCreateswstatenilTPMCCPolicyPCRnil_0_11111111111112111
                                    solve( state_11111111111112111( ~RouterID.1, ~ServerID.1, ~ak_h.1,
                                                                    ~ak_sk.1, ~ssk_nms.1, ~tid.1
                                           ) ▶₀ #t2.5 )
                                      case outTPMPCRExtendswstate_0_1111111111111211
                                      by solve( !KU( ~ak_sk ) @ #vk.14 )
                                    qed
                                  qed
                                qed
                              qed
                            next
                              case case_2
                              solve( TPM_SendCommand( <'TPM2_Create', <swstate, nil>, 
                                                       'TPM_CC_PolicyPCR', nil>
                                     ) @ #t2.8 )
                                case eventTPMSendCommandTPMCreateswstatenilTPMCCPolicyPCRnil_0_11111111111112111
                                solve( state_11111111111112111( ~RouterID.1, ~ServerID.1, ~ak_h.1,
                                                                ~ak_sk.1, ~ssk_nms.1, ~tid.1
                                       ) ▶₀ #t2.6 )
                                  case outTPMPCRExtendswstate_0_1111111111111211
                                  solve( TPM_SendCommand( <'TPM2_Create', <swstate, nil>, 
                                                           'TPM_CC_PolicyPCR', nil>
                                         ) @ #t2.8 )
                                    case eventTPMSendCommandTPMCreateswstatenilTPMCCPolicyPCRnil_0_11111111111112111
                                    solve( state_11111111111112111( ~RouterID.1, ~ServerID.1, ~ak_h.1,
                                                                    ~ak_sk.1, ~ssk_nms.1, ~tid.1
                                           ) ▶₀ #t2.6 )
                                      case outTPMPCRExtendswstate_0_1111111111111211
                                      by solve( !KU( ~ak_sk ) @ #vk.14 )
                                    qed
                                  qed
                                qed
                              qed
                            qed
                          next
                            case case_2
                            solve( (#vr.42 < #t2.6)  ∥ (#vr.42 = #t2.6) )
                              case case_1
                              solve( TPM_SendCommand( <'TPM2_Create', <swstate, nil>, 
                                                       'TPM_CC_PolicyPCR', nil>
                                     ) @ #t2.8 )
                                case eventTPMSendCommandTPMCreateswstatenilTPMCCPolicyPCRnil_0_11111111111112111
                                solve( state_11111111111112111( ~RouterID.1, ~ServerID.1, ~ak_h.1,
                                                                ~ak_sk.1, ~ssk_nms.1, ~tid.1
                                       ) ▶₀ #t2.6 )
                                  case outTPMPCRExtendswstate_0_1111111111111211
                                  solve( TPM_SendCommand( <'TPM2_Create', <swstate, nil>, 
                                                           'TPM_CC_PolicyPCR', nil>
                                         ) @ #t2.8 )
                                    case eventTPMSendCommandTPMCreateswstatenilTPMCCPolicyPCRnil_0_11111111111112111
                                    solve( state_11111111111112111( ~RouterID.1, ~ServerID.1, ~ak_h.1,
                                                                    ~ak_sk.1, ~ssk_nms.1, ~tid.1
                                           ) ▶₀ #t2.6 )
                                      case outTPMPCRExtendswstate_0_1111111111111211
                                      by solve( !KU( ~ak_sk ) @ #vk.14 )
                                    qed
                                  qed
                                qed
                              qed
                            next
                              case case_2
                              solve( TPM_SendCommand( <'TPM2_Create', <swstate, nil>, 
                                                       'TPM_CC_PolicyPCR', nil>
                                     ) @ #t2.8 )
                                case eventTPMSendCommandTPMCreateswstatenilTPMCCPolicyPCRnil_0_11111111111112111
                                solve( state_11111111111112111( ~RouterID.1, ~ServerID.1, ~ak_h.1,
                                                                ~ak_sk.1, ~ssk_nms.1, ~tid.1
                                       ) ▶₀ #t2.7 )
                                  case outTPMPCRExtendswstate_0_1111111111111211
                                  solve( TPM_SendCommand( <'TPM2_Create', <swstate, nil>, 
                                                           'TPM_CC_PolicyPCR', nil>
                                         ) @ #t2.8 )
                                    case eventTPMSendCommandTPMCreateswstatenilTPMCCPolicyPCRnil_0_11111111111112111
                                    solve( state_11111111111112111( ~RouterID.1, ~ServerID.1, ~ak_h.1,
                                                                    ~ak_sk.1, ~ssk_nms.1, ~tid.1
                                           ) ▶₀ #t2.7 )
                                      case outTPMPCRExtendswstate_0_1111111111111211
                                      by solve( !KU( ~ak_sk ) @ #vk.14 )
                                    qed
                                  qed
                                qed
                              qed
                            qed
                          qed
                        qed
                      qed
                    qed
                  qed
                next
                  case case_2
                  solve( TPM_SendCommand( <'TPM2_Certify', obj_sh, obj_h, a_h> ) @ #t2.2 )
                    case eventTPMSendCommandTPMCertifytlsshtlshakh_0_111111111111121111111111111
                    solve( state_111111111111121111111111111( ~RouterID.1, ~ServerID.1,
                                                              ~ak_h.1, ~ak_sk.1, ~ssk_nms.1, ~tid.1, obj_h,
                                                              obj_sh, tls_spk
                           ) ▶₀ #t2.2 )
                      case outTPMPolicyPCRtlssh_0_11111111111112111111111111
                      by contradiction /* cyclic */
                    qed
                  qed
                qed
              next
                case outtlsspkskaecsr_0_11111111111112111111111111111111111111
                solve( ((#vr.29 < #vr.62) ∧
                        (∃ #t2.
                          (Unlock_2( '2', ~n, 'device' ) @ #t2)
                         ∧
                          (#vr.29 < #t2) ∧
                          (#t2 < #vr.62) ∧
                          (∀ #t0 pp. (Unlock( pp, ~n, 'device' ) @ #t0) ⇒ #t0 = #t2) ∧
                          (∀ pp lpp #t0.
                            (Lock( pp, lpp, 'device' ) @ #t0)
                           ⇒
                            ((#t0 < #vr.29) ∨ (#t0 = #vr.29) ∨ (#t2 < #t0))) ∧
                          (∀ pp lpp #t0.
                            (Unlock( pp, lpp, 'device' ) @ #t0)
                           ⇒
                            ((#t0 < #vr.29) ∨ (#t2 < #t0) ∨ (#t2 = #t0)))))  ∥
                       (#vr.62 < #vr.29) )
                  case case_1
                  solve( state_111111111111111111111121111111111( ~RouterID.1, ~ServerID.1,
                                                                  ~ak_h.1, ~ak_sk.1, ~k_h.2, ~k_sk.1,
                                                                  ~ssk_nms.1, authPolicy, ~n
                         ) ▶₀ #t2.2 )
                    case TpmCreateOutkhpkksk_0_11111111111111111111112111111111
                    solve( TPM_SendCommand( <'TPM2_Sign', k_sh, k_h.1, pk(x), 
                                             sign(<pk(x), <swstate, nil>, 'TPM_CC_PolicyPCR', nil>, ~ak_sk)>
                           ) @ #t2.3 )
                      case eventTPMSendCommandTPMSigntlsshtlshtlsspkskae_0_111111111111121111111111111111111
                      solve( state_111111111111121111111111111111111( ~RouterID.1, ~ServerID.1,
                                                                      ~ak_h.1, ~ak_sk.1, ~ssk_nms.1, ~tid.1,
                                                                      sign(<pk(x), <swstate, nil>, 
                                                                            'TPM_CC_PolicyPCR', nil>,
                                                                           ~ak_sk),
                                                                      k_h.1, k_sh, pk(x)
                             ) ▶₀ #t2.3 )
                        case ifverifyskaetlsspkswstatenilTPMCCPolicyPCRnilpkaksktrue_0_11111111111112111111111111111111
                        by contradiction /* from formulas */
                      qed
                    qed
                  qed
                next
                  case case_2
                  solve( TPM_SendCommand( <'TPM2_Sign', k_sh, k_h.1, pk(x), 
                                           sign(<pk(x), <swstate, nil>, 'TPM_CC_PolicyPCR', nil>, ~ak_sk)>
                         ) @ #t2.2 )
                    case eventTPMSendCommandTPMSigntlsshtlshtlsspkskae_0_111111111111121111111111111111111
                    solve( state_111111111111121111111111111111111( ~RouterID.1, ~ServerID.1,
                                                                    ~ak_h.1, ~ak_sk.1, ~ssk_nms.1, ~tid.1,
                                                                    sign(<pk(x), <swstate, nil>, 
                                                                          'TPM_CC_PolicyPCR', nil>,
                                                                         ~ak_sk),
                                                                    k_h.1, k_sh, pk(x)
                           ) ▶₀ #t2.2 )
                      case ifverifyskaetlsspkswstatenilTPMCCPolicyPCRnilpkaksktrue_0_11111111111112111111111111111111
                      by contradiction /* cyclic */
                    qed
                  qed
                qed
              qed
            next
              case outsignobjpkobjapask_0_11111111111111111111211111111
              solve( ((#vr.29 < #vr.52) ∧
                      (∃ #t2.
                        (Unlock_2( '2', ~n, 'device' ) @ #t2)
                       ∧
                        (#vr.29 < #t2) ∧
                        (#t2 < #vr.52) ∧
                        (∀ #t0 pp. (Unlock( pp, ~n, 'device' ) @ #t0) ⇒ #t0 = #t2) ∧
                        (∀ pp lpp #t0.
                          (Lock( pp, lpp, 'device' ) @ #t0)
                         ⇒
                          ((#t0 < #vr.29) ∨ (#t0 = #vr.29) ∨ (#t2 < #t0))) ∧
                        (∀ pp lpp #t0.
                          (Unlock( pp, lpp, 'device' ) @ #t0)
                         ⇒
                          ((#t0 < #vr.29) ∨ (#t2 < #t0) ∨ (#t2 = #t0)))))  ∥
                     (#vr.52 < #vr.29) )
                case case_1
                solve( state_111111111111111111111121111111111( ~RouterID.1, ~ServerID.1,
                                                                ~ak_h.1, ~ak_sk.1, ~k_h.1, ~k_sk.1,
                                                                ~ssk_nms.1, authPolicy, ~n
                       ) ▶₀ #t2.2 )
                  case TpmCreateOutkhpkksk_0_11111111111111111111112111111111
                  solve( TPM_SendCommand( <'TPM2_Certify', obj_sh, obj_h, a_h> ) @ #t2.3 )
                    case eventTPMSendCommandTPMCertifytlsshtlshakh_0_111111111111121111111111111
                    solve( state_111111111111121111111111111( ~RouterID.1, ~ServerID.1,
                                                              ~ak_h.1, ~ak_sk.1, ~ssk_nms.1, ~tid.1, obj_h,
                                                              obj_sh, tls_spk
                           ) ▶₀ #t2.3 )
                      case outTPMPolicyPCRtlssh_0_11111111111112111111111111
                      solve( (#vr.23 < #t2.5)  ∥ (#vr.23 = #t2.5) )
                        case case_1
                        solve( (#vr.27 < #t2.6)  ∥ (#vr.27 = #t2.6) )
                          case case_1
                          solve( (#vr.44 < #t2.4)  ∥ (#vr.44 = #t2.4) )
                            case case_1
                            solve( TPM_SendCommand( <'TPM2_Create', <swstate, nil>, 
                                                     'TPM_CC_PolicyPCR', nil>
                                   ) @ #t2.8 )
                              case eventTPMSendCommandTPMCreateswstatenilTPMCCPolicyPCRnil_0_11111111111112111
                              solve( state_11111111111112111( ~RouterID.1, ~ServerID.1, ~ak_h.1,
                                                              ~ak_sk.1, ~ssk_nms.1, ~tid.1
                                     ) ▶₀ #t2.4 )
                                case outTPMPCRExtendswstate_0_1111111111111211
                                solve( TPM_SendCommand( <'TPM2_Create', <swstate, nil>, 
                                                         'TPM_CC_PolicyPCR', nil>
                                       ) @ #t2.8 )
                                  case eventTPMSendCommandTPMCreateswstatenilTPMCCPolicyPCRnil_0_11111111111112111
                                  solve( state_11111111111112111( ~RouterID.1, ~ServerID.1, ~ak_h.1,
                                                                  ~ak_sk.1, ~ssk_nms.1, ~tid.1
                                         ) ▶₀ #t2.4 )
                                    case outTPMPCRExtendswstate_0_1111111111111211
                                    solve( !KU( sign(<pk(x), 
                                                      sign(<pk(x), <swstate, nil>, 'TPM_CC_PolicyPCR', nil>,
                                                           ~ak_sk)
                                                     >,
                                                     x)
                                           ) @ #vk.4 )
                                      case c_sign
                                      solve( Insert( <'privatePart', ~ak_h>, ~ak_sk ) @ #t2.4 )
                                        case insertprivatePartakhaksk_0_111111111111111
                                        solve( state_111111111111111( ~RouterID.1, ~ServerID.1, ~ak_h, ~ak_sk,
                                                                      ~ssk_nms.1
                                               ) ▶₀ #t2.4 )
                                          case insertauthPolicyakhnil_0_11111111111111
                                          by contradiction /* cyclic */
                                        qed
                                      next
                                        case insertprivatePartkhksk_0_111111111111111111111121111111
                                        by solve( state_111111111111111111111121111111( ~RouterID.1,
                                                                                        ~ServerID.1, ~ak_h.1,
                                                                                        ~ak_sk.1, ~ak_h,
                                                                                        ~ak_sk, ~ssk_nms.1,
                                                                                        authPolicy, lock
                                                  ) ▶₀ #t2.4 )
                                      qed
                                    next
                                      case outsignobjpkobjapask_0_11111111111111111111211111111
                                      solve( ((#vr.52 < #vr.70) ∧
                                              (∃ #t2.
                                                (Unlock_4( '4', ~n.1, 'device' ) @ #t2)
                                               ∧
                                                (#vr.52 < #t2) ∧
                                                (#t2 < #vr.70) ∧
                                                (∀ #t0 pp. (Unlock( pp, ~n.1, 'device' ) @ #t0) ⇒ #t0 = #t2) ∧
                                                (∀ pp lpp #t0.
                                                  (Lock( pp, lpp, 'device' ) @ #t0)
                                                 ⇒
                                                  ((#t0 < #vr.52) ∨ (#t0 = #vr.52) ∨ (#t2 < #t0))) ∧
                                                (∀ pp lpp #t0.
                                                  (Unlock( pp, lpp, 'device' ) @ #t0)
                                                 ⇒
                                                  ((#t0 < #vr.52) ∨ (#t2 < #t0) ∨ (#t2 = #t0)))))  ∥
                                             (#vr.70 < #vr.52)  ∥ (#vr.52 = #vr.70) )
                                        case case_1
                                        solve( TPM_SendCommand( <'TPM2_Certify', obj_sh.1, obj_h, a_h>
                                               ) @ #t2.8 )
                                          case eventTPMSendCommandTPMCertifytlsshtlshakh_0_111111111111121111111111111
                                          by solve( state_111111111111121111111111111( ~RouterID.1,
                                                                                       ~ServerID.1, ~ak_h.1,
                                                                                       ~ak_sk.1, ~ssk_nms.1,
                                                                                       ~tid.1, obj_h,
                                                                                       obj_sh.1, tls_spk
                                                    ) ▶₀ #t2.4 )
                                        qed
                                      next
                                        case case_2
                                        solve( (#vr.70 < #vr.29)  ∥ (#t2.2 < #vr.70) )
                                          case case_1
                                          solve( TPM_SendCommand( <'TPM2_Certify', obj_sh.1, obj_h, a_h>
                                                 ) @ #t2.8 )
                                            case eventTPMSendCommandTPMCertifytlsshtlshakh_0_111111111111121111111111111
                                            by solve( state_111111111111121111111111111( ~RouterID.1,
                                                                                         ~ServerID.1, ~ak_h.1,
                                                                                         ~ak_sk.1, ~ssk_nms.1,
                                                                                         ~tid.1, obj_h,
                                                                                         obj_sh.1, tls_spk
                                                      ) ▶₀ #t2.4 )
                                          qed
                                        next
                                          case case_2
                                          solve( TPM_SendCommand( <'TPM2_Certify', obj_sh.1, obj_h, a_h>
                                                 ) @ #t2.8 )
                                            case eventTPMSendCommandTPMCertifytlsshtlshakh_0_111111111111121111111111111
                                            by solve( state_111111111111121111111111111( ~RouterID.1,
                                                                                         ~ServerID.1, ~ak_h.1,
                                                                                         ~ak_sk.1, ~ssk_nms.1,
                                                                                         ~tid.1, obj_h,
                                                                                         obj_sh.1, tls_spk
                                                      ) ▶₀ #t2.4 )
                                          qed
                                        qed
                                      qed
                                    next
                                      case outtlsspkskaecsr_0_11111111111112111111111111111111111111
                                      solve( TPM_SendCommand( <'TPM2_Sign', k_sh, k_h.1, pk(x), 
                                                               sign(<pk(x), <swstate, nil>, 
                                                                     'TPM_CC_PolicyPCR', nil>,
                                                                    ~ak_sk)
                                                              >
                                             ) @ #t2.9 )
                                        case eventTPMSendCommandTPMSigntlsshtlshtlsspkskae_0_111111111111121111111111111111111
                                        solve( state_111111111111121111111111111111111( ~RouterID.1,
                                                                                        ~ServerID.1, ~ak_h.1,
                                                                                        ~ak_sk.1, ~ssk_nms.1,
                                                                                        ~tid.1,
                                                                                        sign(<pk(x), 
                                                                                              <swstate, nil>, 
                                                                                              'TPM_CC_PolicyPCR', 
                                                                                              nil>,
                                                                                             ~ak_sk),
                                                                                        k_h.1, k_sh, pk(x)
                                               ) ▶₀ #t2.4 )
                                          case ifverifyskaetlsspkswstatenilTPMCCPolicyPCRnilpkaksktrue_0_11111111111112111111111111111111
                                          by contradiction /* from formulas */
                                        qed
                                      qed
                                    qed
                                  qed
                                qed
                              qed
                            qed
                          next
                            case case_2
                            solve( TPM_SendCommand( <'TPM2_Create', <swstate, nil>, 
                                                     'TPM_CC_PolicyPCR', nil>
                                   ) @ #t2.8 )
                              case eventTPMSendCommandTPMCreateswstatenilTPMCCPolicyPCRnil_0_11111111111112111
                              solve( state_11111111111112111( ~RouterID.1, ~ServerID.1, ~ak_h.1,
                                                              ~ak_sk.1, ~ssk_nms.1, ~tid.1
                                     ) ▶₀ #t2.5 )
                                case outTPMPCRExtendswstate_0_1111111111111211
                                solve( TPM_SendCommand( <'TPM2_Create', <swstate, nil>, 
                                                         'TPM_CC_PolicyPCR', nil>
                                       ) @ #t2.8 )
                                  case eventTPMSendCommandTPMCreateswstatenilTPMCCPolicyPCRnil_0_11111111111112111
                                  solve( state_11111111111112111( ~RouterID.1, ~ServerID.1, ~ak_h.1,
                                                                  ~ak_sk.1, ~ssk_nms.1, ~tid.1
                                         ) ▶₀ #t2.5 )
                                    case outTPMPCRExtendswstate_0_1111111111111211
                                    solve( !KU( sign(<pk(x), 
                                                      sign(<pk(x), <swstate, nil>, 'TPM_CC_PolicyPCR', nil>,
                                                           ~ak_sk)
                                                     >,
                                                     x)
                                           ) @ #vk.4 )
                                      case c_sign
                                      solve( Insert( <'privatePart', ~ak_h>, ~ak_sk ) @ #t2.4 )
                                        case insertprivatePartakhaksk_0_111111111111111
                                        solve( Insert( <'publicPart', ~k_h>, pk(x) ) @ #t2.5 )
                                          case insertpublicPartakhpkaksk_0_1111111111111111
                                          by solve( state_1111111111111111( ~RouterID.1, ~ServerID.1, ~k_h,
                                                                            ~ak_sk.1, ~ssk_nms.1
                                                    ) ▶₀ #t2.5 )
                                        next
                                          case insertpublicPartkhpkksk_0_1111111111111111111111211111111
                                          solve( state_1111111111111111111111211111111( ~RouterID.1,
                                                                                        ~ServerID.1, ~ak_h.1,
                                                                                        ~ak_sk.1, ~k_h, ~k_sk,
                                                                                        ~ssk_nms.1,
                                                                                        authPolicy, lock
                                                 ) ▶₀ #t2.5 )
                                            case insertprivatePartkhksk_0_111111111111111111111121111111
                                            by contradiction /* cyclic */
                                          qed
                                        qed
                                      qed
                                    next
                                      case outsignobjpkobjapask_0_11111111111111111111211111111
                                      solve( ((#vr.51 < #vr.69) ∧
                                              (∃ #t2.
                                                (Unlock_4( '4', ~n.1, 'device' ) @ #t2)
                                               ∧
                                                (#vr.51 < #t2) ∧
                                                (#t2 < #vr.69) ∧
                                                (∀ #t0 pp. (Unlock( pp, ~n.1, 'device' ) @ #t0) ⇒ #t0 = #t2) ∧
                                                (∀ pp lpp #t0.
                                                  (Lock( pp, lpp, 'device' ) @ #t0)
                                                 ⇒
                                                  ((#t0 < #vr.51) ∨ (#t0 = #vr.51) ∨ (#t2 < #t0))) ∧
                                                (∀ pp lpp #t0.
                                                  (Unlock( pp, lpp, 'device' ) @ #t0)
                                                 ⇒
                                                  ((#t0 < #vr.51) ∨ (#t2 < #t0) ∨ (#t2 = #t0)))))  ∥
                                             (#vr.69 < #vr.51)  ∥ (#vr.51 = #vr.69) )
                                        case case_1
                                        solve( TPM_SendCommand( <'TPM2_Certify', obj_sh.1, obj_h, a_h>
                                               ) @ #t2.8 )
                                          case eventTPMSendCommandTPMCertifytlsshtlshakh_0_111111111111121111111111111
                                          by solve( state_111111111111121111111111111( ~RouterID.1,
                                                                                       ~ServerID.1, ~ak_h.1,
                                                                                       ~ak_sk.1, ~ssk_nms.1,
                                                                                       ~tid.1, obj_h,
                                                                                       obj_sh.1, tls_spk
                                                    ) ▶₀ #t2.5 )
                                        qed
                                      next
                                        case case_2
                                        solve( (#vr.69 < #vr.29)  ∥ (#t2.2 < #vr.69) )
                                          case case_1
                                          solve( TPM_SendCommand( <'TPM2_Certify', obj_sh.1, obj_h, a_h>
                                                 ) @ #t2.8 )
                                            case eventTPMSendCommandTPMCertifytlsshtlshakh_0_111111111111121111111111111
                                            by solve( state_111111111111121111111111111( ~RouterID.1,
                                                                                         ~ServerID.1, ~ak_h.1,
                                                                                         ~ak_sk.1, ~ssk_nms.1,
                                                                                         ~tid.1, obj_h,
                                                                                         obj_sh.1, tls_spk
                                                      ) ▶₀ #t2.5 )
                                          qed
                                        next
                                          case case_2
                                          solve( TPM_SendCommand( <'TPM2_Certify', obj_sh.1, obj_h, a_h>
                                                 ) @ #t2.8 )
                                            case eventTPMSendCommandTPMCertifytlsshtlshakh_0_111111111111121111111111111
                                            by solve( state_111111111111121111111111111( ~RouterID.1,
                                                                                         ~ServerID.1, ~ak_h.1,
                                                                                         ~ak_sk.1, ~ssk_nms.1,
                                                                                         ~tid.1, obj_h,
                                                                                         obj_sh.1, tls_spk
                                                      ) ▶₀ #t2.5 )
                                          qed
                                        qed
                                      qed
                                    next
                                      case outtlsspkskaecsr_0_11111111111112111111111111111111111111
                                      solve( TPM_SendCommand( <'TPM2_Sign', k_sh, k_h.1, pk(x), 
                                                               sign(<pk(x), <swstate, nil>, 
                                                                     'TPM_CC_PolicyPCR', nil>,
                                                                    ~ak_sk)
                                                              >
                                             ) @ #t2.9 )
                                        case eventTPMSendCommandTPMSigntlsshtlshtlsspkskae_0_111111111111121111111111111111111
                                        solve( state_111111111111121111111111111111111( ~RouterID.1,
                                                                                        ~ServerID.1, ~ak_h.1,
                                                                                        ~ak_sk.1, ~ssk_nms.1,
                                                                                        ~tid.1,
                                                                                        sign(<pk(x), 
                                                                                              <swstate, nil>, 
                                                                                              'TPM_CC_PolicyPCR', 
                                                                                              nil>,
                                                                                             ~ak_sk),
                                                                                        k_h.1, k_sh, pk(x)
                                               ) ▶₀ #t2.5 )
                                          case ifverifyskaetlsspkswstatenilTPMCCPolicyPCRnilpkaksktrue_0_11111111111112111111111111111111
                                          by contradiction /* from formulas */
                                        qed
                                      qed
                                    qed
                                  qed
                                qed
                              qed
                            qed
                          qed
                        next
                          case case_2
                          solve( (#vr.43 < #t2.5)  ∥ (#vr.43 = #t2.5) )
                            case case_1
                            solve( TPM_SendCommand( <'TPM2_Create', <swstate, nil>, 
                                                     'TPM_CC_PolicyPCR', nil>
                                   ) @ #t2.8 )
                              case eventTPMSendCommandTPMCreateswstatenilTPMCCPolicyPCRnil_0_11111111111112111
                              solve( state_11111111111112111( ~RouterID.1, ~ServerID.1, ~ak_h.1,
                                                              ~ak_sk.1, ~ssk_nms.1, ~tid.1
                                     ) ▶₀ #t2.5 )
                                case outTPMPCRExtendswstate_0_1111111111111211
                                solve( TPM_SendCommand( <'TPM2_Create', <swstate, nil>, 
                                                         'TPM_CC_PolicyPCR', nil>
                                       ) @ #t2.8 )
                                  case eventTPMSendCommandTPMCreateswstatenilTPMCCPolicyPCRnil_0_11111111111112111
                                  solve( state_11111111111112111( ~RouterID.1, ~ServerID.1, ~ak_h.1,
                                                                  ~ak_sk.1, ~ssk_nms.1, ~tid.1
                                         ) ▶₀ #t2.5 )
                                    case outTPMPCRExtendswstate_0_1111111111111211
                                    solve( !KU( sign(<pk(x), 
                                                      sign(<pk(x), <swstate, nil>, 'TPM_CC_PolicyPCR', nil>,
                                                           ~ak_sk)
                                                     >,
                                                     x)
                                           ) @ #vk.4 )
                                      case c_sign
                                      solve( Insert( <'privatePart', ~ak_h>, ~ak_sk ) @ #t2.5 )
                                        case insertprivatePartakhaksk_0_111111111111111
                                        solve( state_111111111111111( ~RouterID.1, ~ServerID.1, ~ak_h, ~ak_sk,
                                                                      ~ssk_nms.1
                                               ) ▶₀ #t2.5 )
                                          case insertauthPolicyakhnil_0_11111111111111
                                          by contradiction /* cyclic */
                                        qed
                                      next
                                        case insertprivatePartkhksk_0_111111111111111111111121111111
                                        by solve( state_111111111111111111111121111111( ~RouterID.1,
                                                                                        ~ServerID.1, ~ak_h.1,
                                                                                        ~ak_sk.1, ~ak_h,
                                                                                        ~ak_sk, ~ssk_nms.1,
                                                                                        authPolicy, lock
                                                  ) ▶₀ #t2.5 )
                                      qed
                                    next
                                      case outsignobjpkobjapask_0_11111111111111111111211111111
                                      solve( ((#vr.51 < #vr.69) ∧
                                              (∃ #t2.
                                                (Unlock_4( '4', ~n.1, 'device' ) @ #t2)
                                               ∧
                                                (#vr.51 < #t2) ∧
                                                (#t2 < #vr.69) ∧
                                                (∀ #t0 pp. (Unlock( pp, ~n.1, 'device' ) @ #t0) ⇒ #t0 = #t2) ∧
                                                (∀ pp lpp #t0.
                                                  (Lock( pp, lpp, 'device' ) @ #t0)
                                                 ⇒
                                                  ((#t0 < #vr.51) ∨ (#t0 = #vr.51) ∨ (#t2 < #t0))) ∧
                                                (∀ pp lpp #t0.
                                                  (Unlock( pp, lpp, 'device' ) @ #t0)
                                                 ⇒
                                                  ((#t0 < #vr.51) ∨ (#t2 < #t0) ∨ (#t2 = #t0)))))  ∥
                                             (#vr.69 < #vr.51)  ∥ (#vr.51 = #vr.69) )
                                        case case_1
                                        solve( TPM_SendCommand( <'TPM2_Certify', obj_sh.1, obj_h, a_h>
                                               ) @ #t2.8 )
                                          case eventTPMSendCommandTPMCertifytlsshtlshakh_0_111111111111121111111111111
                                          by solve( state_111111111111121111111111111( ~RouterID.1,
                                                                                       ~ServerID.1, ~ak_h.1,
                                                                                       ~ak_sk.1, ~ssk_nms.1,
                                                                                       ~tid.1, obj_h,
                                                                                       obj_sh.1, tls_spk
                                                    ) ▶₀ #t2.5 )
                                        qed
                                      next
                                        case case_2
                                        solve( (#vr.69 < #vr.28)  ∥ (#t2.2 < #vr.69) )
                                          case case_1
                                          solve( TPM_SendCommand( <'TPM2_Certify', obj_sh.1, obj_h, a_h>
                                                 ) @ #t2.8 )
                                            case eventTPMSendCommandTPMCertifytlsshtlshakh_0_111111111111121111111111111
                                            by solve( state_111111111111121111111111111( ~RouterID.1,
                                                                                         ~ServerID.1, ~ak_h.1,
                                                                                         ~ak_sk.1, ~ssk_nms.1,
                                                                                         ~tid.1, obj_h,
                                                                                         obj_sh.1, tls_spk
                                                      ) ▶₀ #t2.5 )
                                          qed
                                        next
                                          case case_2
                                          solve( TPM_SendCommand( <'TPM2_Certify', obj_sh.1, obj_h, a_h>
                                                 ) @ #t2.8 )
                                            case eventTPMSendCommandTPMCertifytlsshtlshakh_0_111111111111121111111111111
                                            by solve( state_111111111111121111111111111( ~RouterID.1,
                                                                                         ~ServerID.1, ~ak_h.1,
                                                                                         ~ak_sk.1, ~ssk_nms.1,
                                                                                         ~tid.1, obj_h,
                                                                                         obj_sh.1, tls_spk
                                                      ) ▶₀ #t2.5 )
                                          qed
                                        qed
                                      qed
                                    next
                                      case outtlsspkskaecsr_0_11111111111112111111111111111111111111
                                      solve( TPM_SendCommand( <'TPM2_Sign', k_sh, k_h.1, pk(x), 
                                                               sign(<pk(x), <swstate, nil>, 
                                                                     'TPM_CC_PolicyPCR', nil>,
                                                                    ~ak_sk)
                                                              >
                                             ) @ #t2.9 )
                                        case eventTPMSendCommandTPMSigntlsshtlshtlsspkskae_0_111111111111121111111111111111111
                                        solve( state_111111111111121111111111111111111( ~RouterID.1,
                                                                                        ~ServerID.1, ~ak_h.1,
                                                                                        ~ak_sk.1, ~ssk_nms.1,
                                                                                        ~tid.1,
                                                                                        sign(<pk(x), 
                                                                                              <swstate, nil>, 
                                                                                              'TPM_CC_PolicyPCR', 
                                                                                              nil>,
                                                                                             ~ak_sk),
                                                                                        k_h.1, k_sh, pk(x)
                                               ) ▶₀ #t2.5 )
                                          case ifverifyskaetlsspkswstatenilTPMCCPolicyPCRnilpkaksktrue_0_11111111111112111111111111111111
                                          by contradiction /* from formulas */
                                        qed
                                      qed
                                    qed
                                  qed
                                qed
                              qed
                            qed
                          next
                            case case_2
                            solve( TPM_SendCommand( <'TPM2_Create', <swstate, nil>, 
                                                     'TPM_CC_PolicyPCR', nil>
                                   ) @ #t2.8 )
                              case eventTPMSendCommandTPMCreateswstatenilTPMCCPolicyPCRnil_0_11111111111112111
                              solve( state_11111111111112111( ~RouterID.1, ~ServerID.1, ~ak_h.1,
                                                              ~ak_sk.1, ~ssk_nms.1, ~tid.1
                                     ) ▶₀ #t2.6 )
                                case outTPMPCRExtendswstate_0_1111111111111211
                                solve( TPM_SendCommand( <'TPM2_Create', <swstate, nil>, 
                                                         'TPM_CC_PolicyPCR', nil>
                                       ) @ #t2.8 )
                                  case eventTPMSendCommandTPMCreateswstatenilTPMCCPolicyPCRnil_0_11111111111112111
                                  solve( state_11111111111112111( ~RouterID.1, ~ServerID.1, ~ak_h.1,
                                                                  ~ak_sk.1, ~ssk_nms.1, ~tid.1
                                         ) ▶₀ #t2.6 )
                                    case outTPMPCRExtendswstate_0_1111111111111211
                                    solve( !KU( sign(<pk(x), 
                                                      sign(<pk(x), <swstate, nil>, 'TPM_CC_PolicyPCR', nil>,
                                                           ~ak_sk)
                                                     >,
                                                     x)
                                           ) @ #vk.4 )
                                      case c_sign
                                      solve( Insert( <'privatePart', ~ak_h>, ~ak_sk ) @ #t2.5 )
                                        case insertprivatePartakhaksk_0_111111111111111
                                        solve( Insert( <'publicPart', ~k_h>, pk(x) ) @ #t2.6 )
                                          case insertpublicPartakhpkaksk_0_1111111111111111
                                          by solve( state_1111111111111111( ~RouterID.1, ~ServerID.1, ~k_h,
                                                                            ~ak_sk.1, ~ssk_nms.1
                                                    ) ▶₀ #t2.6 )
                                        next
                                          case insertpublicPartkhpkksk_0_1111111111111111111111211111111
                                          solve( state_1111111111111111111111211111111( ~RouterID.1,
                                                                                        ~ServerID.1, ~ak_h.1,
                                                                                        ~ak_sk.1, ~k_h, ~k_sk,
                                                                                        ~ssk_nms.1,
                                                                                        authPolicy, lock
                                                 ) ▶₀ #t2.6 )
                                            case insertprivatePartkhksk_0_111111111111111111111121111111
                                            by contradiction /* cyclic */
                                          qed
                                        qed
                                      qed
                                    next
                                      case outsignobjpkobjapask_0_11111111111111111111211111111
                                      solve( ((#vr.50 < #vr.68) ∧
                                              (∃ #t2.
                                                (Unlock_4( '4', ~n.1, 'device' ) @ #t2)
                                               ∧
                                                (#vr.50 < #t2) ∧
                                                (#t2 < #vr.68) ∧
                                                (∀ #t0 pp. (Unlock( pp, ~n.1, 'device' ) @ #t0) ⇒ #t0 = #t2) ∧
                                                (∀ pp lpp #t0.
                                                  (Lock( pp, lpp, 'device' ) @ #t0)
                                                 ⇒
                                                  ((#t0 < #vr.50) ∨ (#t0 = #vr.50) ∨ (#t2 < #t0))) ∧
                                                (∀ pp lpp #t0.
                                                  (Unlock( pp, lpp, 'device' ) @ #t0)
                                                 ⇒
                                                  ((#t0 < #vr.50) ∨ (#t2 < #t0) ∨ (#t2 = #t0)))))  ∥
                                             (#vr.68 < #vr.50)  ∥ (#vr.50 = #vr.68) )
                                        case case_1
                                        solve( TPM_SendCommand( <'TPM2_Certify', obj_sh.1, obj_h, a_h>
                                               ) @ #t2.8 )
                                          case eventTPMSendCommandTPMCertifytlsshtlshakh_0_111111111111121111111111111
                                          by solve( state_111111111111121111111111111( ~RouterID.1,
                                                                                       ~ServerID.1, ~ak_h.1,
                                                                                       ~ak_sk.1, ~ssk_nms.1,
                                                                                       ~tid.1, obj_h,
                                                                                       obj_sh.1, tls_spk
                                                    ) ▶₀ #t2.6 )
                                        qed
                                      next
                                        case case_2
                                        solve( (#vr.68 < #vr.28)  ∥ (#t2.2 < #vr.68) )
                                          case case_1
                                          solve( TPM_SendCommand( <'TPM2_Certify', obj_sh.1, obj_h, a_h>
                                                 ) @ #t2.8 )
                                            case eventTPMSendCommandTPMCertifytlsshtlshakh_0_111111111111121111111111111
                                            by solve( state_111111111111121111111111111( ~RouterID.1,
                                                                                         ~ServerID.1, ~ak_h.1,
                                                                                         ~ak_sk.1, ~ssk_nms.1,
                                                                                         ~tid.1, obj_h,
                                                                                         obj_sh.1, tls_spk
                                                      ) ▶₀ #t2.6 )
                                          qed
                                        next
                                          case case_2
                                          solve( TPM_SendCommand( <'TPM2_Certify', obj_sh.1, obj_h, a_h>
                                                 ) @ #t2.8 )
                                            case eventTPMSendCommandTPMCertifytlsshtlshakh_0_111111111111121111111111111
                                            by solve( state_111111111111121111111111111( ~RouterID.1,
                                                                                         ~ServerID.1, ~ak_h.1,
                                                                                         ~ak_sk.1, ~ssk_nms.1,
                                                                                         ~tid.1, obj_h,
                                                                                         obj_sh.1, tls_spk
                                                      ) ▶₀ #t2.6 )
                                          qed
                                        qed
                                      qed
                                    next
                                      case outtlsspkskaecsr_0_11111111111112111111111111111111111111
                                      solve( TPM_SendCommand( <'TPM2_Sign', k_sh, k_h.1, pk(x), 
                                                               sign(<pk(x), <swstate, nil>, 
                                                                     'TPM_CC_PolicyPCR', nil>,
                                                                    ~ak_sk)
                                                              >
                                             ) @ #t2.9 )
                                        case eventTPMSendCommandTPMSigntlsshtlshtlsspkskae_0_111111111111121111111111111111111
                                        solve( state_111111111111121111111111111111111( ~RouterID.1,
                                                                                        ~ServerID.1, ~ak_h.1,
                                                                                        ~ak_sk.1, ~ssk_nms.1,
                                                                                        ~tid.1,
                                                                                        sign(<pk(x), 
                                                                                              <swstate, nil>, 
                                                                                              'TPM_CC_PolicyPCR', 
                                                                                              nil>,
                                                                                             ~ak_sk),
                                                                                        k_h.1, k_sh, pk(x)
                                               ) ▶₀ #t2.6 )
                                          case ifverifyskaetlsspkswstatenilTPMCCPolicyPCRnilpkaksktrue_0_11111111111112111111111111111111
                                          by contradiction /* from formulas */
                                        qed
                                      qed
                                    qed
                                  qed
                                qed
                              qed
                            qed
                          qed
                        qed
                      next
                        case case_2
                        solve( (#vr.26 < #t2.6)  ∥ (#vr.26 = #t2.6) )
                          case case_1
                          solve( (#vr.43 < #t2.5)  ∥ (#vr.43 = #t2.5) )
                            case case_1
                            solve( TPM_SendCommand( <'TPM2_Create', <swstate, nil>, 
                                                     'TPM_CC_PolicyPCR', nil>
                                   ) @ #t2.8 )
                              case eventTPMSendCommandTPMCreateswstatenilTPMCCPolicyPCRnil_0_11111111111112111
                              solve( state_11111111111112111( ~RouterID.1, ~ServerID.1, ~ak_h.1,
                                                              ~ak_sk.1, ~ssk_nms.1, ~tid.1
                                     ) ▶₀ #t2.5 )
                                case outTPMPCRExtendswstate_0_1111111111111211
                                solve( TPM_SendCommand( <'TPM2_Create', <swstate, nil>, 
                                                         'TPM_CC_PolicyPCR', nil>
                                       ) @ #t2.8 )
                                  case eventTPMSendCommandTPMCreateswstatenilTPMCCPolicyPCRnil_0_11111111111112111
                                  solve( state_11111111111112111( ~RouterID.1, ~ServerID.1, ~ak_h.1,
                                                                  ~ak_sk.1, ~ssk_nms.1, ~tid.1
                                         ) ▶₀ #t2.5 )
                                    case outTPMPCRExtendswstate_0_1111111111111211
                                    solve( !KU( sign(<pk(x), 
                                                      sign(<pk(x), <swstate, nil>, 'TPM_CC_PolicyPCR', nil>,
                                                           ~ak_sk)
                                                     >,
                                                     x)
                                           ) @ #vk.4 )
                                      case c_sign
                                      solve( Insert( <'privatePart', ~ak_h>, ~ak_sk ) @ #t2.5 )
                                        case insertprivatePartakhaksk_0_111111111111111
                                        solve( state_111111111111111( ~RouterID.1, ~ServerID.1, ~ak_h, ~ak_sk,
                                                                      ~ssk_nms.1
                                               ) ▶₀ #t2.5 )
                                          case insertauthPolicyakhnil_0_11111111111111
                                          by contradiction /* cyclic */
                                        qed
                                      next
                                        case insertprivatePartkhksk_0_111111111111111111111121111111
                                        by solve( state_111111111111111111111121111111( ~RouterID.1,
                                                                                        ~ServerID.1, ~ak_h.1,
                                                                                        ~ak_sk.1, ~ak_h,
                                                                                        ~ak_sk, ~ssk_nms.1,
                                                                                        authPolicy, lock
                                                  ) ▶₀ #t2.5 )
                                      qed
                                    next
                                      case outsignobjpkobjapask_0_11111111111111111111211111111
                                      solve( ((#vr.51 < #vr.69) ∧
                                              (∃ #t2.
                                                (Unlock_4( '4', ~n.1, 'device' ) @ #t2)
                                               ∧
                                                (#vr.51 < #t2) ∧
                                                (#t2 < #vr.69) ∧
                                                (∀ #t0 pp. (Unlock( pp, ~n.1, 'device' ) @ #t0) ⇒ #t0 = #t2) ∧
                                                (∀ pp lpp #t0.
                                                  (Lock( pp, lpp, 'device' ) @ #t0)
                                                 ⇒
                                                  ((#t0 < #vr.51) ∨ (#t0 = #vr.51) ∨ (#t2 < #t0))) ∧
                                                (∀ pp lpp #t0.
                                                  (Unlock( pp, lpp, 'device' ) @ #t0)
                                                 ⇒
                                                  ((#t0 < #vr.51) ∨ (#t2 < #t0) ∨ (#t2 = #t0)))))  ∥
                                             (#vr.69 < #vr.51)  ∥ (#vr.51 = #vr.69) )
                                        case case_1
                                        solve( TPM_SendCommand( <'TPM2_Certify', obj_sh.1, obj_h, a_h>
                                               ) @ #t2.8 )
                                          case eventTPMSendCommandTPMCertifytlsshtlshakh_0_111111111111121111111111111
                                          by solve( state_111111111111121111111111111( ~RouterID.1,
                                                                                       ~ServerID.1, ~ak_h.1,
                                                                                       ~ak_sk.1, ~ssk_nms.1,
                                                                                       ~tid.1, obj_h,
                                                                                       obj_sh.1, tls_spk
                                                    ) ▶₀ #t2.5 )
                                        qed
                                      next
                                        case case_2
                                        solve( (#vr.69 < #vr.28)  ∥ (#t2.2 < #vr.69) )
                                          case case_1
                                          solve( TPM_SendCommand( <'TPM2_Certify', obj_sh.1, obj_h, a_h>
                                                 ) @ #t2.8 )
                                            case eventTPMSendCommandTPMCertifytlsshtlshakh_0_111111111111121111111111111
                                            by solve( state_111111111111121111111111111( ~RouterID.1,
                                                                                         ~ServerID.1, ~ak_h.1,
                                                                                         ~ak_sk.1, ~ssk_nms.1,
                                                                                         ~tid.1, obj_h,
                                                                                         obj_sh.1, tls_spk
                                                      ) ▶₀ #t2.5 )
                                          qed
                                        next
                                          case case_2
                                          solve( TPM_SendCommand( <'TPM2_Certify', obj_sh.1, obj_h, a_h>
                                                 ) @ #t2.8 )
                                            case eventTPMSendCommandTPMCertifytlsshtlshakh_0_111111111111121111111111111
                                            by solve( state_111111111111121111111111111( ~RouterID.1,
                                                                                         ~ServerID.1, ~ak_h.1,
                                                                                         ~ak_sk.1, ~ssk_nms.1,
                                                                                         ~tid.1, obj_h,
                                                                                         obj_sh.1, tls_spk
                                                      ) ▶₀ #t2.5 )
                                          qed
                                        qed
                                      qed
                                    next
                                      case outtlsspkskaecsr_0_11111111111112111111111111111111111111
                                      solve( TPM_SendCommand( <'TPM2_Sign', k_sh, k_h.1, pk(x), 
                                                               sign(<pk(x), <swstate, nil>, 
                                                                     'TPM_CC_PolicyPCR', nil>,
                                                                    ~ak_sk)
                                                              >
                                             ) @ #t2.9 )
                                        case eventTPMSendCommandTPMSigntlsshtlshtlsspkskae_0_111111111111121111111111111111111
                                        solve( state_111111111111121111111111111111111( ~RouterID.1,
                                                                                        ~ServerID.1, ~ak_h.1,
                                                                                        ~ak_sk.1, ~ssk_nms.1,
                                                                                        ~tid.1,
                                                                                        sign(<pk(x), 
                                                                                              <swstate, nil>, 
                                                                                              'TPM_CC_PolicyPCR', 
                                                                                              nil>,
                                                                                             ~ak_sk),
                                                                                        k_h.1, k_sh, pk(x)
                                               ) ▶₀ #t2.5 )
                                          case ifverifyskaetlsspkswstatenilTPMCCPolicyPCRnilpkaksktrue_0_11111111111112111111111111111111
                                          by contradiction /* from formulas */
                                        qed
                                      qed
                                    qed
                                  qed
                                qed
                              qed
                            qed
                          next
                            case case_2
                            solve( TPM_SendCommand( <'TPM2_Create', <swstate, nil>, 
                                                     'TPM_CC_PolicyPCR', nil>
                                   ) @ #t2.8 )
                              case eventTPMSendCommandTPMCreateswstatenilTPMCCPolicyPCRnil_0_11111111111112111
                              solve( state_11111111111112111( ~RouterID.1, ~ServerID.1, ~ak_h.1,
                                                              ~ak_sk.1, ~ssk_nms.1, ~tid.1
                                     ) ▶₀ #t2.6 )
                                case outTPMPCRExtendswstate_0_1111111111111211
                                solve( TPM_SendCommand( <'TPM2_Create', <swstate, nil>, 
                                                         'TPM_CC_PolicyPCR', nil>
                                       ) @ #t2.8 )
                                  case eventTPMSendCommandTPMCreateswstatenilTPMCCPolicyPCRnil_0_11111111111112111
                                  solve( state_11111111111112111( ~RouterID.1, ~ServerID.1, ~ak_h.1,
                                                                  ~ak_sk.1, ~ssk_nms.1, ~tid.1
                                         ) ▶₀ #t2.6 )
                                    case outTPMPCRExtendswstate_0_1111111111111211
                                    solve( !KU( sign(<pk(x), 
                                                      sign(<pk(x), <swstate, nil>, 'TPM_CC_PolicyPCR', nil>,
                                                           ~ak_sk)
                                                     >,
                                                     x)
                                           ) @ #vk.4 )
                                      case c_sign
                                      solve( Insert( <'privatePart', ~ak_h>, ~ak_sk ) @ #t2.5 )
                                        case insertprivatePartakhaksk_0_111111111111111
                                        solve( Insert( <'publicPart', ~k_h>, pk(x) ) @ #t2.4 )
                                          case insertpublicPartkhpkksk_0_1111111111111111111111211111111
                                          by contradiction /* from formulas */
                                        qed
                                      qed
                                    next
                                      case outsignobjpkobjapask_0_11111111111111111111211111111
                                      solve( ((#vr.50 < #vr.68) ∧
                                              (∃ #t2.
                                                (Unlock_4( '4', ~n.1, 'device' ) @ #t2)
                                               ∧
                                                (#vr.50 < #t2) ∧
                                                (#t2 < #vr.68) ∧
                                                (∀ #t0 pp. (Unlock( pp, ~n.1, 'device' ) @ #t0) ⇒ #t0 = #t2) ∧
                                                (∀ pp lpp #t0.
                                                  (Lock( pp, lpp, 'device' ) @ #t0)
                                                 ⇒
                                                  ((#t0 < #vr.50) ∨ (#t0 = #vr.50) ∨ (#t2 < #t0))) ∧
                                                (∀ pp lpp #t0.
                                                  (Unlock( pp, lpp, 'device' ) @ #t0)
                                                 ⇒
                                                  ((#t0 < #vr.50) ∨ (#t2 < #t0) ∨ (#t2 = #t0)))))  ∥
                                             (#vr.68 < #vr.50)  ∥ (#vr.50 = #vr.68) )
                                        case case_1
                                        solve( TPM_SendCommand( <'TPM2_Certify', obj_sh.1, obj_h, a_h>
                                               ) @ #t2.8 )
                                          case eventTPMSendCommandTPMCertifytlsshtlshakh_0_111111111111121111111111111
                                          by solve( state_111111111111121111111111111( ~RouterID.1,
                                                                                       ~ServerID.1, ~ak_h.1,
                                                                                       ~ak_sk.1, ~ssk_nms.1,
                                                                                       ~tid.1, obj_h,
                                                                                       obj_sh.1, tls_spk
                                                    ) ▶₀ #t2.6 )
                                        qed
                                      next
                                        case case_2
                                        solve( (#vr.68 < #vr.28)  ∥ (#t2.2 < #vr.68) )
                                          case case_1
                                          solve( TPM_SendCommand( <'TPM2_Certify', obj_sh.1, obj_h, a_h>
                                                 ) @ #t2.8 )
                                            case eventTPMSendCommandTPMCertifytlsshtlshakh_0_111111111111121111111111111
                                            by solve( state_111111111111121111111111111( ~RouterID.1,
                                                                                         ~ServerID.1, ~ak_h.1,
                                                                                         ~ak_sk.1, ~ssk_nms.1,
                                                                                         ~tid.1, obj_h,
                                                                                         obj_sh.1, tls_spk
                                                      ) ▶₀ #t2.6 )
                                          qed
                                        next
                                          case case_2
                                          solve( TPM_SendCommand( <'TPM2_Certify', obj_sh.1, obj_h, a_h>
                                                 ) @ #t2.8 )
                                            case eventTPMSendCommandTPMCertifytlsshtlshakh_0_111111111111121111111111111
                                            by solve( state_111111111111121111111111111( ~RouterID.1,
                                                                                         ~ServerID.1, ~ak_h.1,
                                                                                         ~ak_sk.1, ~ssk_nms.1,
                                                                                         ~tid.1, obj_h,
                                                                                         obj_sh.1, tls_spk
                                                      ) ▶₀ #t2.6 )
                                          qed
                                        qed
                                      qed
                                    next
                                      case outtlsspkskaecsr_0_11111111111112111111111111111111111111
                                      solve( TPM_SendCommand( <'TPM2_Sign', k_sh, k_h.1, pk(x), 
                                                               sign(<pk(x), <swstate, nil>, 
                                                                     'TPM_CC_PolicyPCR', nil>,
                                                                    ~ak_sk)
                                                              >
                                             ) @ #t2.9 )
                                        case eventTPMSendCommandTPMSigntlsshtlshtlsspkskae_0_111111111111121111111111111111111
                                        solve( state_111111111111121111111111111111111( ~RouterID.1,
                                                                                        ~ServerID.1, ~ak_h.1,
                                                                                        ~ak_sk.1, ~ssk_nms.1,
                                                                                        ~tid.1,
                                                                                        sign(<pk(x), 
                                                                                              <swstate, nil>, 
                                                                                              'TPM_CC_PolicyPCR', 
                                                                                              nil>,
                                                                                             ~ak_sk),
                                                                                        k_h.1, k_sh, pk(x)
                                               ) ▶₀ #t2.6 )
                                          case ifverifyskaetlsspkswstatenilTPMCCPolicyPCRnilpkaksktrue_0_11111111111112111111111111111111
                                          by contradiction /* from formulas */
                                        qed
                                      qed
                                    qed
                                  qed
                                qed
                              qed
                            qed
                          qed
                        next
                          case case_2
                          solve( (#vr.42 < #t2.6)  ∥ (#vr.42 = #t2.6) )
                            case case_1
                            solve( TPM_SendCommand( <'TPM2_Create', <swstate, nil>, 
                                                     'TPM_CC_PolicyPCR', nil>
                                   ) @ #t2.8 )
                              case eventTPMSendCommandTPMCreateswstatenilTPMCCPolicyPCRnil_0_11111111111112111
                              solve( state_11111111111112111( ~RouterID.1, ~ServerID.1, ~ak_h.1,
                                                              ~ak_sk.1, ~ssk_nms.1, ~tid.1
                                     ) ▶₀ #t2.6 )
                                case outTPMPCRExtendswstate_0_1111111111111211
                                solve( TPM_SendCommand( <'TPM2_Create', <swstate, nil>, 
                                                         'TPM_CC_PolicyPCR', nil>
                                       ) @ #t2.8 )
                                  case eventTPMSendCommandTPMCreateswstatenilTPMCCPolicyPCRnil_0_11111111111112111
                                  solve( state_11111111111112111( ~RouterID.1, ~ServerID.1, ~ak_h.1,
                                                                  ~ak_sk.1, ~ssk_nms.1, ~tid.1
                                         ) ▶₀ #t2.6 )
                                    case outTPMPCRExtendswstate_0_1111111111111211
                                    solve( !KU( sign(<pk(x), 
                                                      sign(<pk(x), <swstate, nil>, 'TPM_CC_PolicyPCR', nil>,
                                                           ~ak_sk)
                                                     >,
                                                     x)
                                           ) @ #vk.4 )
                                      case c_sign
                                      solve( Insert( <'privatePart', ~ak_h>, ~ak_sk ) @ #t2.6 )
                                        case insertprivatePartakhaksk_0_111111111111111
                                        solve( state_111111111111111( ~RouterID.1, ~ServerID.1, ~ak_h, ~ak_sk,
                                                                      ~ssk_nms.1
                                               ) ▶₀ #t2.6 )
                                          case insertauthPolicyakhnil_0_11111111111111
                                          by contradiction /* cyclic */
                                        qed
                                      next
                                        case insertprivatePartkhksk_0_111111111111111111111121111111
                                        by solve( state_111111111111111111111121111111( ~RouterID.1,
                                                                                        ~ServerID.1, ~ak_h.1,
                                                                                        ~ak_sk.1, ~ak_h,
                                                                                        ~ak_sk, ~ssk_nms.1,
                                                                                        authPolicy, lock
                                                  ) ▶₀ #t2.6 )
                                      qed
                                    next
                                      case outsignobjpkobjapask_0_11111111111111111111211111111
                                      solve( ((#vr.50 < #vr.68) ∧
                                              (∃ #t2.
                                                (Unlock_4( '4', ~n.1, 'device' ) @ #t2)
                                               ∧
                                                (#vr.50 < #t2) ∧
                                                (#t2 < #vr.68) ∧
                                                (∀ #t0 pp. (Unlock( pp, ~n.1, 'device' ) @ #t0) ⇒ #t0 = #t2) ∧
                                                (∀ pp lpp #t0.
                                                  (Lock( pp, lpp, 'device' ) @ #t0)
                                                 ⇒
                                                  ((#t0 < #vr.50) ∨ (#t0 = #vr.50) ∨ (#t2 < #t0))) ∧
                                                (∀ pp lpp #t0.
                                                  (Unlock( pp, lpp, 'device' ) @ #t0)
                                                 ⇒
                                                  ((#t0 < #vr.50) ∨ (#t2 < #t0) ∨ (#t2 = #t0)))))  ∥
                                             (#vr.68 < #vr.50)  ∥ (#vr.50 = #vr.68) )
                                        case case_1
                                        solve( TPM_SendCommand( <'TPM2_Certify', obj_sh.1, obj_h, a_h>
                                               ) @ #t2.8 )
                                          case eventTPMSendCommandTPMCertifytlsshtlshakh_0_111111111111121111111111111
                                          by solve( state_111111111111121111111111111( ~RouterID.1,
                                                                                       ~ServerID.1, ~ak_h.1,
                                                                                       ~ak_sk.1, ~ssk_nms.1,
                                                                                       ~tid.1, obj_h,
                                                                                       obj_sh.1, tls_spk
                                                    ) ▶₀ #t2.6 )
                                        qed
                                      next
                                        case case_2
                                        solve( (#vr.68 < #vr.27)  ∥ (#t2.2 < #vr.68) )
                                          case case_1
                                          solve( TPM_SendCommand( <'TPM2_Certify', obj_sh.1, obj_h, a_h>
                                                 ) @ #t2.8 )
                                            case eventTPMSendCommandTPMCertifytlsshtlshakh_0_111111111111121111111111111
                                            by solve( state_111111111111121111111111111( ~RouterID.1,
                                                                                         ~ServerID.1, ~ak_h.1,
                                                                                         ~ak_sk.1, ~ssk_nms.1,
                                                                                         ~tid.1, obj_h,
                                                                                         obj_sh.1, tls_spk
                                                      ) ▶₀ #t2.6 )
                                          qed
                                        next
                                          case case_2
                                          solve( TPM_SendCommand( <'TPM2_Certify', obj_sh.1, obj_h, a_h>
                                                 ) @ #t2.8 )
                                            case eventTPMSendCommandTPMCertifytlsshtlshakh_0_111111111111121111111111111
                                            by solve( state_111111111111121111111111111( ~RouterID.1,
                                                                                         ~ServerID.1, ~ak_h.1,
                                                                                         ~ak_sk.1, ~ssk_nms.1,
                                                                                         ~tid.1, obj_h,
                                                                                         obj_sh.1, tls_spk
                                                      ) ▶₀ #t2.6 )
                                          qed
                                        qed
                                      qed
                                    next
                                      case outtlsspkskaecsr_0_11111111111112111111111111111111111111
                                      solve( TPM_SendCommand( <'TPM2_Sign', k_sh, k_h.1, pk(x), 
                                                               sign(<pk(x), <swstate, nil>, 
                                                                     'TPM_CC_PolicyPCR', nil>,
                                                                    ~ak_sk)
                                                              >
                                             ) @ #t2.9 )
                                        case eventTPMSendCommandTPMSigntlsshtlshtlsspkskae_0_111111111111121111111111111111111
                                        solve( state_111111111111121111111111111111111( ~RouterID.1,
                                                                                        ~ServerID.1, ~ak_h.1,
                                                                                        ~ak_sk.1, ~ssk_nms.1,
                                                                                        ~tid.1,
                                                                                        sign(<pk(x), 
                                                                                              <swstate, nil>, 
                                                                                              'TPM_CC_PolicyPCR', 
                                                                                              nil>,
                                                                                             ~ak_sk),
                                                                                        k_h.1, k_sh, pk(x)
                                               ) ▶₀ #t2.6 )
                                          case ifverifyskaetlsspkswstatenilTPMCCPolicyPCRnilpkaksktrue_0_11111111111112111111111111111111
                                          by contradiction /* from formulas */
                                        qed
                                      qed
                                    qed
                                  qed
                                qed
                              qed
                            qed
                          next
                            case case_2
                            solve( TPM_SendCommand( <'TPM2_Create', <swstate, nil>, 
                                                     'TPM_CC_PolicyPCR', nil>
                                   ) @ #t2.8 )
                              case eventTPMSendCommandTPMCreateswstatenilTPMCCPolicyPCRnil_0_11111111111112111
                              solve( state_11111111111112111( ~RouterID.1, ~ServerID.1, ~ak_h.1,
                                                              ~ak_sk.1, ~ssk_nms.1, ~tid.1
                                     ) ▶₀ #t2.7 )
                                case outTPMPCRExtendswstate_0_1111111111111211
                                solve( TPM_SendCommand( <'TPM2_Create', <swstate, nil>, 
                                                         'TPM_CC_PolicyPCR', nil>
                                       ) @ #t2.8 )
                                  case eventTPMSendCommandTPMCreateswstatenilTPMCCPolicyPCRnil_0_11111111111112111
                                  solve( state_11111111111112111( ~RouterID.1, ~ServerID.1, ~ak_h.1,
                                                                  ~ak_sk.1, ~ssk_nms.1, ~tid.1
                                         ) ▶₀ #t2.7 )
                                    case outTPMPCRExtendswstate_0_1111111111111211
                                    solve( !KU( sign(<pk(x), 
                                                      sign(<pk(x), <swstate, nil>, 'TPM_CC_PolicyPCR', nil>,
                                                           ~ak_sk)
                                                     >,
                                                     x)
                                           ) @ #vk.4 )
                                      case c_sign
                                      solve( Insert( <'privatePart', ~ak_h>, ~ak_sk ) @ #t2.6 )
                                        case insertprivatePartakhaksk_0_111111111111111
                                        solve( Insert( <'publicPart', ~k_h>, pk(x) ) @ #t2.4 )
                                          case insertpublicPartkhpkksk_0_1111111111111111111111211111111
                                          by contradiction /* from formulas */
                                        qed
                                      qed
                                    next
                                      case outsignobjpkobjapask_0_11111111111111111111211111111
                                      solve( ((#vr.49 < #vr.67) ∧
                                              (∃ #t2.
                                                (Unlock_4( '4', ~n.1, 'device' ) @ #t2)
                                               ∧
                                                (#vr.49 < #t2) ∧
                                                (#t2 < #vr.67) ∧
                                                (∀ #t0 pp. (Unlock( pp, ~n.1, 'device' ) @ #t0) ⇒ #t0 = #t2) ∧
                                                (∀ pp lpp #t0.
                                                  (Lock( pp, lpp, 'device' ) @ #t0)
                                                 ⇒
                                                  ((#t0 < #vr.49) ∨ (#t0 = #vr.49) ∨ (#t2 < #t0))) ∧
                                                (∀ pp lpp #t0.
                                                  (Unlock( pp, lpp, 'device' ) @ #t0)
                                                 ⇒
                                                  ((#t0 < #vr.49) ∨ (#t2 < #t0) ∨ (#t2 = #t0)))))  ∥
                                             (#vr.67 < #vr.49)  ∥ (#vr.49 = #vr.67) )
                                        case case_1
                                        solve( TPM_SendCommand( <'TPM2_Certify', obj_sh.1, obj_h, a_h>
                                               ) @ #t2.8 )
                                          case eventTPMSendCommandTPMCertifytlsshtlshakh_0_111111111111121111111111111
                                          by solve( state_111111111111121111111111111( ~RouterID.1,
                                                                                       ~ServerID.1, ~ak_h.1,
                                                                                       ~ak_sk.1, ~ssk_nms.1,
                                                                                       ~tid.1, obj_h,
                                                                                       obj_sh.1, tls_spk
                                                    ) ▶₀ #t2.7 )
                                        qed
                                      next
                                        case case_2
                                        solve( (#vr.67 < #vr.27)  ∥ (#t2.2 < #vr.67) )
                                          case case_1
                                          solve( TPM_SendCommand( <'TPM2_Certify', obj_sh.1, obj_h, a_h>
                                                 ) @ #t2.8 )
                                            case eventTPMSendCommandTPMCertifytlsshtlshakh_0_111111111111121111111111111
                                            by solve( state_111111111111121111111111111( ~RouterID.1,
                                                                                         ~ServerID.1, ~ak_h.1,
                                                                                         ~ak_sk.1, ~ssk_nms.1,
                                                                                         ~tid.1, obj_h,
                                                                                         obj_sh.1, tls_spk
                                                      ) ▶₀ #t2.7 )
                                          qed
                                        next
                                          case case_2
                                          solve( TPM_SendCommand( <'TPM2_Certify', obj_sh.1, obj_h, a_h>
                                                 ) @ #t2.8 )
                                            case eventTPMSendCommandTPMCertifytlsshtlshakh_0_111111111111121111111111111
                                            by solve( state_111111111111121111111111111( ~RouterID.1,
                                                                                         ~ServerID.1, ~ak_h.1,
                                                                                         ~ak_sk.1, ~ssk_nms.1,
                                                                                         ~tid.1, obj_h,
                                                                                         obj_sh.1, tls_spk
                                                      ) ▶₀ #t2.7 )
                                          qed
                                        qed
                                      qed
                                    next
                                      case outtlsspkskaecsr_0_11111111111112111111111111111111111111
                                      solve( TPM_SendCommand( <'TPM2_Sign', k_sh, k_h.1, pk(x), 
                                                               sign(<pk(x), <swstate, nil>, 
                                                                     'TPM_CC_PolicyPCR', nil>,
                                                                    ~ak_sk)
                                                              >
                                             ) @ #t2.9 )
                                        case eventTPMSendCommandTPMSigntlsshtlshtlsspkskae_0_111111111111121111111111111111111
                                        solve( state_111111111111121111111111111111111( ~RouterID.1,
                                                                                        ~ServerID.1, ~ak_h.1,
                                                                                        ~ak_sk.1, ~ssk_nms.1,
                                                                                        ~tid.1,
                                                                                        sign(<pk(x), 
                                                                                              <swstate, nil>, 
                                                                                              'TPM_CC_PolicyPCR', 
                                                                                              nil>,
                                                                                             ~ak_sk),
                                                                                        k_h.1, k_sh, pk(x)
                                               ) ▶₀ #t2.7 )
                                          case ifverifyskaetlsspkswstatenilTPMCCPolicyPCRnilpkaksktrue_0_11111111111112111111111111111111
                                          by contradiction /* from formulas */
                                        qed
                                      qed
                                    qed
                                  qed
                                qed
                              qed
                            qed
                          qed
                        qed
                      qed
                    qed
                  qed
                qed
              next
                case case_2
                solve( TPM_SendCommand( <'TPM2_Certify', obj_sh, obj_h, a_h> ) @ #t2.2 )
                  case eventTPMSendCommandTPMCertifytlsshtlshakh_0_111111111111121111111111111
                  solve( state_111111111111121111111111111( ~RouterID.1, ~ServerID.1,
                                                            ~ak_h.1, ~ak_sk.1, ~ssk_nms.1, ~tid.1, obj_h,
                                                            obj_sh, tls_spk
                         ) ▶₀ #t2.2 )
                    case outTPMPolicyPCRtlssh_0_11111111111112111111111111
                    by contradiction /* cyclic */
                  qed
                qed
              qed
            next
              case outtlsspkskaecsr_0_11111111111112111111111111111111111111
              solve( ((#vr.29 < #vr.62) ∧
                      (∃ #t2.
                        (Unlock_2( '2', ~n, 'device' ) @ #t2)
                       ∧
                        (#vr.29 < #t2) ∧
                        (#t2 < #vr.62) ∧
                        (∀ #t0 pp. (Unlock( pp, ~n, 'device' ) @ #t0) ⇒ #t0 = #t2) ∧
                        (∀ pp lpp #t0.
                          (Lock( pp, lpp, 'device' ) @ #t0)
                         ⇒
                          ((#t0 < #vr.29) ∨ (#t0 = #vr.29) ∨ (#t2 < #t0))) ∧
                        (∀ pp lpp #t0.
                          (Unlock( pp, lpp, 'device' ) @ #t0)
                         ⇒
                          ((#t0 < #vr.29) ∨ (#t2 < #t0) ∨ (#t2 = #t0)))))  ∥
                     (#vr.62 < #vr.29) )
                case case_1
                solve( state_111111111111111111111121111111111( ~RouterID.1, ~ServerID.1,
                                                                ~ak_h.1, ~ak_sk.1, ~k_h.2, ~k_sk.1,
                                                                ~ssk_nms.1, authPolicy, ~n
                       ) ▶₀ #t2.2 )
                  case TpmCreateOutkhpkksk_0_11111111111111111111112111111111
                  solve( TPM_SendCommand( <'TPM2_Sign', k_sh, k_h.1, pk(x), 
                                           <swstate, nil>, 'TPM_CC_PolicyPCR', nil>
                         ) @ #t2.3 )
                    case eventTPMSendCommandTPMSigntlsshtlshtlsspkskae_0_111111111111121111111111111111111
                    by solve( state_111111111111121111111111111111111( ~RouterID.1,
                                                                       ~ServerID.1, ~ak_h.1, ~ak_sk.1,
                                                                       ~ssk_nms.1, ~tid.1,
                                                                       <<swstate, nil>, 'TPM_CC_PolicyPCR', 
                                                                        nil>,
                                                                       k_h.1, k_sh, pk(x)
                              ) ▶₀ #t2.3 )
                  qed
                qed
              next
                case case_2
                solve( TPM_SendCommand( <'TPM2_Sign', k_sh, k_h.1, pk(x), 
                                         <swstate, nil>, 'TPM_CC_PolicyPCR', nil>
                       ) @ #t2.2 )
                  case eventTPMSendCommandTPMSigntlsshtlshtlsspkskae_0_111111111111121111111111111111111
                  by solve( state_111111111111121111111111111111111( ~RouterID.1,
                                                                     ~ServerID.1, ~ak_h.1, ~ak_sk.1,
                                                                     ~ssk_nms.1, ~tid.1,
                                                                     <<swstate, nil>, 'TPM_CC_PolicyPCR', nil
                                                                     >,
                                                                     k_h.1, k_sh, pk(x)
                            ) ▶₀ #t2.2 )
                qed
              qed
            qed
          qed
        qed
      qed
    next
      case eventHasKeyTLSServerIDtlsspk_0_111111111111211111
      solve( state_111111111111211111( ~RouterID.1, ~ServerID.1, ~ak_h.1,
                                       ~ak_sk.1, ~ssk_nms.1, csr, skae, k2
             ) ▶₀ #t2 )
        case eventReceiveValueCSRServerIDcsr_0_11111111111121111
        by contradiction /* from formulas */
      qed
    qed
  qed
qed

lemma FreshnessTLS:
  all-traces
  "∀ tid1 tid2 k #t1 #t2.
    ((GenerateTLS( tid1, k ) @ #t1) ∧ (GenerateTLS( tid2, k ) @ #t2)) ⇒
    (tid1 = tid2)"
/*
guarded formula characterizing all counter-examples:
"∃ tid1 tid2 k #t1 #t2.
  (GenerateTLS( tid1, k ) @ #t1) ∧ (GenerateTLS( tid2, k ) @ #t2)
 ∧
  ¬(tid1 = tid2)"
*/
simplify
solve( state_111111111111121111111111( ~RouterID, ~ServerID, ~ak_h,
                                       ~ak_sk, ~ssk_nms, ~tid, tls_h, tls_sh, k
       ) ▶₀ #t1 )
  case intlssh_0_11111111111112111111111
  solve( state_111111111111121111111111( ~RouterID.1, ~ServerID.1, ~ak_h.1,
                                         ~ak_sk.1, ~ssk_nms.1, ~tid.1, tls_h, tls_sh.1, pk(~k_sk)
         ) ▶₀ #t2 )
    case intlssh_0_11111111111112111111111
    by contradiction /* from formulas */
  qed
qed

lemma SecretKey:
  all-traces
  "∀ label k #t1. (SecretKey( label, k ) @ #t1) ⇒ (¬(∃ #t2. K( k ) @ #t2))"
/*
guarded formula characterizing all counter-examples:
"∃ label k #t1. (SecretKey( label, k ) @ #t1) ∧ ∃ #t2. (K( k ) @ #t2)"
*/
simplify
solve( SecretKey( label, k ) @ #t1 )
  case eventSecretKeyAKaksk_0_11
  solve( state_11( ~ak_sk ) ▶₀ #t1 )
    case outpkaksk_0_1
    by solve( !KU( ~ak_sk ) @ #vk )
  qed
next
  case eventSecretKeyNMSssknms_0_11111111111
  solve( state_11111111111( ~RouterID, ~ServerID, ~ak_h, ~ak_sk, ~ssk_nms
         ) ▶₀ #t1 )
    case outpkssknms_0_1111111111
    by solve( !KU( ~ssk_nms ) @ #vk )
  qed
next
  case eventSecretKeyTLSksk_0_111111111111111111111121111
  solve( state_111111111111111111111121111( ~RouterID, ~ServerID, ~ak_h,
                                            ~ak_sk, ~k_h, ~k_sk, ~ssk_nms, authPolicy
         ) ▶₀ #t1 )
    case newksk_0_11111111111111111111112111
    solve( TPM_SendCommand( <'TPM2_Create', authPolicy> ) @ #t2.1 )
      case eventTPMSendCommandTPMCreateswstatenilTPMCCPolicyPCRnil_0_11111111111112111
      solve( state_11111111111112111( ~RouterID.1, ~ServerID.1, ~ak_h.1,
                                      ~ak_sk.1, ~ssk_nms.1, ~tid
             ) ▶₀ #t2.1 )
        case outTPMPCRExtendswstate_0_1111111111111211
        by solve( !KU( ~k_sk ) @ #vk )
      qed
    qed
  qed
qed

lemma CorrectTransfer:
  all-traces
  "∀ label id1 m #t1.
    (ReceiveValue( label, id1, m ) @ #t1) ⇒
    (∃ id2 #t2. (GenerateValue( label, id2, m ) @ #t2) ∧ (#t2 < #t1))"
/*
guarded formula characterizing all counter-examples:
"∃ label id1 m #t1.
  (ReceiveValue( label, id1, m ) @ #t1)
 ∧
  ∀ id2 #t2. (GenerateValue( label, id2, m ) @ #t2) ⇒ ¬(#t2 < #t1)"
*/
simplify
solve( state_11111111111121111( ~RouterID, ~ServerID, ~ak_h, ~ak_sk,
                                ~ssk_nms, m, skae, tls_spk
       ) ▶₀ #t1 )
  case ifverifycsrtlsspkskaetlsspktrue_0_1111111111112111
  solve( !KU( sign(<pk(x), <swstate, nil>, 'TPM_CC_PolicyPCR', nil>,
                   ~ak_sk)
         ) @ #vk.3 )
    case c_sign
    solve( !KU( sign(<pk(x), 
                      sign(<pk(x), <swstate, nil>, 'TPM_CC_PolicyPCR', nil>, ~ak_sk)>,
                     x)
           ) @ #vk.5 )
      case c_sign
      by solve( !KU( ~ak_sk ) @ #vk.6 )
    next
      case outsignobjpkobjapask_0_11111111111111111111211111111
      solve( TPM_SendCommand( <'TPM2_Certify', obj_sh, obj_h, a_h> ) @ #t2 )
        case eventTPMSendCommandTPMCertifytlsshtlshakh_0_111111111111121111111111111
        solve( state_111111111111121111111111111( ~RouterID.1, ~ServerID.1,
                                                  ~ak_h.1, ~ak_sk.1, ~ssk_nms.1, ~tid, obj_h, obj_sh, tls_spk
               ) ▶₀ #t2 )
          case outTPMPolicyPCRtlssh_0_11111111111112111111111111
          solve( (#vr.48 < #t2.3)  ∥ (#vr.48 = #t2.3) )
            case case_1
            solve( (#vr.52 < #t2.4)  ∥ (#vr.52 = #t2.4) )
              case case_1
              solve( (#vr.34 < #t2.2)  ∥ (#vr.34 = #t2.2) )
                case case_1
                solve( state_111111111111111111111121111111111( ~RouterID.1, ~ServerID.1,
                                                                ~ak_h.1, ~ak_sk.1, ~k_h.1, ~k_sk.1,
                                                                ~ssk_nms.1, authPolicy, ~n
                       ) ▶₀ #t2.1 )
                  case TpmCreateOutkhpkksk_0_11111111111111111111112111111111
                  solve( TPM_SendCommand( <'TPM2_Create', authPolicy> ) @ #t2.6 )
                    case eventTPMSendCommandTPMCreateswstatenilTPMCCPolicyPCRnil_0_11111111111112111
                    solve( state_11111111111112111( ~RouterID.1, ~ServerID.1, ~ak_h.1,
                                                    ~ak_sk.1, ~ssk_nms.1, ~tid.1
                           ) ▶₀ #t2.2 )
                      case outTPMPCRExtendswstate_0_1111111111111211
                      solve( TPM_SendCommand( <'TPM2_Create', <swstate, nil>, 
                                               'TPM_CC_PolicyPCR', nil>
                             ) @ #t2.7 )
                        case eventTPMSendCommandTPMCreateswstatenilTPMCCPolicyPCRnil_0_11111111111112111
                        solve( state_11111111111112111( ~RouterID.1, ~ServerID.1, ~ak_h.1,
                                                        ~ak_sk.1, ~ssk_nms.1, ~tid.1
                               ) ▶₀ #t2.3 )
                          case outTPMPCRExtendswstate_0_1111111111111211
                          by solve( !KU( ~ak_sk ) @ #vk.6 )
                        qed
                      qed
                    qed
                  qed
                qed
              next
                case case_2
                solve( state_111111111111111111111121111111111( ~RouterID.1, ~ServerID.1,
                                                                ~ak_h.1, ~ak_sk.1, ~k_h.1, ~k_sk.1,
                                                                ~ssk_nms.1, authPolicy, ~n
                       ) ▶₀ #t2.1 )
                  case TpmCreateOutkhpkksk_0_11111111111111111111112111111111
                  solve( TPM_SendCommand( <'TPM2_Create', authPolicy> ) @ #t2.6 )
                    case eventTPMSendCommandTPMCreateswstatenilTPMCCPolicyPCRnil_0_11111111111112111
                    solve( state_11111111111112111( ~RouterID.1, ~ServerID.1, ~ak_h.1,
                                                    ~ak_sk.1, ~ssk_nms.1, ~tid.1
                           ) ▶₀ #t2.3 )
                      case outTPMPCRExtendswstate_0_1111111111111211
                      solve( TPM_SendCommand( <'TPM2_Create', <swstate, nil>, 
                                               'TPM_CC_PolicyPCR', nil>
                             ) @ #t2.7 )
                        case eventTPMSendCommandTPMCreateswstatenilTPMCCPolicyPCRnil_0_11111111111112111
                        solve( state_11111111111112111( ~RouterID.1, ~ServerID.1, ~ak_h.1,
                                                        ~ak_sk.1, ~ssk_nms.1, ~tid.1
                               ) ▶₀ #t2.4 )
                          case outTPMPCRExtendswstate_0_1111111111111211
                          by solve( !KU( ~ak_sk ) @ #vk.6 )
                        qed
                      qed
                    qed
                  qed
                qed
              qed
            next
              case case_2
              solve( (#vr.34 < #t2.3)  ∥ (#vr.34 = #t2.3) )
                case case_1
                solve( state_111111111111111111111121111111111( ~RouterID.1, ~ServerID.1,
                                                                ~ak_h.1, ~ak_sk.1, ~k_h.1, ~k_sk.1,
                                                                ~ssk_nms.1, authPolicy, ~n
                       ) ▶₀ #t2.1 )
                  case TpmCreateOutkhpkksk_0_11111111111111111111112111111111
                  solve( TPM_SendCommand( <'TPM2_Create', authPolicy> ) @ #t2.6 )
                    case eventTPMSendCommandTPMCreateswstatenilTPMCCPolicyPCRnil_0_11111111111112111
                    solve( state_11111111111112111( ~RouterID.1, ~ServerID.1, ~ak_h.1,
                                                    ~ak_sk.1, ~ssk_nms.1, ~tid.1
                           ) ▶₀ #t2.3 )
                      case outTPMPCRExtendswstate_0_1111111111111211
                      solve( TPM_SendCommand( <'TPM2_Create', <swstate, nil>, 
                                               'TPM_CC_PolicyPCR', nil>
                             ) @ #t2.7 )
                        case eventTPMSendCommandTPMCreateswstatenilTPMCCPolicyPCRnil_0_11111111111112111
                        solve( state_11111111111112111( ~RouterID.1, ~ServerID.1, ~ak_h.1,
                                                        ~ak_sk.1, ~ssk_nms.1, ~tid.1
                               ) ▶₀ #t2.4 )
                          case outTPMPCRExtendswstate_0_1111111111111211
                          by solve( !KU( ~ak_sk ) @ #vk.6 )
                        qed
                      qed
                    qed
                  qed
                qed
              next
                case case_2
                solve( state_111111111111111111111121111111111( ~RouterID.1, ~ServerID.1,
                                                                ~ak_h.1, ~ak_sk.1, ~k_h.1, ~k_sk.1,
                                                                ~ssk_nms.1, authPolicy, ~n
                       ) ▶₀ #t2.1 )
                  case TpmCreateOutkhpkksk_0_11111111111111111111112111111111
                  solve( TPM_SendCommand( <'TPM2_Create', authPolicy> ) @ #t2.6 )
                    case eventTPMSendCommandTPMCreateswstatenilTPMCCPolicyPCRnil_0_11111111111112111
                    solve( state_11111111111112111( ~RouterID.1, ~ServerID.1, ~ak_h.1,
                                                    ~ak_sk.1, ~ssk_nms.1, ~tid.1
                           ) ▶₀ #t2.4 )
                      case outTPMPCRExtendswstate_0_1111111111111211
                      solve( TPM_SendCommand( <'TPM2_Create', <swstate, nil>, 
                                               'TPM_CC_PolicyPCR', nil>
                             ) @ #t2.7 )
                        case eventTPMSendCommandTPMCreateswstatenilTPMCCPolicyPCRnil_0_11111111111112111
                        solve( state_11111111111112111( ~RouterID.1, ~ServerID.1, ~ak_h.1,
                                                        ~ak_sk.1, ~ssk_nms.1, ~tid.1
                               ) ▶₀ #t2.5 )
                          case outTPMPCRExtendswstate_0_1111111111111211
                          by solve( !KU( ~ak_sk ) @ #vk.6 )
                        qed
                      qed
                    qed
                  qed
                qed
              qed
            qed
          next
            case case_2
            solve( (#vr.51 < #t2.4)  ∥ (#vr.51 = #t2.4) )
              case case_1
              solve( (#vr.34 < #t2.3)  ∥ (#vr.34 = #t2.3) )
                case case_1
                solve( state_111111111111111111111121111111111( ~RouterID.1, ~ServerID.1,
                                                                ~ak_h.1, ~ak_sk.1, ~k_h.1, ~k_sk.1,
                                                                ~ssk_nms.1, authPolicy, ~n
                       ) ▶₀ #t2.1 )
                  case TpmCreateOutkhpkksk_0_11111111111111111111112111111111
                  solve( TPM_SendCommand( <'TPM2_Create', authPolicy> ) @ #t2.6 )
                    case eventTPMSendCommandTPMCreateswstatenilTPMCCPolicyPCRnil_0_11111111111112111
                    solve( state_11111111111112111( ~RouterID.1, ~ServerID.1, ~ak_h.1,
                                                    ~ak_sk.1, ~ssk_nms.1, ~tid.1
                           ) ▶₀ #t2.3 )
                      case outTPMPCRExtendswstate_0_1111111111111211
                      solve( TPM_SendCommand( <'TPM2_Create', <swstate, nil>, 
                                               'TPM_CC_PolicyPCR', nil>
                             ) @ #t2.7 )
                        case eventTPMSendCommandTPMCreateswstatenilTPMCCPolicyPCRnil_0_11111111111112111
                        solve( state_11111111111112111( ~RouterID.1, ~ServerID.1, ~ak_h.1,
                                                        ~ak_sk.1, ~ssk_nms.1, ~tid.1
                               ) ▶₀ #t2.4 )
                          case outTPMPCRExtendswstate_0_1111111111111211
                          by solve( !KU( ~ak_sk ) @ #vk.6 )
                        qed
                      qed
                    qed
                  qed
                qed
              next
                case case_2
                solve( state_111111111111111111111121111111111( ~RouterID.1, ~ServerID.1,
                                                                ~ak_h.1, ~ak_sk.1, ~k_h.1, ~k_sk.1,
                                                                ~ssk_nms.1, authPolicy, ~n
                       ) ▶₀ #t2.1 )
                  case TpmCreateOutkhpkksk_0_11111111111111111111112111111111
                  solve( TPM_SendCommand( <'TPM2_Create', authPolicy> ) @ #t2.6 )
                    case eventTPMSendCommandTPMCreateswstatenilTPMCCPolicyPCRnil_0_11111111111112111
                    solve( state_11111111111112111( ~RouterID.1, ~ServerID.1, ~ak_h.1,
                                                    ~ak_sk.1, ~ssk_nms.1, ~tid.1
                           ) ▶₀ #t2.4 )
                      case outTPMPCRExtendswstate_0_1111111111111211
                      solve( TPM_SendCommand( <'TPM2_Create', <swstate, nil>, 
                                               'TPM_CC_PolicyPCR', nil>
                             ) @ #t2.7 )
                        case eventTPMSendCommandTPMCreateswstatenilTPMCCPolicyPCRnil_0_11111111111112111
                        solve( state_11111111111112111( ~RouterID.1, ~ServerID.1, ~ak_h.1,
                                                        ~ak_sk.1, ~ssk_nms.1, ~tid.1
                               ) ▶₀ #t2.5 )
                          case outTPMPCRExtendswstate_0_1111111111111211
                          by solve( !KU( ~ak_sk ) @ #vk.6 )
                        qed
                      qed
                    qed
                  qed
                qed
              qed
            next
              case case_2
              solve( (#vr.34 < #t2.4)  ∥ (#vr.34 = #t2.4) )
                case case_1
                solve( state_111111111111111111111121111111111( ~RouterID.1, ~ServerID.1,
                                                                ~ak_h.1, ~ak_sk.1, ~k_h.1, ~k_sk.1,
                                                                ~ssk_nms.1, authPolicy, ~n
                       ) ▶₀ #t2.1 )
                  case TpmCreateOutkhpkksk_0_11111111111111111111112111111111
                  solve( TPM_SendCommand( <'TPM2_Create', authPolicy> ) @ #t2.6 )
                    case eventTPMSendCommandTPMCreateswstatenilTPMCCPolicyPCRnil_0_11111111111112111
                    solve( state_11111111111112111( ~RouterID.1, ~ServerID.1, ~ak_h.1,
                                                    ~ak_sk.1, ~ssk_nms.1, ~tid.1
                           ) ▶₀ #t2.4 )
                      case outTPMPCRExtendswstate_0_1111111111111211
                      solve( TPM_SendCommand( <'TPM2_Create', <swstate, nil>, 
                                               'TPM_CC_PolicyPCR', nil>
                             ) @ #t2.7 )
                        case eventTPMSendCommandTPMCreateswstatenilTPMCCPolicyPCRnil_0_11111111111112111
                        solve( state_11111111111112111( ~RouterID.1, ~ServerID.1, ~ak_h.1,
                                                        ~ak_sk.1, ~ssk_nms.1, ~tid.1
                               ) ▶₀ #t2.5 )
                          case outTPMPCRExtendswstate_0_1111111111111211
                          by solve( !KU( ~ak_sk ) @ #vk.6 )
                        qed
                      qed
                    qed
                  qed
                qed
              next
                case case_2
                solve( state_111111111111111111111121111111111( ~RouterID.1, ~ServerID.1,
                                                                ~ak_h.1, ~ak_sk.1, ~k_h.1, ~k_sk.1,
                                                                ~ssk_nms.1, authPolicy, ~n
                       ) ▶₀ #t2.1 )
                  case TpmCreateOutkhpkksk_0_11111111111111111111112111111111
                  solve( TPM_SendCommand( <'TPM2_Create', authPolicy> ) @ #t2.6 )
                    case eventTPMSendCommandTPMCreateswstatenilTPMCCPolicyPCRnil_0_11111111111112111
                    solve( state_11111111111112111( ~RouterID.1, ~ServerID.1, ~ak_h.1,
                                                    ~ak_sk.1, ~ssk_nms.1, ~tid.1
                           ) ▶₀ #t2.5 )
                      case outTPMPCRExtendswstate_0_1111111111111211
                      solve( TPM_SendCommand( <'TPM2_Create', <swstate, nil>, 
                                               'TPM_CC_PolicyPCR', nil>
                             ) @ #t2.7 )
                        case eventTPMSendCommandTPMCreateswstatenilTPMCCPolicyPCRnil_0_11111111111112111
                        solve( state_11111111111112111( ~RouterID.1, ~ServerID.1, ~ak_h.1,
                                                        ~ak_sk.1, ~ssk_nms.1, ~tid.1
                               ) ▶₀ #t2.6 )
                          case outTPMPCRExtendswstate_0_1111111111111211
                          by solve( !KU( ~ak_sk ) @ #vk.6 )
                        qed
                      qed
                    qed
                  qed
                qed
              qed
            qed
          qed
        qed
      qed
    next
      case outtlsspkskaecsr_0_11111111111112111111111111111111111111
      by contradiction /* from formulas */
    qed
  next
    case outsignobjpkobjapask_0_11111111111111111111211111111
    solve( TPM_SendCommand( <'TPM2_Certify', obj_sh, obj_h, a_h> ) @ #t2 )
      case eventTPMSendCommandTPMCertifytlsshtlshakh_0_111111111111121111111111111
      solve( state_111111111111121111111111111( ~RouterID.1, ~ServerID.1,
                                                ~ak_h.1, ~ak_sk.1, ~ssk_nms.1, ~tid, obj_h, obj_sh, tls_spk
             ) ▶₀ #t2 )
        case outTPMPolicyPCRtlssh_0_11111111111112111111111111
        solve( (#vr.48 < #t2.3)  ∥ (#vr.48 = #t2.3) )
          case case_1
          solve( (#vr.52 < #t2.4)  ∥ (#vr.52 = #t2.4) )
            case case_1
            solve( (#vr.34 < #t2.2)  ∥ (#vr.34 = #t2.2) )
              case case_1
              solve( state_111111111111111111111121111111111( ~RouterID.1, ~ServerID.1,
                                                              ~ak_h.1, ~ak_sk.1, ~k_h.1, ~k_sk.1, ~ssk_nms.1,
                                                              authPolicy, ~n
                     ) ▶₀ #t2.1 )
                case TpmCreateOutkhpkksk_0_11111111111111111111112111111111
                solve( TPM_SendCommand( <'TPM2_Create', authPolicy> ) @ #t2.6 )
                  case eventTPMSendCommandTPMCreateswstatenilTPMCCPolicyPCRnil_0_11111111111112111
                  solve( state_11111111111112111( ~RouterID.1, ~ServerID.1, ~ak_h.1,
                                                  ~ak_sk.1, ~ssk_nms.1, ~tid.1
                         ) ▶₀ #t2.2 )
                    case outTPMPCRExtendswstate_0_1111111111111211
                    solve( TPM_SendCommand( <'TPM2_Create', <swstate, nil>, 
                                             'TPM_CC_PolicyPCR', nil>
                           ) @ #t2.7 )
                      case eventTPMSendCommandTPMCreateswstatenilTPMCCPolicyPCRnil_0_11111111111112111
                      solve( state_11111111111112111( ~RouterID.1, ~ServerID.1, ~ak_h.1,
                                                      ~ak_sk.1, ~ssk_nms.1, ~tid.1
                             ) ▶₀ #t2.3 )
                        case outTPMPCRExtendswstate_0_1111111111111211
                        solve( !KU( sign(<pk(x), 
                                          sign(<pk(x), <swstate, nil>, 'TPM_CC_PolicyPCR', nil>, ~ak_sk)>,
                                         x)
                               ) @ #vk.4 )
                          case c_sign
                          solve( Insert( <'privatePart', ~ak_h>, ~ak_sk ) @ #t2.3 )
                            case insertprivatePartakhaksk_0_111111111111111
                            solve( state_111111111111111( ~RouterID.1, ~ServerID.1, ~ak_h, ~ak_sk,
                                                          ~ssk_nms.1
                                   ) ▶₀ #t2.3 )
                              case insertauthPolicyakhnil_0_11111111111111
                              by contradiction /* cyclic */
                            qed
                          next
                            case insertprivatePartkhksk_0_111111111111111111111121111111
                            by solve( state_111111111111111111111121111111( ~RouterID.1, ~ServerID.1,
                                                                            ~ak_h.1, ~ak_sk.1, ~ak_h, ~ak_sk,
                                                                            ~ssk_nms.1, authPolicy, lock
                                      ) ▶₀ #t2.3 )
                          qed
                        next
                          case outsignobjpkobjapask_0_11111111111111111111211111111
                          solve( ((#vr.25 < #vr.70) ∧
                                  (∃ #t2.
                                    (Unlock_4( '4', ~n.1, 'device' ) @ #t2)
                                   ∧
                                    (#vr.25 < #t2) ∧
                                    (#t2 < #vr.70) ∧
                                    (∀ #t0 pp. (Unlock( pp, ~n.1, 'device' ) @ #t0) ⇒ #t0 = #t2) ∧
                                    (∀ pp lpp #t0.
                                      (Lock( pp, lpp, 'device' ) @ #t0)
                                     ⇒
                                      ((#t0 < #vr.25) ∨ (#t0 = #vr.25) ∨ (#t2 < #t0))) ∧
                                    (∀ pp lpp #t0.
                                      (Unlock( pp, lpp, 'device' ) @ #t0)
                                     ⇒
                                      ((#t0 < #vr.25) ∨ (#t2 < #t0) ∨ (#t2 = #t0)))))  ∥
                                 (#vr.70 < #vr.25)  ∥ (#vr.25 = #vr.70) )
                            case case_1
                            solve( TPM_SendCommand( <'TPM2_Certify', obj_sh.1, obj_h, a_h>
                                   ) @ #t2.7 )
                              case eventTPMSendCommandTPMCertifytlsshtlshakh_0_111111111111121111111111111
                              by solve( state_111111111111121111111111111( ~RouterID.1, ~ServerID.1,
                                                                           ~ak_h.1, ~ak_sk.1, ~ssk_nms.1,
                                                                           ~tid.1, obj_h, obj_sh.1, tls_spk
                                        ) ▶₀ #t2.3 )
                            qed
                          next
                            case case_2
                            solve( (#vr.70 < #vr.53)  ∥ (#t2.1 < #vr.70) )
                              case case_1
                              solve( TPM_SendCommand( <'TPM2_Certify', obj_sh.1, obj_h, a_h>
                                     ) @ #t2.7 )
                                case eventTPMSendCommandTPMCertifytlsshtlshakh_0_111111111111121111111111111
                                by solve( state_111111111111121111111111111( ~RouterID.1, ~ServerID.1,
                                                                             ~ak_h.1, ~ak_sk.1, ~ssk_nms.1,
                                                                             ~tid.1, obj_h, obj_sh.1, tls_spk
                                          ) ▶₀ #t2.3 )
                              qed
                            next
                              case case_2
                              solve( TPM_SendCommand( <'TPM2_Certify', obj_sh.1, obj_h, a_h>
                                     ) @ #t2.7 )
                                case eventTPMSendCommandTPMCertifytlsshtlshakh_0_111111111111121111111111111
                                by solve( state_111111111111121111111111111( ~RouterID.1, ~ServerID.1,
                                                                             ~ak_h.1, ~ak_sk.1, ~ssk_nms.1,
                                                                             ~tid.1, obj_h, obj_sh.1, tls_spk
                                          ) ▶₀ #t2.3 )
                              qed
                            qed
                          qed
                        next
                          case outtlsspkskaecsr_0_11111111111112111111111111111111111111
                          by contradiction /* from formulas */
                        qed
                      qed
                    qed
                  qed
                qed
              qed
            next
              case case_2
              solve( state_111111111111111111111121111111111( ~RouterID.1, ~ServerID.1,
                                                              ~ak_h.1, ~ak_sk.1, ~k_h.1, ~k_sk.1, ~ssk_nms.1,
                                                              authPolicy, ~n
                     ) ▶₀ #t2.1 )
                case TpmCreateOutkhpkksk_0_11111111111111111111112111111111
                solve( TPM_SendCommand( <'TPM2_Create', authPolicy> ) @ #t2.6 )
                  case eventTPMSendCommandTPMCreateswstatenilTPMCCPolicyPCRnil_0_11111111111112111
                  solve( state_11111111111112111( ~RouterID.1, ~ServerID.1, ~ak_h.1,
                                                  ~ak_sk.1, ~ssk_nms.1, ~tid.1
                         ) ▶₀ #t2.3 )
                    case outTPMPCRExtendswstate_0_1111111111111211
                    solve( TPM_SendCommand( <'TPM2_Create', <swstate, nil>, 
                                             'TPM_CC_PolicyPCR', nil>
                           ) @ #t2.7 )
                      case eventTPMSendCommandTPMCreateswstatenilTPMCCPolicyPCRnil_0_11111111111112111
                      solve( state_11111111111112111( ~RouterID.1, ~ServerID.1, ~ak_h.1,
                                                      ~ak_sk.1, ~ssk_nms.1, ~tid.1
                             ) ▶₀ #t2.4 )
                        case outTPMPCRExtendswstate_0_1111111111111211
                        solve( !KU( sign(<pk(x), 
                                          sign(<pk(x), <swstate, nil>, 'TPM_CC_PolicyPCR', nil>, ~ak_sk)>,
                                         x)
                               ) @ #vk.4 )
                          case c_sign
                          solve( Insert( <'privatePart', ~ak_h>, ~ak_sk ) @ #t2.2 )
                            case insertprivatePartakhaksk_0_111111111111111
                            solve( Insert( <'publicPart', ~k_h>, pk(x) ) @ #t2.4 )
                              case insertpublicPartakhpkaksk_0_1111111111111111
                              by solve( state_1111111111111111( ~RouterID.1, ~ServerID.1, ~k_h,
                                                                ~ak_sk.1, ~ssk_nms.1
                                        ) ▶₀ #t2.4 )
                            next
                              case insertpublicPartkhpkksk_0_1111111111111111111111211111111
                              solve( state_1111111111111111111111211111111( ~RouterID.1, ~ServerID.1,
                                                                            ~ak_h.1, ~ak_sk.1, ~k_h, ~k_sk,
                                                                            ~ssk_nms.1, authPolicy, lock
                                     ) ▶₀ #t2.4 )
                                case insertprivatePartkhksk_0_111111111111111111111121111111
                                by contradiction /* cyclic */
                              qed
                            qed
                          qed
                        next
                          case outsignobjpkobjapask_0_11111111111111111111211111111
                          solve( ((#vr.25 < #vr.69) ∧
                                  (∃ #t2.
                                    (Unlock_4( '4', ~n.1, 'device' ) @ #t2)
                                   ∧
                                    (#vr.25 < #t2) ∧
                                    (#t2 < #vr.69) ∧
                                    (∀ #t0 pp. (Unlock( pp, ~n.1, 'device' ) @ #t0) ⇒ #t0 = #t2) ∧
                                    (∀ pp lpp #t0.
                                      (Lock( pp, lpp, 'device' ) @ #t0)
                                     ⇒
                                      ((#t0 < #vr.25) ∨ (#t0 = #vr.25) ∨ (#t2 < #t0))) ∧
                                    (∀ pp lpp #t0.
                                      (Unlock( pp, lpp, 'device' ) @ #t0)
                                     ⇒
                                      ((#t0 < #vr.25) ∨ (#t2 < #t0) ∨ (#t2 = #t0)))))  ∥
                                 (#vr.69 < #vr.25)  ∥ (#vr.25 = #vr.69) )
                            case case_1
                            solve( TPM_SendCommand( <'TPM2_Certify', obj_sh.1, obj_h, a_h>
                                   ) @ #t2.7 )
                              case eventTPMSendCommandTPMCertifytlsshtlshakh_0_111111111111121111111111111
                              by solve( state_111111111111121111111111111( ~RouterID.1, ~ServerID.1,
                                                                           ~ak_h.1, ~ak_sk.1, ~ssk_nms.1,
                                                                           ~tid.1, obj_h, obj_sh.1, tls_spk
                                        ) ▶₀ #t2.4 )
                            qed
                          next
                            case case_2
                            solve( (#vr.69 < #vr.52)  ∥ (#t2.1 < #vr.69) )
                              case case_1
                              solve( TPM_SendCommand( <'TPM2_Certify', obj_sh.1, obj_h, a_h>
                                     ) @ #t2.7 )
                                case eventTPMSendCommandTPMCertifytlsshtlshakh_0_111111111111121111111111111
                                by solve( state_111111111111121111111111111( ~RouterID.1, ~ServerID.1,
                                                                             ~ak_h.1, ~ak_sk.1, ~ssk_nms.1,
                                                                             ~tid.1, obj_h, obj_sh.1, tls_spk
                                          ) ▶₀ #t2.4 )
                              qed
                            next
                              case case_2
                              solve( TPM_SendCommand( <'TPM2_Certify', obj_sh.1, obj_h, a_h>
                                     ) @ #t2.7 )
                                case eventTPMSendCommandTPMCertifytlsshtlshakh_0_111111111111121111111111111
                                by solve( state_111111111111121111111111111( ~RouterID.1, ~ServerID.1,
                                                                             ~ak_h.1, ~ak_sk.1, ~ssk_nms.1,
                                                                             ~tid.1, obj_h, obj_sh.1, tls_spk
                                          ) ▶₀ #t2.4 )
                              qed
                            qed
                          qed
                        next
                          case outtlsspkskaecsr_0_11111111111112111111111111111111111111
                          by contradiction /* from formulas */
                        qed
                      qed
                    qed
                  qed
                qed
              qed
            qed
          next
            case case_2
            solve( (#vr.34 < #t2.3)  ∥ (#vr.34 = #t2.3) )
              case case_1
              solve( state_111111111111111111111121111111111( ~RouterID.1, ~ServerID.1,
                                                              ~ak_h.1, ~ak_sk.1, ~k_h.1, ~k_sk.1, ~ssk_nms.1,
                                                              authPolicy, ~n
                     ) ▶₀ #t2.1 )
                case TpmCreateOutkhpkksk_0_11111111111111111111112111111111
                solve( TPM_SendCommand( <'TPM2_Create', authPolicy> ) @ #t2.6 )
                  case eventTPMSendCommandTPMCreateswstatenilTPMCCPolicyPCRnil_0_11111111111112111
                  solve( state_11111111111112111( ~RouterID.1, ~ServerID.1, ~ak_h.1,
                                                  ~ak_sk.1, ~ssk_nms.1, ~tid.1
                         ) ▶₀ #t2.3 )
                    case outTPMPCRExtendswstate_0_1111111111111211
                    solve( TPM_SendCommand( <'TPM2_Create', <swstate, nil>, 
                                             'TPM_CC_PolicyPCR', nil>
                           ) @ #t2.7 )
                      case eventTPMSendCommandTPMCreateswstatenilTPMCCPolicyPCRnil_0_11111111111112111
                      solve( state_11111111111112111( ~RouterID.1, ~ServerID.1, ~ak_h.1,
                                                      ~ak_sk.1, ~ssk_nms.1, ~tid.1
                             ) ▶₀ #t2.4 )
                        case outTPMPCRExtendswstate_0_1111111111111211
                        solve( !KU( sign(<pk(x), 
                                          sign(<pk(x), <swstate, nil>, 'TPM_CC_PolicyPCR', nil>, ~ak_sk)>,
                                         x)
                               ) @ #vk.4 )
                          case c_sign
                          solve( Insert( <'privatePart', ~ak_h>, ~ak_sk ) @ #t2.4 )
                            case insertprivatePartakhaksk_0_111111111111111
                            solve( state_111111111111111( ~RouterID.1, ~ServerID.1, ~ak_h, ~ak_sk,
                                                          ~ssk_nms.1
                                   ) ▶₀ #t2.4 )
                              case insertauthPolicyakhnil_0_11111111111111
                              by contradiction /* cyclic */
                            qed
                          next
                            case insertprivatePartkhksk_0_111111111111111111111121111111
                            by solve( state_111111111111111111111121111111( ~RouterID.1, ~ServerID.1,
                                                                            ~ak_h.1, ~ak_sk.1, ~ak_h, ~ak_sk,
                                                                            ~ssk_nms.1, authPolicy, lock
                                      ) ▶₀ #t2.4 )
                          qed
                        next
                          case outsignobjpkobjapask_0_11111111111111111111211111111
                          solve( ((#vr.25 < #vr.69) ∧
                                  (∃ #t2.
                                    (Unlock_4( '4', ~n.1, 'device' ) @ #t2)
                                   ∧
                                    (#vr.25 < #t2) ∧
                                    (#t2 < #vr.69) ∧
                                    (∀ #t0 pp. (Unlock( pp, ~n.1, 'device' ) @ #t0) ⇒ #t0 = #t2) ∧
                                    (∀ pp lpp #t0.
                                      (Lock( pp, lpp, 'device' ) @ #t0)
                                     ⇒
                                      ((#t0 < #vr.25) ∨ (#t0 = #vr.25) ∨ (#t2 < #t0))) ∧
                                    (∀ pp lpp #t0.
                                      (Unlock( pp, lpp, 'device' ) @ #t0)
                                     ⇒
                                      ((#t0 < #vr.25) ∨ (#t2 < #t0) ∨ (#t2 = #t0)))))  ∥
                                 (#vr.69 < #vr.25)  ∥ (#vr.25 = #vr.69) )
                            case case_1
                            solve( TPM_SendCommand( <'TPM2_Certify', obj_sh.1, obj_h, a_h>
                                   ) @ #t2.7 )
                              case eventTPMSendCommandTPMCertifytlsshtlshakh_0_111111111111121111111111111
                              by solve( state_111111111111121111111111111( ~RouterID.1, ~ServerID.1,
                                                                           ~ak_h.1, ~ak_sk.1, ~ssk_nms.1,
                                                                           ~tid.1, obj_h, obj_sh.1, tls_spk
                                        ) ▶₀ #t2.4 )
                            qed
                          next
                            case case_2
                            solve( (#vr.69 < #vr.52)  ∥ (#t2.1 < #vr.69) )
                              case case_1
                              solve( TPM_SendCommand( <'TPM2_Certify', obj_sh.1, obj_h, a_h>
                                     ) @ #t2.7 )
                                case eventTPMSendCommandTPMCertifytlsshtlshakh_0_111111111111121111111111111
                                by solve( state_111111111111121111111111111( ~RouterID.1, ~ServerID.1,
                                                                             ~ak_h.1, ~ak_sk.1, ~ssk_nms.1,
                                                                             ~tid.1, obj_h, obj_sh.1, tls_spk
                                          ) ▶₀ #t2.4 )
                              qed
                            next
                              case case_2
                              solve( TPM_SendCommand( <'TPM2_Certify', obj_sh.1, obj_h, a_h>
                                     ) @ #t2.7 )
                                case eventTPMSendCommandTPMCertifytlsshtlshakh_0_111111111111121111111111111
                                by solve( state_111111111111121111111111111( ~RouterID.1, ~ServerID.1,
                                                                             ~ak_h.1, ~ak_sk.1, ~ssk_nms.1,
                                                                             ~tid.1, obj_h, obj_sh.1, tls_spk
                                          ) ▶₀ #t2.4 )
                              qed
                            qed
                          qed
                        next
                          case outtlsspkskaecsr_0_11111111111112111111111111111111111111
                          by contradiction /* from formulas */
                        qed
                      qed
                    qed
                  qed
                qed
              qed
            next
              case case_2
              solve( state_111111111111111111111121111111111( ~RouterID.1, ~ServerID.1,
                                                              ~ak_h.1, ~ak_sk.1, ~k_h.1, ~k_sk.1, ~ssk_nms.1,
                                                              authPolicy, ~n
                     ) ▶₀ #t2.1 )
                case TpmCreateOutkhpkksk_0_11111111111111111111112111111111
                solve( TPM_SendCommand( <'TPM2_Create', authPolicy> ) @ #t2.6 )
                  case eventTPMSendCommandTPMCreateswstatenilTPMCCPolicyPCRnil_0_11111111111112111
                  solve( state_11111111111112111( ~RouterID.1, ~ServerID.1, ~ak_h.1,
                                                  ~ak_sk.1, ~ssk_nms.1, ~tid.1
                         ) ▶₀ #t2.4 )
                    case outTPMPCRExtendswstate_0_1111111111111211
                    solve( TPM_SendCommand( <'TPM2_Create', <swstate, nil>, 
                                             'TPM_CC_PolicyPCR', nil>
                           ) @ #t2.7 )
                      case eventTPMSendCommandTPMCreateswstatenilTPMCCPolicyPCRnil_0_11111111111112111
                      solve( state_11111111111112111( ~RouterID.1, ~ServerID.1, ~ak_h.1,
                                                      ~ak_sk.1, ~ssk_nms.1, ~tid.1
                             ) ▶₀ #t2.5 )
                        case outTPMPCRExtendswstate_0_1111111111111211
                        solve( !KU( sign(<pk(x), 
                                          sign(<pk(x), <swstate, nil>, 'TPM_CC_PolicyPCR', nil>, ~ak_sk)>,
                                         x)
                               ) @ #vk.4 )
                          case c_sign
                          solve( Insert( <'privatePart', ~ak_h>, ~ak_sk ) @ #t2.3 )
                            case insertprivatePartakhaksk_0_111111111111111
                            solve( Insert( <'publicPart', ~k_h>, pk(x) ) @ #t2.5 )
                              case insertpublicPartakhpkaksk_0_1111111111111111
                              by solve( state_1111111111111111( ~RouterID.1, ~ServerID.1, ~k_h,
                                                                ~ak_sk.1, ~ssk_nms.1
                                        ) ▶₀ #t2.5 )
                            next
                              case insertpublicPartkhpkksk_0_1111111111111111111111211111111
                              solve( state_1111111111111111111111211111111( ~RouterID.1, ~ServerID.1,
                                                                            ~ak_h.1, ~ak_sk.1, ~k_h, ~k_sk,
                                                                            ~ssk_nms.1, authPolicy, lock
                                     ) ▶₀ #t2.5 )
                                case insertprivatePartkhksk_0_111111111111111111111121111111
                                by contradiction /* cyclic */
                              qed
                            qed
                          qed
                        next
                          case outsignobjpkobjapask_0_11111111111111111111211111111
                          solve( ((#vr.25 < #vr.68) ∧
                                  (∃ #t2.
                                    (Unlock_4( '4', ~n.1, 'device' ) @ #t2)
                                   ∧
                                    (#vr.25 < #t2) ∧
                                    (#t2 < #vr.68) ∧
                                    (∀ #t0 pp. (Unlock( pp, ~n.1, 'device' ) @ #t0) ⇒ #t0 = #t2) ∧
                                    (∀ pp lpp #t0.
                                      (Lock( pp, lpp, 'device' ) @ #t0)
                                     ⇒
                                      ((#t0 < #vr.25) ∨ (#t0 = #vr.25) ∨ (#t2 < #t0))) ∧
                                    (∀ pp lpp #t0.
                                      (Unlock( pp, lpp, 'device' ) @ #t0)
                                     ⇒
                                      ((#t0 < #vr.25) ∨ (#t2 < #t0) ∨ (#t2 = #t0)))))  ∥
                                 (#vr.68 < #vr.25)  ∥ (#vr.25 = #vr.68) )
                            case case_1
                            solve( TPM_SendCommand( <'TPM2_Certify', obj_sh.1, obj_h, a_h>
                                   ) @ #t2.7 )
                              case eventTPMSendCommandTPMCertifytlsshtlshakh_0_111111111111121111111111111
                              by solve( state_111111111111121111111111111( ~RouterID.1, ~ServerID.1,
                                                                           ~ak_h.1, ~ak_sk.1, ~ssk_nms.1,
                                                                           ~tid.1, obj_h, obj_sh.1, tls_spk
                                        ) ▶₀ #t2.5 )
                            qed
                          next
                            case case_2
                            solve( (#vr.68 < #vr.51)  ∥ (#t2.1 < #vr.68) )
                              case case_1
                              solve( TPM_SendCommand( <'TPM2_Certify', obj_sh.1, obj_h, a_h>
                                     ) @ #t2.7 )
                                case eventTPMSendCommandTPMCertifytlsshtlshakh_0_111111111111121111111111111
                                by solve( state_111111111111121111111111111( ~RouterID.1, ~ServerID.1,
                                                                             ~ak_h.1, ~ak_sk.1, ~ssk_nms.1,
                                                                             ~tid.1, obj_h, obj_sh.1, tls_spk
                                          ) ▶₀ #t2.5 )
                              qed
                            next
                              case case_2
                              solve( TPM_SendCommand( <'TPM2_Certify', obj_sh.1, obj_h, a_h>
                                     ) @ #t2.7 )
                                case eventTPMSendCommandTPMCertifytlsshtlshakh_0_111111111111121111111111111
                                by solve( state_111111111111121111111111111( ~RouterID.1, ~ServerID.1,
                                                                             ~ak_h.1, ~ak_sk.1, ~ssk_nms.1,
                                                                             ~tid.1, obj_h, obj_sh.1, tls_spk
                                          ) ▶₀ #t2.5 )
                              qed
                            qed
                          qed
                        next
                          case outtlsspkskaecsr_0_11111111111112111111111111111111111111
                          by contradiction /* from formulas */
                        qed
                      qed
                    qed
                  qed
                qed
              qed
            qed
          qed
        next
          case case_2
          solve( (#vr.51 < #t2.4)  ∥ (#vr.51 = #t2.4) )
            case case_1
            solve( (#vr.34 < #t2.3)  ∥ (#vr.34 = #t2.3) )
              case case_1
              solve( state_111111111111111111111121111111111( ~RouterID.1, ~ServerID.1,
                                                              ~ak_h.1, ~ak_sk.1, ~k_h.1, ~k_sk.1, ~ssk_nms.1,
                                                              authPolicy, ~n
                     ) ▶₀ #t2.1 )
                case TpmCreateOutkhpkksk_0_11111111111111111111112111111111
                solve( TPM_SendCommand( <'TPM2_Create', authPolicy> ) @ #t2.6 )
                  case eventTPMSendCommandTPMCreateswstatenilTPMCCPolicyPCRnil_0_11111111111112111
                  solve( state_11111111111112111( ~RouterID.1, ~ServerID.1, ~ak_h.1,
                                                  ~ak_sk.1, ~ssk_nms.1, ~tid.1
                         ) ▶₀ #t2.3 )
                    case outTPMPCRExtendswstate_0_1111111111111211
                    solve( TPM_SendCommand( <'TPM2_Create', <swstate, nil>, 
                                             'TPM_CC_PolicyPCR', nil>
                           ) @ #t2.7 )
                      case eventTPMSendCommandTPMCreateswstatenilTPMCCPolicyPCRnil_0_11111111111112111
                      solve( state_11111111111112111( ~RouterID.1, ~ServerID.1, ~ak_h.1,
                                                      ~ak_sk.1, ~ssk_nms.1, ~tid.1
                             ) ▶₀ #t2.4 )
                        case outTPMPCRExtendswstate_0_1111111111111211
                        solve( !KU( sign(<pk(x), 
                                          sign(<pk(x), <swstate, nil>, 'TPM_CC_PolicyPCR', nil>, ~ak_sk)>,
                                         x)
                               ) @ #vk.4 )
                          case c_sign
                          solve( Insert( <'privatePart', ~ak_h>, ~ak_sk ) @ #t2.4 )
                            case insertprivatePartakhaksk_0_111111111111111
                            solve( state_111111111111111( ~RouterID.1, ~ServerID.1, ~ak_h, ~ak_sk,
                                                          ~ssk_nms.1
                                   ) ▶₀ #t2.4 )
                              case insertauthPolicyakhnil_0_11111111111111
                              by contradiction /* cyclic */
                            qed
                          next
                            case insertprivatePartkhksk_0_111111111111111111111121111111
                            by solve( state_111111111111111111111121111111( ~RouterID.1, ~ServerID.1,
                                                                            ~ak_h.1, ~ak_sk.1, ~ak_h, ~ak_sk,
                                                                            ~ssk_nms.1, authPolicy, lock
                                      ) ▶₀ #t2.4 )
                          qed
                        next
                          case outsignobjpkobjapask_0_11111111111111111111211111111
                          solve( ((#vr.25 < #vr.69) ∧
                                  (∃ #t2.
                                    (Unlock_4( '4', ~n.1, 'device' ) @ #t2)
                                   ∧
                                    (#vr.25 < #t2) ∧
                                    (#t2 < #vr.69) ∧
                                    (∀ #t0 pp. (Unlock( pp, ~n.1, 'device' ) @ #t0) ⇒ #t0 = #t2) ∧
                                    (∀ pp lpp #t0.
                                      (Lock( pp, lpp, 'device' ) @ #t0)
                                     ⇒
                                      ((#t0 < #vr.25) ∨ (#t0 = #vr.25) ∨ (#t2 < #t0))) ∧
                                    (∀ pp lpp #t0.
                                      (Unlock( pp, lpp, 'device' ) @ #t0)
                                     ⇒
                                      ((#t0 < #vr.25) ∨ (#t2 < #t0) ∨ (#t2 = #t0)))))  ∥
                                 (#vr.69 < #vr.25)  ∥ (#vr.25 = #vr.69) )
                            case case_1
                            solve( TPM_SendCommand( <'TPM2_Certify', obj_sh.1, obj_h, a_h>
                                   ) @ #t2.7 )
                              case eventTPMSendCommandTPMCertifytlsshtlshakh_0_111111111111121111111111111
                              by solve( state_111111111111121111111111111( ~RouterID.1, ~ServerID.1,
                                                                           ~ak_h.1, ~ak_sk.1, ~ssk_nms.1,
                                                                           ~tid.1, obj_h, obj_sh.1, tls_spk
                                        ) ▶₀ #t2.4 )
                            qed
                          next
                            case case_2
                            solve( (#vr.69 < #vr.52)  ∥ (#t2.1 < #vr.69) )
                              case case_1
                              solve( TPM_SendCommand( <'TPM2_Certify', obj_sh.1, obj_h, a_h>
                                     ) @ #t2.7 )
                                case eventTPMSendCommandTPMCertifytlsshtlshakh_0_111111111111121111111111111
                                by solve( state_111111111111121111111111111( ~RouterID.1, ~ServerID.1,
                                                                             ~ak_h.1, ~ak_sk.1, ~ssk_nms.1,
                                                                             ~tid.1, obj_h, obj_sh.1, tls_spk
                                          ) ▶₀ #t2.4 )
                              qed
                            next
                              case case_2
                              solve( TPM_SendCommand( <'TPM2_Certify', obj_sh.1, obj_h, a_h>
                                     ) @ #t2.7 )
                                case eventTPMSendCommandTPMCertifytlsshtlshakh_0_111111111111121111111111111
                                by solve( state_111111111111121111111111111( ~RouterID.1, ~ServerID.1,
                                                                             ~ak_h.1, ~ak_sk.1, ~ssk_nms.1,
                                                                             ~tid.1, obj_h, obj_sh.1, tls_spk
                                          ) ▶₀ #t2.4 )
                              qed
                            qed
                          qed
                        next
                          case outtlsspkskaecsr_0_11111111111112111111111111111111111111
                          by contradiction /* from formulas */
                        qed
                      qed
                    qed
                  qed
                qed
              qed
            next
              case case_2
              solve( state_111111111111111111111121111111111( ~RouterID.1, ~ServerID.1,
                                                              ~ak_h.1, ~ak_sk.1, ~k_h.1, ~k_sk.1, ~ssk_nms.1,
                                                              authPolicy, ~n
                     ) ▶₀ #t2.1 )
                case TpmCreateOutkhpkksk_0_11111111111111111111112111111111
                solve( TPM_SendCommand( <'TPM2_Create', authPolicy> ) @ #t2.6 )
                  case eventTPMSendCommandTPMCreateswstatenilTPMCCPolicyPCRnil_0_11111111111112111
                  solve( state_11111111111112111( ~RouterID.1, ~ServerID.1, ~ak_h.1,
                                                  ~ak_sk.1, ~ssk_nms.1, ~tid.1
                         ) ▶₀ #t2.4 )
                    case outTPMPCRExtendswstate_0_1111111111111211
                    solve( TPM_SendCommand( <'TPM2_Create', <swstate, nil>, 
                                             'TPM_CC_PolicyPCR', nil>
                           ) @ #t2.7 )
                      case eventTPMSendCommandTPMCreateswstatenilTPMCCPolicyPCRnil_0_11111111111112111
                      solve( state_11111111111112111( ~RouterID.1, ~ServerID.1, ~ak_h.1,
                                                      ~ak_sk.1, ~ssk_nms.1, ~tid.1
                             ) ▶₀ #t2.5 )
                        case outTPMPCRExtendswstate_0_1111111111111211
                        solve( !KU( sign(<pk(x), 
                                          sign(<pk(x), <swstate, nil>, 'TPM_CC_PolicyPCR', nil>, ~ak_sk)>,
                                         x)
                               ) @ #vk.4 )
                          case c_sign
                          solve( Insert( <'privatePart', ~ak_h>, ~ak_sk ) @ #t2.3 )
                            case insertprivatePartakhaksk_0_111111111111111
                            solve( Insert( <'publicPart', ~k_h>, pk(x) ) @ #t2.2 )
                              case insertpublicPartkhpkksk_0_1111111111111111111111211111111
                              solve( !KU( pk(~k_sk) ) @ #vk.4 )
                                case c_pk
                                solve( Insert( <'authPolicy', ~k_h>,
                                               <<swstate, nil>, 'TPM_CC_PolicyPCR', nil>
                                       ) @ #t2.5 )
                                  case insertauthPolicykhauthPolicy_0_11111111111111111111112111111
                                  solve( state_11111111111111111111112111111( ~RouterID.1, ~ServerID.1,
                                                                              ~ak_h.1, ~ak_sk.1, ~k_h,
                                                                              ~k_sk.1, ~ssk_nms.1,
                                                                              <<swstate, nil>, 
                                                                               'TPM_CC_PolicyPCR', nil>,
                                                                              lock
                                         ) ▶₀ #t2.5 )
                                    case lockdevice_0_1111111111111111111111211111
                                    by contradiction /* cyclic */
                                  qed
                                qed
                              next
                                case outTPMSigntlsshtlshtlsspkskae_0_1111111111111211111111111111111111
                                solve( TPM_SendCommand( <'TPM2_Create', <swstate, nil>, 
                                                         'TPM_CC_PolicyPCR', nil>
                                       ) @ #t2.7 )
                                  case eventTPMSendCommandTPMCreateswstatenilTPMCCPolicyPCRnil_0_11111111111112111
                                  solve( state_11111111111112111( ~RouterID.1, ~ServerID.1, ~ak_h.1,
                                                                  ~ak_sk.1, ~ssk_nms.1, ~tid.1
                                         ) ▶₀ #t2.5 )
                                    case outTPMPCRExtendswstate_0_1111111111111211
                                    solve( Insert( <'authPolicy', ~k_h>,
                                                   <<swstate, nil>, 'TPM_CC_PolicyPCR', nil>
                                           ) @ #t2.5 )
                                      case insertauthPolicykhauthPolicy_0_11111111111111111111112111111
                                      solve( state_11111111111111111111112111111( ~RouterID.1, ~ServerID.1,
                                                                                  ~ak_h.1, ~ak_sk.1, ~k_h,
                                                                                  ~k_sk.1, ~ssk_nms.1,
                                                                                  <<swstate, nil>, 
                                                                                   'TPM_CC_PolicyPCR', nil>,
                                                                                  lock
                                             ) ▶₀ #t2.5 )
                                        case lockdevice_0_1111111111111111111111211111
                                        by contradiction /* cyclic */
                                      qed
                                    qed
                                  qed
                                qed
                              next
                                case outtlsspkskaecsr_0_11111111111112111111111111111111111111
                                solve( (#vr.79 < #vr.51)  ∥ (#t2.1 < #vr.79) )
                                  case case_1
                                  solve( TPM_SendCommand( <'TPM2_Sign', k_sh, k_h.1, m> ) @ #t2.7 )
                                    case eventTPMSendCommandTPMSigntlsshtlshtlsspkskae_0_111111111111121111111111111111111
                                    solve( state_111111111111121111111111111111111( ~RouterID.1, ~ServerID.1,
                                                                                    ~ak_h.1, ~ak_sk.1,
                                                                                    ~ssk_nms.1, ~tid.1, skae,
                                                                                    k_h.1, k_sh, tls_spk
                                           ) ▶₀ #t2.5 )
                                      case ifverifyskaetlsspkswstatenilTPMCCPolicyPCRnilpkaksktrue_0_11111111111112111111111111111111
                                      by contradiction /* cyclic */
                                    qed
                                  qed
                                next
                                  case case_2
                                  solve( ((#vr.25 < #vr.79) ∧
                                          (∃ #t2.
                                            (Unlock_4( '4', ~n.1, 'device' ) @ #t2)
                                           ∧
                                            (#vr.25 < #t2) ∧
                                            (#t2 < #vr.79) ∧
                                            (∀ #t0 pp. (Unlock( pp, ~n.1, 'device' ) @ #t0) ⇒ #t0 = #t2) ∧
                                            (∀ pp lpp #t0.
                                              (Lock( pp, lpp, 'device' ) @ #t0)
                                             ⇒
                                              ((#t0 < #vr.25) ∨ (#t0 = #vr.25) ∨ (#t2 < #t0))) ∧
                                            (∀ pp lpp #t0.
                                              (Unlock( pp, lpp, 'device' ) @ #t0)
                                             ⇒
                                              ((#t0 < #vr.25) ∨ (#t2 < #t0) ∨ (#t2 = #t0)))))  ∥
                                         (#vr.79 < #vr.25) )
                                    case case_1
                                    solve( TPM_SendCommand( <'TPM2_Sign', k_sh, k_h.1, m> ) @ #t2.7 )
                                      case eventTPMSendCommandTPMSigntlsshtlshtlsspkskae_0_111111111111121111111111111111111
                                      solve( state_111111111111121111111111111111111( ~RouterID.1,
                                                                                      ~ServerID.1, ~ak_h.1,
                                                                                      ~ak_sk.1, ~ssk_nms.1,
                                                                                      ~tid.1, skae, k_h.1,
                                                                                      k_sh, tls_spk
                                             ) ▶₀ #t2.5 )
                                        case ifverifyskaetlsspkswstatenilTPMCCPolicyPCRnilpkaksktrue_0_11111111111112111111111111111111
                                        by contradiction /* cyclic */
                                      qed
                                    qed
                                  next
                                    case case_2
                                    solve( TPM_SendCommand( <'TPM2_Sign', k_sh, k_h.1, m> ) @ #t2.7 )
                                      case eventTPMSendCommandTPMSigntlsshtlshtlsspkskae_0_111111111111121111111111111111111
                                      solve( state_111111111111121111111111111111111( ~RouterID.1,
                                                                                      ~ServerID.1, ~ak_h.1,
                                                                                      ~ak_sk.1, ~ssk_nms.1,
                                                                                      ~tid.1, skae, k_h.1,
                                                                                      k_sh, tls_spk
                                             ) ▶₀ #t2.5 )
                                        case ifverifyskaetlsspkswstatenilTPMCCPolicyPCRnilpkaksktrue_0_11111111111112111111111111111111
                                        by contradiction /* cyclic */
                                      qed
                                    qed
                                  qed
                                qed
                              qed
                            qed
                          qed
                        next
                          case outsignobjpkobjapask_0_11111111111111111111211111111
                          solve( ((#vr.25 < #vr.68) ∧
                                  (∃ #t2.
                                    (Unlock_4( '4', ~n.1, 'device' ) @ #t2)
                                   ∧
                                    (#vr.25 < #t2) ∧
                                    (#t2 < #vr.68) ∧
                                    (∀ #t0 pp. (Unlock( pp, ~n.1, 'device' ) @ #t0) ⇒ #t0 = #t2) ∧
                                    (∀ pp lpp #t0.
                                      (Lock( pp, lpp, 'device' ) @ #t0)
                                     ⇒
                                      ((#t0 < #vr.25) ∨ (#t0 = #vr.25) ∨ (#t2 < #t0))) ∧
                                    (∀ pp lpp #t0.
                                      (Unlock( pp, lpp, 'device' ) @ #t0)
                                     ⇒
                                      ((#t0 < #vr.25) ∨ (#t2 < #t0) ∨ (#t2 = #t0)))))  ∥
                                 (#vr.68 < #vr.25)  ∥ (#vr.25 = #vr.68) )
                            case case_1
                            solve( TPM_SendCommand( <'TPM2_Certify', obj_sh.1, obj_h, a_h>
                                   ) @ #t2.7 )
                              case eventTPMSendCommandTPMCertifytlsshtlshakh_0_111111111111121111111111111
                              by solve( state_111111111111121111111111111( ~RouterID.1, ~ServerID.1,
                                                                           ~ak_h.1, ~ak_sk.1, ~ssk_nms.1,
                                                                           ~tid.1, obj_h, obj_sh.1, tls_spk
                                        ) ▶₀ #t2.5 )
                            qed
                          next
                            case case_2
                            solve( (#vr.68 < #vr.51)  ∥ (#t2.1 < #vr.68) )
                              case case_1
                              solve( TPM_SendCommand( <'TPM2_Certify', obj_sh.1, obj_h, a_h>
                                     ) @ #t2.7 )
                                case eventTPMSendCommandTPMCertifytlsshtlshakh_0_111111111111121111111111111
                                by solve( state_111111111111121111111111111( ~RouterID.1, ~ServerID.1,
                                                                             ~ak_h.1, ~ak_sk.1, ~ssk_nms.1,
                                                                             ~tid.1, obj_h, obj_sh.1, tls_spk
                                          ) ▶₀ #t2.5 )
                              qed
                            next
                              case case_2
                              solve( TPM_SendCommand( <'TPM2_Certify', obj_sh.1, obj_h, a_h>
                                     ) @ #t2.7 )
                                case eventTPMSendCommandTPMCertifytlsshtlshakh_0_111111111111121111111111111
                                by solve( state_111111111111121111111111111( ~RouterID.1, ~ServerID.1,
                                                                             ~ak_h.1, ~ak_sk.1, ~ssk_nms.1,
                                                                             ~tid.1, obj_h, obj_sh.1, tls_spk
                                          ) ▶₀ #t2.5 )
                              qed
                            qed
                          qed
                        next
                          case outtlsspkskaecsr_0_11111111111112111111111111111111111111
                          by contradiction /* from formulas */
                        qed
                      qed
                    qed
                  qed
                qed
              qed
            qed
          next
            case case_2
            solve( (#vr.34 < #t2.4)  ∥ (#vr.34 = #t2.4) )
              case case_1
              solve( state_111111111111111111111121111111111( ~RouterID.1, ~ServerID.1,
                                                              ~ak_h.1, ~ak_sk.1, ~k_h.1, ~k_sk.1, ~ssk_nms.1,
                                                              authPolicy, ~n
                     ) ▶₀ #t2.1 )
                case TpmCreateOutkhpkksk_0_11111111111111111111112111111111
                solve( TPM_SendCommand( <'TPM2_Create', authPolicy> ) @ #t2.6 )
                  case eventTPMSendCommandTPMCreateswstatenilTPMCCPolicyPCRnil_0_11111111111112111
                  solve( state_11111111111112111( ~RouterID.1, ~ServerID.1, ~ak_h.1,
                                                  ~ak_sk.1, ~ssk_nms.1, ~tid.1
                         ) ▶₀ #t2.4 )
                    case outTPMPCRExtendswstate_0_1111111111111211
                    solve( TPM_SendCommand( <'TPM2_Create', <swstate, nil>, 
                                             'TPM_CC_PolicyPCR', nil>
                           ) @ #t2.7 )
                      case eventTPMSendCommandTPMCreateswstatenilTPMCCPolicyPCRnil_0_11111111111112111
                      solve( state_11111111111112111( ~RouterID.1, ~ServerID.1, ~ak_h.1,
                                                      ~ak_sk.1, ~ssk_nms.1, ~tid.1
                             ) ▶₀ #t2.5 )
                        case outTPMPCRExtendswstate_0_1111111111111211
                        solve( !KU( sign(<pk(x), 
                                          sign(<pk(x), <swstate, nil>, 'TPM_CC_PolicyPCR', nil>, ~ak_sk)>,
                                         x)
                               ) @ #vk.4 )
                          case c_sign
                          solve( Insert( <'privatePart', ~ak_h>, ~ak_sk ) @ #t2.5 )
                            case insertprivatePartakhaksk_0_111111111111111
                            solve( state_111111111111111( ~RouterID.1, ~ServerID.1, ~ak_h, ~ak_sk,
                                                          ~ssk_nms.1
                                   ) ▶₀ #t2.5 )
                              case insertauthPolicyakhnil_0_11111111111111
                              by contradiction /* cyclic */
                            qed
                          next
                            case insertprivatePartkhksk_0_111111111111111111111121111111
                            by solve( state_111111111111111111111121111111( ~RouterID.1, ~ServerID.1,
                                                                            ~ak_h.1, ~ak_sk.1, ~ak_h, ~ak_sk,
                                                                            ~ssk_nms.1, authPolicy, lock
                                      ) ▶₀ #t2.5 )
                          qed
                        next
                          case outsignobjpkobjapask_0_11111111111111111111211111111
                          solve( ((#vr.25 < #vr.68) ∧
                                  (∃ #t2.
                                    (Unlock_4( '4', ~n.1, 'device' ) @ #t2)
                                   ∧
                                    (#vr.25 < #t2) ∧
                                    (#t2 < #vr.68) ∧
                                    (∀ #t0 pp. (Unlock( pp, ~n.1, 'device' ) @ #t0) ⇒ #t0 = #t2) ∧
                                    (∀ pp lpp #t0.
                                      (Lock( pp, lpp, 'device' ) @ #t0)
                                     ⇒
                                      ((#t0 < #vr.25) ∨ (#t0 = #vr.25) ∨ (#t2 < #t0))) ∧
                                    (∀ pp lpp #t0.
                                      (Unlock( pp, lpp, 'device' ) @ #t0)
                                     ⇒
                                      ((#t0 < #vr.25) ∨ (#t2 < #t0) ∨ (#t2 = #t0)))))  ∥
                                 (#vr.68 < #vr.25)  ∥ (#vr.25 = #vr.68) )
                            case case_1
                            solve( TPM_SendCommand( <'TPM2_Certify', obj_sh.1, obj_h, a_h>
                                   ) @ #t2.7 )
                              case eventTPMSendCommandTPMCertifytlsshtlshakh_0_111111111111121111111111111
                              by solve( state_111111111111121111111111111( ~RouterID.1, ~ServerID.1,
                                                                           ~ak_h.1, ~ak_sk.1, ~ssk_nms.1,
                                                                           ~tid.1, obj_h, obj_sh.1, tls_spk
                                        ) ▶₀ #t2.5 )
                            qed
                          next
                            case case_2
                            solve( (#vr.68 < #vr.51)  ∥ (#t2.1 < #vr.68) )
                              case case_1
                              solve( TPM_SendCommand( <'TPM2_Certify', obj_sh.1, obj_h, a_h>
                                     ) @ #t2.7 )
                                case eventTPMSendCommandTPMCertifytlsshtlshakh_0_111111111111121111111111111
                                by solve( state_111111111111121111111111111( ~RouterID.1, ~ServerID.1,
                                                                             ~ak_h.1, ~ak_sk.1, ~ssk_nms.1,
                                                                             ~tid.1, obj_h, obj_sh.1, tls_spk
                                          ) ▶₀ #t2.5 )
                              qed
                            next
                              case case_2
                              solve( TPM_SendCommand( <'TPM2_Certify', obj_sh.1, obj_h, a_h>
                                     ) @ #t2.7 )
                                case eventTPMSendCommandTPMCertifytlsshtlshakh_0_111111111111121111111111111
                                by solve( state_111111111111121111111111111( ~RouterID.1, ~ServerID.1,
                                                                             ~ak_h.1, ~ak_sk.1, ~ssk_nms.1,
                                                                             ~tid.1, obj_h, obj_sh.1, tls_spk
                                          ) ▶₀ #t2.5 )
                              qed
                            qed
                          qed
                        next
                          case outtlsspkskaecsr_0_11111111111112111111111111111111111111
                          by contradiction /* from formulas */
                        qed
                      qed
                    qed
                  qed
                qed
              qed
            next
              case case_2
              solve( state_111111111111111111111121111111111( ~RouterID.1, ~ServerID.1,
                                                              ~ak_h.1, ~ak_sk.1, ~k_h.1, ~k_sk.1, ~ssk_nms.1,
                                                              authPolicy, ~n
                     ) ▶₀ #t2.1 )
                case TpmCreateOutkhpkksk_0_11111111111111111111112111111111
                solve( TPM_SendCommand( <'TPM2_Create', authPolicy> ) @ #t2.6 )
                  case eventTPMSendCommandTPMCreateswstatenilTPMCCPolicyPCRnil_0_11111111111112111
                  solve( state_11111111111112111( ~RouterID.1, ~ServerID.1, ~ak_h.1,
                                                  ~ak_sk.1, ~ssk_nms.1, ~tid.1
                         ) ▶₀ #t2.5 )
                    case outTPMPCRExtendswstate_0_1111111111111211
                    solve( TPM_SendCommand( <'TPM2_Create', <swstate, nil>, 
                                             'TPM_CC_PolicyPCR', nil>
                           ) @ #t2.7 )
                      case eventTPMSendCommandTPMCreateswstatenilTPMCCPolicyPCRnil_0_11111111111112111
                      solve( state_11111111111112111( ~RouterID.1, ~ServerID.1, ~ak_h.1,
                                                      ~ak_sk.1, ~ssk_nms.1, ~tid.1
                             ) ▶₀ #t2.6 )
                        case outTPMPCRExtendswstate_0_1111111111111211
                        solve( !KU( sign(<pk(x), 
                                          sign(<pk(x), <swstate, nil>, 'TPM_CC_PolicyPCR', nil>, ~ak_sk)>,
                                         x)
                               ) @ #vk.4 )
                          case c_sign
                          solve( Insert( <'privatePart', ~ak_h>, ~ak_sk ) @ #t2.4 )
                            case insertprivatePartakhaksk_0_111111111111111
                            solve( Insert( <'publicPart', ~k_h>, pk(x) ) @ #t2.2 )
                              case insertpublicPartkhpkksk_0_1111111111111111111111211111111
                              solve( !KU( pk(~k_sk) ) @ #vk.4 )
                                case c_pk
                                solve( Insert( <'authPolicy', ~k_h>,
                                               <<swstate, nil>, 'TPM_CC_PolicyPCR', nil>
                                       ) @ #t2.3 )
                                  case insertauthPolicykhauthPolicy_0_11111111111111111111112111111
                                  solve( Insert( <'policyDigest', obj_sh>,
                                                 <<swstate, nil>, 'TPM_CC_PolicyPCR', nil>
                                         ) @ #t2.6 )
                                    case insertpolicyDigestshpcrLTPMCCPolicyPCRpL_0_111111111111111111111112111111
                                    solve( state_111111111111111111111112111111( ~RouterID.1, ~ServerID.1,
                                                                                 ~ak_h.1, ~ak_sk.1,
                                                                                 ~ssk_nms.1, nil,
                                                                                 <swstate, nil>, obj_sh, lock
                                           ) ▶₀ #t2.6 )
                                      case eventPolicyPCRshpL_0_11111111111111111111111211111
                                      solve( (#vr.64 < #vr.50)  ∥ (#t2.1 < #vr.64) )
                                        case case_1
                                        solve( (#vr.32 < #t2.10)  ∥ (#vr.32 = #t2.10) )
                                          case case_1
                                          solve( state_1111111111111111111111121111111( ~RouterID.1,
                                                                                        ~ServerID.1, ~ak_h.1,
                                                                                        ~ak_sk.1, ~ssk_nms.1,
                                                                                        pL, pcrL, s_h, ~n.1
                                                 ) ▶₀ #t2.7 )
                                            case insertpolicyDigestshpcrLTPMCCPolicyPCRpL_0_111111111111111111111112111111
                                            solve( (#vr.32 < #t2.13)  ∥ (#vr.32 = #t2.13) )
                                              case case_1
                                              solve( (#t2.10 < #t2.13)  ∥ (#t2.10 = #t2.13) )
                                                case case_1
                                                by contradiction /* from formulas */
                                              next
                                                case case_2
                                                solve( (#t2.9 < #t2.12)  ∥ (#t2.9 = #t2.12) )
                                                  case case_1
                                                  by contradiction /* from formulas */
                                                next
                                                  case case_2
                                                  solve( TPM_SendCommand( <'TPM2_PolicyPCR', obj_sh>
                                                         ) @ #t2.8 )
                                                    case eventTPMSendCommandTPMPolicyPCRtlssh_0_1111111111111211111111111
                                                    solve( state_1111111111111211111111111( ~RouterID.1,
                                                                                            ~ServerID.1,
                                                                                            ~ak_h.1, ~ak_sk.1,
                                                                                            ~ssk_nms.1,
                                                                                            ~tid.1, tls_h,
                                                                                            obj_sh, tls_spk
                                                           ) ▶₀ #t2.8 )
                                                      case eventGenerateTLStidtlsspk_0_111111111111121111111111
                                                      by contradiction /* cyclic */
                                                    qed
                                                  qed
                                                qed
                                              qed
                                            next
                                              case case_2
                                              by contradiction /* from formulas */
                                            qed
                                          qed
                                        next
                                          case case_2
                                          solve( state_1111111111111111111111121111111( ~RouterID.1,
                                                                                        ~ServerID.1, ~ak_h.1,
                                                                                        ~ak_sk.1, ~ssk_nms.1,
                                                                                        pL, pcrL, s_h, ~n.1
                                                 ) ▶₀ #t2.7 )
                                            case insertpolicyDigestshpcrLTPMCCPolicyPCRpL_0_111111111111111111111112111111
                                            solve( (#t2.8 < #t2.13)  ∥ (#t2.8 = #t2.13) )
                                              case case_1
                                              by contradiction /* from formulas */
                                            next
                                              case case_2
                                              solve( (#t2.10 < #t2.12)  ∥ (#t2.10 = #t2.12) )
                                                case case_1
                                                by contradiction /* from formulas */
                                              next
                                                case case_2
                                                solve( TPM_SendCommand( <'TPM2_PolicyPCR', obj_sh> ) @ #t2.9 )
                                                  case eventTPMSendCommandTPMPolicyPCRtlssh_0_1111111111111211111111111
                                                  solve( state_1111111111111211111111111( ~RouterID.1,
                                                                                          ~ServerID.1,
                                                                                          ~ak_h.1, ~ak_sk.1,
                                                                                          ~ssk_nms.1, ~tid.1,
                                                                                          tls_h, obj_sh,
                                                                                          tls_spk
                                                         ) ▶₀ #t2.9 )
                                                    case eventGenerateTLStidtlsspk_0_111111111111121111111111
                                                    by contradiction /* cyclic */
                                                  qed
                                                qed
                                              qed
                                            qed
                                          qed
                                        qed
                                      next
                                        case case_2
                                        solve( ((#vr.25 < #vr.64) ∧
                                                (∃ #t2.
                                                  (Unlock_4( '4', ~n.2, 'device' ) @ #t2)
                                                 ∧
                                                  (#vr.25 < #t2) ∧
                                                  (#t2 < #vr.64) ∧
                                                  (∀ #t0 pp.
                                                    (Unlock( pp, ~n.2, 'device' ) @ #t0) ⇒ #t0 = #t2) ∧
                                                  (∀ pp lpp #t0.
                                                    (Lock( pp, lpp, 'device' ) @ #t0)
                                                   ⇒
                                                    ((#t0 < #vr.25) ∨ (#t0 = #vr.25) ∨ (#t2 < #t0))) ∧
                                                  (∀ pp lpp #t0.
                                                    (Unlock( pp, lpp, 'device' ) @ #t0)
                                                   ⇒
                                                    ((#t0 < #vr.25) ∨ (#t2 < #t0) ∨ (#t2 = #t0)))))  ∥
                                               (#vr.64 < #vr.25) )
                                          case case_1
                                          solve( (#vr.32 < #t2.9)  ∥ (#vr.32 = #t2.9) )
                                            case case_1
                                            solve( TPM_SendCommand( <'TPM2_PolicyPCR', obj_sh> ) @ #t2.7 )
                                              case eventTPMSendCommandTPMPolicyPCRtlssh_0_1111111111111211111111111
                                              solve( state_1111111111111211111111111( ~RouterID.1,
                                                                                      ~ServerID.1, ~ak_h.1,
                                                                                      ~ak_sk.1, ~ssk_nms.1,
                                                                                      ~tid.1, tls_h, obj_sh,
                                                                                      tls_spk
                                                     ) ▶₀ #t2.7 )
                                                case eventGenerateTLStidtlsspk_0_111111111111121111111111
                                                solve( Unlock_4( '4', ~n.2, 'device' ) @ #t2.10 )
                                                  case unlockdevice_0_111111111111111111112111111111
                                                  solve( state_111111111111111111112111111111( ~RouterID.1,
                                                                                               ~ServerID.1,
                                                                                               ~ak_h.1,
                                                                                               ~ak_sk.1,
                                                                                               ~ssk_nms.1,
                                                                                               a_h, a_sk,
                                                                                               obj_ap, obj_h,
                                                                                               obj_pd, obj_pk,
                                                                                               obj_sh.1, ~n.2
                                                         ) ▶₀ #t2.8 )
                                                    case outsignobjpkobjapask_0_11111111111111111111211111111
                                                    by contradiction /* cyclic */
                                                  qed
                                                next
                                                  case unlockdevice_0_11111111111111111111211111112
                                                  by solve( state_11111111111111111111211111112( ~RouterID.1,
                                                                                                 ~ServerID.1,
                                                                                                 ~ak_h.1,
                                                                                                 ~ak_sk.1,
                                                                                                 ~ssk_nms.1,
                                                                                                 a_h, obj_ap,
                                                                                                 obj_h,
                                                                                                 obj_pd,
                                                                                                 obj_pk,
                                                                                                 obj_sh.1,
                                                                                                 ~n.2
                                                            ) ▶₀ #t2.8 )
                                                qed
                                              qed
                                            qed
                                          next
                                            case case_2
                                            solve( TPM_SendCommand( <'TPM2_PolicyPCR', obj_sh> ) @ #t2.8 )
                                              case eventTPMSendCommandTPMPolicyPCRtlssh_0_1111111111111211111111111
                                              solve( state_1111111111111211111111111( ~RouterID.1,
                                                                                      ~ServerID.1, ~ak_h.1,
                                                                                      ~ak_sk.1, ~ssk_nms.1,
                                                                                      ~tid.1, tls_h, obj_sh,
                                                                                      tls_spk
                                                     ) ▶₀ #t2.8 )
                                                case eventGenerateTLStidtlsspk_0_111111111111121111111111
                                                solve( Unlock_4( '4', ~n.2, 'device' ) @ #t2.10 )
                                                  case unlockdevice_0_111111111111111111112111111111
                                                  solve( state_111111111111111111112111111111( ~RouterID.1,
                                                                                               ~ServerID.1,
                                                                                               ~ak_h.1,
                                                                                               ~ak_sk.1,
                                                                                               ~ssk_nms.1,
                                                                                               a_h, a_sk,
                                                                                               obj_ap, obj_h,
                                                                                               obj_pd, obj_pk,
                                                                                               obj_sh.1, ~n.2
                                                         ) ▶₀ #t2.9 )
                                                    case outsignobjpkobjapask_0_11111111111111111111211111111
                                                    by contradiction /* cyclic */
                                                  qed
                                                next
                                                  case unlockdevice_0_11111111111111111111211111112
                                                  by solve( state_11111111111111111111211111112( ~RouterID.1,
                                                                                                 ~ServerID.1,
                                                                                                 ~ak_h.1,
                                                                                                 ~ak_sk.1,
                                                                                                 ~ssk_nms.1,
                                                                                                 a_h, obj_ap,
                                                                                                 obj_h,
                                                                                                 obj_pd,
                                                                                                 obj_pk,
                                                                                                 obj_sh.1,
                                                                                                 ~n.2
                                                            ) ▶₀ #t2.9 )
                                                qed
                                              qed
                                            qed
                                          qed
                                        next
                                          case case_2
                                          solve( (#vr.32 < #t2.10)  ∥ (#vr.32 = #t2.10) )
                                            case case_1
                                            solve( state_1111111111111111111111121111111( ~RouterID.1,
                                                                                          ~ServerID.1,
                                                                                          ~ak_h.1, ~ak_sk.1,
                                                                                          ~ssk_nms.1, pL,
                                                                                          pcrL, s_h, ~n.1
                                                   ) ▶₀ #t2.7 )
                                              case insertpolicyDigestshpcrLTPMCCPolicyPCRpL_0_111111111111111111111112111111
                                              solve( (#vr.32 < #t2.13)  ∥ (#vr.32 = #t2.13) )
                                                case case_1
                                                solve( (#t2.10 < #t2.13)  ∥ (#t2.10 = #t2.13) )
                                                  case case_1
                                                  by contradiction /* from formulas */
                                                next
                                                  case case_2
                                                  solve( (#t2.9 < #t2.12)  ∥ (#t2.9 = #t2.12) )
                                                    case case_1
                                                    by contradiction /* from formulas */
                                                  next
                                                    case case_2
                                                    solve( TPM_SendCommand( <'TPM2_PolicyPCR', obj_sh>
                                                           ) @ #t2.8 )
                                                      case eventTPMSendCommandTPMPolicyPCRtlssh_0_1111111111111211111111111
                                                      solve( state_1111111111111211111111111( ~RouterID.1,
                                                                                              ~ServerID.1,
                                                                                              ~ak_h.1,
                                                                                              ~ak_sk.1,
                                                                                              ~ssk_nms.1,
                                                                                              ~tid.1, tls_h,
                                                                                              obj_sh, tls_spk
                                                             ) ▶₀ #t2.8 )
                                                        case eventGenerateTLStidtlsspk_0_111111111111121111111111
                                                        solve( TPM_SendCommand( <'TPM2_PolicyPCR', obj_sh>
                                                               ) @ #t2.11 )
                                                          case eventTPMSendCommandTPMPolicyPCRtlssh_0_1111111111111211111111111
                                                          solve( state_1111111111111211111111111( ~RouterID.1,
                                                                                                  ~ServerID.1,
                                                                                                  ~ak_h.1,
                                                                                                  ~ak_sk.1,
                                                                                                  ~ssk_nms.1,
                                                                                                  ~tid.1,
                                                                                                  tls_h,
                                                                                                  obj_sh,
                                                                                                  tls_spk
                                                                 ) ▶₀ #t2.9 )
                                                            case eventGenerateTLStidtlsspk_0_111111111111121111111111
                                                            solve( TPM_SendCommand( <'TPM2_Create', 
                                                                                     <swstate, nil>, 
                                                                                     'TPM_CC_PolicyPCR', nil>
                                                                   ) @ #t2.11 )
                                                              case eventTPMSendCommandTPMCreateswstatenilTPMCCPolicyPCRnil_0_11111111111112111
                                                              solve( state_11111111111112111( ~RouterID.1,
                                                                                              ~ServerID.1,
                                                                                              ~ak_h.1,
                                                                                              ~ak_sk.1,
                                                                                              ~ssk_nms.1,
                                                                                              ~tid.1
                                                                     ) ▶₀ #t2.9 )
                                                                case outTPMPCRExtendswstate_0_1111111111111211
                                                                solve( TPM_SendCommand( <'TPM2_Create', 
                                                                                         <swstate, nil>, 
                                                                                         'TPM_CC_PolicyPCR', 
                                                                                         nil>
                                                                       ) @ #t2.11 )
                                                                  case eventTPMSendCommandTPMCreateswstatenilTPMCCPolicyPCRnil_0_11111111111112111
                                                                  solve( state_11111111111112111( ~RouterID.1,
                                                                                                  ~ServerID.1,
                                                                                                  ~ak_h.1,
                                                                                                  ~ak_sk.1,
                                                                                                  ~ssk_nms.1,
                                                                                                  ~tid.1
                                                                         ) ▶₀ #t2.9 )
                                                                    case outTPMPCRExtendswstate_0_1111111111111211
                                                                    solve( !KU( ~k_h ) @ #vk.11 )
                                                                      case outTPMCertifytlsshtlshakh_0_1111111111111211111111111111
                                                                      solve( TPM_SendCommand( <'TPM2_Create', 
                                                                                               <swstate, nil
                                                                                               >, 
                                                                                               'TPM_CC_PolicyPCR', 
                                                                                               nil>
                                                                             ) @ #t2.11 )
                                                                        case eventTPMSendCommandTPMCreateswstatenilTPMCCPolicyPCRnil_0_11111111111112111
                                                                        solve( state_11111111111112111( ~RouterID.1,
                                                                                                        ~ServerID.1,
                                                                                                        ~ak_h.1,
                                                                                                        ~ak_sk.1,
                                                                                                        ~ssk_nms.1,
                                                                                                        ~tid.1
                                                                               ) ▶₀ #t2.9 )
                                                                          case outTPMPCRExtendswstate_0_1111111111111211
                                                                          by solve( !KU( ~k_sk ) @ #vk.21 )
                                                                        qed
                                                                      qed
                                                                    next
                                                                      case outTPMSigntlsshtlshtlsspkskae_0_1111111111111211111111111111111111
                                                                      by contradiction /* cyclic */
                                                                    qed
                                                                  qed
                                                                qed
                                                              qed
                                                            qed
                                                          qed
                                                        qed
                                                      qed
                                                    qed
                                                  qed
                                                qed
                                              next
                                                case case_2
                                                by contradiction /* from formulas */
                                              qed
                                            qed
                                          next
                                            case case_2
                                            solve( state_1111111111111111111111121111111( ~RouterID.1,
                                                                                          ~ServerID.1,
                                                                                          ~ak_h.1, ~ak_sk.1,
                                                                                          ~ssk_nms.1, pL,
                                                                                          pcrL, s_h, ~n.1
                                                   ) ▶₀ #t2.7 )
                                              case insertpolicyDigestshpcrLTPMCCPolicyPCRpL_0_111111111111111111111112111111
                                              solve( (#t2.8 < #t2.13)  ∥ (#t2.8 = #t2.13) )
                                                case case_1
                                                by contradiction /* from formulas */
                                              next
                                                case case_2
                                                solve( (#t2.10 < #t2.12)  ∥ (#t2.10 = #t2.12) )
                                                  case case_1
                                                  by contradiction /* from formulas */
                                                next
                                                  case case_2
                                                  solve( TPM_SendCommand( <'TPM2_PolicyPCR', obj_sh>
                                                         ) @ #t2.9 )
                                                    case eventTPMSendCommandTPMPolicyPCRtlssh_0_1111111111111211111111111
                                                    solve( state_1111111111111211111111111( ~RouterID.1,
                                                                                            ~ServerID.1,
                                                                                            ~ak_h.1, ~ak_sk.1,
                                                                                            ~ssk_nms.1,
                                                                                            ~tid.1, tls_h,
                                                                                            obj_sh, tls_spk
                                                           ) ▶₀ #t2.9 )
                                                      case eventGenerateTLStidtlsspk_0_111111111111121111111111
                                                      solve( TPM_SendCommand( <'TPM2_PolicyPCR', obj_sh>
                                                             ) @ #t2.11 )
                                                        case eventTPMSendCommandTPMPolicyPCRtlssh_0_1111111111111211111111111
                                                        solve( state_1111111111111211111111111( ~RouterID.1,
                                                                                                ~ServerID.1,
                                                                                                ~ak_h.1,
                                                                                                ~ak_sk.1,
                                                                                                ~ssk_nms.1,
                                                                                                ~tid.1, tls_h,
                                                                                                obj_sh,
                                                                                                tls_spk
                                                               ) ▶₀ #t2.10 )
                                                          case eventGenerateTLStidtlsspk_0_111111111111121111111111
                                                          solve( TPM_SendCommand( <'TPM2_Create', 
                                                                                   <swstate, nil>, 
                                                                                   'TPM_CC_PolicyPCR', nil>
                                                                 ) @ #t2.11 )
                                                            case eventTPMSendCommandTPMCreateswstatenilTPMCCPolicyPCRnil_0_11111111111112111
                                                            solve( state_11111111111112111( ~RouterID.1,
                                                                                            ~ServerID.1,
                                                                                            ~ak_h.1, ~ak_sk.1,
                                                                                            ~ssk_nms.1, ~tid.1
                                                                   ) ▶₀ #t2.10 )
                                                              case outTPMPCRExtendswstate_0_1111111111111211
                                                              solve( TPM_SendCommand( <'TPM2_Create', 
                                                                                       <swstate, nil>, 
                                                                                       'TPM_CC_PolicyPCR', nil
                                                                                      >
                                                                     ) @ #t2.11 )
                                                                case eventTPMSendCommandTPMCreateswstatenilTPMCCPolicyPCRnil_0_11111111111112111
                                                                solve( state_11111111111112111( ~RouterID.1,
                                                                                                ~ServerID.1,
                                                                                                ~ak_h.1,
                                                                                                ~ak_sk.1,
                                                                                                ~ssk_nms.1,
                                                                                                ~tid.1
                                                                       ) ▶₀ #t2.10 )
                                                                  case outTPMPCRExtendswstate_0_1111111111111211
                                                                  solve( !KU( ~k_h ) @ #vk.11 )
                                                                    case outTPMCertifytlsshtlshakh_0_1111111111111211111111111111
                                                                    solve( TPM_SendCommand( <'TPM2_Create', 
                                                                                             <swstate, nil>, 
                                                                                             'TPM_CC_PolicyPCR', 
                                                                                             nil>
                                                                           ) @ #t2.11 )
                                                                      case eventTPMSendCommandTPMCreateswstatenilTPMCCPolicyPCRnil_0_11111111111112111
                                                                      solve( state_11111111111112111( ~RouterID.1,
                                                                                                      ~ServerID.1,
                                                                                                      ~ak_h.1,
                                                                                                      ~ak_sk.1,
                                                                                                      ~ssk_nms.1,
                                                                                                      ~tid.1
                                                                             ) ▶₀ #t2.10 )
                                                                        case outTPMPCRExtendswstate_0_1111111111111211
                                                                        by solve( !KU( ~k_sk ) @ #vk.21 )
                                                                      qed
                                                                    qed
                                                                  next
                                                                    case outTPMSigntlsshtlshtlsspkskae_0_1111111111111211111111111111111111
                                                                    by contradiction /* cyclic */
                                                                  qed
                                                                qed
                                                              qed
                                                            qed
                                                          qed
                                                        qed
                                                      qed
                                                    qed
                                                  qed
                                                qed
                                              qed
                                            qed
                                          qed
                                        qed
                                      qed
                                    qed
                                  qed
                                qed
                              next
                                case outTPMSigntlsshtlshtlsspkskae_0_1111111111111211111111111111111111
                                solve( TPM_SendCommand( <'TPM2_Create', <swstate, nil>, 
                                                         'TPM_CC_PolicyPCR', nil>
                                       ) @ #t2.7 )
                                  case eventTPMSendCommandTPMCreateswstatenilTPMCCPolicyPCRnil_0_11111111111112111
                                  solve( state_11111111111112111( ~RouterID.1, ~ServerID.1, ~ak_h.1,
                                                                  ~ak_sk.1, ~ssk_nms.1, ~tid.1
                                         ) ▶₀ #t2.6 )
                                    case outTPMPCRExtendswstate_0_1111111111111211
                                    solve( Insert( <'authPolicy', ~k_h>,
                                                   <<swstate, nil>, 'TPM_CC_PolicyPCR', nil>
                                           ) @ #t2.3 )
                                      case insertauthPolicykhauthPolicy_0_11111111111111111111112111111
                                      solve( Insert( <'policyDigest', obj_sh>,
                                                     <<swstate, nil>, 'TPM_CC_PolicyPCR', nil>
                                             ) @ #t2.6 )
                                        case insertpolicyDigestshpcrLTPMCCPolicyPCRpL_0_111111111111111111111112111111
                                        solve( state_111111111111111111111112111111( ~RouterID.1, ~ServerID.1,
                                                                                     ~ak_h.1, ~ak_sk.1,
                                                                                     ~ssk_nms.1, nil,
                                                                                     <swstate, nil>, obj_sh,
                                                                                     lock
                                               ) ▶₀ #t2.6 )
                                          case eventPolicyPCRshpL_0_11111111111111111111111211111
                                          solve( (#vr.75 < #vr.50)  ∥ (#t2.1 < #vr.75) )
                                            case case_1
                                            solve( (#vr.32 < #t2.10)  ∥ (#vr.32 = #t2.10) )
                                              case case_1
                                              solve( state_1111111111111111111111121111111( ~RouterID.1,
                                                                                            ~ServerID.1,
                                                                                            ~ak_h.1, ~ak_sk.1,
                                                                                            ~ssk_nms.1, pL,
                                                                                            pcrL, s_h, ~n.1
                                                     ) ▶₀ #t2.7 )
                                                case insertpolicyDigestshpcrLTPMCCPolicyPCRpL_0_111111111111111111111112111111
                                                solve( (#vr.32 < #t2.13)  ∥ (#vr.32 = #t2.13) )
                                                  case case_1
                                                  solve( (#t2.10 < #t2.13)  ∥ (#t2.10 = #t2.13) )
                                                    case case_1
                                                    by contradiction /* from formulas */
                                                  next
                                                    case case_2
                                                    solve( (#t2.9 < #t2.12)  ∥ (#t2.9 = #t2.12) )
                                                      case case_1
                                                      by contradiction /* from formulas */
                                                    next
                                                      case case_2
                                                      solve( TPM_SendCommand( <'TPM2_PolicyPCR', obj_sh>
                                                             ) @ #t2.8 )
                                                        case eventTPMSendCommandTPMPolicyPCRtlssh_0_1111111111111211111111111
                                                        solve( state_1111111111111211111111111( ~RouterID.1,
                                                                                                ~ServerID.1,
                                                                                                ~ak_h.1,
                                                                                                ~ak_sk.1,
                                                                                                ~ssk_nms.1,
                                                                                                ~tid.1, tls_h,
                                                                                                obj_sh,
                                                                                                tls_spk
                                                               ) ▶₀ #t2.8 )
                                                          case eventGenerateTLStidtlsspk_0_111111111111121111111111
                                                          by contradiction /* cyclic */
                                                        qed
                                                      qed
                                                    qed
                                                  qed
                                                next
                                                  case case_2
                                                  by contradiction /* from formulas */
                                                qed
                                              qed
                                            next
                                              case case_2
                                              solve( state_1111111111111111111111121111111( ~RouterID.1,
                                                                                            ~ServerID.1,
                                                                                            ~ak_h.1, ~ak_sk.1,
                                                                                            ~ssk_nms.1, pL,
                                                                                            pcrL, s_h, ~n.1
                                                     ) ▶₀ #t2.7 )
                                                case insertpolicyDigestshpcrLTPMCCPolicyPCRpL_0_111111111111111111111112111111
                                                solve( (#t2.8 < #t2.13)  ∥ (#t2.8 = #t2.13) )
                                                  case case_1
                                                  by contradiction /* from formulas */
                                                next
                                                  case case_2
                                                  solve( (#t2.10 < #t2.12)  ∥ (#t2.10 = #t2.12) )
                                                    case case_1
                                                    by contradiction /* from formulas */
                                                  next
                                                    case case_2
                                                    solve( TPM_SendCommand( <'TPM2_PolicyPCR', obj_sh>
                                                           ) @ #t2.9 )
                                                      case eventTPMSendCommandTPMPolicyPCRtlssh_0_1111111111111211111111111
                                                      solve( state_1111111111111211111111111( ~RouterID.1,
                                                                                              ~ServerID.1,
                                                                                              ~ak_h.1,
                                                                                              ~ak_sk.1,
                                                                                              ~ssk_nms.1,
                                                                                              ~tid.1, tls_h,
                                                                                              obj_sh, tls_spk
                                                             ) ▶₀ #t2.9 )
                                                        case eventGenerateTLStidtlsspk_0_111111111111121111111111
                                                        by contradiction /* cyclic */
                                                      qed
                                                    qed
                                                  qed
                                                qed
                                              qed
                                            qed
                                          next
                                            case case_2
                                            solve( ((#vr.25 < #vr.75) ∧
                                                    (∃ #t2.
                                                      (Unlock_4( '4', ~n.2, 'device' ) @ #t2)
                                                     ∧
                                                      (#vr.25 < #t2) ∧
                                                      (#t2 < #vr.75) ∧
                                                      (∀ #t0 pp.
                                                        (Unlock( pp, ~n.2, 'device' ) @ #t0) ⇒ #t0 = #t2) ∧
                                                      (∀ pp lpp #t0.
                                                        (Lock( pp, lpp, 'device' ) @ #t0)
                                                       ⇒
                                                        ((#t0 < #vr.25) ∨ (#t0 = #vr.25) ∨ (#t2 < #t0))) ∧
                                                      (∀ pp lpp #t0.
                                                        (Unlock( pp, lpp, 'device' ) @ #t0)
                                                       ⇒
                                                        ((#t0 < #vr.25) ∨ (#t2 < #t0) ∨ (#t2 = #t0)))))  ∥
                                                   (#vr.75 < #vr.25) )
                                              case case_1
                                              solve( (#vr.32 < #t2.9)  ∥ (#vr.32 = #t2.9) )
                                                case case_1
                                                solve( TPM_SendCommand( <'TPM2_PolicyPCR', obj_sh> ) @ #t2.7 )
                                                  case eventTPMSendCommandTPMPolicyPCRtlssh_0_1111111111111211111111111
                                                  solve( state_1111111111111211111111111( ~RouterID.1,
                                                                                          ~ServerID.1,
                                                                                          ~ak_h.1, ~ak_sk.1,
                                                                                          ~ssk_nms.1, ~tid.1,
                                                                                          tls_h, obj_sh,
                                                                                          tls_spk
                                                         ) ▶₀ #t2.7 )
                                                    case eventGenerateTLStidtlsspk_0_111111111111121111111111
                                                    solve( Unlock_4( '4', ~n.2, 'device' ) @ #t2.10 )
                                                      case unlockdevice_0_111111111111111111112111111111
                                                      solve( state_111111111111111111112111111111( ~RouterID.1,
                                                                                                   ~ServerID.1,
                                                                                                   ~ak_h.1,
                                                                                                   ~ak_sk.1,
                                                                                                   ~ssk_nms.1,
                                                                                                   a_h, a_sk,
                                                                                                   obj_ap,
                                                                                                   obj_h,
                                                                                                   obj_pd,
                                                                                                   obj_pk,
                                                                                                   obj_sh.1,
                                                                                                   ~n.2
                                                             ) ▶₀ #t2.8 )
                                                        case outsignobjpkobjapask_0_11111111111111111111211111111
                                                        by contradiction /* cyclic */
                                                      qed
                                                    next
                                                      case unlockdevice_0_11111111111111111111211111112
                                                      by solve( state_11111111111111111111211111112( ~RouterID.1,
                                                                                                     ~ServerID.1,
                                                                                                     ~ak_h.1,
                                                                                                     ~ak_sk.1,
                                                                                                     ~ssk_nms.1,
                                                                                                     a_h,
                                                                                                     obj_ap,
                                                                                                     obj_h,
                                                                                                     obj_pd,
                                                                                                     obj_pk,
                                                                                                     obj_sh.1,
                                                                                                     ~n.2
                                                                ) ▶₀ #t2.8 )
                                                    qed
                                                  qed
                                                qed
                                              next
                                                case case_2
                                                solve( TPM_SendCommand( <'TPM2_PolicyPCR', obj_sh> ) @ #t2.8 )
                                                  case eventTPMSendCommandTPMPolicyPCRtlssh_0_1111111111111211111111111
                                                  solve( state_1111111111111211111111111( ~RouterID.1,
                                                                                          ~ServerID.1,
                                                                                          ~ak_h.1, ~ak_sk.1,
                                                                                          ~ssk_nms.1, ~tid.1,
                                                                                          tls_h, obj_sh,
                                                                                          tls_spk
                                                         ) ▶₀ #t2.8 )
                                                    case eventGenerateTLStidtlsspk_0_111111111111121111111111
                                                    solve( Unlock_4( '4', ~n.2, 'device' ) @ #t2.10 )
                                                      case unlockdevice_0_111111111111111111112111111111
                                                      solve( state_111111111111111111112111111111( ~RouterID.1,
                                                                                                   ~ServerID.1,
                                                                                                   ~ak_h.1,
                                                                                                   ~ak_sk.1,
                                                                                                   ~ssk_nms.1,
                                                                                                   a_h, a_sk,
                                                                                                   obj_ap,
                                                                                                   obj_h,
                                                                                                   obj_pd,
                                                                                                   obj_pk,
                                                                                                   obj_sh.1,
                                                                                                   ~n.2
                                                             ) ▶₀ #t2.9 )
                                                        case outsignobjpkobjapask_0_11111111111111111111211111111
                                                        by contradiction /* cyclic */
                                                      qed
                                                    next
                                                      case unlockdevice_0_11111111111111111111211111112
                                                      by solve( state_11111111111111111111211111112( ~RouterID.1,
                                                                                                     ~ServerID.1,
                                                                                                     ~ak_h.1,
                                                                                                     ~ak_sk.1,
                                                                                                     ~ssk_nms.1,
                                                                                                     a_h,
                                                                                                     obj_ap,
                                                                                                     obj_h,
                                                                                                     obj_pd,
                                                                                                     obj_pk,
                                                                                                     obj_sh.1,
                                                                                                     ~n.2
                                                                ) ▶₀ #t2.9 )
                                                    qed
                                                  qed
                                                qed
                                              qed
                                            next
                                              case case_2
                                              solve( (#vr.32 < #t2.10)  ∥ (#vr.32 = #t2.10) )
                                                case case_1
                                                solve( state_1111111111111111111111121111111( ~RouterID.1,
                                                                                              ~ServerID.1,
                                                                                              ~ak_h.1,
                                                                                              ~ak_sk.1,
                                                                                              ~ssk_nms.1, pL,
                                                                                              pcrL, s_h, ~n.1
                                                       ) ▶₀ #t2.7 )
                                                  case insertpolicyDigestshpcrLTPMCCPolicyPCRpL_0_111111111111111111111112111111
                                                  solve( (#vr.32 < #t2.13)  ∥ (#vr.32 = #t2.13) )
                                                    case case_1
                                                    solve( (#t2.10 < #t2.13)  ∥ (#t2.10 = #t2.13) )
                                                      case case_1
                                                      by contradiction /* from formulas */
                                                    next
                                                      case case_2
                                                      solve( (#t2.9 < #t2.12)  ∥ (#t2.9 = #t2.12) )
                                                        case case_1
                                                        by contradiction /* from formulas */
                                                      next
                                                        case case_2
                                                        solve( TPM_SendCommand( <'TPM2_PolicyPCR', obj_sh>
                                                               ) @ #t2.8 )
                                                          case eventTPMSendCommandTPMPolicyPCRtlssh_0_1111111111111211111111111
                                                          solve( state_1111111111111211111111111( ~RouterID.1,
                                                                                                  ~ServerID.1,
                                                                                                  ~ak_h.1,
                                                                                                  ~ak_sk.1,
                                                                                                  ~ssk_nms.1,
                                                                                                  ~tid.1,
                                                                                                  tls_h,
                                                                                                  obj_sh,
                                                                                                  tls_spk
                                                                 ) ▶₀ #t2.8 )
                                                            case eventGenerateTLStidtlsspk_0_111111111111121111111111
                                                            solve( TPM_SendCommand( <'TPM2_PolicyPCR', obj_sh>
                                                                   ) @ #t2.11 )
                                                              case eventTPMSendCommandTPMPolicyPCRtlssh_0_1111111111111211111111111
                                                              solve( state_1111111111111211111111111( ~RouterID.1,
                                                                                                      ~ServerID.1,
                                                                                                      ~ak_h.1,
                                                                                                      ~ak_sk.1,
                                                                                                      ~ssk_nms.1,
                                                                                                      ~tid.1,
                                                                                                      tls_h,
                                                                                                      obj_sh,
                                                                                                      tls_spk
                                                                     ) ▶₀ #t2.9 )
                                                                case eventGenerateTLStidtlsspk_0_111111111111121111111111
                                                                solve( TPM_SendCommand( <'TPM2_Create', 
                                                                                         <swstate, nil>, 
                                                                                         'TPM_CC_PolicyPCR', 
                                                                                         nil>
                                                                       ) @ #t2.11 )
                                                                  case eventTPMSendCommandTPMCreateswstatenilTPMCCPolicyPCRnil_0_11111111111112111
                                                                  solve( state_11111111111112111( ~RouterID.1,
                                                                                                  ~ServerID.1,
                                                                                                  ~ak_h.1,
                                                                                                  ~ak_sk.1,
                                                                                                  ~ssk_nms.1,
                                                                                                  ~tid.1
                                                                         ) ▶₀ #t2.9 )
                                                                    case outTPMPCRExtendswstate_0_1111111111111211
                                                                    solve( TPM_SendCommand( <'TPM2_Create', 
                                                                                             <swstate, nil>, 
                                                                                             'TPM_CC_PolicyPCR', 
                                                                                             nil>
                                                                           ) @ #t2.11 )
                                                                      case eventTPMSendCommandTPMCreateswstatenilTPMCCPolicyPCRnil_0_11111111111112111
                                                                      solve( state_11111111111112111( ~RouterID.1,
                                                                                                      ~ServerID.1,
                                                                                                      ~ak_h.1,
                                                                                                      ~ak_sk.1,
                                                                                                      ~ssk_nms.1,
                                                                                                      ~tid.1
                                                                             ) ▶₀ #t2.9 )
                                                                        case outTPMPCRExtendswstate_0_1111111111111211
                                                                        by solve( !KU( ~k_sk ) @ #vk.21 )
                                                                      qed
                                                                    qed
                                                                  qed
                                                                qed
                                                              qed
                                                            qed
                                                          qed
                                                        qed
                                                      qed
                                                    qed
                                                  next
                                                    case case_2
                                                    by contradiction /* from formulas */
                                                  qed
                                                qed
                                              next
                                                case case_2
                                                solve( state_1111111111111111111111121111111( ~RouterID.1,
                                                                                              ~ServerID.1,
                                                                                              ~ak_h.1,
                                                                                              ~ak_sk.1,
                                                                                              ~ssk_nms.1, pL,
                                                                                              pcrL, s_h, ~n.1
                                                       ) ▶₀ #t2.7 )
                                                  case insertpolicyDigestshpcrLTPMCCPolicyPCRpL_0_111111111111111111111112111111
                                                  solve( (#t2.8 < #t2.13)  ∥ (#t2.8 = #t2.13) )
                                                    case case_1
                                                    by contradiction /* from formulas */
                                                  next
                                                    case case_2
                                                    solve( (#t2.10 < #t2.12)  ∥ (#t2.10 = #t2.12) )
                                                      case case_1
                                                      by contradiction /* from formulas */
                                                    next
                                                      case case_2
                                                      solve( TPM_SendCommand( <'TPM2_PolicyPCR', obj_sh>
                                                             ) @ #t2.9 )
                                                        case eventTPMSendCommandTPMPolicyPCRtlssh_0_1111111111111211111111111
                                                        solve( state_1111111111111211111111111( ~RouterID.1,
                                                                                                ~ServerID.1,
                                                                                                ~ak_h.1,
                                                                                                ~ak_sk.1,
                                                                                                ~ssk_nms.1,
                                                                                                ~tid.1, tls_h,
                                                                                                obj_sh,
                                                                                                tls_spk
                                                               ) ▶₀ #t2.9 )
                                                          case eventGenerateTLStidtlsspk_0_111111111111121111111111
                                                          solve( TPM_SendCommand( <'TPM2_PolicyPCR', obj_sh>
                                                                 ) @ #t2.11 )
                                                            case eventTPMSendCommandTPMPolicyPCRtlssh_0_1111111111111211111111111
                                                            solve( state_1111111111111211111111111( ~RouterID.1,
                                                                                                    ~ServerID.1,
                                                                                                    ~ak_h.1,
                                                                                                    ~ak_sk.1,
                                                                                                    ~ssk_nms.1,
                                                                                                    ~tid.1,
                                                                                                    tls_h,
                                                                                                    obj_sh,
                                                                                                    tls_spk
                                                                   ) ▶₀ #t2.10 )
                                                              case eventGenerateTLStidtlsspk_0_111111111111121111111111
                                                              solve( TPM_SendCommand( <'TPM2_Create', 
                                                                                       <swstate, nil>, 
                                                                                       'TPM_CC_PolicyPCR', nil
                                                                                      >
                                                                     ) @ #t2.11 )
                                                                case eventTPMSendCommandTPMCreateswstatenilTPMCCPolicyPCRnil_0_11111111111112111
                                                                solve( state_11111111111112111( ~RouterID.1,
                                                                                                ~ServerID.1,
                                                                                                ~ak_h.1,
                                                                                                ~ak_sk.1,
                                                                                                ~ssk_nms.1,
                                                                                                ~tid.1
                                                                       ) ▶₀ #t2.10 )
                                                                  case outTPMPCRExtendswstate_0_1111111111111211
                                                                  solve( TPM_SendCommand( <'TPM2_Create', 
                                                                                           <swstate, nil>, 
                                                                                           'TPM_CC_PolicyPCR', 
                                                                                           nil>
                                                                         ) @ #t2.11 )
                                                                    case eventTPMSendCommandTPMCreateswstatenilTPMCCPolicyPCRnil_0_11111111111112111
                                                                    solve( state_11111111111112111( ~RouterID.1,
                                                                                                    ~ServerID.1,
                                                                                                    ~ak_h.1,
                                                                                                    ~ak_sk.1,
                                                                                                    ~ssk_nms.1,
                                                                                                    ~tid.1
                                                                           ) ▶₀ #t2.10 )
                                                                      case outTPMPCRExtendswstate_0_1111111111111211
                                                                      by solve( !KU( ~k_sk ) @ #vk.21 )
                                                                    qed
                                                                  qed
                                                                qed
                                                              qed
                                                            qed
                                                          qed
                                                        qed
                                                      qed
                                                    qed
                                                  qed
                                                qed
                                              qed
                                            qed
                                          qed
                                        qed
                                      qed
                                    qed
                                  qed
                                qed
                              next
                                case outtlsspkskaecsr_0_11111111111112111111111111111111111111
                                solve( (#vr.78 < #vr.50)  ∥ (#t2.1 < #vr.78) )
                                  case case_1
                                  solve( TPM_SendCommand( <'TPM2_Sign', k_sh, k_h.1, m> ) @ #t2.7 )
                                    case eventTPMSendCommandTPMSigntlsshtlshtlsspkskae_0_111111111111121111111111111111111
                                    solve( state_111111111111121111111111111111111( ~RouterID.1, ~ServerID.1,
                                                                                    ~ak_h.1, ~ak_sk.1,
                                                                                    ~ssk_nms.1, ~tid.1, skae,
                                                                                    k_h.1, k_sh, tls_spk
                                           ) ▶₀ #t2.6 )
                                      case ifverifyskaetlsspkswstatenilTPMCCPolicyPCRnilpkaksktrue_0_11111111111112111111111111111111
                                      by contradiction /* cyclic */
                                    qed
                                  qed
                                next
                                  case case_2
                                  solve( ((#vr.25 < #vr.78) ∧
                                          (∃ #t2.
                                            (Unlock_4( '4', ~n.1, 'device' ) @ #t2)
                                           ∧
                                            (#vr.25 < #t2) ∧
                                            (#t2 < #vr.78) ∧
                                            (∀ #t0 pp. (Unlock( pp, ~n.1, 'device' ) @ #t0) ⇒ #t0 = #t2) ∧
                                            (∀ pp lpp #t0.
                                              (Lock( pp, lpp, 'device' ) @ #t0)
                                             ⇒
                                              ((#t0 < #vr.25) ∨ (#t0 = #vr.25) ∨ (#t2 < #t0))) ∧
                                            (∀ pp lpp #t0.
                                              (Unlock( pp, lpp, 'device' ) @ #t0)
                                             ⇒
                                              ((#t0 < #vr.25) ∨ (#t2 < #t0) ∨ (#t2 = #t0)))))  ∥
                                         (#vr.78 < #vr.25) )
                                    case case_1
                                    solve( TPM_SendCommand( <'TPM2_Sign', k_sh, k_h.1, m> ) @ #t2.7 )
                                      case eventTPMSendCommandTPMSigntlsshtlshtlsspkskae_0_111111111111121111111111111111111
                                      solve( state_111111111111121111111111111111111( ~RouterID.1,
                                                                                      ~ServerID.1, ~ak_h.1,
                                                                                      ~ak_sk.1, ~ssk_nms.1,
                                                                                      ~tid.1, skae, k_h.1,
                                                                                      k_sh, tls_spk
                                             ) ▶₀ #t2.6 )
                                        case ifverifyskaetlsspkswstatenilTPMCCPolicyPCRnilpkaksktrue_0_11111111111112111111111111111111
                                        by contradiction /* cyclic */
                                      qed
                                    qed
                                  next
                                    case case_2
                                    solve( TPM_SendCommand( <'TPM2_Sign', k_sh, k_h.1, m> ) @ #t2.7 )
                                      case eventTPMSendCommandTPMSigntlsshtlshtlsspkskae_0_111111111111121111111111111111111
                                      solve( state_111111111111121111111111111111111( ~RouterID.1,
                                                                                      ~ServerID.1, ~ak_h.1,
                                                                                      ~ak_sk.1, ~ssk_nms.1,
                                                                                      ~tid.1, skae, k_h.1,
                                                                                      k_sh, tls_spk
                                             ) ▶₀ #t2.6 )
                                        case ifverifyskaetlsspkswstatenilTPMCCPolicyPCRnilpkaksktrue_0_11111111111112111111111111111111
                                        by contradiction /* cyclic */
                                      qed
                                    qed
                                  qed
                                qed
                              qed
                            qed
                          qed
                        next
                          case outsignobjpkobjapask_0_11111111111111111111211111111
                          solve( ((#vr.25 < #vr.67) ∧
                                  (∃ #t2.
                                    (Unlock_4( '4', ~n.1, 'device' ) @ #t2)
                                   ∧
                                    (#vr.25 < #t2) ∧
                                    (#t2 < #vr.67) ∧
                                    (∀ #t0 pp. (Unlock( pp, ~n.1, 'device' ) @ #t0) ⇒ #t0 = #t2) ∧
                                    (∀ pp lpp #t0.
                                      (Lock( pp, lpp, 'device' ) @ #t0)
                                     ⇒
                                      ((#t0 < #vr.25) ∨ (#t0 = #vr.25) ∨ (#t2 < #t0))) ∧
                                    (∀ pp lpp #t0.
                                      (Unlock( pp, lpp, 'device' ) @ #t0)
                                     ⇒
                                      ((#t0 < #vr.25) ∨ (#t2 < #t0) ∨ (#t2 = #t0)))))  ∥
                                 (#vr.67 < #vr.25)  ∥ (#vr.25 = #vr.67) )
                            case case_1
                            solve( TPM_SendCommand( <'TPM2_Certify', obj_sh.1, obj_h, a_h>
                                   ) @ #t2.7 )
                              case eventTPMSendCommandTPMCertifytlsshtlshakh_0_111111111111121111111111111
                              by solve( state_111111111111121111111111111( ~RouterID.1, ~ServerID.1,
                                                                           ~ak_h.1, ~ak_sk.1, ~ssk_nms.1,
                                                                           ~tid.1, obj_h, obj_sh.1, tls_spk
                                        ) ▶₀ #t2.6 )
                            qed
                          next
                            case case_2
                            solve( (#vr.67 < #vr.50)  ∥ (#t2.1 < #vr.67) )
                              case case_1
                              solve( TPM_SendCommand( <'TPM2_Certify', obj_sh.1, obj_h, a_h>
                                     ) @ #t2.7 )
                                case eventTPMSendCommandTPMCertifytlsshtlshakh_0_111111111111121111111111111
                                by solve( state_111111111111121111111111111( ~RouterID.1, ~ServerID.1,
                                                                             ~ak_h.1, ~ak_sk.1, ~ssk_nms.1,
                                                                             ~tid.1, obj_h, obj_sh.1, tls_spk
                                          ) ▶₀ #t2.6 )
                              qed
                            next
                              case case_2
                              solve( TPM_SendCommand( <'TPM2_Certify', obj_sh.1, obj_h, a_h>
                                     ) @ #t2.7 )
                                case eventTPMSendCommandTPMCertifytlsshtlshakh_0_111111111111121111111111111
                                by solve( state_111111111111121111111111111( ~RouterID.1, ~ServerID.1,
                                                                             ~ak_h.1, ~ak_sk.1, ~ssk_nms.1,
                                                                             ~tid.1, obj_h, obj_sh.1, tls_spk
                                          ) ▶₀ #t2.6 )
                              qed
                            qed
                          qed
                        next
                          case outtlsspkskaecsr_0_11111111111112111111111111111111111111
                          by contradiction /* from formulas */
                        qed
                      qed
                    qed
                  qed
                qed
              qed
            qed
          qed
        qed
      qed
    qed
  next
    case outtlsspkskaecsr_0_11111111111112111111111111111111111111
    solve( ((#vr.35 < #vr.65) ∧
            (∃ #t2.
              (Unlock_5( '5', ~n, 'device' ) @ #t2)
             ∧
              (#vr.35 < #t2) ∧
              (#t2 < #vr.65) ∧
              (∀ #t0 pp. (Unlock( pp, ~n, 'device' ) @ #t0) ⇒ #t0 = #t2) ∧
              (∀ pp lpp #t0.
                (Lock( pp, lpp, 'device' ) @ #t0)
               ⇒
                ((#t0 < #vr.35) ∨ (#t0 = #vr.35) ∨ (#t2 < #t0))) ∧
              (∀ pp lpp #t0.
                (Unlock( pp, lpp, 'device' ) @ #t0)
               ⇒
                ((#t0 < #vr.35) ∨ (#t2 < #t0) ∨ (#t2 = #t0)))))  ∥
           (#vr.65 < #vr.35) )
      case case_1
      solve( TPM_SendCommand( <'TPM2_Sign', k_sh, k_h, pk(x), <swstate, nil>, 
                               'TPM_CC_PolicyPCR', nil>
             ) @ #t2 )
        case eventTPMSendCommandTPMSigntlsshtlshtlsspkskae_0_111111111111121111111111111111111
        by solve( state_111111111111121111111111111111111( ~RouterID.1,
                                                           ~ServerID.1, ~ak_h.1, ~ak_sk.1, ~ssk_nms.1, ~tid,
                                                           <<swstate, nil>, 'TPM_CC_PolicyPCR', nil>, k_h,
                                                           k_sh, pk(x)
                  ) ▶₀ #t2 )
      qed
    next
      case case_2
      solve( state_111111111111111111111121111111111( ~RouterID.1, ~ServerID.1,
                                                      ~ak_h.1, ~ak_sk.1, ~k_h.2, ~k_sk.1, ~ssk_nms.1,
                                                      authPolicy.1, ~n.1
             ) ▶₀ #t2 )
        case TpmCreateOutkhpkksk_0_11111111111111111111112111111111
        solve( TPM_SendCommand( <'TPM2_Sign', k_sh, k_h.1, pk(x), 
                                 <swstate, nil>, 'TPM_CC_PolicyPCR', nil>
               ) @ #t2.1 )
          case eventTPMSendCommandTPMSigntlsshtlshtlsspkskae_0_111111111111121111111111111111111
          by solve( state_111111111111121111111111111111111( ~RouterID.1,
                                                             ~ServerID.1, ~ak_h.1, ~ak_sk.1, ~ssk_nms.1, ~tid,
                                                             <<swstate, nil>, 'TPM_CC_PolicyPCR', nil>, k_h.1,
                                                             k_sh, pk(x)
                    ) ▶₀ #t2.1 )
        qed
      qed
    qed
  qed
qed

lemma Authentication:
  all-traces
  "(∀ X Y param #t1.
     (RouterCommit( X, Y, param ) @ #t1) ⇒
     (∃ #t2. (ServerRunning( Y, X, param ) @ #t2) ∧ (#t2 < #t1))) ∧
   (∀ X Y param #t1.
     (ServerCommit( X, Y, param ) @ #t1) ⇒
     (∃ #t2. (RouterRunning( Y, X, param ) @ #t2) ∧ (#t2 < #t1)))"
/*
guarded formula characterizing all counter-examples:
"((∃ X Y param #t1.
    (RouterCommit( X, Y, param ) @ #t1)
   ∧
    ∀ #t2. (ServerRunning( Y, X, param ) @ #t2) ⇒ ¬(#t2 < #t1)) ∨
  (∃ X Y param #t1.
    (ServerCommit( X, Y, param ) @ #t1)
   ∧
    ∀ #t2. (RouterRunning( Y, X, param ) @ #t2) ⇒ ¬(#t2 < #t1)))"
*/
simplify
solve( (∃ X Y param #t1.
         (RouterCommit( X, Y, param ) @ #t1)
        ∧
         ∀ #t2. (ServerRunning( Y, X, param ) @ #t2) ⇒ ¬(#t2 < #t1))  ∥
       (∃ X Y param #t1.
         (ServerCommit( X, Y, param ) @ #t1)
        ∧
         ∀ #t2. (RouterRunning( Y, X, param ) @ #t2) ⇒ ¬(#t2 < #t1)) )
  case case_1
  solve( state_111111111111121111111111111111111111111111( ~RouterID,
                                                           ~ServerID, ~ak_h, ~ak_sk, ~ssk_nms, ~tid, csr,
                                                           signature_cert_tls, skae, tls_h, tls_sh, tls_spk
         ) ▶₀ #t1 )
    case ifverifysignaturecerttlstlsspkpkssknmstrue_0_11111111111112111111111111111111111111111
    solve( ((#vr.18 < #vr.52) ∧
            (∃ #t2.
              (Unlock_5( '5', ~n, 'device' ) @ #t2)
             ∧
              (#vr.18 < #t2) ∧
              (#t2 < #vr.52) ∧
              (∀ #t0 pp. (Unlock( pp, ~n, 'device' ) @ #t0) ⇒ #t0 = #t2) ∧
              (∀ pp lpp #t0.
                (Lock( pp, lpp, 'device' ) @ #t0)
               ⇒
                ((#t0 < #vr.18) ∨ (#t0 = #vr.18) ∨ (#t2 < #t0))) ∧
              (∀ pp lpp #t0.
                (Unlock( pp, lpp, 'device' ) @ #t0)
               ⇒
                ((#t0 < #vr.18) ∨ (#t2 < #t0) ∨ (#t2 = #t0)))))  ∥
           (#vr.52 < #vr.18) )
      case case_1
      solve( TPM_SendCommand( <'TPM2_Sign', k_sh, k_h.1, m> ) @ #t2 )
        case eventTPMSendCommandTPMSigntlsshtlshtlsspkskae_0_111111111111121111111111111111111
        solve( state_111111111111121111111111111111111( ~RouterID.1, ~ServerID.1,
                                                        ~ak_h.1, ~ak_sk.1, ~ssk_nms.1, ~tid.1, skae, k_h.1,
                                                        k_sh, tls_spk
               ) ▶₀ #t2 )
          case ifverifyskaetlsspkswstatenilTPMCCPolicyPCRnilpkaksktrue_0_11111111111112111111111111111111
          by contradiction /* cyclic */
        qed
      qed
    next
      case case_2
      solve( state_111111111111111111111121111111111( ~RouterID.1, ~ServerID.1,
                                                      ~ak_h.1, ~ak_sk.1, ~k_h.2, ~k_sk.2, ~ssk_nms.1,
                                                      authPolicy.1, ~n.1
             ) ▶₀ #t2 )
        case TpmCreateOutkhpkksk_0_11111111111111111111112111111111
        solve( TPM_SendCommand( <'TPM2_Sign', k_sh, k_h.1, m> ) @ #t2.1 )
          case eventTPMSendCommandTPMSigntlsshtlshtlsspkskae_0_111111111111121111111111111111111
          solve( state_111111111111121111111111111111111( ~RouterID.1, ~ServerID.1,
                                                          ~ak_h.1, ~ak_sk.1, ~ssk_nms.1, ~tid.1, skae, k_h.1,
                                                          k_sh, tls_spk
                 ) ▶₀ #t2.1 )
            case ifverifyskaetlsspkswstatenilTPMCCPolicyPCRnilpkaksktrue_0_11111111111112111111111111111111
            solve( (#vr.45 < #t2.3)  ∥ (#vr.45 = #t2.3) )
              case case_1
              solve( (#vr.48 < #t2.4)  ∥ (#vr.48 = #t2.4) )
                case case_1
                solve( TPM_SendCommand( <'TPM2_Create', authPolicy> ) @ #t2.2 )
                  case eventTPMSendCommandTPMCreateswstatenilTPMCCPolicyPCRnil_0_11111111111112111
                  solve( state_11111111111112111( ~RouterID.1, ~ServerID.1, ~ak_h.1,
                                                  ~ak_sk.1, ~ssk_nms.1, ~tid.1
                         ) ▶₀ #t2.2 )
                    case outTPMPCRExtendswstate_0_1111111111111211
                    solve( TPM_SendCommand( <'TPM2_Create', <swstate, nil>, 
                                             'TPM_CC_PolicyPCR', nil>
                           ) @ #t2.6 )
                      case eventTPMSendCommandTPMCreateswstatenilTPMCCPolicyPCRnil_0_11111111111112111
                      solve( state_11111111111112111( ~RouterID.1, ~ServerID.1, ~ak_h.1,
                                                      ~ak_sk.1, ~ssk_nms.1, ~tid.1
                             ) ▶₀ #t2.3 )
                        case outTPMPCRExtendswstate_0_1111111111111211
                        solve( TPM_SendCommand( <'TPM2_Create', <swstate, nil>, 
                                                 'TPM_CC_PolicyPCR', nil>
                               ) @ #t2.6 )
                          case eventTPMSendCommandTPMCreateswstatenilTPMCCPolicyPCRnil_0_11111111111112111
                          solve( state_11111111111112111( ~RouterID.1, ~ServerID.1, ~ak_h.1,
                                                          ~ak_sk.1, ~ssk_nms.1, ~tid.1
                                 ) ▶₀ #t2.3 )
                            case outTPMPCRExtendswstate_0_1111111111111211
                            solve( !KU( sign(pk(~k_sk), ~ssk_nms) ) @ #vk.6 )
                              case c_sign
                              solve( !KU( sign(<pk(~k_sk), <swstate, nil>, 'TPM_CC_PolicyPCR', nil>,
                                               ~ak_sk)
                                     ) @ #vk.7 )
                                case c_sign
                                solve( !KU( pk(~k_sk) ) @ #vk.3 )
                                  case c_pk
                                  solve( Insert( <'privatePart', ~k_h>, k_sk.1 ) @ #t2.3 )
                                    case insertprivatePartakhaksk_0_111111111111111
                                    by solve( state_111111111111111( ~RouterID.1, ~ServerID.1, ~k_h,
                                                                     ~ak_sk.1, ~ssk_nms.1
                                              ) ▶₀ #t2.3 )
                                  next
                                    case insertprivatePartkhksk_0_111111111111111111111121111111
                                    solve( state_111111111111111111111121111111( ~RouterID.1, ~ServerID.1,
                                                                                 ~ak_h.1, ~ak_sk.1, ~k_h,
                                                                                 ~k_sk.1, ~ssk_nms.1,
                                                                                 authPolicy, lock
                                           ) ▶₀ #t2.3 )
                                      case insertauthPolicykhauthPolicy_0_11111111111111111111112111111
                                      by contradiction /* cyclic */
                                    qed
                                  qed
                                next
                                  case outTPMSigntlsshtlshtlsspkskae_0_1111111111111211111111111111111111
                                  by contradiction /* cyclic */
                                next
                                  case outtlsspkskaecsr_0_11111111111112111111111111111111111111
                                  by contradiction /* cyclic */
                                qed
                              next
                                case outsignobjpkobjapask_0_11111111111111111111211111111
                                solve( (#vr.77 < #vr.50)  ∥ (#t2 < #vr.77) )
                                  case case_1
                                  solve( TPM_SendCommand( <'TPM2_Certify', obj_sh, obj_h, a_h> ) @ #t2.7 )
                                    case eventTPMSendCommandTPMCertifytlsshtlshakh_0_111111111111121111111111111
                                    solve( state_111111111111121111111111111( ~RouterID.1, ~ServerID.1,
                                                                              ~ak_h.1, ~ak_sk.1, ~ssk_nms.1,
                                                                              ~tid.1, obj_h, obj_sh, tls_spk
                                           ) ▶₀ #t2.3 )
                                      case outTPMPolicyPCRtlssh_0_11111111111112111111111111
                                      by contradiction /* cyclic */
                                    qed
                                  qed
                                next
                                  case case_2
                                  solve( TPM_SendCommand( <'TPM2_Certify', obj_sh, obj_h, a_h> ) @ #t2.7 )
                                    case eventTPMSendCommandTPMCertifytlsshtlshakh_0_111111111111121111111111111
                                    solve( state_111111111111121111111111111( ~RouterID.1, ~ServerID.1,
                                                                              ~ak_h.1, ~ak_sk.1, ~ssk_nms.1,
                                                                              ~tid.1, obj_h, obj_sh, tls_spk
                                           ) ▶₀ #t2.3 )
                                      case outTPMPolicyPCRtlssh_0_11111111111112111111111111
                                      solve( (#vr.40 < #t2.9)  ∥ (#vr.40 = #t2.9) )
                                        case case_1
                                        solve( (#vr.46 < #t2.10)  ∥ (#vr.46 = #t2.10) )
                                          case case_1
                                          solve( (#vr.32 < #t2.8)  ∥ (#vr.32 = #t2.8) )
                                            case case_1
                                            solve( (#t2.5 < #t2.10)  ∥ (#t2.5 = #t2.10)  ∥ (#vr.74 < #t2.5) )
                                              case case_1
                                              by contradiction /* from formulas */
                                            next
                                              case case_2
                                              solve( (#t2.6 < #t2.10)  ∥ (#t2.6 = #t2.10)  ∥
                                                     (#vr.75 < #t2.6) )
                                                case case_1
                                                by contradiction /* from formulas */
                                              next
                                                case case_2
                                                solve( Unlock_4( '4', ~n.2, 'device' ) @ #t2.7 )
                                                  case unlockdevice_0_111111111111111111112111111111
                                                  solve( state_111111111111111111112111111111( ~RouterID.1,
                                                                                               ~ServerID.1,
                                                                                               ~ak_h.1,
                                                                                               ~ak_sk.1,
                                                                                               ~ssk_nms.1,
                                                                                               a_h, a_sk,
                                                                                               obj_ap, obj_h,
                                                                                               obj_pd, obj_pk,
                                                                                               obj_sh, ~n.2
                                                         ) ▶₀ #t2.4 )
                                                    case outsignobjpkobjapask_0_11111111111111111111211111111
                                                    solve( (#t2.7 < #t2.15)  ∥ (#t2.7 = #t2.15) )
                                                      case case_1
                                                      by contradiction /* from formulas */
                                                    next
                                                      case case_2
                                                      solve( (#vr.32 < #t2.12)  ∥ (#vr.32 = #t2.12) )
                                                        case case_1
                                                        solve( (#vr.40 < #t2.13)  ∥ (#vr.40 = #t2.13) )
                                                          case case_1
                                                          solve( (#vr.46 < #t2.14)  ∥ (#vr.46 = #t2.14) )
                                                            case case_1
                                                            solve( (#t2.14 < #t2.6)  ∥ (#t2.14 = #t2.6) )
                                                              case case_1
                                                              by contradiction /* from formulas */
                                                            next
                                                              case case_2
                                                              solve( (#t2.9 < #t2.13)  ∥ (#t2.9 = #t2.13) )
                                                                case case_1
                                                                by contradiction /* from formulas */
                                                              next
                                                                case case_2
                                                                solve( (#t2.8 < #t2.12)  ∥ (#t2.8 = #t2.12) )
                                                                  case case_1
                                                                  by contradiction /* from formulas */
                                                                next
                                                                  case case_2
                                                                  solve( TPM_SendCommand( <'TPM2_Create', 
                                                                                           <swstate, nil>, 
                                                                                           'TPM_CC_PolicyPCR', 
                                                                                           nil>
                                                                         ) @ #t2.10 )
                                                                    case eventTPMSendCommandTPMCreateswstatenilTPMCCPolicyPCRnil_0_11111111111112111
                                                                    solve( state_11111111111112111( ~RouterID.1,
                                                                                                    ~ServerID.1,
                                                                                                    ~ak_h.1,
                                                                                                    ~ak_sk.1,
                                                                                                    ~ssk_nms.1,
                                                                                                    ~tid.1
                                                                           ) ▶₀ #t2.5 )
                                                                      case outTPMPCRExtendswstate_0_1111111111111211
                                                                      solve( TPM_SendCommand( <
                                                                                               'TPM2_Certify', 
                                                                                               k_sh, ~k_h, 
                                                                                               ~ak_h>
                                                                             ) @ #t2.10 )
                                                                        case eventTPMSendCommandTPMCertifytlsshtlshakh_0_111111111111121111111111111
                                                                        solve( state_111111111111121111111111111( ~RouterID.1,
                                                                                                                  ~ServerID.1,
                                                                                                                  ~ak_h,
                                                                                                                  ~ak_sk.1,
                                                                                                                  ~ssk_nms.1,
                                                                                                                  ~tid.1,
                                                                                                                  ~k_h,
                                                                                                                  k_sh,
                                                                                                                  tls_spk
                                                                               ) ▶₀ #t2.5 )
                                                                          case outTPMPolicyPCRtlssh_0_11111111111112111111111111
                                                                          solve( TPM_SendCommand( <
                                                                                                   'TPM2_Create', 
                                                                                                   <swstate, 
                                                                                                    nil>, 
                                                                                                   'TPM_CC_PolicyPCR', 
                                                                                                   nil>
                                                                                 ) @ #t2.10 )
                                                                            case eventTPMSendCommandTPMCreateswstatenilTPMCCPolicyPCRnil_0_11111111111112111
                                                                            solve( state_11111111111112111( ~RouterID.1,
                                                                                                            ~ServerID.1,
                                                                                                            ~ak_h.1,
                                                                                                            ~ak_sk.1,
                                                                                                            ~ssk_nms.1,
                                                                                                            ~tid.1
                                                                                   ) ▶₀ #t2.5 )
                                                                              case outTPMPCRExtendswstate_0_1111111111111211
                                                                              solve( Insert( <'privatePart', 
                                                                                              ~k_h>,
                                                                                             k_sk.1
                                                                                     ) @ #t2.5 )
                                                                                case insertprivatePartakhaksk_0_111111111111111
                                                                                by solve( state_111111111111111( ~RouterID.1,
                                                                                                                 ~ServerID.1,
                                                                                                                 ~k_h,
                                                                                                                 ~ak_sk.1,
                                                                                                                 ~ssk_nms.1
                                                                                          ) ▶₀ #t2.5 )
                                                                              next
                                                                                case insertprivatePartkhksk_0_111111111111111111111121111111
                                                                                solve( state_111111111111111111111121111111( ~RouterID.1,
                                                                                                                             ~ServerID.1,
                                                                                                                             ~ak_h.1,
                                                                                                                             ~ak_sk.1,
                                                                                                                             ~k_h,
                                                                                                                             ~k_sk.1,
                                                                                                                             ~ssk_nms.1,
                                                                                                                             authPolicy,
                                                                                                                             lock
                                                                                       ) ▶₀ #t2.5 )
                                                                                  case insertauthPolicykhauthPolicy_0_11111111111111111111112111111
                                                                                  by contradiction
                                                                                     /* cyclic */
                                                                                qed
                                                                              qed
                                                                            qed
                                                                          qed
                                                                        qed
                                                                      qed
                                                                    qed
                                                                  qed
                                                                qed
                                                              qed
                                                            qed
                                                          next
                                                            case case_2
                                                            by contradiction /* from formulas */
                                                          qed
                                                        next
                                                          case case_2
                                                          by contradiction /* from formulas */
                                                        qed
                                                      next
                                                        case case_2
                                                        by contradiction /* from formulas */
                                                      qed
                                                    qed
                                                  qed
                                                next
                                                  case unlockdevice_0_11111111111111111111211111112
                                                  by solve( state_11111111111111111111211111112( ~RouterID.1,
                                                                                                 ~ServerID.1,
                                                                                                 ~ak_h.1,
                                                                                                 ~ak_sk.1,
                                                                                                 ~ssk_nms.1,
                                                                                                 a_h, obj_ap,
                                                                                                 obj_h,
                                                                                                 obj_pd,
                                                                                                 obj_pk,
                                                                                                 obj_sh, ~n.2
                                                            ) ▶₀ #t2.4 )
                                                qed
                                              next
                                                case case_3
                                                solve( Unlock_4( '4', ~n.2, 'device' ) @ #t2.7 )
                                                  case unlockdevice_0_111111111111111111112111111111
                                                  solve( state_111111111111111111112111111111( ~RouterID.1,
                                                                                               ~ServerID.1,
                                                                                               ~ak_h.1,
                                                                                               ~ak_sk.1,
                                                                                               ~ssk_nms.1,
                                                                                               a_h, a_sk,
                                                                                               obj_ap, obj_h,
                                                                                               obj_pd, obj_pk,
                                                                                               obj_sh, ~n.2
                                                         ) ▶₀ #t2.4 )
                                                    case outsignobjpkobjapask_0_11111111111111111111211111111
                                                    solve( (#t2.10 < #t2.16)  ∥ (#t2.10 = #t2.16) )
                                                      case case_1
                                                      by contradiction /* from formulas */
                                                    next
                                                      case case_2
                                                      solve( (#vr.32 < #t2.13)  ∥ (#vr.32 = #t2.13) )
                                                        case case_1
                                                        solve( (#vr.40 < #t2.14)  ∥ (#vr.40 = #t2.14) )
                                                          case case_1
                                                          solve( (#vr.46 < #t2.15)  ∥ (#vr.46 = #t2.15) )
                                                            case case_1
                                                            solve( (#t2.15 < #t2.6)  ∥ (#t2.15 = #t2.6) )
                                                              case case_1
                                                              by contradiction /* from formulas */
                                                            next
                                                              case case_2
                                                              solve( (#t2.9 < #t2.14)  ∥ (#t2.9 = #t2.14) )
                                                                case case_1
                                                                by contradiction /* from formulas */
                                                              next
                                                                case case_2
                                                                solve( (#t2.8 < #t2.13)  ∥ (#t2.8 = #t2.13) )
                                                                  case case_1
                                                                  by contradiction /* from formulas */
                                                                next
                                                                  case case_2
                                                                  solve( TPM_SendCommand( <'TPM2_Create', 
                                                                                           <swstate, nil>, 
                                                                                           'TPM_CC_PolicyPCR', 
                                                                                           nil>
                                                                         ) @ #t2.11 )
                                                                    case eventTPMSendCommandTPMCreateswstatenilTPMCCPolicyPCRnil_0_11111111111112111
                                                                    solve( state_11111111111112111( ~RouterID.1,
                                                                                                    ~ServerID.1,
                                                                                                    ~ak_h.1,
                                                                                                    ~ak_sk.1,
                                                                                                    ~ssk_nms.1,
                                                                                                    ~tid.1
                                                                           ) ▶₀ #t2.5 )
                                                                      case outTPMPCRExtendswstate_0_1111111111111211
                                                                      solve( TPM_SendCommand( <
                                                                                               'TPM2_Certify', 
                                                                                               k_sh, ~k_h, 
                                                                                               ~ak_h>
                                                                             ) @ #t2.11 )
                                                                        case eventTPMSendCommandTPMCertifytlsshtlshakh_0_111111111111121111111111111
                                                                        solve( state_111111111111121111111111111( ~RouterID.1,
                                                                                                                  ~ServerID.1,
                                                                                                                  ~ak_h,
                                                                                                                  ~ak_sk.1,
                                                                                                                  ~ssk_nms.1,
                                                                                                                  ~tid.1,
                                                                                                                  ~k_h,
                                                                                                                  k_sh,
                                                                                                                  tls_spk
                                                                               ) ▶₀ #t2.5 )
                                                                          case outTPMPolicyPCRtlssh_0_11111111111112111111111111
                                                                          solve( TPM_SendCommand( <
                                                                                                   'TPM2_Create', 
                                                                                                   <swstate, 
                                                                                                    nil>, 
                                                                                                   'TPM_CC_PolicyPCR', 
                                                                                                   nil>
                                                                                 ) @ #t2.11 )
                                                                            case eventTPMSendCommandTPMCreateswstatenilTPMCCPolicyPCRnil_0_11111111111112111
                                                                            solve( state_11111111111112111( ~RouterID.1,
                                                                                                            ~ServerID.1,
                                                                                                            ~ak_h.1,
                                                                                                            ~ak_sk.1,
                                                                                                            ~ssk_nms.1,
                                                                                                            ~tid.1
                                                                                   ) ▶₀ #t2.5 )
                                                                              case outTPMPCRExtendswstate_0_1111111111111211
                                                                              solve( Insert( <'privatePart', 
                                                                                              ~k_h>,
                                                                                             k_sk.1
                                                                                     ) @ #t2.5 )
                                                                                case insertprivatePartakhaksk_0_111111111111111
                                                                                by solve( state_111111111111111( ~RouterID.1,
                                                                                                                 ~ServerID.1,
                                                                                                                 ~k_h,
                                                                                                                 ~ak_sk.1,
                                                                                                                 ~ssk_nms.1
                                                                                          ) ▶₀ #t2.5 )
                                                                              next
                                                                                case insertprivatePartkhksk_0_111111111111111111111121111111
                                                                                solve( state_111111111111111111111121111111( ~RouterID.1,
                                                                                                                             ~ServerID.1,
                                                                                                                             ~ak_h.1,
                                                                                                                             ~ak_sk.1,
                                                                                                                             ~k_h,
                                                                                                                             ~k_sk.1,
                                                                                                                             ~ssk_nms.1,
                                                                                                                             authPolicy,
                                                                                                                             lock
                                                                                       ) ▶₀ #t2.5 )
                                                                                  case insertauthPolicykhauthPolicy_0_11111111111111111111112111111
                                                                                  by contradiction
                                                                                     /* cyclic */
                                                                                qed
                                                                              qed
                                                                            qed
                                                                          qed
                                                                        qed
                                                                      qed
                                                                    qed
                                                                  qed
                                                                qed
                                                              qed
                                                            qed
                                                          next
                                                            case case_2
                                                            by contradiction /* from formulas */
                                                          qed
                                                        next
                                                          case case_2
                                                          by contradiction /* from formulas */
                                                        qed
                                                      next
                                                        case case_2
                                                        by contradiction /* from formulas */
                                                      qed
                                                    qed
                                                  qed
                                                next
                                                  case unlockdevice_0_11111111111111111111211111112
                                                  by solve( state_11111111111111111111211111112( ~RouterID.1,
                                                                                                 ~ServerID.1,
                                                                                                 ~ak_h.1,
                                                                                                 ~ak_sk.1,
                                                                                                 ~ssk_nms.1,
                                                                                                 a_h, obj_ap,
                                                                                                 obj_h,
                                                                                                 obj_pd,
                                                                                                 obj_pk,
                                                                                                 obj_sh, ~n.2
                                                            ) ▶₀ #t2.4 )
                                                qed
                                              qed
                                            next
                                              case case_3
                                              solve( (#t2.6 < #t2.11)  ∥ (#t2.6 = #t2.11)  ∥
                                                     (#vr.75 < #t2.6) )
                                                case case_1
                                                by contradiction /* from formulas */
                                              next
                                                case case_2
                                                solve( Unlock_4( '4', ~n.2, 'device' ) @ #t2.7 )
                                                  case unlockdevice_0_111111111111111111112111111111
                                                  solve( state_111111111111111111112111111111( ~RouterID.1,
                                                                                               ~ServerID.1,
                                                                                               ~ak_h.1,
                                                                                               ~ak_sk.1,
                                                                                               ~ssk_nms.1,
                                                                                               a_h, a_sk,
                                                                                               obj_ap, obj_h,
                                                                                               obj_pd, obj_pk,
                                                                                               obj_sh, ~n.2
                                                         ) ▶₀ #t2.4 )
                                                    case outsignobjpkobjapask_0_11111111111111111111211111111
                                                    solve( (#t2.7 < #t2.16)  ∥ (#t2.7 = #t2.16) )
                                                      case case_1
                                                      by contradiction /* from formulas */
                                                    next
                                                      case case_2
                                                      solve( (#vr.32 < #t2.13)  ∥ (#vr.32 = #t2.13) )
                                                        case case_1
                                                        solve( (#vr.40 < #t2.14)  ∥ (#vr.40 = #t2.14) )
                                                          case case_1
                                                          solve( (#vr.46 < #t2.15)  ∥ (#vr.46 = #t2.15) )
                                                            case case_1
                                                            solve( (#t2.10 < #t2.15)  ∥ (#t2.10 = #t2.15) )
                                                              case case_1
                                                              by contradiction /* from formulas */
                                                            next
                                                              case case_2
                                                              solve( (#t2.9 < #t2.14)  ∥ (#t2.9 = #t2.14) )
                                                                case case_1
                                                                by contradiction /* from formulas */
                                                              next
                                                                case case_2
                                                                solve( (#t2.8 < #t2.13)  ∥ (#t2.8 = #t2.13) )
                                                                  case case_1
                                                                  by contradiction /* from formulas */
                                                                next
                                                                  case case_2
                                                                  solve( TPM_SendCommand( <'TPM2_Create', 
                                                                                           <swstate, nil>, 
                                                                                           'TPM_CC_PolicyPCR', 
                                                                                           nil>
                                                                         ) @ #t2.11 )
                                                                    case eventTPMSendCommandTPMCreateswstatenilTPMCCPolicyPCRnil_0_11111111111112111
                                                                    solve( state_11111111111112111( ~RouterID.1,
                                                                                                    ~ServerID.1,
                                                                                                    ~ak_h.1,
                                                                                                    ~ak_sk.1,
                                                                                                    ~ssk_nms.1,
                                                                                                    ~tid.1
                                                                           ) ▶₀ #t2.5 )
                                                                      case outTPMPCRExtendswstate_0_1111111111111211
                                                                      solve( TPM_SendCommand( <
                                                                                               'TPM2_Certify', 
                                                                                               k_sh, ~k_h, 
                                                                                               ~ak_h>
                                                                             ) @ #t2.11 )
                                                                        case eventTPMSendCommandTPMCertifytlsshtlshakh_0_111111111111121111111111111
                                                                        solve( state_111111111111121111111111111( ~RouterID.1,
                                                                                                                  ~ServerID.1,
                                                                                                                  ~ak_h,
                                                                                                                  ~ak_sk.1,
                                                                                                                  ~ssk_nms.1,
                                                                                                                  ~tid.1,
                                                                                                                  ~k_h,
                                                                                                                  k_sh,
                                                                                                                  tls_spk
                                                                               ) ▶₀ #t2.5 )
                                                                          case outTPMPolicyPCRtlssh_0_11111111111112111111111111
                                                                          solve( TPM_SendCommand( <
                                                                                                   'TPM2_Create', 
                                                                                                   <swstate, 
                                                                                                    nil>, 
                                                                                                   'TPM_CC_PolicyPCR', 
                                                                                                   nil>
                                                                                 ) @ #t2.11 )
                                                                            case eventTPMSendCommandTPMCreateswstatenilTPMCCPolicyPCRnil_0_11111111111112111
                                                                            solve( state_11111111111112111( ~RouterID.1,
                                                                                                            ~ServerID.1,
                                                                                                            ~ak_h.1,
                                                                                                            ~ak_sk.1,
                                                                                                            ~ssk_nms.1,
                                                                                                            ~tid.1
                                                                                   ) ▶₀ #t2.5 )
                                                                              case outTPMPCRExtendswstate_0_1111111111111211
                                                                              solve( Insert( <'privatePart', 
                                                                                              ~k_h>,
                                                                                             k_sk.1
                                                                                     ) @ #t2.5 )
                                                                                case insertprivatePartakhaksk_0_111111111111111
                                                                                by solve( state_111111111111111( ~RouterID.1,
                                                                                                                 ~ServerID.1,
                                                                                                                 ~k_h,
                                                                                                                 ~ak_sk.1,
                                                                                                                 ~ssk_nms.1
                                                                                          ) ▶₀ #t2.5 )
                                                                              next
                                                                                case insertprivatePartkhksk_0_111111111111111111111121111111
                                                                                solve( state_111111111111111111111121111111( ~RouterID.1,
                                                                                                                             ~ServerID.1,
                                                                                                                             ~ak_h.1,
                                                                                                                             ~ak_sk.1,
                                                                                                                             ~k_h,
                                                                                                                             ~k_sk.1,
                                                                                                                             ~ssk_nms.1,
                                                                                                                             authPolicy,
                                                                                                                             lock
                                                                                       ) ▶₀ #t2.5 )
                                                                                  case insertauthPolicykhauthPolicy_0_11111111111111111111112111111
                                                                                  by contradiction
                                                                                     /* cyclic */
                                                                                qed
                                                                              qed
                                                                            qed
                                                                          qed
                                                                        qed
                                                                      qed
                                                                    qed
                                                                  qed
                                                                qed
                                                              qed
                                                            qed
                                                          next
                                                            case case_2
                                                            by contradiction /* from formulas */
                                                          qed
                                                        next
                                                          case case_2
                                                          by contradiction /* from formulas */
                                                        qed
                                                      next
                                                        case case_2
                                                        by contradiction /* from formulas */
                                                      qed
                                                    qed
                                                  qed
                                                next
                                                  case unlockdevice_0_11111111111111111111211111112
                                                  by solve( state_11111111111111111111211111112( ~RouterID.1,
                                                                                                 ~ServerID.1,
                                                                                                 ~ak_h.1,
                                                                                                 ~ak_sk.1,
                                                                                                 ~ssk_nms.1,
                                                                                                 a_h, obj_ap,
                                                                                                 obj_h,
                                                                                                 obj_pd,
                                                                                                 obj_pk,
                                                                                                 obj_sh, ~n.2
                                                            ) ▶₀ #t2.4 )
                                                qed
                                              next
                                                case case_3
                                                solve( Unlock_4( '4', ~n.2, 'device' ) @ #t2.7 )
                                                  case unlockdevice_0_111111111111111111112111111111
                                                  solve( state_111111111111111111112111111111( ~RouterID.1,
                                                                                               ~ServerID.1,
                                                                                               ~ak_h.1,
                                                                                               ~ak_sk.1,
                                                                                               ~ssk_nms.1,
                                                                                               a_h, a_sk,
                                                                                               obj_ap, obj_h,
                                                                                               obj_pd, obj_pk,
                                                                                               obj_sh, ~n.2
                                                         ) ▶₀ #t2.4 )
                                                    case outsignobjpkobjapask_0_11111111111111111111211111111
                                                    solve( (#t2.11 < #t2.17)  ∥ (#t2.11 = #t2.17) )
                                                      case case_1
                                                      by contradiction /* from formulas */
                                                    next
                                                      case case_2
                                                      solve( (#vr.32 < #t2.14)  ∥ (#vr.32 = #t2.14) )
                                                        case case_1
                                                        solve( (#vr.40 < #t2.15)  ∥ (#vr.40 = #t2.15) )
                                                          case case_1
                                                          solve( (#vr.46 < #t2.16)  ∥ (#vr.46 = #t2.16) )
                                                            case case_1
                                                            solve( (#t2.10 < #t2.16)  ∥ (#t2.10 = #t2.16) )
                                                              case case_1
                                                              by contradiction /* from formulas */
                                                            next
                                                              case case_2
                                                              solve( (#t2.9 < #t2.15)  ∥ (#t2.9 = #t2.15) )
                                                                case case_1
                                                                by contradiction /* from formulas */
                                                              next
                                                                case case_2
                                                                solve( (#t2.8 < #t2.14)  ∥ (#t2.8 = #t2.14) )
                                                                  case case_1
                                                                  by contradiction /* from formulas */
                                                                next
                                                                  case case_2
                                                                  solve( TPM_SendCommand( <'TPM2_Create', 
                                                                                           <swstate, nil>, 
                                                                                           'TPM_CC_PolicyPCR', 
                                                                                           nil>
                                                                         ) @ #t2.12 )
                                                                    case eventTPMSendCommandTPMCreateswstatenilTPMCCPolicyPCRnil_0_11111111111112111
                                                                    solve( state_11111111111112111( ~RouterID.1,
                                                                                                    ~ServerID.1,
                                                                                                    ~ak_h.1,
                                                                                                    ~ak_sk.1,
                                                                                                    ~ssk_nms.1,
                                                                                                    ~tid.1
                                                                           ) ▶₀ #t2.5 )
                                                                      case outTPMPCRExtendswstate_0_1111111111111211
                                                                      solve( TPM_SendCommand( <
                                                                                               'TPM2_Certify', 
                                                                                               k_sh, ~k_h, 
                                                                                               ~ak_h>
                                                                             ) @ #t2.12 )
                                                                        case eventTPMSendCommandTPMCertifytlsshtlshakh_0_111111111111121111111111111
                                                                        solve( state_111111111111121111111111111( ~RouterID.1,
                                                                                                                  ~ServerID.1,
                                                                                                                  ~ak_h,
                                                                                                                  ~ak_sk.1,
                                                                                                                  ~ssk_nms.1,
                                                                                                                  ~tid.1,
                                                                                                                  ~k_h,
                                                                                                                  k_sh,
                                                                                                                  tls_spk
                                                                               ) ▶₀ #t2.5 )
                                                                          case outTPMPolicyPCRtlssh_0_11111111111112111111111111
                                                                          solve( TPM_SendCommand( <
                                                                                                   'TPM2_Create', 
                                                                                                   <swstate, 
                                                                                                    nil>, 
                                                                                                   'TPM_CC_PolicyPCR', 
                                                                                                   nil>
                                                                                 ) @ #t2.12 )
                                                                            case eventTPMSendCommandTPMCreateswstatenilTPMCCPolicyPCRnil_0_11111111111112111
                                                                            solve( state_11111111111112111( ~RouterID.1,
                                                                                                            ~ServerID.1,
                                                                                                            ~ak_h.1,
                                                                                                            ~ak_sk.1,
                                                                                                            ~ssk_nms.1,
                                                                                                            ~tid.1
                                                                                   ) ▶₀ #t2.5 )
                                                                              case outTPMPCRExtendswstate_0_1111111111111211
                                                                              solve( Insert( <'privatePart', 
                                                                                              ~k_h>,
                                                                                             k_sk.1
                                                                                     ) @ #t2.5 )
                                                                                case insertprivatePartakhaksk_0_111111111111111
                                                                                by solve( state_111111111111111( ~RouterID.1,
                                                                                                                 ~ServerID.1,
                                                                                                                 ~k_h,
                                                                                                                 ~ak_sk.1,
                                                                                                                 ~ssk_nms.1
                                                                                          ) ▶₀ #t2.5 )
                                                                              next
                                                                                case insertprivatePartkhksk_0_111111111111111111111121111111
                                                                                solve( state_111111111111111111111121111111( ~RouterID.1,
                                                                                                                             ~ServerID.1,
                                                                                                                             ~ak_h.1,
                                                                                                                             ~ak_sk.1,
                                                                                                                             ~k_h,
                                                                                                                             ~k_sk.1,
                                                                                                                             ~ssk_nms.1,
                                                                                                                             authPolicy,
                                                                                                                             lock
                                                                                       ) ▶₀ #t2.5 )
                                                                                  case insertauthPolicykhauthPolicy_0_11111111111111111111112111111
                                                                                  by contradiction
                                                                                     /* cyclic */
                                                                                qed
                                                                              qed
                                                                            qed
                                                                          qed
                                                                        qed
                                                                      qed
                                                                    qed
                                                                  qed
                                                                qed
                                                              qed
                                                            qed
                                                          next
                                                            case case_2
                                                            by contradiction /* from formulas */
                                                          qed
                                                        next
                                                          case case_2
                                                          by contradiction /* from formulas */
                                                        qed
                                                      next
                                                        case case_2
                                                        by contradiction /* from formulas */
                                                      qed
                                                    qed
                                                  qed
                                                next
                                                  case unlockdevice_0_11111111111111111111211111112
                                                  by solve( state_11111111111111111111211111112( ~RouterID.1,
                                                                                                 ~ServerID.1,
                                                                                                 ~ak_h.1,
                                                                                                 ~ak_sk.1,
                                                                                                 ~ssk_nms.1,
                                                                                                 a_h, obj_ap,
                                                                                                 obj_h,
                                                                                                 obj_pd,
                                                                                                 obj_pk,
                                                                                                 obj_sh, ~n.2
                                                            ) ▶₀ #t2.4 )
                                                qed
                                              qed
                                            qed
                                          next
                                            case case_2
                                            solve( (#t2.6 < #t2.10)  ∥ (#t2.6 = #t2.10)  ∥ (#vr.73 < #t2.6) )
                                              case case_1
                                              by contradiction /* from formulas */
                                            next
                                              case case_2
                                              solve( (#t2.7 < #t2.10)  ∥ (#t2.7 = #t2.10)  ∥
                                                     (#vr.74 < #t2.7) )
                                                case case_1
                                                by contradiction /* from formulas */
                                              next
                                                case case_2
                                                solve( Unlock_4( '4', ~n.2, 'device' ) @ #t2.8 )
                                                  case unlockdevice_0_111111111111111111112111111111
                                                  solve( state_111111111111111111112111111111( ~RouterID.1,
                                                                                               ~ServerID.1,
                                                                                               ~ak_h.1,
                                                                                               ~ak_sk.1,
                                                                                               ~ssk_nms.1,
                                                                                               a_h, a_sk,
                                                                                               obj_ap, obj_h,
                                                                                               obj_pd, obj_pk,
                                                                                               obj_sh, ~n.2
                                                         ) ▶₀ #t2.5 )
                                                    case outsignobjpkobjapask_0_11111111111111111111211111111
                                                    solve( (#t2.4 < #t2.12)  ∥ (#t2.4 = #t2.12) )
                                                      case case_1
                                                      by contradiction /* from formulas */
                                                    next
                                                      case case_2
                                                      solve( (#t2.8 < #t2.14)  ∥ (#t2.8 = #t2.14) )
                                                        case case_1
                                                        by contradiction /* from formulas */
                                                      next
                                                        case case_2
                                                        solve( (#vr.39 < #t2.12)  ∥ (#vr.39 = #t2.12) )
                                                          case case_1
                                                          solve( (#vr.45 < #t2.13)  ∥ (#vr.45 = #t2.13) )
                                                            case case_1
                                                            solve( (#t2.13 < #t2.7)  ∥ (#t2.13 = #t2.7) )
                                                              case case_1
                                                              by contradiction /* from formulas */
                                                            next
                                                              case case_2
                                                              solve( (#t2.9 < #t2.12)  ∥ (#t2.9 = #t2.12) )
                                                                case case_1
                                                                by contradiction /* from formulas */
                                                              next
                                                                case case_2
                                                                solve( TPM_SendCommand( <'TPM2_Create', 
                                                                                         <swstate, nil>, 
                                                                                         'TPM_CC_PolicyPCR', 
                                                                                         nil>
                                                                       ) @ #t2.10 )
                                                                  case eventTPMSendCommandTPMCreateswstatenilTPMCCPolicyPCRnil_0_11111111111112111
                                                                  solve( state_11111111111112111( ~RouterID.1,
                                                                                                  ~ServerID.1,
                                                                                                  ~ak_h.1,
                                                                                                  ~ak_sk.1,
                                                                                                  ~ssk_nms.1,
                                                                                                  ~tid.1
                                                                         ) ▶₀ #t2.6 )
                                                                    case outTPMPCRExtendswstate_0_1111111111111211
                                                                    solve( TPM_SendCommand( <'TPM2_Certify', 
                                                                                             k_sh, ~k_h, ~ak_h
                                                                                            >
                                                                           ) @ #t2.10 )
                                                                      case eventTPMSendCommandTPMCertifytlsshtlshakh_0_111111111111121111111111111
                                                                      solve( state_111111111111121111111111111( ~RouterID.1,
                                                                                                                ~ServerID.1,
                                                                                                                ~ak_h,
                                                                                                                ~ak_sk.1,
                                                                                                                ~ssk_nms.1,
                                                                                                                ~tid.1,
                                                                                                                ~k_h,
                                                                                                                k_sh,
                                                                                                                tls_spk
                                                                             ) ▶₀ #t2.6 )
                                                                        case outTPMPolicyPCRtlssh_0_11111111111112111111111111
                                                                        solve( TPM_SendCommand( <
                                                                                                 'TPM2_Create', 
                                                                                                 <swstate, nil
                                                                                                 >, 
                                                                                                 'TPM_CC_PolicyPCR', 
                                                                                                 nil>
                                                                               ) @ #t2.10 )
                                                                          case eventTPMSendCommandTPMCreateswstatenilTPMCCPolicyPCRnil_0_11111111111112111
                                                                          solve( state_11111111111112111( ~RouterID.1,
                                                                                                          ~ServerID.1,
                                                                                                          ~ak_h.1,
                                                                                                          ~ak_sk.1,
                                                                                                          ~ssk_nms.1,
                                                                                                          ~tid.1
                                                                                 ) ▶₀ #t2.6 )
                                                                            case outTPMPCRExtendswstate_0_1111111111111211
                                                                            solve( Insert( <'privatePart', 
                                                                                            ~k_h>,
                                                                                           k_sk.1
                                                                                   ) @ #t2.6 )
                                                                              case insertprivatePartakhaksk_0_111111111111111
                                                                              by solve( state_111111111111111( ~RouterID.1,
                                                                                                               ~ServerID.1,
                                                                                                               ~k_h,
                                                                                                               ~ak_sk.1,
                                                                                                               ~ssk_nms.1
                                                                                        ) ▶₀ #t2.6 )
                                                                            next
                                                                              case insertprivatePartkhksk_0_111111111111111111111121111111
                                                                              solve( state_111111111111111111111121111111( ~RouterID.1,
                                                                                                                           ~ServerID.1,
                                                                                                                           ~ak_h.1,
                                                                                                                           ~ak_sk.1,
                                                                                                                           ~k_h,
                                                                                                                           ~k_sk.1,
                                                                                                                           ~ssk_nms.1,
                                                                                                                           authPolicy,
                                                                                                                           lock
                                                                                     ) ▶₀ #t2.6 )
                                                                                case insertauthPolicykhauthPolicy_0_11111111111111111111112111111
                                                                                by contradiction /* cyclic */
                                                                              qed
                                                                            qed
                                                                          qed
                                                                        qed
                                                                      qed
                                                                    qed
                                                                  qed
                                                                qed
                                                              qed
                                                            qed
                                                          next
                                                            case case_2
                                                            by contradiction /* from formulas */
                                                          qed
                                                        next
                                                          case case_2
                                                          by contradiction /* from formulas */
                                                        qed
                                                      qed
                                                    qed
                                                  qed
                                                next
                                                  case unlockdevice_0_11111111111111111111211111112
                                                  by solve( state_11111111111111111111211111112( ~RouterID.1,
                                                                                                 ~ServerID.1,
                                                                                                 ~ak_h.1,
                                                                                                 ~ak_sk.1,
                                                                                                 ~ssk_nms.1,
                                                                                                 a_h, obj_ap,
                                                                                                 obj_h,
                                                                                                 obj_pd,
                                                                                                 obj_pk,
                                                                                                 obj_sh, ~n.2
                                                            ) ▶₀ #t2.5 )
                                                qed
                                              next
                                                case case_3
                                                solve( Unlock_4( '4', ~n.2, 'device' ) @ #t2.8 )
                                                  case unlockdevice_0_111111111111111111112111111111
                                                  solve( state_111111111111111111112111111111( ~RouterID.1,
                                                                                               ~ServerID.1,
                                                                                               ~ak_h.1,
                                                                                               ~ak_sk.1,
                                                                                               ~ssk_nms.1,
                                                                                               a_h, a_sk,
                                                                                               obj_ap, obj_h,
                                                                                               obj_pd, obj_pk,
                                                                                               obj_sh, ~n.2
                                                         ) ▶₀ #t2.5 )
                                                    case outsignobjpkobjapask_0_11111111111111111111211111111
                                                    solve( (#t2.4 < #t2.13)  ∥ (#t2.4 = #t2.13) )
                                                      case case_1
                                                      by contradiction /* from formulas */
                                                    next
                                                      case case_2
                                                      solve( (#t2.10 < #t2.15)  ∥ (#t2.10 = #t2.15) )
                                                        case case_1
                                                        by contradiction /* from formulas */
                                                      next
                                                        case case_2
                                                        solve( (#vr.39 < #t2.13)  ∥ (#vr.39 = #t2.13) )
                                                          case case_1
                                                          solve( (#vr.45 < #t2.14)  ∥ (#vr.45 = #t2.14) )
                                                            case case_1
                                                            solve( (#t2.14 < #t2.7)  ∥ (#t2.14 = #t2.7) )
                                                              case case_1
                                                              by contradiction /* from formulas */
                                                            next
                                                              case case_2
                                                              solve( (#t2.9 < #t2.13)  ∥ (#t2.9 = #t2.13) )
                                                                case case_1
                                                                by contradiction /* from formulas */
                                                              next
                                                                case case_2
                                                                solve( TPM_SendCommand( <'TPM2_Create', 
                                                                                         <swstate, nil>, 
                                                                                         'TPM_CC_PolicyPCR', 
                                                                                         nil>
                                                                       ) @ #t2.11 )
                                                                  case eventTPMSendCommandTPMCreateswstatenilTPMCCPolicyPCRnil_0_11111111111112111
                                                                  solve( state_11111111111112111( ~RouterID.1,
                                                                                                  ~ServerID.1,
                                                                                                  ~ak_h.1,
                                                                                                  ~ak_sk.1,
                                                                                                  ~ssk_nms.1,
                                                                                                  ~tid.1
                                                                         ) ▶₀ #t2.6 )
                                                                    case outTPMPCRExtendswstate_0_1111111111111211
                                                                    solve( TPM_SendCommand( <'TPM2_Certify', 
                                                                                             k_sh, ~k_h, ~ak_h
                                                                                            >
                                                                           ) @ #t2.11 )
                                                                      case eventTPMSendCommandTPMCertifytlsshtlshakh_0_111111111111121111111111111
                                                                      solve( state_111111111111121111111111111( ~RouterID.1,
                                                                                                                ~ServerID.1,
                                                                                                                ~ak_h,
                                                                                                                ~ak_sk.1,
                                                                                                                ~ssk_nms.1,
                                                                                                                ~tid.1,
                                                                                                                ~k_h,
                                                                                                                k_sh,
                                                                                                                tls_spk
                                                                             ) ▶₀ #t2.6 )
                                                                        case outTPMPolicyPCRtlssh_0_11111111111112111111111111
                                                                        solve( TPM_SendCommand( <
                                                                                                 'TPM2_Create', 
                                                                                                 <swstate, nil
                                                                                                 >, 
                                                                                                 'TPM_CC_PolicyPCR', 
                                                                                                 nil>
                                                                               ) @ #t2.11 )
                                                                          case eventTPMSendCommandTPMCreateswstatenilTPMCCPolicyPCRnil_0_11111111111112111
                                                                          solve( state_11111111111112111( ~RouterID.1,
                                                                                                          ~ServerID.1,
                                                                                                          ~ak_h.1,
                                                                                                          ~ak_sk.1,
                                                                                                          ~ssk_nms.1,
                                                                                                          ~tid.1
                                                                                 ) ▶₀ #t2.6 )
                                                                            case outTPMPCRExtendswstate_0_1111111111111211
                                                                            solve( Insert( <'privatePart', 
                                                                                            ~k_h>,
                                                                                           k_sk.1
                                                                                   ) @ #t2.6 )
                                                                              case insertprivatePartakhaksk_0_111111111111111
                                                                              by solve( state_111111111111111( ~RouterID.1,
                                                                                                               ~ServerID.1,
                                                                                                               ~k_h,
                                                                                                               ~ak_sk.1,
                                                                                                               ~ssk_nms.1
                                                                                        ) ▶₀ #t2.6 )
                                                                            next
                                                                              case insertprivatePartkhksk_0_111111111111111111111121111111
                                                                              solve( state_111111111111111111111121111111( ~RouterID.1,
                                                                                                                           ~ServerID.1,
                                                                                                                           ~ak_h.1,
                                                                                                                           ~ak_sk.1,
                                                                                                                           ~k_h,
                                                                                                                           ~k_sk.1,
                                                                                                                           ~ssk_nms.1,
                                                                                                                           authPolicy,
                                                                                                                           lock
                                                                                     ) ▶₀ #t2.6 )
                                                                                case insertauthPolicykhauthPolicy_0_11111111111111111111112111111
                                                                                by contradiction /* cyclic */
                                                                              qed
                                                                            qed
                                                                          qed
                                                                        qed
                                                                      qed
                                                                    qed
                                                                  qed
                                                                qed
                                                              qed
                                                            qed
                                                          next
                                                            case case_2
                                                            by contradiction /* from formulas */
                                                          qed
                                                        next
                                                          case case_2
                                                          by contradiction /* from formulas */
                                                        qed
                                                      qed
                                                    qed
                                                  qed
                                                next
                                                  case unlockdevice_0_11111111111111111111211111112
                                                  by solve( state_11111111111111111111211111112( ~RouterID.1,
                                                                                                 ~ServerID.1,
                                                                                                 ~ak_h.1,
                                                                                                 ~ak_sk.1,
                                                                                                 ~ssk_nms.1,
                                                                                                 a_h, obj_ap,
                                                                                                 obj_h,
                                                                                                 obj_pd,
                                                                                                 obj_pk,
                                                                                                 obj_sh, ~n.2
                                                            ) ▶₀ #t2.5 )
                                                qed
                                              qed
                                            next
                                              case case_3
                                              solve( (#t2.7 < #t2.11)  ∥ (#t2.7 = #t2.11)  ∥
                                                     (#vr.74 < #t2.7) )
                                                case case_1
                                                by contradiction /* from formulas */
                                              next
                                                case case_2
                                                solve( Unlock_4( '4', ~n.2, 'device' ) @ #t2.8 )
                                                  case unlockdevice_0_111111111111111111112111111111
                                                  solve( state_111111111111111111112111111111( ~RouterID.1,
                                                                                               ~ServerID.1,
                                                                                               ~ak_h.1,
                                                                                               ~ak_sk.1,
                                                                                               ~ssk_nms.1,
                                                                                               a_h, a_sk,
                                                                                               obj_ap, obj_h,
                                                                                               obj_pd, obj_pk,
                                                                                               obj_sh, ~n.2
                                                         ) ▶₀ #t2.5 )
                                                    case outsignobjpkobjapask_0_11111111111111111111211111111
                                                    solve( (#t2.4 < #t2.13)  ∥ (#t2.4 = #t2.13) )
                                                      case case_1
                                                      by contradiction /* from formulas */
                                                    next
                                                      case case_2
                                                      solve( (#t2.8 < #t2.15)  ∥ (#t2.8 = #t2.15) )
                                                        case case_1
                                                        by contradiction /* from formulas */
                                                      next
                                                        case case_2
                                                        solve( (#vr.39 < #t2.13)  ∥ (#vr.39 = #t2.13) )
                                                          case case_1
                                                          solve( (#vr.45 < #t2.14)  ∥ (#vr.45 = #t2.14) )
                                                            case case_1
                                                            solve( (#t2.10 < #t2.14)  ∥ (#t2.10 = #t2.14) )
                                                              case case_1
                                                              by contradiction /* from formulas */
                                                            next
                                                              case case_2
                                                              solve( (#t2.9 < #t2.13)  ∥ (#t2.9 = #t2.13) )
                                                                case case_1
                                                                by contradiction /* from formulas */
                                                              next
                                                                case case_2
                                                                solve( TPM_SendCommand( <'TPM2_Create', 
                                                                                         <swstate, nil>, 
                                                                                         'TPM_CC_PolicyPCR', 
                                                                                         nil>
                                                                       ) @ #t2.11 )
                                                                  case eventTPMSendCommandTPMCreateswstatenilTPMCCPolicyPCRnil_0_11111111111112111
                                                                  solve( state_11111111111112111( ~RouterID.1,
                                                                                                  ~ServerID.1,
                                                                                                  ~ak_h.1,
                                                                                                  ~ak_sk.1,
                                                                                                  ~ssk_nms.1,
                                                                                                  ~tid.1
                                                                         ) ▶₀ #t2.6 )
                                                                    case outTPMPCRExtendswstate_0_1111111111111211
                                                                    solve( TPM_SendCommand( <'TPM2_Certify', 
                                                                                             k_sh, ~k_h, ~ak_h
                                                                                            >
                                                                           ) @ #t2.11 )
                                                                      case eventTPMSendCommandTPMCertifytlsshtlshakh_0_111111111111121111111111111
                                                                      solve( state_111111111111121111111111111( ~RouterID.1,
                                                                                                                ~ServerID.1,
                                                                                                                ~ak_h,
                                                                                                                ~ak_sk.1,
                                                                                                                ~ssk_nms.1,
                                                                                                                ~tid.1,
                                                                                                                ~k_h,
                                                                                                                k_sh,
                                                                                                                tls_spk
                                                                             ) ▶₀ #t2.6 )
                                                                        case outTPMPolicyPCRtlssh_0_11111111111112111111111111
                                                                        solve( TPM_SendCommand( <
                                                                                                 'TPM2_Create', 
                                                                                                 <swstate, nil
                                                                                                 >, 
                                                                                                 'TPM_CC_PolicyPCR', 
                                                                                                 nil>
                                                                               ) @ #t2.11 )
                                                                          case eventTPMSendCommandTPMCreateswstatenilTPMCCPolicyPCRnil_0_11111111111112111
                                                                          solve( state_11111111111112111( ~RouterID.1,
                                                                                                          ~ServerID.1,
                                                                                                          ~ak_h.1,
                                                                                                          ~ak_sk.1,
                                                                                                          ~ssk_nms.1,
                                                                                                          ~tid.1
                                                                                 ) ▶₀ #t2.6 )
                                                                            case outTPMPCRExtendswstate_0_1111111111111211
                                                                            solve( Insert( <'privatePart', 
                                                                                            ~k_h>,
                                                                                           k_sk.1
                                                                                   ) @ #t2.6 )
                                                                              case insertprivatePartakhaksk_0_111111111111111
                                                                              by solve( state_111111111111111( ~RouterID.1,
                                                                                                               ~ServerID.1,
                                                                                                               ~k_h,
                                                                                                               ~ak_sk.1,
                                                                                                               ~ssk_nms.1
                                                                                        ) ▶₀ #t2.6 )
                                                                            next
                                                                              case insertprivatePartkhksk_0_111111111111111111111121111111
                                                                              solve( state_111111111111111111111121111111( ~RouterID.1,
                                                                                                                           ~ServerID.1,
                                                                                                                           ~ak_h.1,
                                                                                                                           ~ak_sk.1,
                                                                                                                           ~k_h,
                                                                                                                           ~k_sk.1,
                                                                                                                           ~ssk_nms.1,
                                                                                                                           authPolicy,
                                                                                                                           lock
                                                                                     ) ▶₀ #t2.6 )
                                                                                case insertauthPolicykhauthPolicy_0_11111111111111111111112111111
                                                                                by contradiction /* cyclic */
                                                                              qed
                                                                            qed
                                                                          qed
                                                                        qed
                                                                      qed
                                                                    qed
                                                                  qed
                                                                qed
                                                              qed
                                                            qed
                                                          next
                                                            case case_2
                                                            by contradiction /* from formulas */
                                                          qed
                                                        next
                                                          case case_2
                                                          by contradiction /* from formulas */
                                                        qed
                                                      qed
                                                    qed
                                                  qed
                                                next
                                                  case unlockdevice_0_11111111111111111111211111112
                                                  by solve( state_11111111111111111111211111112( ~RouterID.1,
                                                                                                 ~ServerID.1,
                                                                                                 ~ak_h.1,
                                                                                                 ~ak_sk.1,
                                                                                                 ~ssk_nms.1,
                                                                                                 a_h, obj_ap,
                                                                                                 obj_h,
                                                                                                 obj_pd,
                                                                                                 obj_pk,
                                                                                                 obj_sh, ~n.2
                                                            ) ▶₀ #t2.5 )
                                                qed
                                              next
                                                case case_3
                                                solve( Unlock_4( '4', ~n.2, 'device' ) @ #t2.8 )
                                                  case unlockdevice_0_111111111111111111112111111111
                                                  solve( state_111111111111111111112111111111( ~RouterID.1,
                                                                                               ~ServerID.1,
                                                                                               ~ak_h.1,
                                                                                               ~ak_sk.1,
                                                                                               ~ssk_nms.1,
                                                                                               a_h, a_sk,
                                                                                               obj_ap, obj_h,
                                                                                               obj_pd, obj_pk,
                                                                                               obj_sh, ~n.2
                                                         ) ▶₀ #t2.5 )
                                                    case outsignobjpkobjapask_0_11111111111111111111211111111
                                                    solve( (#t2.4 < #t2.14)  ∥ (#t2.4 = #t2.14) )
                                                      case case_1
                                                      by contradiction /* from formulas */
                                                    next
                                                      case case_2
                                                      solve( (#t2.11 < #t2.16)  ∥ (#t2.11 = #t2.16) )
                                                        case case_1
                                                        by contradiction /* from formulas */
                                                      next
                                                        case case_2
                                                        solve( (#vr.39 < #t2.14)  ∥ (#vr.39 = #t2.14) )
                                                          case case_1
                                                          solve( (#vr.45 < #t2.15)  ∥ (#vr.45 = #t2.15) )
                                                            case case_1
                                                            solve( (#t2.10 < #t2.15)  ∥ (#t2.10 = #t2.15) )
                                                              case case_1
                                                              by contradiction /* from formulas */
                                                            next
                                                              case case_2
                                                              solve( (#t2.9 < #t2.14)  ∥ (#t2.9 = #t2.14) )
                                                                case case_1
                                                                by contradiction /* from formulas */
                                                              next
                                                                case case_2
                                                                solve( TPM_SendCommand( <'TPM2_Create', 
                                                                                         <swstate, nil>, 
                                                                                         'TPM_CC_PolicyPCR', 
                                                                                         nil>
                                                                       ) @ #t2.12 )
                                                                  case eventTPMSendCommandTPMCreateswstatenilTPMCCPolicyPCRnil_0_11111111111112111
                                                                  solve( state_11111111111112111( ~RouterID.1,
                                                                                                  ~ServerID.1,
                                                                                                  ~ak_h.1,
                                                                                                  ~ak_sk.1,
                                                                                                  ~ssk_nms.1,
                                                                                                  ~tid.1
                                                                         ) ▶₀ #t2.6 )
                                                                    case outTPMPCRExtendswstate_0_1111111111111211
                                                                    solve( TPM_SendCommand( <'TPM2_Certify', 
                                                                                             k_sh, ~k_h, ~ak_h
                                                                                            >
                                                                           ) @ #t2.12 )
                                                                      case eventTPMSendCommandTPMCertifytlsshtlshakh_0_111111111111121111111111111
                                                                      solve( state_111111111111121111111111111( ~RouterID.1,
                                                                                                                ~ServerID.1,
                                                                                                                ~ak_h,
                                                                                                                ~ak_sk.1,
                                                                                                                ~ssk_nms.1,
                                                                                                                ~tid.1,
                                                                                                                ~k_h,
                                                                                                                k_sh,
                                                                                                                tls_spk
                                                                             ) ▶₀ #t2.6 )
                                                                        case outTPMPolicyPCRtlssh_0_11111111111112111111111111
                                                                        solve( TPM_SendCommand( <
                                                                                                 'TPM2_Create', 
                                                                                                 <swstate, nil
                                                                                                 >, 
                                                                                                 'TPM_CC_PolicyPCR', 
                                                                                                 nil>
                                                                               ) @ #t2.12 )
                                                                          case eventTPMSendCommandTPMCreateswstatenilTPMCCPolicyPCRnil_0_11111111111112111
                                                                          solve( state_11111111111112111( ~RouterID.1,
                                                                                                          ~ServerID.1,
                                                                                                          ~ak_h.1,
                                                                                                          ~ak_sk.1,
                                                                                                          ~ssk_nms.1,
                                                                                                          ~tid.1
                                                                                 ) ▶₀ #t2.6 )
                                                                            case outTPMPCRExtendswstate_0_1111111111111211
                                                                            solve( Insert( <'privatePart', 
                                                                                            ~k_h>,
                                                                                           k_sk.1
                                                                                   ) @ #t2.6 )
                                                                              case insertprivatePartakhaksk_0_111111111111111
                                                                              by solve( state_111111111111111( ~RouterID.1,
                                                                                                               ~ServerID.1,
                                                                                                               ~k_h,
                                                                                                               ~ak_sk.1,
                                                                                                               ~ssk_nms.1
                                                                                        ) ▶₀ #t2.6 )
                                                                            next
                                                                              case insertprivatePartkhksk_0_111111111111111111111121111111
                                                                              solve( state_111111111111111111111121111111( ~RouterID.1,
                                                                                                                           ~ServerID.1,
                                                                                                                           ~ak_h.1,
                                                                                                                           ~ak_sk.1,
                                                                                                                           ~k_h,
                                                                                                                           ~k_sk.1,
                                                                                                                           ~ssk_nms.1,
                                                                                                                           authPolicy,
                                                                                                                           lock
                                                                                     ) ▶₀ #t2.6 )
                                                                                case insertauthPolicykhauthPolicy_0_11111111111111111111112111111
                                                                                by contradiction /* cyclic */
                                                                              qed
                                                                            qed
                                                                          qed
                                                                        qed
                                                                      qed
                                                                    qed
                                                                  qed
                                                                qed
                                                              qed
                                                            qed
                                                          next
                                                            case case_2
                                                            by contradiction /* from formulas */
                                                          qed
                                                        next
                                                          case case_2
                                                          by contradiction /* from formulas */
                                                        qed
                                                      qed
                                                    qed
                                                  qed
                                                next
                                                  case unlockdevice_0_11111111111111111111211111112
                                                  by solve( state_11111111111111111111211111112( ~RouterID.1,
                                                                                                 ~ServerID.1,
                                                                                                 ~ak_h.1,
                                                                                                 ~ak_sk.1,
                                                                                                 ~ssk_nms.1,
                                                                                                 a_h, obj_ap,
                                                                                                 obj_h,
                                                                                                 obj_pd,
                                                                                                 obj_pk,
                                                                                                 obj_sh, ~n.2
                                                            ) ▶₀ #t2.5 )
                                                qed
                                              qed
                                            qed
                                          qed
                                        next
                                          case case_2
                                          solve( (#vr.32 < #t2.9)  ∥ (#vr.32 = #t2.9) )
                                            case case_1
                                            solve( (#t2.7 < #t2.11)  ∥ (#t2.7 = #t2.11)  ∥ (#vr.74 < #t2.7) )
                                              case case_1
                                              by contradiction /* from formulas */
                                            next
                                              case case_2
                                              solve( Unlock_4( '4', ~n.2, 'device' ) @ #t2.8 )
                                                case unlockdevice_0_111111111111111111112111111111
                                                solve( state_111111111111111111112111111111( ~RouterID.1,
                                                                                             ~ServerID.1,
                                                                                             ~ak_h.1,
                                                                                             ~ak_sk.1,
                                                                                             ~ssk_nms.1, a_h,
                                                                                             a_sk, obj_ap,
                                                                                             obj_h, obj_pd,
                                                                                             obj_pk, obj_sh,
                                                                                             ~n.2
                                                       ) ▶₀ #t2.5 )
                                                  case outsignobjpkobjapask_0_11111111111111111111211111111
                                                  solve( (#t2.4 < #t2.15)  ∥ (#t2.4 = #t2.15) )
                                                    case case_1
                                                    by contradiction /* from formulas */
                                                  next
                                                    case case_2
                                                    solve( (#t2.8 < #t2.15)  ∥ (#t2.8 = #t2.15) )
                                                      case case_1
                                                      by contradiction /* from formulas */
                                                    next
                                                      case case_2
                                                      solve( (#vr.32 < #t2.13)  ∥ (#vr.32 = #t2.13) )
                                                        case case_1
                                                        solve( (#vr.40 < #t2.14)  ∥ (#vr.40 = #t2.14) )
                                                          case case_1
                                                          solve( (#t2.10 < #t2.14)  ∥ (#t2.10 = #t2.14) )
                                                            case case_1
                                                            by contradiction /* from formulas */
                                                          next
                                                            case case_2
                                                            solve( (#t2.9 < #t2.13)  ∥ (#t2.9 = #t2.13) )
                                                              case case_1
                                                              by contradiction /* from formulas */
                                                            next
                                                              case case_2
                                                              solve( TPM_SendCommand( <'TPM2_Create', 
                                                                                       <swstate, nil>, 
                                                                                       'TPM_CC_PolicyPCR', nil
                                                                                      >
                                                                     ) @ #t2.11 )
                                                                case eventTPMSendCommandTPMCreateswstatenilTPMCCPolicyPCRnil_0_11111111111112111
                                                                solve( state_11111111111112111( ~RouterID.1,
                                                                                                ~ServerID.1,
                                                                                                ~ak_h.1,
                                                                                                ~ak_sk.1,
                                                                                                ~ssk_nms.1,
                                                                                                ~tid.1
                                                                       ) ▶₀ #t2.6 )
                                                                  case outTPMPCRExtendswstate_0_1111111111111211
                                                                  solve( TPM_SendCommand( <'TPM2_Certify', 
                                                                                           k_sh, ~k_h, ~ak_h>
                                                                         ) @ #t2.11 )
                                                                    case eventTPMSendCommandTPMCertifytlsshtlshakh_0_111111111111121111111111111
                                                                    solve( state_111111111111121111111111111( ~RouterID.1,
                                                                                                              ~ServerID.1,
                                                                                                              ~ak_h,
                                                                                                              ~ak_sk.1,
                                                                                                              ~ssk_nms.1,
                                                                                                              ~tid.1,
                                                                                                              ~k_h,
                                                                                                              k_sh,
                                                                                                              tls_spk
                                                                           ) ▶₀ #t2.6 )
                                                                      case outTPMPolicyPCRtlssh_0_11111111111112111111111111
                                                                      solve( TPM_SendCommand( <'TPM2_Create', 
                                                                                               <swstate, nil
                                                                                               >, 
                                                                                               'TPM_CC_PolicyPCR', 
                                                                                               nil>
                                                                             ) @ #t2.11 )
                                                                        case eventTPMSendCommandTPMCreateswstatenilTPMCCPolicyPCRnil_0_11111111111112111
                                                                        solve( state_11111111111112111( ~RouterID.1,
                                                                                                        ~ServerID.1,
                                                                                                        ~ak_h.1,
                                                                                                        ~ak_sk.1,
                                                                                                        ~ssk_nms.1,
                                                                                                        ~tid.1
                                                                               ) ▶₀ #t2.6 )
                                                                          case outTPMPCRExtendswstate_0_1111111111111211
                                                                          solve( Insert( <'privatePart', ~k_h
                                                                                         >,
                                                                                         k_sk.1
                                                                                 ) @ #t2.7 )
                                                                            case insertprivatePartakhaksk_0_111111111111111
                                                                            by solve( state_111111111111111( ~RouterID.1,
                                                                                                             ~ServerID.1,
                                                                                                             ~k_h,
                                                                                                             ~ak_sk.1,
                                                                                                             ~ssk_nms.1
                                                                                      ) ▶₀ #t2.6 )
                                                                          next
                                                                            case insertprivatePartkhksk_0_111111111111111111111121111111
                                                                            solve( state_111111111111111111111121111111( ~RouterID.1,
                                                                                                                         ~ServerID.1,
                                                                                                                         ~ak_h.1,
                                                                                                                         ~ak_sk.1,
                                                                                                                         ~k_h,
                                                                                                                         ~k_sk.1,
                                                                                                                         ~ssk_nms.1,
                                                                                                                         authPolicy,
                                                                                                                         lock
                                                                                   ) ▶₀ #t2.6 )
                                                                              case insertauthPolicykhauthPolicy_0_11111111111111111111112111111
                                                                              by contradiction /* cyclic */
                                                                            qed
                                                                          qed
                                                                        qed
                                                                      qed
                                                                    qed
                                                                  qed
                                                                qed
                                                              qed
                                                            qed
                                                          qed
                                                        next
                                                          case case_2
                                                          by contradiction /* from formulas */
                                                        qed
                                                      next
                                                        case case_2
                                                        by contradiction /* from formulas */
                                                      qed
                                                    qed
                                                  qed
                                                qed
                                              next
                                                case unlockdevice_0_11111111111111111111211111112
                                                by solve( state_11111111111111111111211111112( ~RouterID.1,
                                                                                               ~ServerID.1,
                                                                                               ~ak_h.1,
                                                                                               ~ak_sk.1,
                                                                                               ~ssk_nms.1,
                                                                                               a_h, obj_ap,
                                                                                               obj_h, obj_pd,
                                                                                               obj_pk, obj_sh,
                                                                                               ~n.2
                                                          ) ▶₀ #t2.5 )
                                              qed
                                            next
                                              case case_3
                                              solve( Unlock_4( '4', ~n.2, 'device' ) @ #t2.8 )
                                                case unlockdevice_0_111111111111111111112111111111
                                                solve( state_111111111111111111112111111111( ~RouterID.1,
                                                                                             ~ServerID.1,
                                                                                             ~ak_h.1,
                                                                                             ~ak_sk.1,
                                                                                             ~ssk_nms.1, a_h,
                                                                                             a_sk, obj_ap,
                                                                                             obj_h, obj_pd,
                                                                                             obj_pk, obj_sh,
                                                                                             ~n.2
                                                       ) ▶₀ #t2.5 )
                                                  case outsignobjpkobjapask_0_11111111111111111111211111111
                                                  solve( (#t2.4 < #t2.16)  ∥ (#t2.4 = #t2.16) )
                                                    case case_1
                                                    by contradiction /* from formulas */
                                                  next
                                                    case case_2
                                                    solve( (#t2.11 < #t2.16)  ∥ (#t2.11 = #t2.16) )
                                                      case case_1
                                                      by contradiction /* from formulas */
                                                    next
                                                      case case_2
                                                      solve( (#vr.32 < #t2.14)  ∥ (#vr.32 = #t2.14) )
                                                        case case_1
                                                        solve( (#vr.40 < #t2.15)  ∥ (#vr.40 = #t2.15) )
                                                          case case_1
                                                          solve( (#t2.10 < #t2.15)  ∥ (#t2.10 = #t2.15) )
                                                            case case_1
                                                            by contradiction /* from formulas */
                                                          next
                                                            case case_2
                                                            solve( (#t2.9 < #t2.14)  ∥ (#t2.9 = #t2.14) )
                                                              case case_1
                                                              by contradiction /* from formulas */
                                                            next
                                                              case case_2
                                                              solve( TPM_SendCommand( <'TPM2_Create', 
                                                                                       <swstate, nil>, 
                                                                                       'TPM_CC_PolicyPCR', nil
                                                                                      >
                                                                     ) @ #t2.12 )
                                                                case eventTPMSendCommandTPMCreateswstatenilTPMCCPolicyPCRnil_0_11111111111112111
                                                                solve( state_11111111111112111( ~RouterID.1,
                                                                                                ~ServerID.1,
                                                                                                ~ak_h.1,
                                                                                                ~ak_sk.1,
                                                                                                ~ssk_nms.1,
                                                                                                ~tid.1
                                                                       ) ▶₀ #t2.6 )
                                                                  case outTPMPCRExtendswstate_0_1111111111111211
                                                                  solve( TPM_SendCommand( <'TPM2_Certify', 
                                                                                           k_sh, ~k_h, ~ak_h>
                                                                         ) @ #t2.12 )
                                                                    case eventTPMSendCommandTPMCertifytlsshtlshakh_0_111111111111121111111111111
                                                                    solve( state_111111111111121111111111111( ~RouterID.1,
                                                                                                              ~ServerID.1,
                                                                                                              ~ak_h,
                                                                                                              ~ak_sk.1,
                                                                                                              ~ssk_nms.1,
                                                                                                              ~tid.1,
                                                                                                              ~k_h,
                                                                                                              k_sh,
                                                                                                              tls_spk
                                                                           ) ▶₀ #t2.6 )
                                                                      case outTPMPolicyPCRtlssh_0_11111111111112111111111111
                                                                      solve( TPM_SendCommand( <'TPM2_Create', 
                                                                                               <swstate, nil
                                                                                               >, 
                                                                                               'TPM_CC_PolicyPCR', 
                                                                                               nil>
                                                                             ) @ #t2.12 )
                                                                        case eventTPMSendCommandTPMCreateswstatenilTPMCCPolicyPCRnil_0_11111111111112111
                                                                        solve( state_11111111111112111( ~RouterID.1,
                                                                                                        ~ServerID.1,
                                                                                                        ~ak_h.1,
                                                                                                        ~ak_sk.1,
                                                                                                        ~ssk_nms.1,
                                                                                                        ~tid.1
                                                                               ) ▶₀ #t2.6 )
                                                                          case outTPMPCRExtendswstate_0_1111111111111211
                                                                          solve( Insert( <'privatePart', ~k_h
                                                                                         >,
                                                                                         k_sk.1
                                                                                 ) @ #t2.7 )
                                                                            case insertprivatePartakhaksk_0_111111111111111
                                                                            by solve( state_111111111111111( ~RouterID.1,
                                                                                                             ~ServerID.1,
                                                                                                             ~k_h,
                                                                                                             ~ak_sk.1,
                                                                                                             ~ssk_nms.1
                                                                                      ) ▶₀ #t2.6 )
                                                                          next
                                                                            case insertprivatePartkhksk_0_111111111111111111111121111111
                                                                            solve( state_111111111111111111111121111111( ~RouterID.1,
                                                                                                                         ~ServerID.1,
                                                                                                                         ~ak_h.1,
                                                                                                                         ~ak_sk.1,
                                                                                                                         ~k_h,
                                                                                                                         ~k_sk.1,
                                                                                                                         ~ssk_nms.1,
                                                                                                                         authPolicy,
                                                                                                                         lock
                                                                                   ) ▶₀ #t2.6 )
                                                                              case insertauthPolicykhauthPolicy_0_11111111111111111111112111111
                                                                              by contradiction /* cyclic */
                                                                            qed
                                                                          qed
                                                                        qed
                                                                      qed
                                                                    qed
                                                                  qed
                                                                qed
                                                              qed
                                                            qed
                                                          qed
                                                        next
                                                          case case_2
                                                          by contradiction /* from formulas */
                                                        qed
                                                      next
                                                        case case_2
                                                        by contradiction /* from formulas */
                                                      qed
                                                    qed
                                                  qed
                                                qed
                                              next
                                                case unlockdevice_0_11111111111111111111211111112
                                                by solve( state_11111111111111111111211111112( ~RouterID.1,
                                                                                               ~ServerID.1,
                                                                                               ~ak_h.1,
                                                                                               ~ak_sk.1,
                                                                                               ~ssk_nms.1,
                                                                                               a_h, obj_ap,
                                                                                               obj_h, obj_pd,
                                                                                               obj_pk, obj_sh,
                                                                                               ~n.2
                                                          ) ▶₀ #t2.5 )
                                              qed
                                            qed
                                          next
                                            case case_2
                                            solve( (#t2.8 < #t2.11)  ∥ (#t2.8 = #t2.11)  ∥ (#vr.73 < #t2.8) )
                                              case case_1
                                              by contradiction /* from formulas */
                                            next
                                              case case_2
                                              solve( Unlock_4( '4', ~n.2, 'device' ) @ #t2.9 )
                                                case unlockdevice_0_111111111111111111112111111111
                                                solve( state_111111111111111111112111111111( ~RouterID.1,
                                                                                             ~ServerID.1,
                                                                                             ~ak_h.1,
                                                                                             ~ak_sk.1,
                                                                                             ~ssk_nms.1, a_h,
                                                                                             a_sk, obj_ap,
                                                                                             obj_h, obj_pd,
                                                                                             obj_pk, obj_sh,
                                                                                             ~n.2
                                                       ) ▶₀ #t2.6 )
                                                  case outsignobjpkobjapask_0_11111111111111111111211111111
                                                  solve( (#t2.4 < #t2.15)  ∥ (#t2.4 = #t2.15) )
                                                    case case_1
                                                    by contradiction /* from formulas */
                                                  next
                                                    case case_2
                                                    solve( (#t2.5 < #t2.13)  ∥ (#t2.5 = #t2.13) )
                                                      case case_1
                                                      by contradiction /* from formulas */
                                                    next
                                                      case case_2
                                                      solve( (#t2.9 < #t2.14)  ∥ (#t2.9 = #t2.14) )
                                                        case case_1
                                                        by contradiction /* from formulas */
                                                      next
                                                        case case_2
                                                        solve( (#vr.39 < #t2.13)  ∥ (#vr.39 = #t2.13) )
                                                          case case_1
                                                          solve( (#t2.10 < #t2.13)  ∥ (#t2.10 = #t2.13) )
                                                            case case_1
                                                            by contradiction /* from formulas */
                                                          next
                                                            case case_2
                                                            solve( TPM_SendCommand( <'TPM2_Create', 
                                                                                     <swstate, nil>, 
                                                                                     'TPM_CC_PolicyPCR', nil>
                                                                   ) @ #t2.11 )
                                                              case eventTPMSendCommandTPMCreateswstatenilTPMCCPolicyPCRnil_0_11111111111112111
                                                              solve( state_11111111111112111( ~RouterID.1,
                                                                                              ~ServerID.1,
                                                                                              ~ak_h.1,
                                                                                              ~ak_sk.1,
                                                                                              ~ssk_nms.1,
                                                                                              ~tid.1
                                                                     ) ▶₀ #t2.7 )
                                                                case outTPMPCRExtendswstate_0_1111111111111211
                                                                solve( TPM_SendCommand( <'TPM2_Certify', 
                                                                                         k_sh, ~k_h, ~ak_h>
                                                                       ) @ #t2.11 )
                                                                  case eventTPMSendCommandTPMCertifytlsshtlshakh_0_111111111111121111111111111
                                                                  solve( state_111111111111121111111111111( ~RouterID.1,
                                                                                                            ~ServerID.1,
                                                                                                            ~ak_h,
                                                                                                            ~ak_sk.1,
                                                                                                            ~ssk_nms.1,
                                                                                                            ~tid.1,
                                                                                                            ~k_h,
                                                                                                            k_sh,
                                                                                                            tls_spk
                                                                         ) ▶₀ #t2.7 )
                                                                    case outTPMPolicyPCRtlssh_0_11111111111112111111111111
                                                                    solve( TPM_SendCommand( <'TPM2_Create', 
                                                                                             <swstate, nil>, 
                                                                                             'TPM_CC_PolicyPCR', 
                                                                                             nil>
                                                                           ) @ #t2.11 )
                                                                      case eventTPMSendCommandTPMCreateswstatenilTPMCCPolicyPCRnil_0_11111111111112111
                                                                      solve( state_11111111111112111( ~RouterID.1,
                                                                                                      ~ServerID.1,
                                                                                                      ~ak_h.1,
                                                                                                      ~ak_sk.1,
                                                                                                      ~ssk_nms.1,
                                                                                                      ~tid.1
                                                                             ) ▶₀ #t2.7 )
                                                                        case outTPMPCRExtendswstate_0_1111111111111211
                                                                        solve( Insert( <'privatePart', ~k_h>,
                                                                                       k_sk.1
                                                                               ) @ #t2.8 )
                                                                          case insertprivatePartakhaksk_0_111111111111111
                                                                          by solve( state_111111111111111( ~RouterID.1,
                                                                                                           ~ServerID.1,
                                                                                                           ~k_h,
                                                                                                           ~ak_sk.1,
                                                                                                           ~ssk_nms.1
                                                                                    ) ▶₀ #t2.7 )
                                                                        next
                                                                          case insertprivatePartkhksk_0_111111111111111111111121111111
                                                                          solve( state_111111111111111111111121111111( ~RouterID.1,
                                                                                                                       ~ServerID.1,
                                                                                                                       ~ak_h.1,
                                                                                                                       ~ak_sk.1,
                                                                                                                       ~k_h,
                                                                                                                       ~k_sk.1,
                                                                                                                       ~ssk_nms.1,
                                                                                                                       authPolicy,
                                                                                                                       lock
                                                                                 ) ▶₀ #t2.7 )
                                                                            case insertauthPolicykhauthPolicy_0_11111111111111111111112111111
                                                                            by contradiction /* cyclic */
                                                                          qed
                                                                        qed
                                                                      qed
                                                                    qed
                                                                  qed
                                                                qed
                                                              qed
                                                            qed
                                                          qed
                                                        next
                                                          case case_2
                                                          by contradiction /* from formulas */
                                                        qed
                                                      qed
                                                    qed
                                                  qed
                                                qed
                                              next
                                                case unlockdevice_0_11111111111111111111211111112
                                                by solve( state_11111111111111111111211111112( ~RouterID.1,
                                                                                               ~ServerID.1,
                                                                                               ~ak_h.1,
                                                                                               ~ak_sk.1,
                                                                                               ~ssk_nms.1,
                                                                                               a_h, obj_ap,
                                                                                               obj_h, obj_pd,
                                                                                               obj_pk, obj_sh,
                                                                                               ~n.2
                                                          ) ▶₀ #t2.6 )
                                              qed
                                            next
                                              case case_3
                                              solve( Unlock_4( '4', ~n.2, 'device' ) @ #t2.9 )
                                                case unlockdevice_0_111111111111111111112111111111
                                                solve( state_111111111111111111112111111111( ~RouterID.1,
                                                                                             ~ServerID.1,
                                                                                             ~ak_h.1,
                                                                                             ~ak_sk.1,
                                                                                             ~ssk_nms.1, a_h,
                                                                                             a_sk, obj_ap,
                                                                                             obj_h, obj_pd,
                                                                                             obj_pk, obj_sh,
                                                                                             ~n.2
                                                       ) ▶₀ #t2.6 )
                                                  case outsignobjpkobjapask_0_11111111111111111111211111111
                                                  solve( (#t2.4 < #t2.16)  ∥ (#t2.4 = #t2.16) )
                                                    case case_1
                                                    by contradiction /* from formulas */
                                                  next
                                                    case case_2
                                                    solve( (#t2.5 < #t2.14)  ∥ (#t2.5 = #t2.14) )
                                                      case case_1
                                                      by contradiction /* from formulas */
                                                    next
                                                      case case_2
                                                      solve( (#t2.11 < #t2.15)  ∥ (#t2.11 = #t2.15) )
                                                        case case_1
                                                        by contradiction /* from formulas */
                                                      next
                                                        case case_2
                                                        solve( (#vr.39 < #t2.14)  ∥ (#vr.39 = #t2.14) )
                                                          case case_1
                                                          solve( (#t2.10 < #t2.14)  ∥ (#t2.10 = #t2.14) )
                                                            case case_1
                                                            by contradiction /* from formulas */
                                                          next
                                                            case case_2
                                                            solve( TPM_SendCommand( <'TPM2_Create', 
                                                                                     <swstate, nil>, 
                                                                                     'TPM_CC_PolicyPCR', nil>
                                                                   ) @ #t2.12 )
                                                              case eventTPMSendCommandTPMCreateswstatenilTPMCCPolicyPCRnil_0_11111111111112111
                                                              solve( state_11111111111112111( ~RouterID.1,
                                                                                              ~ServerID.1,
                                                                                              ~ak_h.1,
                                                                                              ~ak_sk.1,
                                                                                              ~ssk_nms.1,
                                                                                              ~tid.1
                                                                     ) ▶₀ #t2.7 )
                                                                case outTPMPCRExtendswstate_0_1111111111111211
                                                                solve( TPM_SendCommand( <'TPM2_Certify', 
                                                                                         k_sh, ~k_h, ~ak_h>
                                                                       ) @ #t2.12 )
                                                                  case eventTPMSendCommandTPMCertifytlsshtlshakh_0_111111111111121111111111111
                                                                  solve( state_111111111111121111111111111( ~RouterID.1,
                                                                                                            ~ServerID.1,
                                                                                                            ~ak_h,
                                                                                                            ~ak_sk.1,
                                                                                                            ~ssk_nms.1,
                                                                                                            ~tid.1,
                                                                                                            ~k_h,
                                                                                                            k_sh,
                                                                                                            tls_spk
                                                                         ) ▶₀ #t2.7 )
                                                                    case outTPMPolicyPCRtlssh_0_11111111111112111111111111
                                                                    solve( TPM_SendCommand( <'TPM2_Create', 
                                                                                             <swstate, nil>, 
                                                                                             'TPM_CC_PolicyPCR', 
                                                                                             nil>
                                                                           ) @ #t2.12 )
                                                                      case eventTPMSendCommandTPMCreateswstatenilTPMCCPolicyPCRnil_0_11111111111112111
                                                                      solve( state_11111111111112111( ~RouterID.1,
                                                                                                      ~ServerID.1,
                                                                                                      ~ak_h.1,
                                                                                                      ~ak_sk.1,
                                                                                                      ~ssk_nms.1,
                                                                                                      ~tid.1
                                                                             ) ▶₀ #t2.7 )
                                                                        case outTPMPCRExtendswstate_0_1111111111111211
                                                                        solve( Insert( <'privatePart', ~k_h>,
                                                                                       k_sk.1
                                                                               ) @ #t2.8 )
                                                                          case insertprivatePartakhaksk_0_111111111111111
                                                                          by solve( state_111111111111111( ~RouterID.1,
                                                                                                           ~ServerID.1,
                                                                                                           ~k_h,
                                                                                                           ~ak_sk.1,
                                                                                                           ~ssk_nms.1
                                                                                    ) ▶₀ #t2.7 )
                                                                        next
                                                                          case insertprivatePartkhksk_0_111111111111111111111121111111
                                                                          solve( state_111111111111111111111121111111( ~RouterID.1,
                                                                                                                       ~ServerID.1,
                                                                                                                       ~ak_h.1,
                                                                                                                       ~ak_sk.1,
                                                                                                                       ~k_h,
                                                                                                                       ~k_sk.1,
                                                                                                                       ~ssk_nms.1,
                                                                                                                       authPolicy,
                                                                                                                       lock
                                                                                 ) ▶₀ #t2.7 )
                                                                            case insertauthPolicykhauthPolicy_0_11111111111111111111112111111
                                                                            by contradiction /* cyclic */
                                                                          qed
                                                                        qed
                                                                      qed
                                                                    qed
                                                                  qed
                                                                qed
                                                              qed
                                                            qed
                                                          qed
                                                        next
                                                          case case_2
                                                          by contradiction /* from formulas */
                                                        qed
                                                      qed
                                                    qed
                                                  qed
                                                qed
                                              next
                                                case unlockdevice_0_11111111111111111111211111112
                                                by solve( state_11111111111111111111211111112( ~RouterID.1,
                                                                                               ~ServerID.1,
                                                                                               ~ak_h.1,
                                                                                               ~ak_sk.1,
                                                                                               ~ssk_nms.1,
                                                                                               a_h, obj_ap,
                                                                                               obj_h, obj_pd,
                                                                                               obj_pk, obj_sh,
                                                                                               ~n.2
                                                          ) ▶₀ #t2.6 )
                                              qed
                                            qed
                                          qed
                                        qed
                                      next
                                        case case_2
                                        solve( (#vr.45 < #t2.10)  ∥ (#vr.45 = #t2.10) )
                                          case case_1
                                          solve( (#vr.32 < #t2.9)  ∥ (#vr.32 = #t2.9) )
                                            case case_1
                                            solve( (#t2.6 < #t2.10)  ∥ (#t2.6 = #t2.10)  ∥ (#vr.73 < #t2.6) )
                                              case case_1
                                              by contradiction /* from formulas */
                                            next
                                              case case_2
                                              solve( (#t2.7 < #t2.10)  ∥ (#t2.7 = #t2.10)  ∥
                                                     (#vr.74 < #t2.7) )
                                                case case_1
                                                by contradiction /* from formulas */
                                              next
                                                case case_2
                                                solve( Unlock_4( '4', ~n.2, 'device' ) @ #t2.8 )
                                                  case unlockdevice_0_111111111111111111112111111111
                                                  solve( state_111111111111111111112111111111( ~RouterID.1,
                                                                                               ~ServerID.1,
                                                                                               ~ak_h.1,
                                                                                               ~ak_sk.1,
                                                                                               ~ssk_nms.1,
                                                                                               a_h, a_sk,
                                                                                               obj_ap, obj_h,
                                                                                               obj_pd, obj_pk,
                                                                                               obj_sh, ~n.2
                                                         ) ▶₀ #t2.5 )
                                                    case outsignobjpkobjapask_0_11111111111111111111211111111
                                                    solve( (#t2.4 < #t2.13)  ∥ (#t2.4 = #t2.13) )
                                                      case case_1
                                                      by contradiction /* from formulas */
                                                    next
                                                      case case_2
                                                      solve( (#t2.8 < #t2.14)  ∥ (#t2.8 = #t2.14) )
                                                        case case_1
                                                        by contradiction /* from formulas */
                                                      next
                                                        case case_2
                                                        solve( (#vr.32 < #t2.12)  ∥ (#vr.32 = #t2.12) )
                                                          case case_1
                                                          solve( (#vr.45 < #t2.13)  ∥ (#vr.45 = #t2.13) )
                                                            case case_1
                                                            solve( (#t2.13 < #t2.7)  ∥ (#t2.13 = #t2.7) )
                                                              case case_1
                                                              by contradiction /* from formulas */
                                                            next
                                                              case case_2
                                                              solve( (#t2.9 < #t2.12)  ∥ (#t2.9 = #t2.12) )
                                                                case case_1
                                                                by contradiction /* from formulas */
                                                              next
                                                                case case_2
                                                                solve( TPM_SendCommand( <'TPM2_Create', 
                                                                                         <swstate, nil>, 
                                                                                         'TPM_CC_PolicyPCR', 
                                                                                         nil>
                                                                       ) @ #t2.10 )
                                                                  case eventTPMSendCommandTPMCreateswstatenilTPMCCPolicyPCRnil_0_11111111111112111
                                                                  solve( state_11111111111112111( ~RouterID.1,
                                                                                                  ~ServerID.1,
                                                                                                  ~ak_h.1,
                                                                                                  ~ak_sk.1,
                                                                                                  ~ssk_nms.1,
                                                                                                  ~tid.1
                                                                         ) ▶₀ #t2.6 )
                                                                    case outTPMPCRExtendswstate_0_1111111111111211
                                                                    solve( TPM_SendCommand( <'TPM2_Certify', 
                                                                                             k_sh, ~k_h, ~ak_h
                                                                                            >
                                                                           ) @ #t2.10 )
                                                                      case eventTPMSendCommandTPMCertifytlsshtlshakh_0_111111111111121111111111111
                                                                      solve( state_111111111111121111111111111( ~RouterID.1,
                                                                                                                ~ServerID.1,
                                                                                                                ~ak_h,
                                                                                                                ~ak_sk.1,
                                                                                                                ~ssk_nms.1,
                                                                                                                ~tid.1,
                                                                                                                ~k_h,
                                                                                                                k_sh,
                                                                                                                tls_spk
                                                                             ) ▶₀ #t2.6 )
                                                                        case outTPMPolicyPCRtlssh_0_11111111111112111111111111
                                                                        solve( TPM_SendCommand( <
                                                                                                 'TPM2_Create', 
                                                                                                 <swstate, nil
                                                                                                 >, 
                                                                                                 'TPM_CC_PolicyPCR', 
                                                                                                 nil>
                                                                               ) @ #t2.10 )
                                                                          case eventTPMSendCommandTPMCreateswstatenilTPMCCPolicyPCRnil_0_11111111111112111
                                                                          solve( state_11111111111112111( ~RouterID.1,
                                                                                                          ~ServerID.1,
                                                                                                          ~ak_h.1,
                                                                                                          ~ak_sk.1,
                                                                                                          ~ssk_nms.1,
                                                                                                          ~tid.1
                                                                                 ) ▶₀ #t2.6 )
                                                                            case outTPMPCRExtendswstate_0_1111111111111211
                                                                            solve( Insert( <'privatePart', 
                                                                                            ~k_h>,
                                                                                           k_sk.1
                                                                                   ) @ #t2.6 )
                                                                              case insertprivatePartakhaksk_0_111111111111111
                                                                              by solve( state_111111111111111( ~RouterID.1,
                                                                                                               ~ServerID.1,
                                                                                                               ~k_h,
                                                                                                               ~ak_sk.1,
                                                                                                               ~ssk_nms.1
                                                                                        ) ▶₀ #t2.6 )
                                                                            next
                                                                              case insertprivatePartkhksk_0_111111111111111111111121111111
                                                                              solve( state_111111111111111111111121111111( ~RouterID.1,
                                                                                                                           ~ServerID.1,
                                                                                                                           ~ak_h.1,
                                                                                                                           ~ak_sk.1,
                                                                                                                           ~k_h,
                                                                                                                           ~k_sk.1,
                                                                                                                           ~ssk_nms.1,
                                                                                                                           authPolicy,
                                                                                                                           lock
                                                                                     ) ▶₀ #t2.6 )
                                                                                case insertauthPolicykhauthPolicy_0_11111111111111111111112111111
                                                                                by contradiction /* cyclic */
                                                                              qed
                                                                            qed
                                                                          qed
                                                                        qed
                                                                      qed
                                                                    qed
                                                                  qed
                                                                qed
                                                              qed
                                                            qed
                                                          next
                                                            case case_2
                                                            by contradiction /* from formulas */
                                                          qed
                                                        next
                                                          case case_2
                                                          by contradiction /* from formulas */
                                                        qed
                                                      qed
                                                    qed
                                                  qed
                                                next
                                                  case unlockdevice_0_11111111111111111111211111112
                                                  by solve( state_11111111111111111111211111112( ~RouterID.1,
                                                                                                 ~ServerID.1,
                                                                                                 ~ak_h.1,
                                                                                                 ~ak_sk.1,
                                                                                                 ~ssk_nms.1,
                                                                                                 a_h, obj_ap,
                                                                                                 obj_h,
                                                                                                 obj_pd,
                                                                                                 obj_pk,
                                                                                                 obj_sh, ~n.2
                                                            ) ▶₀ #t2.5 )
                                                qed
                                              next
                                                case case_3
                                                solve( Unlock_4( '4', ~n.2, 'device' ) @ #t2.8 )
                                                  case unlockdevice_0_111111111111111111112111111111
                                                  solve( state_111111111111111111112111111111( ~RouterID.1,
                                                                                               ~ServerID.1,
                                                                                               ~ak_h.1,
                                                                                               ~ak_sk.1,
                                                                                               ~ssk_nms.1,
                                                                                               a_h, a_sk,
                                                                                               obj_ap, obj_h,
                                                                                               obj_pd, obj_pk,
                                                                                               obj_sh, ~n.2
                                                         ) ▶₀ #t2.5 )
                                                    case outsignobjpkobjapask_0_11111111111111111111211111111
                                                    solve( (#t2.4 < #t2.14)  ∥ (#t2.4 = #t2.14) )
                                                      case case_1
                                                      by contradiction /* from formulas */
                                                    next
                                                      case case_2
                                                      solve( (#t2.10 < #t2.15)  ∥ (#t2.10 = #t2.15) )
                                                        case case_1
                                                        by contradiction /* from formulas */
                                                      next
                                                        case case_2
                                                        solve( (#vr.32 < #t2.13)  ∥ (#vr.32 = #t2.13) )
                                                          case case_1
                                                          solve( (#vr.45 < #t2.14)  ∥ (#vr.45 = #t2.14) )
                                                            case case_1
                                                            solve( (#t2.14 < #t2.7)  ∥ (#t2.14 = #t2.7) )
                                                              case case_1
                                                              by contradiction /* from formulas */
                                                            next
                                                              case case_2
                                                              solve( (#t2.9 < #t2.13)  ∥ (#t2.9 = #t2.13) )
                                                                case case_1
                                                                by contradiction /* from formulas */
                                                              next
                                                                case case_2
                                                                solve( TPM_SendCommand( <'TPM2_Create', 
                                                                                         <swstate, nil>, 
                                                                                         'TPM_CC_PolicyPCR', 
                                                                                         nil>
                                                                       ) @ #t2.11 )
                                                                  case eventTPMSendCommandTPMCreateswstatenilTPMCCPolicyPCRnil_0_11111111111112111
                                                                  solve( state_11111111111112111( ~RouterID.1,
                                                                                                  ~ServerID.1,
                                                                                                  ~ak_h.1,
                                                                                                  ~ak_sk.1,
                                                                                                  ~ssk_nms.1,
                                                                                                  ~tid.1
                                                                         ) ▶₀ #t2.6 )
                                                                    case outTPMPCRExtendswstate_0_1111111111111211
                                                                    solve( TPM_SendCommand( <'TPM2_Certify', 
                                                                                             k_sh, ~k_h, ~ak_h
                                                                                            >
                                                                           ) @ #t2.11 )
                                                                      case eventTPMSendCommandTPMCertifytlsshtlshakh_0_111111111111121111111111111
                                                                      solve( state_111111111111121111111111111( ~RouterID.1,
                                                                                                                ~ServerID.1,
                                                                                                                ~ak_h,
                                                                                                                ~ak_sk.1,
                                                                                                                ~ssk_nms.1,
                                                                                                                ~tid.1,
                                                                                                                ~k_h,
                                                                                                                k_sh,
                                                                                                                tls_spk
                                                                             ) ▶₀ #t2.6 )
                                                                        case outTPMPolicyPCRtlssh_0_11111111111112111111111111
                                                                        solve( TPM_SendCommand( <
                                                                                                 'TPM2_Create', 
                                                                                                 <swstate, nil
                                                                                                 >, 
                                                                                                 'TPM_CC_PolicyPCR', 
                                                                                                 nil>
                                                                               ) @ #t2.11 )
                                                                          case eventTPMSendCommandTPMCreateswstatenilTPMCCPolicyPCRnil_0_11111111111112111
                                                                          solve( state_11111111111112111( ~RouterID.1,
                                                                                                          ~ServerID.1,
                                                                                                          ~ak_h.1,
                                                                                                          ~ak_sk.1,
                                                                                                          ~ssk_nms.1,
                                                                                                          ~tid.1
                                                                                 ) ▶₀ #t2.6 )
                                                                            case outTPMPCRExtendswstate_0_1111111111111211
                                                                            solve( Insert( <'privatePart', 
                                                                                            ~k_h>,
                                                                                           k_sk.1
                                                                                   ) @ #t2.6 )
                                                                              case insertprivatePartakhaksk_0_111111111111111
                                                                              by solve( state_111111111111111( ~RouterID.1,
                                                                                                               ~ServerID.1,
                                                                                                               ~k_h,
                                                                                                               ~ak_sk.1,
                                                                                                               ~ssk_nms.1
                                                                                        ) ▶₀ #t2.6 )
                                                                            next
                                                                              case insertprivatePartkhksk_0_111111111111111111111121111111
                                                                              solve( state_111111111111111111111121111111( ~RouterID.1,
                                                                                                                           ~ServerID.1,
                                                                                                                           ~ak_h.1,
                                                                                                                           ~ak_sk.1,
                                                                                                                           ~k_h,
                                                                                                                           ~k_sk.1,
                                                                                                                           ~ssk_nms.1,
                                                                                                                           authPolicy,
                                                                                                                           lock
                                                                                     ) ▶₀ #t2.6 )
                                                                                case insertauthPolicykhauthPolicy_0_11111111111111111111112111111
                                                                                by contradiction /* cyclic */
                                                                              qed
                                                                            qed
                                                                          qed
                                                                        qed
                                                                      qed
                                                                    qed
                                                                  qed
                                                                qed
                                                              qed
                                                            qed
                                                          next
                                                            case case_2
                                                            by contradiction /* from formulas */
                                                          qed
                                                        next
                                                          case case_2
                                                          by contradiction /* from formulas */
                                                        qed
                                                      qed
                                                    qed
                                                  qed
                                                next
                                                  case unlockdevice_0_11111111111111111111211111112
                                                  by solve( state_11111111111111111111211111112( ~RouterID.1,
                                                                                                 ~ServerID.1,
                                                                                                 ~ak_h.1,
                                                                                                 ~ak_sk.1,
                                                                                                 ~ssk_nms.1,
                                                                                                 a_h, obj_ap,
                                                                                                 obj_h,
                                                                                                 obj_pd,
                                                                                                 obj_pk,
                                                                                                 obj_sh, ~n.2
                                                            ) ▶₀ #t2.5 )
                                                qed
                                              qed
                                            next
                                              case case_3
                                              solve( (#t2.7 < #t2.11)  ∥ (#t2.7 = #t2.11)  ∥
                                                     (#vr.74 < #t2.7) )
                                                case case_1
                                                by contradiction /* from formulas */
                                              next
                                                case case_2
                                                solve( Unlock_4( '4', ~n.2, 'device' ) @ #t2.8 )
                                                  case unlockdevice_0_111111111111111111112111111111
                                                  solve( state_111111111111111111112111111111( ~RouterID.1,
                                                                                               ~ServerID.1,
                                                                                               ~ak_h.1,
                                                                                               ~ak_sk.1,
                                                                                               ~ssk_nms.1,
                                                                                               a_h, a_sk,
                                                                                               obj_ap, obj_h,
                                                                                               obj_pd, obj_pk,
                                                                                               obj_sh, ~n.2
                                                         ) ▶₀ #t2.5 )
                                                    case outsignobjpkobjapask_0_11111111111111111111211111111
                                                    solve( (#t2.4 < #t2.14)  ∥ (#t2.4 = #t2.14) )
                                                      case case_1
                                                      by contradiction /* from formulas */
                                                    next
                                                      case case_2
                                                      solve( (#t2.8 < #t2.15)  ∥ (#t2.8 = #t2.15) )
                                                        case case_1
                                                        by contradiction /* from formulas */
                                                      next
                                                        case case_2
                                                        solve( (#vr.32 < #t2.13)  ∥ (#vr.32 = #t2.13) )
                                                          case case_1
                                                          solve( (#vr.45 < #t2.14)  ∥ (#vr.45 = #t2.14) )
                                                            case case_1
                                                            solve( (#t2.10 < #t2.14)  ∥ (#t2.10 = #t2.14) )
                                                              case case_1
                                                              by contradiction /* from formulas */
                                                            next
                                                              case case_2
                                                              solve( (#t2.9 < #t2.13)  ∥ (#t2.9 = #t2.13) )
                                                                case case_1
                                                                by contradiction /* from formulas */
                                                              next
                                                                case case_2
                                                                solve( TPM_SendCommand( <'TPM2_Create', 
                                                                                         <swstate, nil>, 
                                                                                         'TPM_CC_PolicyPCR', 
                                                                                         nil>
                                                                       ) @ #t2.11 )
                                                                  case eventTPMSendCommandTPMCreateswstatenilTPMCCPolicyPCRnil_0_11111111111112111
                                                                  solve( state_11111111111112111( ~RouterID.1,
                                                                                                  ~ServerID.1,
                                                                                                  ~ak_h.1,
                                                                                                  ~ak_sk.1,
                                                                                                  ~ssk_nms.1,
                                                                                                  ~tid.1
                                                                         ) ▶₀ #t2.6 )
                                                                    case outTPMPCRExtendswstate_0_1111111111111211
                                                                    solve( TPM_SendCommand( <'TPM2_Certify', 
                                                                                             k_sh, ~k_h, ~ak_h
                                                                                            >
                                                                           ) @ #t2.11 )
                                                                      case eventTPMSendCommandTPMCertifytlsshtlshakh_0_111111111111121111111111111
                                                                      solve( state_111111111111121111111111111( ~RouterID.1,
                                                                                                                ~ServerID.1,
                                                                                                                ~ak_h,
                                                                                                                ~ak_sk.1,
                                                                                                                ~ssk_nms.1,
                                                                                                                ~tid.1,
                                                                                                                ~k_h,
                                                                                                                k_sh,
                                                                                                                tls_spk
                                                                             ) ▶₀ #t2.6 )
                                                                        case outTPMPolicyPCRtlssh_0_11111111111112111111111111
                                                                        solve( TPM_SendCommand( <
                                                                                                 'TPM2_Create', 
                                                                                                 <swstate, nil
                                                                                                 >, 
                                                                                                 'TPM_CC_PolicyPCR', 
                                                                                                 nil>
                                                                               ) @ #t2.11 )
                                                                          case eventTPMSendCommandTPMCreateswstatenilTPMCCPolicyPCRnil_0_11111111111112111
                                                                          solve( state_11111111111112111( ~RouterID.1,
                                                                                                          ~ServerID.1,
                                                                                                          ~ak_h.1,
                                                                                                          ~ak_sk.1,
                                                                                                          ~ssk_nms.1,
                                                                                                          ~tid.1
                                                                                 ) ▶₀ #t2.6 )
                                                                            case outTPMPCRExtendswstate_0_1111111111111211
                                                                            solve( Insert( <'privatePart', 
                                                                                            ~k_h>,
                                                                                           k_sk.1
                                                                                   ) @ #t2.6 )
                                                                              case insertprivatePartakhaksk_0_111111111111111
                                                                              by solve( state_111111111111111( ~RouterID.1,
                                                                                                               ~ServerID.1,
                                                                                                               ~k_h,
                                                                                                               ~ak_sk.1,
                                                                                                               ~ssk_nms.1
                                                                                        ) ▶₀ #t2.6 )
                                                                            next
                                                                              case insertprivatePartkhksk_0_111111111111111111111121111111
                                                                              solve( state_111111111111111111111121111111( ~RouterID.1,
                                                                                                                           ~ServerID.1,
                                                                                                                           ~ak_h.1,
                                                                                                                           ~ak_sk.1,
                                                                                                                           ~k_h,
                                                                                                                           ~k_sk.1,
                                                                                                                           ~ssk_nms.1,
                                                                                                                           authPolicy,
                                                                                                                           lock
                                                                                     ) ▶₀ #t2.6 )
                                                                                case insertauthPolicykhauthPolicy_0_11111111111111111111112111111
                                                                                by contradiction /* cyclic */
                                                                              qed
                                                                            qed
                                                                          qed
                                                                        qed
                                                                      qed
                                                                    qed
                                                                  qed
                                                                qed
                                                              qed
                                                            qed
                                                          next
                                                            case case_2
                                                            by contradiction /* from formulas */
                                                          qed
                                                        next
                                                          case case_2
                                                          by contradiction /* from formulas */
                                                        qed
                                                      qed
                                                    qed
                                                  qed
                                                next
                                                  case unlockdevice_0_11111111111111111111211111112
                                                  by solve( state_11111111111111111111211111112( ~RouterID.1,
                                                                                                 ~ServerID.1,
                                                                                                 ~ak_h.1,
                                                                                                 ~ak_sk.1,
                                                                                                 ~ssk_nms.1,
                                                                                                 a_h, obj_ap,
                                                                                                 obj_h,
                                                                                                 obj_pd,
                                                                                                 obj_pk,
                                                                                                 obj_sh, ~n.2
                                                            ) ▶₀ #t2.5 )
                                                qed
                                              next
                                                case case_3
                                                solve( Unlock_4( '4', ~n.2, 'device' ) @ #t2.8 )
                                                  case unlockdevice_0_111111111111111111112111111111
                                                  solve( state_111111111111111111112111111111( ~RouterID.1,
                                                                                               ~ServerID.1,
                                                                                               ~ak_h.1,
                                                                                               ~ak_sk.1,
                                                                                               ~ssk_nms.1,
                                                                                               a_h, a_sk,
                                                                                               obj_ap, obj_h,
                                                                                               obj_pd, obj_pk,
                                                                                               obj_sh, ~n.2
                                                         ) ▶₀ #t2.5 )
                                                    case outsignobjpkobjapask_0_11111111111111111111211111111
                                                    solve( (#t2.4 < #t2.15)  ∥ (#t2.4 = #t2.15) )
                                                      case case_1
                                                      by contradiction /* from formulas */
                                                    next
                                                      case case_2
                                                      solve( (#t2.11 < #t2.16)  ∥ (#t2.11 = #t2.16) )
                                                        case case_1
                                                        by contradiction /* from formulas */
                                                      next
                                                        case case_2
                                                        solve( (#vr.32 < #t2.14)  ∥ (#vr.32 = #t2.14) )
                                                          case case_1
                                                          solve( (#vr.45 < #t2.15)  ∥ (#vr.45 = #t2.15) )
                                                            case case_1
                                                            solve( (#t2.10 < #t2.15)  ∥ (#t2.10 = #t2.15) )
                                                              case case_1
                                                              by contradiction /* from formulas */
                                                            next
                                                              case case_2
                                                              solve( (#t2.9 < #t2.14)  ∥ (#t2.9 = #t2.14) )
                                                                case case_1
                                                                by contradiction /* from formulas */
                                                              next
                                                                case case_2
                                                                solve( TPM_SendCommand( <'TPM2_Create', 
                                                                                         <swstate, nil>, 
                                                                                         'TPM_CC_PolicyPCR', 
                                                                                         nil>
                                                                       ) @ #t2.12 )
                                                                  case eventTPMSendCommandTPMCreateswstatenilTPMCCPolicyPCRnil_0_11111111111112111
                                                                  solve( state_11111111111112111( ~RouterID.1,
                                                                                                  ~ServerID.1,
                                                                                                  ~ak_h.1,
                                                                                                  ~ak_sk.1,
                                                                                                  ~ssk_nms.1,
                                                                                                  ~tid.1
                                                                         ) ▶₀ #t2.6 )
                                                                    case outTPMPCRExtendswstate_0_1111111111111211
                                                                    solve( TPM_SendCommand( <'TPM2_Certify', 
                                                                                             k_sh, ~k_h, ~ak_h
                                                                                            >
                                                                           ) @ #t2.12 )
                                                                      case eventTPMSendCommandTPMCertifytlsshtlshakh_0_111111111111121111111111111
                                                                      solve( state_111111111111121111111111111( ~RouterID.1,
                                                                                                                ~ServerID.1,
                                                                                                                ~ak_h,
                                                                                                                ~ak_sk.1,
                                                                                                                ~ssk_nms.1,
                                                                                                                ~tid.1,
                                                                                                                ~k_h,
                                                                                                                k_sh,
                                                                                                                tls_spk
                                                                             ) ▶₀ #t2.6 )
                                                                        case outTPMPolicyPCRtlssh_0_11111111111112111111111111
                                                                        solve( TPM_SendCommand( <
                                                                                                 'TPM2_Create', 
                                                                                                 <swstate, nil
                                                                                                 >, 
                                                                                                 'TPM_CC_PolicyPCR', 
                                                                                                 nil>
                                                                               ) @ #t2.12 )
                                                                          case eventTPMSendCommandTPMCreateswstatenilTPMCCPolicyPCRnil_0_11111111111112111
                                                                          solve( state_11111111111112111( ~RouterID.1,
                                                                                                          ~ServerID.1,
                                                                                                          ~ak_h.1,
                                                                                                          ~ak_sk.1,
                                                                                                          ~ssk_nms.1,
                                                                                                          ~tid.1
                                                                                 ) ▶₀ #t2.6 )
                                                                            case outTPMPCRExtendswstate_0_1111111111111211
                                                                            solve( Insert( <'privatePart', 
                                                                                            ~k_h>,
                                                                                           k_sk.1
                                                                                   ) @ #t2.6 )
                                                                              case insertprivatePartakhaksk_0_111111111111111
                                                                              by solve( state_111111111111111( ~RouterID.1,
                                                                                                               ~ServerID.1,
                                                                                                               ~k_h,
                                                                                                               ~ak_sk.1,
                                                                                                               ~ssk_nms.1
                                                                                        ) ▶₀ #t2.6 )
                                                                            next
                                                                              case insertprivatePartkhksk_0_111111111111111111111121111111
                                                                              solve( state_111111111111111111111121111111( ~RouterID.1,
                                                                                                                           ~ServerID.1,
                                                                                                                           ~ak_h.1,
                                                                                                                           ~ak_sk.1,
                                                                                                                           ~k_h,
                                                                                                                           ~k_sk.1,
                                                                                                                           ~ssk_nms.1,
                                                                                                                           authPolicy,
                                                                                                                           lock
                                                                                     ) ▶₀ #t2.6 )
                                                                                case insertauthPolicykhauthPolicy_0_11111111111111111111112111111
                                                                                by contradiction /* cyclic */
                                                                              qed
                                                                            qed
                                                                          qed
                                                                        qed
                                                                      qed
                                                                    qed
                                                                  qed
                                                                qed
                                                              qed
                                                            qed
                                                          next
                                                            case case_2
                                                            by contradiction /* from formulas */
                                                          qed
                                                        next
                                                          case case_2
                                                          by contradiction /* from formulas */
                                                        qed
                                                      qed
                                                    qed
                                                  qed
                                                next
                                                  case unlockdevice_0_11111111111111111111211111112
                                                  by solve( state_11111111111111111111211111112( ~RouterID.1,
                                                                                                 ~ServerID.1,
                                                                                                 ~ak_h.1,
                                                                                                 ~ak_sk.1,
                                                                                                 ~ssk_nms.1,
                                                                                                 a_h, obj_ap,
                                                                                                 obj_h,
                                                                                                 obj_pd,
                                                                                                 obj_pk,
                                                                                                 obj_sh, ~n.2
                                                            ) ▶₀ #t2.5 )
                                                qed
                                              qed
                                            qed
                                          next
                                            case case_2
                                            solve( (#t2.7 < #t2.10)  ∥ (#t2.7 = #t2.10)  ∥ (#vr.72 < #t2.7) )
                                              case case_1
                                              by contradiction /* from formulas */
                                            next
                                              case case_2
                                              solve( (#t2.8 < #t2.10)  ∥ (#t2.8 = #t2.10)  ∥
                                                     (#vr.73 < #t2.8) )
                                                case case_1
                                                by contradiction /* from formulas */
                                              next
                                                case case_2
                                                solve( Unlock_4( '4', ~n.2, 'device' ) @ #t2.9 )
                                                  case unlockdevice_0_111111111111111111112111111111
                                                  solve( state_111111111111111111112111111111( ~RouterID.1,
                                                                                               ~ServerID.1,
                                                                                               ~ak_h.1,
                                                                                               ~ak_sk.1,
                                                                                               ~ssk_nms.1,
                                                                                               a_h, a_sk,
                                                                                               obj_ap, obj_h,
                                                                                               obj_pd, obj_pk,
                                                                                               obj_sh, ~n.2
                                                         ) ▶₀ #t2.6 )
                                                    case outsignobjpkobjapask_0_11111111111111111111211111111
                                                    solve( (#t2.4 < #t2.13)  ∥ (#t2.4 = #t2.13) )
                                                      case case_1
                                                      by contradiction /* from formulas */
                                                    next
                                                      case case_2
                                                      solve( (#t2.5 < #t2.12)  ∥ (#t2.5 = #t2.12) )
                                                        case case_1
                                                        by contradiction /* from formulas */
                                                      next
                                                        case case_2
                                                        solve( (#t2.9 < #t2.13)  ∥ (#t2.9 = #t2.13) )
                                                          case case_1
                                                          by contradiction /* from formulas */
                                                        next
                                                          case case_2
                                                          solve( (#vr.44 < #t2.12)  ∥ (#vr.44 = #t2.12) )
                                                            case case_1
                                                            solve( (#t2.12 < #t2.8)  ∥ (#t2.12 = #t2.8) )
                                                              case case_1
                                                              by contradiction /* from formulas */
                                                            next
                                                              case case_2
                                                              solve( TPM_SendCommand( <'TPM2_Create', 
                                                                                       <swstate, nil>, 
                                                                                       'TPM_CC_PolicyPCR', nil
                                                                                      >
                                                                     ) @ #t2.10 )
                                                                case eventTPMSendCommandTPMCreateswstatenilTPMCCPolicyPCRnil_0_11111111111112111
                                                                solve( state_11111111111112111( ~RouterID.1,
                                                                                                ~ServerID.1,
                                                                                                ~ak_h.1,
                                                                                                ~ak_sk.1,
                                                                                                ~ssk_nms.1,
                                                                                                ~tid.1
                                                                       ) ▶₀ #t2.7 )
                                                                  case outTPMPCRExtendswstate_0_1111111111111211
                                                                  solve( TPM_SendCommand( <'TPM2_Certify', 
                                                                                           k_sh, ~k_h, ~ak_h>
                                                                         ) @ #t2.10 )
                                                                    case eventTPMSendCommandTPMCertifytlsshtlshakh_0_111111111111121111111111111
                                                                    solve( state_111111111111121111111111111( ~RouterID.1,
                                                                                                              ~ServerID.1,
                                                                                                              ~ak_h,
                                                                                                              ~ak_sk.1,
                                                                                                              ~ssk_nms.1,
                                                                                                              ~tid.1,
                                                                                                              ~k_h,
                                                                                                              k_sh,
                                                                                                              tls_spk
                                                                           ) ▶₀ #t2.7 )
                                                                      case outTPMPolicyPCRtlssh_0_11111111111112111111111111
                                                                      solve( TPM_SendCommand( <'TPM2_Create', 
                                                                                               <swstate, nil
                                                                                               >, 
                                                                                               'TPM_CC_PolicyPCR', 
                                                                                               nil>
                                                                             ) @ #t2.10 )
                                                                        case eventTPMSendCommandTPMCreateswstatenilTPMCCPolicyPCRnil_0_11111111111112111
                                                                        solve( state_11111111111112111( ~RouterID.1,
                                                                                                        ~ServerID.1,
                                                                                                        ~ak_h.1,
                                                                                                        ~ak_sk.1,
                                                                                                        ~ssk_nms.1,
                                                                                                        ~tid.1
                                                                               ) ▶₀ #t2.7 )
                                                                          case outTPMPCRExtendswstate_0_1111111111111211
                                                                          solve( Insert( <'privatePart', ~k_h
                                                                                         >,
                                                                                         k_sk.1
                                                                                 ) @ #t2.7 )
                                                                            case insertprivatePartakhaksk_0_111111111111111
                                                                            by solve( state_111111111111111( ~RouterID.1,
                                                                                                             ~ServerID.1,
                                                                                                             ~k_h,
                                                                                                             ~ak_sk.1,
                                                                                                             ~ssk_nms.1
                                                                                      ) ▶₀ #t2.7 )
                                                                          next
                                                                            case insertprivatePartkhksk_0_111111111111111111111121111111
                                                                            solve( state_111111111111111111111121111111( ~RouterID.1,
                                                                                                                         ~ServerID.1,
                                                                                                                         ~ak_h.1,
                                                                                                                         ~ak_sk.1,
                                                                                                                         ~k_h,
                                                                                                                         ~k_sk.1,
                                                                                                                         ~ssk_nms.1,
                                                                                                                         authPolicy,
                                                                                                                         lock
                                                                                   ) ▶₀ #t2.7 )
                                                                              case insertauthPolicykhauthPolicy_0_11111111111111111111112111111
                                                                              by contradiction /* cyclic */
                                                                            qed
                                                                          qed
                                                                        qed
                                                                      qed
                                                                    qed
                                                                  qed
                                                                qed
                                                              qed
                                                            qed
                                                          next
                                                            case case_2
                                                            by contradiction /* from formulas */
                                                          qed
                                                        qed
                                                      qed
                                                    qed
                                                  qed
                                                next
                                                  case unlockdevice_0_11111111111111111111211111112
                                                  by solve( state_11111111111111111111211111112( ~RouterID.1,
                                                                                                 ~ServerID.1,
                                                                                                 ~ak_h.1,
                                                                                                 ~ak_sk.1,
                                                                                                 ~ssk_nms.1,
                                                                                                 a_h, obj_ap,
                                                                                                 obj_h,
                                                                                                 obj_pd,
                                                                                                 obj_pk,
                                                                                                 obj_sh, ~n.2
                                                            ) ▶₀ #t2.6 )
                                                qed
                                              next
                                                case case_3
                                                solve( Unlock_4( '4', ~n.2, 'device' ) @ #t2.9 )
                                                  case unlockdevice_0_111111111111111111112111111111
                                                  solve( state_111111111111111111112111111111( ~RouterID.1,
                                                                                               ~ServerID.1,
                                                                                               ~ak_h.1,
                                                                                               ~ak_sk.1,
                                                                                               ~ssk_nms.1,
                                                                                               a_h, a_sk,
                                                                                               obj_ap, obj_h,
                                                                                               obj_pd, obj_pk,
                                                                                               obj_sh, ~n.2
                                                         ) ▶₀ #t2.6 )
                                                    case outsignobjpkobjapask_0_11111111111111111111211111111
                                                    solve( (#t2.4 < #t2.14)  ∥ (#t2.4 = #t2.14) )
                                                      case case_1
                                                      by contradiction /* from formulas */
                                                    next
                                                      case case_2
                                                      solve( (#t2.5 < #t2.13)  ∥ (#t2.5 = #t2.13) )
                                                        case case_1
                                                        by contradiction /* from formulas */
                                                      next
                                                        case case_2
                                                        solve( (#t2.10 < #t2.14)  ∥ (#t2.10 = #t2.14) )
                                                          case case_1
                                                          by contradiction /* from formulas */
                                                        next
                                                          case case_2
                                                          solve( (#vr.44 < #t2.13)  ∥ (#vr.44 = #t2.13) )
                                                            case case_1
                                                            solve( (#t2.13 < #t2.8)  ∥ (#t2.13 = #t2.8) )
                                                              case case_1
                                                              by contradiction /* from formulas */
                                                            next
                                                              case case_2
                                                              solve( TPM_SendCommand( <'TPM2_Create', 
                                                                                       <swstate, nil>, 
                                                                                       'TPM_CC_PolicyPCR', nil
                                                                                      >
                                                                     ) @ #t2.11 )
                                                                case eventTPMSendCommandTPMCreateswstatenilTPMCCPolicyPCRnil_0_11111111111112111
                                                                solve( state_11111111111112111( ~RouterID.1,
                                                                                                ~ServerID.1,
                                                                                                ~ak_h.1,
                                                                                                ~ak_sk.1,
                                                                                                ~ssk_nms.1,
                                                                                                ~tid.1
                                                                       ) ▶₀ #t2.7 )
                                                                  case outTPMPCRExtendswstate_0_1111111111111211
                                                                  solve( TPM_SendCommand( <'TPM2_Certify', 
                                                                                           k_sh, ~k_h, ~ak_h>
                                                                         ) @ #t2.11 )
                                                                    case eventTPMSendCommandTPMCertifytlsshtlshakh_0_111111111111121111111111111
                                                                    solve( state_111111111111121111111111111( ~RouterID.1,
                                                                                                              ~ServerID.1,
                                                                                                              ~ak_h,
                                                                                                              ~ak_sk.1,
                                                                                                              ~ssk_nms.1,
                                                                                                              ~tid.1,
                                                                                                              ~k_h,
                                                                                                              k_sh,
                                                                                                              tls_spk
                                                                           ) ▶₀ #t2.7 )
                                                                      case outTPMPolicyPCRtlssh_0_11111111111112111111111111
                                                                      solve( TPM_SendCommand( <'TPM2_Create', 
                                                                                               <swstate, nil
                                                                                               >, 
                                                                                               'TPM_CC_PolicyPCR', 
                                                                                               nil>
                                                                             ) @ #t2.11 )
                                                                        case eventTPMSendCommandTPMCreateswstatenilTPMCCPolicyPCRnil_0_11111111111112111
                                                                        solve( state_11111111111112111( ~RouterID.1,
                                                                                                        ~ServerID.1,
                                                                                                        ~ak_h.1,
                                                                                                        ~ak_sk.1,
                                                                                                        ~ssk_nms.1,
                                                                                                        ~tid.1
                                                                               ) ▶₀ #t2.7 )
                                                                          case outTPMPCRExtendswstate_0_1111111111111211
                                                                          solve( Insert( <'privatePart', ~k_h
                                                                                         >,
                                                                                         k_sk.1
                                                                                 ) @ #t2.7 )
                                                                            case insertprivatePartakhaksk_0_111111111111111
                                                                            by solve( state_111111111111111( ~RouterID.1,
                                                                                                             ~ServerID.1,
                                                                                                             ~k_h,
                                                                                                             ~ak_sk.1,
                                                                                                             ~ssk_nms.1
                                                                                      ) ▶₀ #t2.7 )
                                                                          next
                                                                            case insertprivatePartkhksk_0_111111111111111111111121111111
                                                                            solve( state_111111111111111111111121111111( ~RouterID.1,
                                                                                                                         ~ServerID.1,
                                                                                                                         ~ak_h.1,
                                                                                                                         ~ak_sk.1,
                                                                                                                         ~k_h,
                                                                                                                         ~k_sk.1,
                                                                                                                         ~ssk_nms.1,
                                                                                                                         authPolicy,
                                                                                                                         lock
                                                                                   ) ▶₀ #t2.7 )
                                                                              case insertauthPolicykhauthPolicy_0_11111111111111111111112111111
                                                                              by contradiction /* cyclic */
                                                                            qed
                                                                          qed
                                                                        qed
                                                                      qed
                                                                    qed
                                                                  qed
                                                                qed
                                                              qed
                                                            qed
                                                          next
                                                            case case_2
                                                            by contradiction /* from formulas */
                                                          qed
                                                        qed
                                                      qed
                                                    qed
                                                  qed
                                                next
                                                  case unlockdevice_0_11111111111111111111211111112
                                                  by solve( state_11111111111111111111211111112( ~RouterID.1,
                                                                                                 ~ServerID.1,
                                                                                                 ~ak_h.1,
                                                                                                 ~ak_sk.1,
                                                                                                 ~ssk_nms.1,
                                                                                                 a_h, obj_ap,
                                                                                                 obj_h,
                                                                                                 obj_pd,
                                                                                                 obj_pk,
                                                                                                 obj_sh, ~n.2
                                                            ) ▶₀ #t2.6 )
                                                qed
                                              qed
                                            next
                                              case case_3
                                              solve( (#t2.8 < #t2.11)  ∥ (#t2.8 = #t2.11)  ∥
                                                     (#vr.73 < #t2.8) )
                                                case case_1
                                                by contradiction /* from formulas */
                                              next
                                                case case_2
                                                solve( Unlock_4( '4', ~n.2, 'device' ) @ #t2.9 )
                                                  case unlockdevice_0_111111111111111111112111111111
                                                  solve( state_111111111111111111112111111111( ~RouterID.1,
                                                                                               ~ServerID.1,
                                                                                               ~ak_h.1,
                                                                                               ~ak_sk.1,
                                                                                               ~ssk_nms.1,
                                                                                               a_h, a_sk,
                                                                                               obj_ap, obj_h,
                                                                                               obj_pd, obj_pk,
                                                                                               obj_sh, ~n.2
                                                         ) ▶₀ #t2.6 )
                                                    case outsignobjpkobjapask_0_11111111111111111111211111111
                                                    solve( (#t2.4 < #t2.14)  ∥ (#t2.4 = #t2.14) )
                                                      case case_1
                                                      by contradiction /* from formulas */
                                                    next
                                                      case case_2
                                                      solve( (#t2.5 < #t2.13)  ∥ (#t2.5 = #t2.13) )
                                                        case case_1
                                                        by contradiction /* from formulas */
                                                      next
                                                        case case_2
                                                        solve( (#t2.9 < #t2.14)  ∥ (#t2.9 = #t2.14) )
                                                          case case_1
                                                          by contradiction /* from formulas */
                                                        next
                                                          case case_2
                                                          solve( (#vr.44 < #t2.13)  ∥ (#vr.44 = #t2.13) )
                                                            case case_1
                                                            solve( (#t2.10 < #t2.13)  ∥ (#t2.10 = #t2.13) )
                                                              case case_1
                                                              by contradiction /* from formulas */
                                                            next
                                                              case case_2
                                                              solve( TPM_SendCommand( <'TPM2_Create', 
                                                                                       <swstate, nil>, 
                                                                                       'TPM_CC_PolicyPCR', nil
                                                                                      >
                                                                     ) @ #t2.11 )
                                                                case eventTPMSendCommandTPMCreateswstatenilTPMCCPolicyPCRnil_0_11111111111112111
                                                                solve( state_11111111111112111( ~RouterID.1,
                                                                                                ~ServerID.1,
                                                                                                ~ak_h.1,
                                                                                                ~ak_sk.1,
                                                                                                ~ssk_nms.1,
                                                                                                ~tid.1
                                                                       ) ▶₀ #t2.7 )
                                                                  case outTPMPCRExtendswstate_0_1111111111111211
                                                                  solve( TPM_SendCommand( <'TPM2_Certify', 
                                                                                           k_sh, ~k_h, ~ak_h>
                                                                         ) @ #t2.11 )
                                                                    case eventTPMSendCommandTPMCertifytlsshtlshakh_0_111111111111121111111111111
                                                                    solve( state_111111111111121111111111111( ~RouterID.1,
                                                                                                              ~ServerID.1,
                                                                                                              ~ak_h,
                                                                                                              ~ak_sk.1,
                                                                                                              ~ssk_nms.1,
                                                                                                              ~tid.1,
                                                                                                              ~k_h,
                                                                                                              k_sh,
                                                                                                              tls_spk
                                                                           ) ▶₀ #t2.7 )
                                                                      case outTPMPolicyPCRtlssh_0_11111111111112111111111111
                                                                      solve( TPM_SendCommand( <'TPM2_Create', 
                                                                                               <swstate, nil
                                                                                               >, 
                                                                                               'TPM_CC_PolicyPCR', 
                                                                                               nil>
                                                                             ) @ #t2.11 )
                                                                        case eventTPMSendCommandTPMCreateswstatenilTPMCCPolicyPCRnil_0_11111111111112111
                                                                        solve( state_11111111111112111( ~RouterID.1,
                                                                                                        ~ServerID.1,
                                                                                                        ~ak_h.1,
                                                                                                        ~ak_sk.1,
                                                                                                        ~ssk_nms.1,
                                                                                                        ~tid.1
                                                                               ) ▶₀ #t2.7 )
                                                                          case outTPMPCRExtendswstate_0_1111111111111211
                                                                          solve( Insert( <'privatePart', ~k_h
                                                                                         >,
                                                                                         k_sk.1
                                                                                 ) @ #t2.7 )
                                                                            case insertprivatePartakhaksk_0_111111111111111
                                                                            by solve( state_111111111111111( ~RouterID.1,
                                                                                                             ~ServerID.1,
                                                                                                             ~k_h,
                                                                                                             ~ak_sk.1,
                                                                                                             ~ssk_nms.1
                                                                                      ) ▶₀ #t2.7 )
                                                                          next
                                                                            case insertprivatePartkhksk_0_111111111111111111111121111111
                                                                            solve( state_111111111111111111111121111111( ~RouterID.1,
                                                                                                                         ~ServerID.1,
                                                                                                                         ~ak_h.1,
                                                                                                                         ~ak_sk.1,
                                                                                                                         ~k_h,
                                                                                                                         ~k_sk.1,
                                                                                                                         ~ssk_nms.1,
                                                                                                                         authPolicy,
                                                                                                                         lock
                                                                                   ) ▶₀ #t2.7 )
                                                                              case insertauthPolicykhauthPolicy_0_11111111111111111111112111111
                                                                              by contradiction /* cyclic */
                                                                            qed
                                                                          qed
                                                                        qed
                                                                      qed
                                                                    qed
                                                                  qed
                                                                qed
                                                              qed
                                                            qed
                                                          next
                                                            case case_2
                                                            by contradiction /* from formulas */
                                                          qed
                                                        qed
                                                      qed
                                                    qed
                                                  qed
                                                next
                                                  case unlockdevice_0_11111111111111111111211111112
                                                  by solve( state_11111111111111111111211111112( ~RouterID.1,
                                                                                                 ~ServerID.1,
                                                                                                 ~ak_h.1,
                                                                                                 ~ak_sk.1,
                                                                                                 ~ssk_nms.1,
                                                                                                 a_h, obj_ap,
                                                                                                 obj_h,
                                                                                                 obj_pd,
                                                                                                 obj_pk,
                                                                                                 obj_sh, ~n.2
                                                            ) ▶₀ #t2.6 )
                                                qed
                                              next
                                                case case_3
                                                solve( Unlock_4( '4', ~n.2, 'device' ) @ #t2.9 )
                                                  case unlockdevice_0_111111111111111111112111111111
                                                  solve( state_111111111111111111112111111111( ~RouterID.1,
                                                                                               ~ServerID.1,
                                                                                               ~ak_h.1,
                                                                                               ~ak_sk.1,
                                                                                               ~ssk_nms.1,
                                                                                               a_h, a_sk,
                                                                                               obj_ap, obj_h,
                                                                                               obj_pd, obj_pk,
                                                                                               obj_sh, ~n.2
                                                         ) ▶₀ #t2.6 )
                                                    case outsignobjpkobjapask_0_11111111111111111111211111111
                                                    solve( (#t2.4 < #t2.15)  ∥ (#t2.4 = #t2.15) )
                                                      case case_1
                                                      by contradiction /* from formulas */
                                                    next
                                                      case case_2
                                                      solve( (#t2.5 < #t2.14)  ∥ (#t2.5 = #t2.14) )
                                                        case case_1
                                                        by contradiction /* from formulas */
                                                      next
                                                        case case_2
                                                        solve( (#t2.11 < #t2.15)  ∥ (#t2.11 = #t2.15) )
                                                          case case_1
                                                          by contradiction /* from formulas */
                                                        next
                                                          case case_2
                                                          solve( (#vr.44 < #t2.14)  ∥ (#vr.44 = #t2.14) )
                                                            case case_1
                                                            solve( (#t2.10 < #t2.14)  ∥ (#t2.10 = #t2.14) )
                                                              case case_1
                                                              by contradiction /* from formulas */
                                                            next
                                                              case case_2
                                                              solve( TPM_SendCommand( <'TPM2_Create', 
                                                                                       <swstate, nil>, 
                                                                                       'TPM_CC_PolicyPCR', nil
                                                                                      >
                                                                     ) @ #t2.12 )
                                                                case eventTPMSendCommandTPMCreateswstatenilTPMCCPolicyPCRnil_0_11111111111112111
                                                                solve( state_11111111111112111( ~RouterID.1,
                                                                                                ~ServerID.1,
                                                                                                ~ak_h.1,
                                                                                                ~ak_sk.1,
                                                                                                ~ssk_nms.1,
                                                                                                ~tid.1
                                                                       ) ▶₀ #t2.7 )
                                                                  case outTPMPCRExtendswstate_0_1111111111111211
                                                                  solve( TPM_SendCommand( <'TPM2_Certify', 
                                                                                           k_sh, ~k_h, ~ak_h>
                                                                         ) @ #t2.12 )
                                                                    case eventTPMSendCommandTPMCertifytlsshtlshakh_0_111111111111121111111111111
                                                                    solve( state_111111111111121111111111111( ~RouterID.1,
                                                                                                              ~ServerID.1,
                                                                                                              ~ak_h,
                                                                                                              ~ak_sk.1,
                                                                                                              ~ssk_nms.1,
                                                                                                              ~tid.1,
                                                                                                              ~k_h,
                                                                                                              k_sh,
                                                                                                              tls_spk
                                                                           ) ▶₀ #t2.7 )
                                                                      case outTPMPolicyPCRtlssh_0_11111111111112111111111111
                                                                      solve( TPM_SendCommand( <'TPM2_Create', 
                                                                                               <swstate, nil
                                                                                               >, 
                                                                                               'TPM_CC_PolicyPCR', 
                                                                                               nil>
                                                                             ) @ #t2.12 )
                                                                        case eventTPMSendCommandTPMCreateswstatenilTPMCCPolicyPCRnil_0_11111111111112111
                                                                        solve( state_11111111111112111( ~RouterID.1,
                                                                                                        ~ServerID.1,
                                                                                                        ~ak_h.1,
                                                                                                        ~ak_sk.1,
                                                                                                        ~ssk_nms.1,
                                                                                                        ~tid.1
                                                                               ) ▶₀ #t2.7 )
                                                                          case outTPMPCRExtendswstate_0_1111111111111211
                                                                          solve( Insert( <'privatePart', ~k_h
                                                                                         >,
                                                                                         k_sk.1
                                                                                 ) @ #t2.7 )
                                                                            case insertprivatePartakhaksk_0_111111111111111
                                                                            by solve( state_111111111111111( ~RouterID.1,
                                                                                                             ~ServerID.1,
                                                                                                             ~k_h,
                                                                                                             ~ak_sk.1,
                                                                                                             ~ssk_nms.1
                                                                                      ) ▶₀ #t2.7 )
                                                                          next
                                                                            case insertprivatePartkhksk_0_111111111111111111111121111111
                                                                            solve( state_111111111111111111111121111111( ~RouterID.1,
                                                                                                                         ~ServerID.1,
                                                                                                                         ~ak_h.1,
                                                                                                                         ~ak_sk.1,
                                                                                                                         ~k_h,
                                                                                                                         ~k_sk.1,
                                                                                                                         ~ssk_nms.1,
                                                                                                                         authPolicy,
                                                                                                                         lock
                                                                                   ) ▶₀ #t2.7 )
                                                                              case insertauthPolicykhauthPolicy_0_11111111111111111111112111111
                                                                              by contradiction /* cyclic */
                                                                            qed
                                                                          qed
                                                                        qed
                                                                      qed
                                                                    qed
                                                                  qed
                                                                qed
                                                              qed
                                                            qed
                                                          next
                                                            case case_2
                                                            by contradiction /* from formulas */
                                                          qed
                                                        qed
                                                      qed
                                                    qed
                                                  qed
                                                next
                                                  case unlockdevice_0_11111111111111111111211111112
                                                  by solve( state_11111111111111111111211111112( ~RouterID.1,
                                                                                                 ~ServerID.1,
                                                                                                 ~ak_h.1,
                                                                                                 ~ak_sk.1,
                                                                                                 ~ssk_nms.1,
                                                                                                 a_h, obj_ap,
                                                                                                 obj_h,
                                                                                                 obj_pd,
                                                                                                 obj_pk,
                                                                                                 obj_sh, ~n.2
                                                            ) ▶₀ #t2.6 )
                                                qed
                                              qed
                                            qed
                                          qed
                                        next
                                          case case_2
                                          solve( (#vr.32 < #t2.10)  ∥ (#vr.32 = #t2.10) )
                                            case case_1
                                            solve( (#t2.8 < #t2.11)  ∥ (#t2.8 = #t2.11)  ∥ (#vr.73 < #t2.8) )
                                              case case_1
                                              by contradiction /* from formulas */
                                            next
                                              case case_2
                                              solve( Unlock_4( '4', ~n.2, 'device' ) @ #t2.9 )
                                                case unlockdevice_0_111111111111111111112111111111
                                                solve( state_111111111111111111112111111111( ~RouterID.1,
                                                                                             ~ServerID.1,
                                                                                             ~ak_h.1,
                                                                                             ~ak_sk.1,
                                                                                             ~ssk_nms.1, a_h,
                                                                                             a_sk, obj_ap,
                                                                                             obj_h, obj_pd,
                                                                                             obj_pk, obj_sh,
                                                                                             ~n.2
                                                       ) ▶₀ #t2.6 )
                                                  case outsignobjpkobjapask_0_11111111111111111111211111111
                                                  solve( (#t2.4 < #t2.14)  ∥ (#t2.4 = #t2.14) )
                                                    case case_1
                                                    by contradiction /* from formulas */
                                                  next
                                                    case case_2
                                                    solve( (#t2.5 < #t2.14)  ∥ (#t2.5 = #t2.14) )
                                                      case case_1
                                                      by contradiction /* from formulas */
                                                    next
                                                      case case_2
                                                      solve( (#t2.9 < #t2.14)  ∥ (#t2.9 = #t2.14) )
                                                        case case_1
                                                        by contradiction /* from formulas */
                                                      next
                                                        case case_2
                                                        solve( (#vr.32 < #t2.13)  ∥ (#vr.32 = #t2.13) )
                                                          case case_1
                                                          solve( (#t2.10 < #t2.13)  ∥ (#t2.10 = #t2.13) )
                                                            case case_1
                                                            by contradiction /* from formulas */
                                                          next
                                                            case case_2
                                                            solve( TPM_SendCommand( <'TPM2_Create', 
                                                                                     <swstate, nil>, 
                                                                                     'TPM_CC_PolicyPCR', nil>
                                                                   ) @ #t2.11 )
                                                              case eventTPMSendCommandTPMCreateswstatenilTPMCCPolicyPCRnil_0_11111111111112111
                                                              solve( state_11111111111112111( ~RouterID.1,
                                                                                              ~ServerID.1,
                                                                                              ~ak_h.1,
                                                                                              ~ak_sk.1,
                                                                                              ~ssk_nms.1,
                                                                                              ~tid.1
                                                                     ) ▶₀ #t2.7 )
                                                                case outTPMPCRExtendswstate_0_1111111111111211
                                                                solve( TPM_SendCommand( <'TPM2_Certify', 
                                                                                         k_sh, ~k_h, ~ak_h>
                                                                       ) @ #t2.11 )
                                                                  case eventTPMSendCommandTPMCertifytlsshtlshakh_0_111111111111121111111111111
                                                                  solve( state_111111111111121111111111111( ~RouterID.1,
                                                                                                            ~ServerID.1,
                                                                                                            ~ak_h,
                                                                                                            ~ak_sk.1,
                                                                                                            ~ssk_nms.1,
                                                                                                            ~tid.1,
                                                                                                            ~k_h,
                                                                                                            k_sh,
                                                                                                            tls_spk
                                                                         ) ▶₀ #t2.7 )
                                                                    case outTPMPolicyPCRtlssh_0_11111111111112111111111111
                                                                    solve( TPM_SendCommand( <'TPM2_Create', 
                                                                                             <swstate, nil>, 
                                                                                             'TPM_CC_PolicyPCR', 
                                                                                             nil>
                                                                           ) @ #t2.11 )
                                                                      case eventTPMSendCommandTPMCreateswstatenilTPMCCPolicyPCRnil_0_11111111111112111
                                                                      solve( state_11111111111112111( ~RouterID.1,
                                                                                                      ~ServerID.1,
                                                                                                      ~ak_h.1,
                                                                                                      ~ak_sk.1,
                                                                                                      ~ssk_nms.1,
                                                                                                      ~tid.1
                                                                             ) ▶₀ #t2.7 )
                                                                        case outTPMPCRExtendswstate_0_1111111111111211
                                                                        solve( Insert( <'privatePart', ~k_h>,
                                                                                       k_sk.1
                                                                               ) @ #t2.8 )
                                                                          case insertprivatePartakhaksk_0_111111111111111
                                                                          by solve( state_111111111111111( ~RouterID.1,
                                                                                                           ~ServerID.1,
                                                                                                           ~k_h,
                                                                                                           ~ak_sk.1,
                                                                                                           ~ssk_nms.1
                                                                                    ) ▶₀ #t2.7 )
                                                                        next
                                                                          case insertprivatePartkhksk_0_111111111111111111111121111111
                                                                          solve( state_111111111111111111111121111111( ~RouterID.1,
                                                                                                                       ~ServerID.1,
                                                                                                                       ~ak_h.1,
                                                                                                                       ~ak_sk.1,
                                                                                                                       ~k_h,
                                                                                                                       ~k_sk.1,
                                                                                                                       ~ssk_nms.1,
                                                                                                                       authPolicy,
                                                                                                                       lock
                                                                                 ) ▶₀ #t2.7 )
                                                                            case insertauthPolicykhauthPolicy_0_11111111111111111111112111111
                                                                            by contradiction /* cyclic */
                                                                          qed
                                                                        qed
                                                                      qed
                                                                    qed
                                                                  qed
                                                                qed
                                                              qed
                                                            qed
                                                          qed
                                                        next
                                                          case case_2
                                                          by contradiction /* from formulas */
                                                        qed
                                                      qed
                                                    qed
                                                  qed
                                                qed
                                              next
                                                case unlockdevice_0_11111111111111111111211111112
                                                by solve( state_11111111111111111111211111112( ~RouterID.1,
                                                                                               ~ServerID.1,
                                                                                               ~ak_h.1,
                                                                                               ~ak_sk.1,
                                                                                               ~ssk_nms.1,
                                                                                               a_h, obj_ap,
                                                                                               obj_h, obj_pd,
                                                                                               obj_pk, obj_sh,
                                                                                               ~n.2
                                                          ) ▶₀ #t2.6 )
                                              qed
                                            next
                                              case case_3
                                              solve( Unlock_4( '4', ~n.2, 'device' ) @ #t2.9 )
                                                case unlockdevice_0_111111111111111111112111111111
                                                solve( state_111111111111111111112111111111( ~RouterID.1,
                                                                                             ~ServerID.1,
                                                                                             ~ak_h.1,
                                                                                             ~ak_sk.1,
                                                                                             ~ssk_nms.1, a_h,
                                                                                             a_sk, obj_ap,
                                                                                             obj_h, obj_pd,
                                                                                             obj_pk, obj_sh,
                                                                                             ~n.2
                                                       ) ▶₀ #t2.6 )
                                                  case outsignobjpkobjapask_0_11111111111111111111211111111
                                                  solve( (#t2.4 < #t2.15)  ∥ (#t2.4 = #t2.15) )
                                                    case case_1
                                                    by contradiction /* from formulas */
                                                  next
                                                    case case_2
                                                    solve( (#t2.5 < #t2.15)  ∥ (#t2.5 = #t2.15) )
                                                      case case_1
                                                      by contradiction /* from formulas */
                                                    next
                                                      case case_2
                                                      solve( (#t2.11 < #t2.15)  ∥ (#t2.11 = #t2.15) )
                                                        case case_1
                                                        by contradiction /* from formulas */
                                                      next
                                                        case case_2
                                                        solve( (#vr.32 < #t2.14)  ∥ (#vr.32 = #t2.14) )
                                                          case case_1
                                                          solve( (#t2.10 < #t2.14)  ∥ (#t2.10 = #t2.14) )
                                                            case case_1
                                                            by contradiction /* from formulas */
                                                          next
                                                            case case_2
                                                            solve( TPM_SendCommand( <'TPM2_Create', 
                                                                                     <swstate, nil>, 
                                                                                     'TPM_CC_PolicyPCR', nil>
                                                                   ) @ #t2.12 )
                                                              case eventTPMSendCommandTPMCreateswstatenilTPMCCPolicyPCRnil_0_11111111111112111
                                                              solve( state_11111111111112111( ~RouterID.1,
                                                                                              ~ServerID.1,
                                                                                              ~ak_h.1,
                                                                                              ~ak_sk.1,
                                                                                              ~ssk_nms.1,
                                                                                              ~tid.1
                                                                     ) ▶₀ #t2.7 )
                                                                case outTPMPCRExtendswstate_0_1111111111111211
                                                                solve( TPM_SendCommand( <'TPM2_Certify', 
                                                                                         k_sh, ~k_h, ~ak_h>
                                                                       ) @ #t2.12 )
                                                                  case eventTPMSendCommandTPMCertifytlsshtlshakh_0_111111111111121111111111111
                                                                  solve( state_111111111111121111111111111( ~RouterID.1,
                                                                                                            ~ServerID.1,
                                                                                                            ~ak_h,
                                                                                                            ~ak_sk.1,
                                                                                                            ~ssk_nms.1,
                                                                                                            ~tid.1,
                                                                                                            ~k_h,
                                                                                                            k_sh,
                                                                                                            tls_spk
                                                                         ) ▶₀ #t2.7 )
                                                                    case outTPMPolicyPCRtlssh_0_11111111111112111111111111
                                                                    solve( TPM_SendCommand( <'TPM2_Create', 
                                                                                             <swstate, nil>, 
                                                                                             'TPM_CC_PolicyPCR', 
                                                                                             nil>
                                                                           ) @ #t2.12 )
                                                                      case eventTPMSendCommandTPMCreateswstatenilTPMCCPolicyPCRnil_0_11111111111112111
                                                                      solve( state_11111111111112111( ~RouterID.1,
                                                                                                      ~ServerID.1,
                                                                                                      ~ak_h.1,
                                                                                                      ~ak_sk.1,
                                                                                                      ~ssk_nms.1,
                                                                                                      ~tid.1
                                                                             ) ▶₀ #t2.7 )
                                                                        case outTPMPCRExtendswstate_0_1111111111111211
                                                                        solve( Insert( <'privatePart', ~k_h>,
                                                                                       k_sk.1
                                                                               ) @ #t2.8 )
                                                                          case insertprivatePartakhaksk_0_111111111111111
                                                                          by solve( state_111111111111111( ~RouterID.1,
                                                                                                           ~ServerID.1,
                                                                                                           ~k_h,
                                                                                                           ~ak_sk.1,
                                                                                                           ~ssk_nms.1
                                                                                    ) ▶₀ #t2.7 )
                                                                        next
                                                                          case insertprivatePartkhksk_0_111111111111111111111121111111
                                                                          solve( state_111111111111111111111121111111( ~RouterID.1,
                                                                                                                       ~ServerID.1,
                                                                                                                       ~ak_h.1,
                                                                                                                       ~ak_sk.1,
                                                                                                                       ~k_h,
                                                                                                                       ~k_sk.1,
                                                                                                                       ~ssk_nms.1,
                                                                                                                       authPolicy,
                                                                                                                       lock
                                                                                 ) ▶₀ #t2.7 )
                                                                            case insertauthPolicykhauthPolicy_0_11111111111111111111112111111
                                                                            by contradiction /* cyclic */
                                                                          qed
                                                                        qed
                                                                      qed
                                                                    qed
                                                                  qed
                                                                qed
                                                              qed
                                                            qed
                                                          qed
                                                        next
                                                          case case_2
                                                          by contradiction /* from formulas */
                                                        qed
                                                      qed
                                                    qed
                                                  qed
                                                qed
                                              next
                                                case unlockdevice_0_11111111111111111111211111112
                                                by solve( state_11111111111111111111211111112( ~RouterID.1,
                                                                                               ~ServerID.1,
                                                                                               ~ak_h.1,
                                                                                               ~ak_sk.1,
                                                                                               ~ssk_nms.1,
                                                                                               a_h, obj_ap,
                                                                                               obj_h, obj_pd,
                                                                                               obj_pk, obj_sh,
                                                                                               ~n.2
                                                          ) ▶₀ #t2.6 )
                                              qed
                                            qed
                                          next
                                            case case_2
                                            solve( (#t2.9 < #t2.11)  ∥ (#t2.9 = #t2.11)  ∥ (#vr.72 < #t2.9) )
                                              case case_1
                                              by contradiction /* from formulas */
                                            next
                                              case case_2
                                              solve( Unlock_4( '4', ~n.2, 'device' ) @ #t2.10 )
                                                case unlockdevice_0_111111111111111111112111111111
                                                solve( state_111111111111111111112111111111( ~RouterID.1,
                                                                                             ~ServerID.1,
                                                                                             ~ak_h.1,
                                                                                             ~ak_sk.1,
                                                                                             ~ssk_nms.1, a_h,
                                                                                             a_sk, obj_ap,
                                                                                             obj_h, obj_pd,
                                                                                             obj_pk, obj_sh,
                                                                                             ~n.2
                                                       ) ▶₀ #t2.7 )
                                                  case outsignobjpkobjapask_0_11111111111111111111211111111
                                                  solve( (#t2.4 < #t2.14)  ∥ (#t2.4 = #t2.14) )
                                                    case case_1
                                                    by contradiction /* from formulas */
                                                  next
                                                    case case_2
                                                    solve( (#t2.5 < #t2.14)  ∥ (#t2.5 = #t2.14) )
                                                      case case_1
                                                      by contradiction /* from formulas */
                                                    next
                                                      case case_2
                                                      solve( (#t2.6 < #t2.13)  ∥ (#t2.6 = #t2.13) )
                                                        case case_1
                                                        by contradiction /* from formulas */
                                                      next
                                                        case case_2
                                                        solve( (#t2.10 < #t2.13)  ∥ (#t2.10 = #t2.13) )
                                                          case case_1
                                                          by contradiction /* from formulas */
                                                        next
                                                          case case_2
                                                          solve( TPM_SendCommand( <'TPM2_Create', 
                                                                                   <swstate, nil>, 
                                                                                   'TPM_CC_PolicyPCR', nil>
                                                                 ) @ #t2.11 )
                                                            case eventTPMSendCommandTPMCreateswstatenilTPMCCPolicyPCRnil_0_11111111111112111
                                                            solve( state_11111111111112111( ~RouterID.1,
                                                                                            ~ServerID.1,
                                                                                            ~ak_h.1, ~ak_sk.1,
                                                                                            ~ssk_nms.1, ~tid.1
                                                                   ) ▶₀ #t2.8 )
                                                              case outTPMPCRExtendswstate_0_1111111111111211
                                                              solve( TPM_SendCommand( <'TPM2_Certify', k_sh, 
                                                                                       ~k_h, ~ak_h>
                                                                     ) @ #t2.11 )
                                                                case eventTPMSendCommandTPMCertifytlsshtlshakh_0_111111111111121111111111111
                                                                solve( state_111111111111121111111111111( ~RouterID.1,
                                                                                                          ~ServerID.1,
                                                                                                          ~ak_h,
                                                                                                          ~ak_sk.1,
                                                                                                          ~ssk_nms.1,
                                                                                                          ~tid.1,
                                                                                                          ~k_h,
                                                                                                          k_sh,
                                                                                                          tls_spk
                                                                       ) ▶₀ #t2.8 )
                                                                  case outTPMPolicyPCRtlssh_0_11111111111112111111111111
                                                                  solve( TPM_SendCommand( <'TPM2_Create', 
                                                                                           <swstate, nil>, 
                                                                                           'TPM_CC_PolicyPCR', 
                                                                                           nil>
                                                                         ) @ #t2.11 )
                                                                    case eventTPMSendCommandTPMCreateswstatenilTPMCCPolicyPCRnil_0_11111111111112111
                                                                    solve( state_11111111111112111( ~RouterID.1,
                                                                                                    ~ServerID.1,
                                                                                                    ~ak_h.1,
                                                                                                    ~ak_sk.1,
                                                                                                    ~ssk_nms.1,
                                                                                                    ~tid.1
                                                                           ) ▶₀ #t2.8 )
                                                                      case outTPMPCRExtendswstate_0_1111111111111211
                                                                      solve( Insert( <'privatePart', ~k_h>,
                                                                                     k_sk.1
                                                                             ) @ #t2.9 )
                                                                        case insertprivatePartakhaksk_0_111111111111111
                                                                        by solve( state_111111111111111( ~RouterID.1,
                                                                                                         ~ServerID.1,
                                                                                                         ~k_h,
                                                                                                         ~ak_sk.1,
                                                                                                         ~ssk_nms.1
                                                                                  ) ▶₀ #t2.8 )
                                                                      next
                                                                        case insertprivatePartkhksk_0_111111111111111111111121111111
                                                                        solve( state_111111111111111111111121111111( ~RouterID.1,
                                                                                                                     ~ServerID.1,
                                                                                                                     ~ak_h.1,
                                                                                                                     ~ak_sk.1,
                                                                                                                     ~k_h,
                                                                                                                     ~k_sk.1,
                                                                                                                     ~ssk_nms.1,
                                                                                                                     authPolicy,
                                                                                                                     lock
                                                                               ) ▶₀ #t2.8 )
                                                                          case insertauthPolicykhauthPolicy_0_11111111111111111111112111111
                                                                          by contradiction /* cyclic */
                                                                        qed
                                                                      qed
                                                                    qed
                                                                  qed
                                                                qed
                                                              qed
                                                            qed
                                                          qed
                                                        qed
                                                      qed
                                                    qed
                                                  qed
                                                qed
                                              next
                                                case unlockdevice_0_11111111111111111111211111112
                                                by solve( state_11111111111111111111211111112( ~RouterID.1,
                                                                                               ~ServerID.1,
                                                                                               ~ak_h.1,
                                                                                               ~ak_sk.1,
                                                                                               ~ssk_nms.1,
                                                                                               a_h, obj_ap,
                                                                                               obj_h, obj_pd,
                                                                                               obj_pk, obj_sh,
                                                                                               ~n.2
                                                          ) ▶₀ #t2.7 )
                                              qed
                                            next
                                              case case_3
                                              solve( Unlock_4( '4', ~n.2, 'device' ) @ #t2.10 )
                                                case unlockdevice_0_111111111111111111112111111111
                                                solve( state_111111111111111111112111111111( ~RouterID.1,
                                                                                             ~ServerID.1,
                                                                                             ~ak_h.1,
                                                                                             ~ak_sk.1,
                                                                                             ~ssk_nms.1, a_h,
                                                                                             a_sk, obj_ap,
                                                                                             obj_h, obj_pd,
                                                                                             obj_pk, obj_sh,
                                                                                             ~n.2
                                                       ) ▶₀ #t2.7 )
                                                  case outsignobjpkobjapask_0_11111111111111111111211111111
                                                  solve( (#t2.4 < #t2.15)  ∥ (#t2.4 = #t2.15) )
                                                    case case_1
                                                    by contradiction /* from formulas */
                                                  next
                                                    case case_2
                                                    solve( (#t2.5 < #t2.15)  ∥ (#t2.5 = #t2.15) )
                                                      case case_1
                                                      by contradiction /* from formulas */
                                                    next
                                                      case case_2
                                                      solve( (#t2.6 < #t2.14)  ∥ (#t2.6 = #t2.14) )
                                                        case case_1
                                                        by contradiction /* from formulas */
                                                      next
                                                        case case_2
                                                        solve( (#t2.11 < #t2.14)  ∥ (#t2.11 = #t2.14) )
                                                          case case_1
                                                          by contradiction /* from formulas */
                                                        next
                                                          case case_2
                                                          solve( TPM_SendCommand( <'TPM2_Create', 
                                                                                   <swstate, nil>, 
                                                                                   'TPM_CC_PolicyPCR', nil>
                                                                 ) @ #t2.12 )
                                                            case eventTPMSendCommandTPMCreateswstatenilTPMCCPolicyPCRnil_0_11111111111112111
                                                            solve( state_11111111111112111( ~RouterID.1,
                                                                                            ~ServerID.1,
                                                                                            ~ak_h.1, ~ak_sk.1,
                                                                                            ~ssk_nms.1, ~tid.1
                                                                   ) ▶₀ #t2.8 )
                                                              case outTPMPCRExtendswstate_0_1111111111111211
                                                              solve( TPM_SendCommand( <'TPM2_Certify', k_sh, 
                                                                                       ~k_h, ~ak_h>
                                                                     ) @ #t2.12 )
                                                                case eventTPMSendCommandTPMCertifytlsshtlshakh_0_111111111111121111111111111
                                                                solve( state_111111111111121111111111111( ~RouterID.1,
                                                                                                          ~ServerID.1,
                                                                                                          ~ak_h,
                                                                                                          ~ak_sk.1,
                                                                                                          ~ssk_nms.1,
                                                                                                          ~tid.1,
                                                                                                          ~k_h,
                                                                                                          k_sh,
                                                                                                          tls_spk
                                                                       ) ▶₀ #t2.8 )
                                                                  case outTPMPolicyPCRtlssh_0_11111111111112111111111111
                                                                  solve( TPM_SendCommand( <'TPM2_Create', 
                                                                                           <swstate, nil>, 
                                                                                           'TPM_CC_PolicyPCR', 
                                                                                           nil>
                                                                         ) @ #t2.12 )
                                                                    case eventTPMSendCommandTPMCreateswstatenilTPMCCPolicyPCRnil_0_11111111111112111
                                                                    solve( state_11111111111112111( ~RouterID.1,
                                                                                                    ~ServerID.1,
                                                                                                    ~ak_h.1,
                                                                                                    ~ak_sk.1,
                                                                                                    ~ssk_nms.1,
                                                                                                    ~tid.1
                                                                           ) ▶₀ #t2.8 )
                                                                      case outTPMPCRExtendswstate_0_1111111111111211
                                                                      solve( Insert( <'privatePart', ~k_h>,
                                                                                     k_sk.1
                                                                             ) @ #t2.9 )
                                                                        case insertprivatePartakhaksk_0_111111111111111
                                                                        by solve( state_111111111111111( ~RouterID.1,
                                                                                                         ~ServerID.1,
                                                                                                         ~k_h,
                                                                                                         ~ak_sk.1,
                                                                                                         ~ssk_nms.1
                                                                                  ) ▶₀ #t2.8 )
                                                                      next
                                                                        case insertprivatePartkhksk_0_111111111111111111111121111111
                                                                        solve( state_111111111111111111111121111111( ~RouterID.1,
                                                                                                                     ~ServerID.1,
                                                                                                                     ~ak_h.1,
                                                                                                                     ~ak_sk.1,
                                                                                                                     ~k_h,
                                                                                                                     ~k_sk.1,
                                                                                                                     ~ssk_nms.1,
                                                                                                                     authPolicy,
                                                                                                                     lock
                                                                               ) ▶₀ #t2.8 )
                                                                          case insertauthPolicykhauthPolicy_0_11111111111111111111112111111
                                                                          by contradiction /* cyclic */
                                                                        qed
                                                                      qed
                                                                    qed
                                                                  qed
                                                                qed
                                                              qed
                                                            qed
                                                          qed
                                                        qed
                                                      qed
                                                    qed
                                                  qed
                                                qed
                                              next
                                                case unlockdevice_0_11111111111111111111211111112
                                                by solve( state_11111111111111111111211111112( ~RouterID.1,
                                                                                               ~ServerID.1,
                                                                                               ~ak_h.1,
                                                                                               ~ak_sk.1,
                                                                                               ~ssk_nms.1,
                                                                                               a_h, obj_ap,
                                                                                               obj_h, obj_pd,
                                                                                               obj_pk, obj_sh,
                                                                                               ~n.2
                                                          ) ▶₀ #t2.7 )
                                              qed
                                            qed
                                          qed
                                        qed
                                      qed
                                    qed
                                  qed
                                qed
                              qed
                            next
                              case outtlsspksigntlsspkssknms_0_11111111111121111111111
                              by contradiction /* from formulas */
                            qed
                          qed
                        qed
                      qed
                    qed
                  qed
                qed
              next
                case case_2
                solve( TPM_SendCommand( <'TPM2_Create', authPolicy> ) @ #t2.3 )
                  case eventTPMSendCommandTPMCreateswstatenilTPMCCPolicyPCRnil_0_11111111111112111
                  solve( state_11111111111112111( ~RouterID.1, ~ServerID.1, ~ak_h.1,
                                                  ~ak_sk.1, ~ssk_nms.1, ~tid.1
                         ) ▶₀ #t2.3 )
                    case outTPMPCRExtendswstate_0_1111111111111211
                    solve( TPM_SendCommand( <'TPM2_Create', <swstate, nil>, 
                                             'TPM_CC_PolicyPCR', nil>
                           ) @ #t2.6 )
                      case eventTPMSendCommandTPMCreateswstatenilTPMCCPolicyPCRnil_0_11111111111112111
                      solve( state_11111111111112111( ~RouterID.1, ~ServerID.1, ~ak_h.1,
                                                      ~ak_sk.1, ~ssk_nms.1, ~tid.1
                             ) ▶₀ #t2.4 )
                        case outTPMPCRExtendswstate_0_1111111111111211
                        solve( TPM_SendCommand( <'TPM2_Create', <swstate, nil>, 
                                                 'TPM_CC_PolicyPCR', nil>
                               ) @ #t2.6 )
                          case eventTPMSendCommandTPMCreateswstatenilTPMCCPolicyPCRnil_0_11111111111112111
                          solve( state_11111111111112111( ~RouterID.1, ~ServerID.1, ~ak_h.1,
                                                          ~ak_sk.1, ~ssk_nms.1, ~tid.1
                                 ) ▶₀ #t2.4 )
                            case outTPMPCRExtendswstate_0_1111111111111211
                            solve( !KU( sign(pk(~k_sk), ~ssk_nms) ) @ #vk.6 )
                              case c_sign
                              solve( !KU( sign(<pk(~k_sk), <swstate, nil>, 'TPM_CC_PolicyPCR', nil>,
                                               ~ak_sk)
                                     ) @ #vk.7 )
                                case c_sign
                                solve( !KU( pk(~k_sk) ) @ #vk.3 )
                                  case c_pk
                                  solve( Insert( <'privatePart', ~k_h>, k_sk.1 ) @ #t2.4 )
                                    case insertprivatePartakhaksk_0_111111111111111
                                    by solve( state_111111111111111( ~RouterID.1, ~ServerID.1, ~k_h,
                                                                     ~ak_sk.1, ~ssk_nms.1
                                              ) ▶₀ #t2.4 )
                                  next
                                    case insertprivatePartkhksk_0_111111111111111111111121111111
                                    solve( state_111111111111111111111121111111( ~RouterID.1, ~ServerID.1,
                                                                                 ~ak_h.1, ~ak_sk.1, ~k_h,
                                                                                 ~k_sk.1, ~ssk_nms.1,
                                                                                 authPolicy, lock
                                           ) ▶₀ #t2.4 )
                                      case insertauthPolicykhauthPolicy_0_11111111111111111111112111111
                                      by contradiction /* cyclic */
                                    qed
                                  qed
                                next
                                  case outTPMSigntlsshtlshtlsspkskae_0_1111111111111211111111111111111111
                                  by contradiction /* cyclic */
                                next
                                  case outtlsspkskaecsr_0_11111111111112111111111111111111111111
                                  by contradiction /* cyclic */
                                qed
                              next
                                case outsignobjpkobjapask_0_11111111111111111111211111111
                                solve( (#vr.76 < #vr.49)  ∥ (#t2 < #vr.76) )
                                  case case_1
                                  solve( TPM_SendCommand( <'TPM2_Certify', obj_sh, obj_h, a_h> ) @ #t2.7 )
                                    case eventTPMSendCommandTPMCertifytlsshtlshakh_0_111111111111121111111111111
                                    solve( state_111111111111121111111111111( ~RouterID.1, ~ServerID.1,
                                                                              ~ak_h.1, ~ak_sk.1, ~ssk_nms.1,
                                                                              ~tid.1, obj_h, obj_sh, tls_spk
                                           ) ▶₀ #t2.4 )
                                      case outTPMPolicyPCRtlssh_0_11111111111112111111111111
                                      by contradiction /* cyclic */
                                    qed
                                  qed
                                next
                                  case case_2
                                  solve( TPM_SendCommand( <'TPM2_Certify', obj_sh, obj_h, a_h> ) @ #t2.7 )
                                    case eventTPMSendCommandTPMCertifytlsshtlshakh_0_111111111111121111111111111
                                    solve( state_111111111111121111111111111( ~RouterID.1, ~ServerID.1,
                                                                              ~ak_h.1, ~ak_sk.1, ~ssk_nms.1,
                                                                              ~tid.1, obj_h, obj_sh, tls_spk
                                           ) ▶₀ #t2.4 )
                                      case outTPMPolicyPCRtlssh_0_11111111111112111111111111
                                      solve( (#vr.40 < #t2.9)  ∥ (#vr.40 = #t2.9) )
                                        case case_1
                                        solve( (#t2.2 < #t2.10)  ∥ (#t2.2 = #t2.10) )
                                          case case_1
                                          by contradiction /* from formulas */
                                        next
                                          case case_2
                                          solve( (#vr.32 < #t2.8)  ∥ (#vr.32 = #t2.8) )
                                            case case_1
                                            solve( (#t2.6 < #t2.10)  ∥ (#t2.6 = #t2.10)  ∥ (#vr.74 < #t2.6) )
                                              case case_1
                                              by contradiction /* from formulas */
                                            next
                                              case case_2
                                              solve( Unlock_4( '4', ~n.2, 'device' ) @ #t2.7 )
                                                case unlockdevice_0_111111111111111111112111111111
                                                solve( state_111111111111111111112111111111( ~RouterID.1,
                                                                                             ~ServerID.1,
                                                                                             ~ak_h.1,
                                                                                             ~ak_sk.1,
                                                                                             ~ssk_nms.1, a_h,
                                                                                             a_sk, obj_ap,
                                                                                             obj_h, obj_pd,
                                                                                             obj_pk, obj_sh,
                                                                                             ~n.2
                                                       ) ▶₀ #t2.5 )
                                                  case outsignobjpkobjapask_0_11111111111111111111211111111
                                                  solve( (#t2.2 < #t2.14)  ∥ (#t2.2 = #t2.14) )
                                                    case case_1
                                                    by contradiction /* from formulas */
                                                  next
                                                    case case_2
                                                    solve( (#t2.7 < #t2.14)  ∥ (#t2.7 = #t2.14) )
                                                      case case_1
                                                      by contradiction /* from formulas */
                                                    next
                                                      case case_2
                                                      solve( (#vr.32 < #t2.12)  ∥ (#vr.32 = #t2.12) )
                                                        case case_1
                                                        solve( (#vr.40 < #t2.13)  ∥ (#vr.40 = #t2.13) )
                                                          case case_1
                                                          solve( (#t2.9 < #t2.13)  ∥ (#t2.9 = #t2.13) )
                                                            case case_1
                                                            by contradiction /* from formulas */
                                                          next
                                                            case case_2
                                                            solve( (#t2.8 < #t2.12)  ∥ (#t2.8 = #t2.12) )
                                                              case case_1
                                                              by contradiction /* from formulas */
                                                            next
                                                              case case_2
                                                              solve( TPM_SendCommand( <'TPM2_Create', 
                                                                                       <swstate, nil>, 
                                                                                       'TPM_CC_PolicyPCR', nil
                                                                                      >
                                                                     ) @ #t2.10 )
                                                                case eventTPMSendCommandTPMCreateswstatenilTPMCCPolicyPCRnil_0_11111111111112111
                                                                solve( state_11111111111112111( ~RouterID.1,
                                                                                                ~ServerID.1,
                                                                                                ~ak_h.1,
                                                                                                ~ak_sk.1,
                                                                                                ~ssk_nms.1,
                                                                                                ~tid.1
                                                                       ) ▶₀ #t2.6 )
                                                                  case outTPMPCRExtendswstate_0_1111111111111211
                                                                  solve( TPM_SendCommand( <'TPM2_Certify', 
                                                                                           k_sh, ~k_h, ~ak_h>
                                                                         ) @ #t2.10 )
                                                                    case eventTPMSendCommandTPMCertifytlsshtlshakh_0_111111111111121111111111111
                                                                    solve( state_111111111111121111111111111( ~RouterID.1,
                                                                                                              ~ServerID.1,
                                                                                                              ~ak_h,
                                                                                                              ~ak_sk.1,
                                                                                                              ~ssk_nms.1,
                                                                                                              ~tid.1,
                                                                                                              ~k_h,
                                                                                                              k_sh,
                                                                                                              tls_spk
                                                                           ) ▶₀ #t2.6 )
                                                                      case outTPMPolicyPCRtlssh_0_11111111111112111111111111
                                                                      solve( TPM_SendCommand( <'TPM2_Create', 
                                                                                               <swstate, nil
                                                                                               >, 
                                                                                               'TPM_CC_PolicyPCR', 
                                                                                               nil>
                                                                             ) @ #t2.10 )
                                                                        case eventTPMSendCommandTPMCreateswstatenilTPMCCPolicyPCRnil_0_11111111111112111
                                                                        solve( state_11111111111112111( ~RouterID.1,
                                                                                                        ~ServerID.1,
                                                                                                        ~ak_h.1,
                                                                                                        ~ak_sk.1,
                                                                                                        ~ssk_nms.1,
                                                                                                        ~tid.1
                                                                               ) ▶₀ #t2.6 )
                                                                          case outTPMPCRExtendswstate_0_1111111111111211
                                                                          solve( Insert( <'privatePart', ~k_h
                                                                                         >,
                                                                                         k_sk.1
                                                                                 ) @ #t2.6 )
                                                                            case insertprivatePartakhaksk_0_111111111111111
                                                                            by solve( state_111111111111111( ~RouterID.1,
                                                                                                             ~ServerID.1,
                                                                                                             ~k_h,
                                                                                                             ~ak_sk.1,
                                                                                                             ~ssk_nms.1
                                                                                      ) ▶₀ #t2.6 )
                                                                          next
                                                                            case insertprivatePartkhksk_0_111111111111111111111121111111
                                                                            solve( state_111111111111111111111121111111( ~RouterID.1,
                                                                                                                         ~ServerID.1,
                                                                                                                         ~ak_h.1,
                                                                                                                         ~ak_sk.1,
                                                                                                                         ~k_h,
                                                                                                                         ~k_sk.1,
                                                                                                                         ~ssk_nms.1,
                                                                                                                         authPolicy,
                                                                                                                         lock
                                                                                   ) ▶₀ #t2.6 )
                                                                              case insertauthPolicykhauthPolicy_0_11111111111111111111112111111
                                                                              by contradiction /* cyclic */
                                                                            qed
                                                                          qed
                                                                        qed
                                                                      qed
                                                                    qed
                                                                  qed
                                                                qed
                                                              qed
                                                            qed
                                                          qed
                                                        next
                                                          case case_2
                                                          by contradiction /* from formulas */
                                                        qed
                                                      next
                                                        case case_2
                                                        by contradiction /* from formulas */
                                                      qed
                                                    qed
                                                  qed
                                                qed
                                              next
                                                case unlockdevice_0_11111111111111111111211111112
                                                by solve( state_11111111111111111111211111112( ~RouterID.1,
                                                                                               ~ServerID.1,
                                                                                               ~ak_h.1,
                                                                                               ~ak_sk.1,
                                                                                               ~ssk_nms.1,
                                                                                               a_h, obj_ap,
                                                                                               obj_h, obj_pd,
                                                                                               obj_pk, obj_sh,
                                                                                               ~n.2
                                                          ) ▶₀ #t2.5 )
                                              qed
                                            next
                                              case case_3
                                              solve( Unlock_4( '4', ~n.2, 'device' ) @ #t2.7 )
                                                case unlockdevice_0_111111111111111111112111111111
                                                solve( state_111111111111111111112111111111( ~RouterID.1,
                                                                                             ~ServerID.1,
                                                                                             ~ak_h.1,
                                                                                             ~ak_sk.1,
                                                                                             ~ssk_nms.1, a_h,
                                                                                             a_sk, obj_ap,
                                                                                             obj_h, obj_pd,
                                                                                             obj_pk, obj_sh,
                                                                                             ~n.2
                                                       ) ▶₀ #t2.5 )
                                                  case outsignobjpkobjapask_0_11111111111111111111211111111
                                                  solve( (#t2.2 < #t2.15)  ∥ (#t2.2 = #t2.15) )
                                                    case case_1
                                                    by contradiction /* from formulas */
                                                  next
                                                    case case_2
                                                    solve( (#t2.10 < #t2.15)  ∥ (#t2.10 = #t2.15) )
                                                      case case_1
                                                      by contradiction /* from formulas */
                                                    next
                                                      case case_2
                                                      solve( (#vr.32 < #t2.13)  ∥ (#vr.32 = #t2.13) )
                                                        case case_1
                                                        solve( (#vr.40 < #t2.14)  ∥ (#vr.40 = #t2.14) )
                                                          case case_1
                                                          solve( (#t2.9 < #t2.14)  ∥ (#t2.9 = #t2.14) )
                                                            case case_1
                                                            by contradiction /* from formulas */
                                                          next
                                                            case case_2
                                                            solve( (#t2.8 < #t2.13)  ∥ (#t2.8 = #t2.13) )
                                                              case case_1
                                                              by contradiction /* from formulas */
                                                            next
                                                              case case_2
                                                              solve( TPM_SendCommand( <'TPM2_Create', 
                                                                                       <swstate, nil>, 
                                                                                       'TPM_CC_PolicyPCR', nil
                                                                                      >
                                                                     ) @ #t2.11 )
                                                                case eventTPMSendCommandTPMCreateswstatenilTPMCCPolicyPCRnil_0_11111111111112111
                                                                solve( state_11111111111112111( ~RouterID.1,
                                                                                                ~ServerID.1,
                                                                                                ~ak_h.1,
                                                                                                ~ak_sk.1,
                                                                                                ~ssk_nms.1,
                                                                                                ~tid.1
                                                                       ) ▶₀ #t2.6 )
                                                                  case outTPMPCRExtendswstate_0_1111111111111211
                                                                  solve( TPM_SendCommand( <'TPM2_Certify', 
                                                                                           k_sh, ~k_h, ~ak_h>
                                                                         ) @ #t2.11 )
                                                                    case eventTPMSendCommandTPMCertifytlsshtlshakh_0_111111111111121111111111111
                                                                    solve( state_111111111111121111111111111( ~RouterID.1,
                                                                                                              ~ServerID.1,
                                                                                                              ~ak_h,
                                                                                                              ~ak_sk.1,
                                                                                                              ~ssk_nms.1,
                                                                                                              ~tid.1,
                                                                                                              ~k_h,
                                                                                                              k_sh,
                                                                                                              tls_spk
                                                                           ) ▶₀ #t2.6 )
                                                                      case outTPMPolicyPCRtlssh_0_11111111111112111111111111
                                                                      solve( TPM_SendCommand( <'TPM2_Create', 
                                                                                               <swstate, nil
                                                                                               >, 
                                                                                               'TPM_CC_PolicyPCR', 
                                                                                               nil>
                                                                             ) @ #t2.11 )
                                                                        case eventTPMSendCommandTPMCreateswstatenilTPMCCPolicyPCRnil_0_11111111111112111
                                                                        solve( state_11111111111112111( ~RouterID.1,
                                                                                                        ~ServerID.1,
                                                                                                        ~ak_h.1,
                                                                                                        ~ak_sk.1,
                                                                                                        ~ssk_nms.1,
                                                                                                        ~tid.1
                                                                               ) ▶₀ #t2.6 )
                                                                          case outTPMPCRExtendswstate_0_1111111111111211
                                                                          solve( Insert( <'privatePart', ~k_h
                                                                                         >,
                                                                                         k_sk.1
                                                                                 ) @ #t2.6 )
                                                                            case insertprivatePartakhaksk_0_111111111111111
                                                                            by solve( state_111111111111111( ~RouterID.1,
                                                                                                             ~ServerID.1,
                                                                                                             ~k_h,
                                                                                                             ~ak_sk.1,
                                                                                                             ~ssk_nms.1
                                                                                      ) ▶₀ #t2.6 )
                                                                          next
                                                                            case insertprivatePartkhksk_0_111111111111111111111121111111
                                                                            solve( state_111111111111111111111121111111( ~RouterID.1,
                                                                                                                         ~ServerID.1,
                                                                                                                         ~ak_h.1,
                                                                                                                         ~ak_sk.1,
                                                                                                                         ~k_h,
                                                                                                                         ~k_sk.1,
                                                                                                                         ~ssk_nms.1,
                                                                                                                         authPolicy,
                                                                                                                         lock
                                                                                   ) ▶₀ #t2.6 )
                                                                              case insertauthPolicykhauthPolicy_0_11111111111111111111112111111
                                                                              by contradiction /* cyclic */
                                                                            qed
                                                                          qed
                                                                        qed
                                                                      qed
                                                                    qed
                                                                  qed
                                                                qed
                                                              qed
                                                            qed
                                                          qed
                                                        next
                                                          case case_2
                                                          by contradiction /* from formulas */
                                                        qed
                                                      next
                                                        case case_2
                                                        by contradiction /* from formulas */
                                                      qed
                                                    qed
                                                  qed
                                                qed
                                              next
                                                case unlockdevice_0_11111111111111111111211111112
                                                by solve( state_11111111111111111111211111112( ~RouterID.1,
                                                                                               ~ServerID.1,
                                                                                               ~ak_h.1,
                                                                                               ~ak_sk.1,
                                                                                               ~ssk_nms.1,
                                                                                               a_h, obj_ap,
                                                                                               obj_h, obj_pd,
                                                                                               obj_pk, obj_sh,
                                                                                               ~n.2
                                                          ) ▶₀ #t2.5 )
                                              qed
                                            qed
                                          next
                                            case case_2
                                            solve( (#t2.7 < #t2.10)  ∥ (#t2.7 = #t2.10)  ∥ (#vr.73 < #t2.7) )
                                              case case_1
                                              by contradiction /* from formulas */
                                            next
                                              case case_2
                                              solve( Unlock_4( '4', ~n.2, 'device' ) @ #t2.8 )
                                                case unlockdevice_0_111111111111111111112111111111
                                                solve( state_111111111111111111112111111111( ~RouterID.1,
                                                                                             ~ServerID.1,
                                                                                             ~ak_h.1,
                                                                                             ~ak_sk.1,
                                                                                             ~ssk_nms.1, a_h,
                                                                                             a_sk, obj_ap,
                                                                                             obj_h, obj_pd,
                                                                                             obj_pk, obj_sh,
                                                                                             ~n.2
                                                       ) ▶₀ #t2.6 )
                                                  case outsignobjpkobjapask_0_11111111111111111111211111111
                                                  solve( (#t2.2 < #t2.14)  ∥ (#t2.2 = #t2.14) )
                                                    case case_1
                                                    by contradiction /* from formulas */
                                                  next
                                                    case case_2
                                                    solve( (#t2.5 < #t2.12)  ∥ (#t2.5 = #t2.12) )
                                                      case case_1
                                                      by contradiction /* from formulas */
                                                    next
                                                      case case_2
                                                      solve( (#t2.8 < #t2.13)  ∥ (#t2.8 = #t2.13) )
                                                        case case_1
                                                        by contradiction /* from formulas */
                                                      next
                                                        case case_2
                                                        solve( (#vr.39 < #t2.12)  ∥ (#vr.39 = #t2.12) )
                                                          case case_1
                                                          solve( (#t2.9 < #t2.12)  ∥ (#t2.9 = #t2.12) )
                                                            case case_1
                                                            by contradiction /* from formulas */
                                                          next
                                                            case case_2
                                                            solve( TPM_SendCommand( <'TPM2_Create', 
                                                                                     <swstate, nil>, 
                                                                                     'TPM_CC_PolicyPCR', nil>
                                                                   ) @ #t2.10 )
                                                              case eventTPMSendCommandTPMCreateswstatenilTPMCCPolicyPCRnil_0_11111111111112111
                                                              solve( state_11111111111112111( ~RouterID.1,
                                                                                              ~ServerID.1,
                                                                                              ~ak_h.1,
                                                                                              ~ak_sk.1,
                                                                                              ~ssk_nms.1,
                                                                                              ~tid.1
                                                                     ) ▶₀ #t2.7 )
                                                                case outTPMPCRExtendswstate_0_1111111111111211
                                                                solve( TPM_SendCommand( <'TPM2_Certify', 
                                                                                         k_sh, ~k_h, ~ak_h>
                                                                       ) @ #t2.10 )
                                                                  case eventTPMSendCommandTPMCertifytlsshtlshakh_0_111111111111121111111111111
                                                                  solve( state_111111111111121111111111111( ~RouterID.1,
                                                                                                            ~ServerID.1,
                                                                                                            ~ak_h,
                                                                                                            ~ak_sk.1,
                                                                                                            ~ssk_nms.1,
                                                                                                            ~tid.1,
                                                                                                            ~k_h,
                                                                                                            k_sh,
                                                                                                            tls_spk
                                                                         ) ▶₀ #t2.7 )
                                                                    case outTPMPolicyPCRtlssh_0_11111111111112111111111111
                                                                    solve( TPM_SendCommand( <'TPM2_Create', 
                                                                                             <swstate, nil>, 
                                                                                             'TPM_CC_PolicyPCR', 
                                                                                             nil>
                                                                           ) @ #t2.10 )
                                                                      case eventTPMSendCommandTPMCreateswstatenilTPMCCPolicyPCRnil_0_11111111111112111
                                                                      solve( state_11111111111112111( ~RouterID.1,
                                                                                                      ~ServerID.1,
                                                                                                      ~ak_h.1,
                                                                                                      ~ak_sk.1,
                                                                                                      ~ssk_nms.1,
                                                                                                      ~tid.1
                                                                             ) ▶₀ #t2.7 )
                                                                        case outTPMPCRExtendswstate_0_1111111111111211
                                                                        solve( Insert( <'privatePart', ~k_h>,
                                                                                       k_sk.1
                                                                               ) @ #t2.7 )
                                                                          case insertprivatePartakhaksk_0_111111111111111
                                                                          by solve( state_111111111111111( ~RouterID.1,
                                                                                                           ~ServerID.1,
                                                                                                           ~k_h,
                                                                                                           ~ak_sk.1,
                                                                                                           ~ssk_nms.1
                                                                                    ) ▶₀ #t2.7 )
                                                                        next
                                                                          case insertprivatePartkhksk_0_111111111111111111111121111111
                                                                          solve( state_111111111111111111111121111111( ~RouterID.1,
                                                                                                                       ~ServerID.1,
                                                                                                                       ~ak_h.1,
                                                                                                                       ~ak_sk.1,
                                                                                                                       ~k_h,
                                                                                                                       ~k_sk.1,
                                                                                                                       ~ssk_nms.1,
                                                                                                                       authPolicy,
                                                                                                                       lock
                                                                                 ) ▶₀ #t2.7 )
                                                                            case insertauthPolicykhauthPolicy_0_11111111111111111111112111111
                                                                            by contradiction /* cyclic */
                                                                          qed
                                                                        qed
                                                                      qed
                                                                    qed
                                                                  qed
                                                                qed
                                                              qed
                                                            qed
                                                          qed
                                                        next
                                                          case case_2
                                                          by contradiction /* from formulas */
                                                        qed
                                                      qed
                                                    qed
                                                  qed
                                                qed
                                              next
                                                case unlockdevice_0_11111111111111111111211111112
                                                by solve( state_11111111111111111111211111112( ~RouterID.1,
                                                                                               ~ServerID.1,
                                                                                               ~ak_h.1,
                                                                                               ~ak_sk.1,
                                                                                               ~ssk_nms.1,
                                                                                               a_h, obj_ap,
                                                                                               obj_h, obj_pd,
                                                                                               obj_pk, obj_sh,
                                                                                               ~n.2
                                                          ) ▶₀ #t2.6 )
                                              qed
                                            next
                                              case case_3
                                              solve( Unlock_4( '4', ~n.2, 'device' ) @ #t2.8 )
                                                case unlockdevice_0_111111111111111111112111111111
                                                solve( state_111111111111111111112111111111( ~RouterID.1,
                                                                                             ~ServerID.1,
                                                                                             ~ak_h.1,
                                                                                             ~ak_sk.1,
                                                                                             ~ssk_nms.1, a_h,
                                                                                             a_sk, obj_ap,
                                                                                             obj_h, obj_pd,
                                                                                             obj_pk, obj_sh,
                                                                                             ~n.2
                                                       ) ▶₀ #t2.6 )
                                                  case outsignobjpkobjapask_0_11111111111111111111211111111
                                                  solve( (#t2.2 < #t2.15)  ∥ (#t2.2 = #t2.15) )
                                                    case case_1
                                                    by contradiction /* from formulas */
                                                  next
                                                    case case_2
                                                    solve( (#t2.5 < #t2.13)  ∥ (#t2.5 = #t2.13) )
                                                      case case_1
                                                      by contradiction /* from formulas */
                                                    next
                                                      case case_2
                                                      solve( (#t2.10 < #t2.14)  ∥ (#t2.10 = #t2.14) )
                                                        case case_1
                                                        by contradiction /* from formulas */
                                                      next
                                                        case case_2
                                                        solve( (#vr.39 < #t2.13)  ∥ (#vr.39 = #t2.13) )
                                                          case case_1
                                                          solve( (#t2.9 < #t2.13)  ∥ (#t2.9 = #t2.13) )
                                                            case case_1
                                                            by contradiction /* from formulas */
                                                          next
                                                            case case_2
                                                            solve( TPM_SendCommand( <'TPM2_Create', 
                                                                                     <swstate, nil>, 
                                                                                     'TPM_CC_PolicyPCR', nil>
                                                                   ) @ #t2.11 )
                                                              case eventTPMSendCommandTPMCreateswstatenilTPMCCPolicyPCRnil_0_11111111111112111
                                                              solve( state_11111111111112111( ~RouterID.1,
                                                                                              ~ServerID.1,
                                                                                              ~ak_h.1,
                                                                                              ~ak_sk.1,
                                                                                              ~ssk_nms.1,
                                                                                              ~tid.1
                                                                     ) ▶₀ #t2.7 )
                                                                case outTPMPCRExtendswstate_0_1111111111111211
                                                                solve( TPM_SendCommand( <'TPM2_Certify', 
                                                                                         k_sh, ~k_h, ~ak_h>
                                                                       ) @ #t2.11 )
                                                                  case eventTPMSendCommandTPMCertifytlsshtlshakh_0_111111111111121111111111111
                                                                  solve( state_111111111111121111111111111( ~RouterID.1,
                                                                                                            ~ServerID.1,
                                                                                                            ~ak_h,
                                                                                                            ~ak_sk.1,
                                                                                                            ~ssk_nms.1,
                                                                                                            ~tid.1,
                                                                                                            ~k_h,
                                                                                                            k_sh,
                                                                                                            tls_spk
                                                                         ) ▶₀ #t2.7 )
                                                                    case outTPMPolicyPCRtlssh_0_11111111111112111111111111
                                                                    solve( TPM_SendCommand( <'TPM2_Create', 
                                                                                             <swstate, nil>, 
                                                                                             'TPM_CC_PolicyPCR', 
                                                                                             nil>
                                                                           ) @ #t2.11 )
                                                                      case eventTPMSendCommandTPMCreateswstatenilTPMCCPolicyPCRnil_0_11111111111112111
                                                                      solve( state_11111111111112111( ~RouterID.1,
                                                                                                      ~ServerID.1,
                                                                                                      ~ak_h.1,
                                                                                                      ~ak_sk.1,
                                                                                                      ~ssk_nms.1,
                                                                                                      ~tid.1
                                                                             ) ▶₀ #t2.7 )
                                                                        case outTPMPCRExtendswstate_0_1111111111111211
                                                                        solve( Insert( <'privatePart', ~k_h>,
                                                                                       k_sk.1
                                                                               ) @ #t2.7 )
                                                                          case insertprivatePartakhaksk_0_111111111111111
                                                                          by solve( state_111111111111111( ~RouterID.1,
                                                                                                           ~ServerID.1,
                                                                                                           ~k_h,
                                                                                                           ~ak_sk.1,
                                                                                                           ~ssk_nms.1
                                                                                    ) ▶₀ #t2.7 )
                                                                        next
                                                                          case insertprivatePartkhksk_0_111111111111111111111121111111
                                                                          solve( state_111111111111111111111121111111( ~RouterID.1,
                                                                                                                       ~ServerID.1,
                                                                                                                       ~ak_h.1,
                                                                                                                       ~ak_sk.1,
                                                                                                                       ~k_h,
                                                                                                                       ~k_sk.1,
                                                                                                                       ~ssk_nms.1,
                                                                                                                       authPolicy,
                                                                                                                       lock
                                                                                 ) ▶₀ #t2.7 )
                                                                            case insertauthPolicykhauthPolicy_0_11111111111111111111112111111
                                                                            by contradiction /* cyclic */
                                                                          qed
                                                                        qed
                                                                      qed
                                                                    qed
                                                                  qed
                                                                qed
                                                              qed
                                                            qed
                                                          qed
                                                        next
                                                          case case_2
                                                          by contradiction /* from formulas */
                                                        qed
                                                      qed
                                                    qed
                                                  qed
                                                qed
                                              next
                                                case unlockdevice_0_11111111111111111111211111112
                                                by solve( state_11111111111111111111211111112( ~RouterID.1,
                                                                                               ~ServerID.1,
                                                                                               ~ak_h.1,
                                                                                               ~ak_sk.1,
                                                                                               ~ssk_nms.1,
                                                                                               a_h, obj_ap,
                                                                                               obj_h, obj_pd,
                                                                                               obj_pk, obj_sh,
                                                                                               ~n.2
                                                          ) ▶₀ #t2.6 )
                                              qed
                                            qed
                                          qed
                                        qed
                                      next
                                        case case_2
                                        solve( (#t2.2 < #t2.10)  ∥ (#t2.2 = #t2.10) )
                                          case case_1
                                          by contradiction /* from formulas */
                                        next
                                          case case_2
                                          solve( (#vr.32 < #t2.9)  ∥ (#vr.32 = #t2.9) )
                                            case case_1
                                            solve( (#t2.7 < #t2.10)  ∥ (#t2.7 = #t2.10)  ∥ (#vr.73 < #t2.7) )
                                              case case_1
                                              by contradiction /* from formulas */
                                            next
                                              case case_2
                                              solve( Unlock_4( '4', ~n.2, 'device' ) @ #t2.8 )
                                                case unlockdevice_0_111111111111111111112111111111
                                                solve( state_111111111111111111112111111111( ~RouterID.1,
                                                                                             ~ServerID.1,
                                                                                             ~ak_h.1,
                                                                                             ~ak_sk.1,
                                                                                             ~ssk_nms.1, a_h,
                                                                                             a_sk, obj_ap,
                                                                                             obj_h, obj_pd,
                                                                                             obj_pk, obj_sh,
                                                                                             ~n.2
                                                       ) ▶₀ #t2.6 )
                                                  case outsignobjpkobjapask_0_11111111111111111111211111111
                                                  solve( (#t2.2 < #t2.14)  ∥ (#t2.2 = #t2.14) )
                                                    case case_1
                                                    by contradiction /* from formulas */
                                                  next
                                                    case case_2
                                                    solve( (#t2.5 < #t2.13)  ∥ (#t2.5 = #t2.13) )
                                                      case case_1
                                                      by contradiction /* from formulas */
                                                    next
                                                      case case_2
                                                      solve( (#t2.8 < #t2.13)  ∥ (#t2.8 = #t2.13) )
                                                        case case_1
                                                        by contradiction /* from formulas */
                                                      next
                                                        case case_2
                                                        solve( (#vr.32 < #t2.12)  ∥ (#vr.32 = #t2.12) )
                                                          case case_1
                                                          solve( (#t2.9 < #t2.12)  ∥ (#t2.9 = #t2.12) )
                                                            case case_1
                                                            by contradiction /* from formulas */
                                                          next
                                                            case case_2
                                                            solve( TPM_SendCommand( <'TPM2_Create', 
                                                                                     <swstate, nil>, 
                                                                                     'TPM_CC_PolicyPCR', nil>
                                                                   ) @ #t2.10 )
                                                              case eventTPMSendCommandTPMCreateswstatenilTPMCCPolicyPCRnil_0_11111111111112111
                                                              solve( state_11111111111112111( ~RouterID.1,
                                                                                              ~ServerID.1,
                                                                                              ~ak_h.1,
                                                                                              ~ak_sk.1,
                                                                                              ~ssk_nms.1,
                                                                                              ~tid.1
                                                                     ) ▶₀ #t2.7 )
                                                                case outTPMPCRExtendswstate_0_1111111111111211
                                                                solve( TPM_SendCommand( <'TPM2_Certify', 
                                                                                         k_sh, ~k_h, ~ak_h>
                                                                       ) @ #t2.10 )
                                                                  case eventTPMSendCommandTPMCertifytlsshtlshakh_0_111111111111121111111111111
                                                                  solve( state_111111111111121111111111111( ~RouterID.1,
                                                                                                            ~ServerID.1,
                                                                                                            ~ak_h,
                                                                                                            ~ak_sk.1,
                                                                                                            ~ssk_nms.1,
                                                                                                            ~tid.1,
                                                                                                            ~k_h,
                                                                                                            k_sh,
                                                                                                            tls_spk
                                                                         ) ▶₀ #t2.7 )
                                                                    case outTPMPolicyPCRtlssh_0_11111111111112111111111111
                                                                    solve( TPM_SendCommand( <'TPM2_Create', 
                                                                                             <swstate, nil>, 
                                                                                             'TPM_CC_PolicyPCR', 
                                                                                             nil>
                                                                           ) @ #t2.10 )
                                                                      case eventTPMSendCommandTPMCreateswstatenilTPMCCPolicyPCRnil_0_11111111111112111
                                                                      solve( state_11111111111112111( ~RouterID.1,
                                                                                                      ~ServerID.1,
                                                                                                      ~ak_h.1,
                                                                                                      ~ak_sk.1,
                                                                                                      ~ssk_nms.1,
                                                                                                      ~tid.1
                                                                             ) ▶₀ #t2.7 )
                                                                        case outTPMPCRExtendswstate_0_1111111111111211
                                                                        solve( Insert( <'privatePart', ~k_h>,
                                                                                       k_sk.1
                                                                               ) @ #t2.7 )
                                                                          case insertprivatePartakhaksk_0_111111111111111
                                                                          by solve( state_111111111111111( ~RouterID.1,
                                                                                                           ~ServerID.1,
                                                                                                           ~k_h,
                                                                                                           ~ak_sk.1,
                                                                                                           ~ssk_nms.1
                                                                                    ) ▶₀ #t2.7 )
                                                                        next
                                                                          case insertprivatePartkhksk_0_111111111111111111111121111111
                                                                          solve( state_111111111111111111111121111111( ~RouterID.1,
                                                                                                                       ~ServerID.1,
                                                                                                                       ~ak_h.1,
                                                                                                                       ~ak_sk.1,
                                                                                                                       ~k_h,
                                                                                                                       ~k_sk.1,
                                                                                                                       ~ssk_nms.1,
                                                                                                                       authPolicy,
                                                                                                                       lock
                                                                                 ) ▶₀ #t2.7 )
                                                                            case insertauthPolicykhauthPolicy_0_11111111111111111111112111111
                                                                            by contradiction /* cyclic */
                                                                          qed
                                                                        qed
                                                                      qed
                                                                    qed
                                                                  qed
                                                                qed
                                                              qed
                                                            qed
                                                          qed
                                                        next
                                                          case case_2
                                                          by contradiction /* from formulas */
                                                        qed
                                                      qed
                                                    qed
                                                  qed
                                                qed
                                              next
                                                case unlockdevice_0_11111111111111111111211111112
                                                by solve( state_11111111111111111111211111112( ~RouterID.1,
                                                                                               ~ServerID.1,
                                                                                               ~ak_h.1,
                                                                                               ~ak_sk.1,
                                                                                               ~ssk_nms.1,
                                                                                               a_h, obj_ap,
                                                                                               obj_h, obj_pd,
                                                                                               obj_pk, obj_sh,
                                                                                               ~n.2
                                                          ) ▶₀ #t2.6 )
                                              qed
                                            next
                                              case case_3
                                              solve( Unlock_4( '4', ~n.2, 'device' ) @ #t2.8 )
                                                case unlockdevice_0_111111111111111111112111111111
                                                solve( state_111111111111111111112111111111( ~RouterID.1,
                                                                                             ~ServerID.1,
                                                                                             ~ak_h.1,
                                                                                             ~ak_sk.1,
                                                                                             ~ssk_nms.1, a_h,
                                                                                             a_sk, obj_ap,
                                                                                             obj_h, obj_pd,
                                                                                             obj_pk, obj_sh,
                                                                                             ~n.2
                                                       ) ▶₀ #t2.6 )
                                                  case outsignobjpkobjapask_0_11111111111111111111211111111
                                                  solve( (#t2.2 < #t2.15)  ∥ (#t2.2 = #t2.15) )
                                                    case case_1
                                                    by contradiction /* from formulas */
                                                  next
                                                    case case_2
                                                    solve( (#t2.5 < #t2.14)  ∥ (#t2.5 = #t2.14) )
                                                      case case_1
                                                      by contradiction /* from formulas */
                                                    next
                                                      case case_2
                                                      solve( (#t2.10 < #t2.14)  ∥ (#t2.10 = #t2.14) )
                                                        case case_1
                                                        by contradiction /* from formulas */
                                                      next
                                                        case case_2
                                                        solve( (#vr.32 < #t2.13)  ∥ (#vr.32 = #t2.13) )
                                                          case case_1
                                                          solve( (#t2.9 < #t2.13)  ∥ (#t2.9 = #t2.13) )
                                                            case case_1
                                                            by contradiction /* from formulas */
                                                          next
                                                            case case_2
                                                            solve( TPM_SendCommand( <'TPM2_Create', 
                                                                                     <swstate, nil>, 
                                                                                     'TPM_CC_PolicyPCR', nil>
                                                                   ) @ #t2.11 )
                                                              case eventTPMSendCommandTPMCreateswstatenilTPMCCPolicyPCRnil_0_11111111111112111
                                                              solve( state_11111111111112111( ~RouterID.1,
                                                                                              ~ServerID.1,
                                                                                              ~ak_h.1,
                                                                                              ~ak_sk.1,
                                                                                              ~ssk_nms.1,
                                                                                              ~tid.1
                                                                     ) ▶₀ #t2.7 )
                                                                case outTPMPCRExtendswstate_0_1111111111111211
                                                                solve( TPM_SendCommand( <'TPM2_Certify', 
                                                                                         k_sh, ~k_h, ~ak_h>
                                                                       ) @ #t2.11 )
                                                                  case eventTPMSendCommandTPMCertifytlsshtlshakh_0_111111111111121111111111111
                                                                  solve( state_111111111111121111111111111( ~RouterID.1,
                                                                                                            ~ServerID.1,
                                                                                                            ~ak_h,
                                                                                                            ~ak_sk.1,
                                                                                                            ~ssk_nms.1,
                                                                                                            ~tid.1,
                                                                                                            ~k_h,
                                                                                                            k_sh,
                                                                                                            tls_spk
                                                                         ) ▶₀ #t2.7 )
                                                                    case outTPMPolicyPCRtlssh_0_11111111111112111111111111
                                                                    solve( TPM_SendCommand( <'TPM2_Create', 
                                                                                             <swstate, nil>, 
                                                                                             'TPM_CC_PolicyPCR', 
                                                                                             nil>
                                                                           ) @ #t2.11 )
                                                                      case eventTPMSendCommandTPMCreateswstatenilTPMCCPolicyPCRnil_0_11111111111112111
                                                                      solve( state_11111111111112111( ~RouterID.1,
                                                                                                      ~ServerID.1,
                                                                                                      ~ak_h.1,
                                                                                                      ~ak_sk.1,
                                                                                                      ~ssk_nms.1,
                                                                                                      ~tid.1
                                                                             ) ▶₀ #t2.7 )
                                                                        case outTPMPCRExtendswstate_0_1111111111111211
                                                                        solve( Insert( <'privatePart', ~k_h>,
                                                                                       k_sk.1
                                                                               ) @ #t2.7 )
                                                                          case insertprivatePartakhaksk_0_111111111111111
                                                                          by solve( state_111111111111111( ~RouterID.1,
                                                                                                           ~ServerID.1,
                                                                                                           ~k_h,
                                                                                                           ~ak_sk.1,
                                                                                                           ~ssk_nms.1
                                                                                    ) ▶₀ #t2.7 )
                                                                        next
                                                                          case insertprivatePartkhksk_0_111111111111111111111121111111
                                                                          solve( state_111111111111111111111121111111( ~RouterID.1,
                                                                                                                       ~ServerID.1,
                                                                                                                       ~ak_h.1,
                                                                                                                       ~ak_sk.1,
                                                                                                                       ~k_h,
                                                                                                                       ~k_sk.1,
                                                                                                                       ~ssk_nms.1,
                                                                                                                       authPolicy,
                                                                                                                       lock
                                                                                 ) ▶₀ #t2.7 )
                                                                            case insertauthPolicykhauthPolicy_0_11111111111111111111112111111
                                                                            by contradiction /* cyclic */
                                                                          qed
                                                                        qed
                                                                      qed
                                                                    qed
                                                                  qed
                                                                qed
                                                              qed
                                                            qed
                                                          qed
                                                        next
                                                          case case_2
                                                          by contradiction /* from formulas */
                                                        qed
                                                      qed
                                                    qed
                                                  qed
                                                qed
                                              next
                                                case unlockdevice_0_11111111111111111111211111112
                                                by solve( state_11111111111111111111211111112( ~RouterID.1,
                                                                                               ~ServerID.1,
                                                                                               ~ak_h.1,
                                                                                               ~ak_sk.1,
                                                                                               ~ssk_nms.1,
                                                                                               a_h, obj_ap,
                                                                                               obj_h, obj_pd,
                                                                                               obj_pk, obj_sh,
                                                                                               ~n.2
                                                          ) ▶₀ #t2.6 )
                                              qed
                                            qed
                                          next
                                            case case_2
                                            solve( (#t2.8 < #t2.10)  ∥ (#t2.8 = #t2.10)  ∥ (#vr.72 < #t2.8) )
                                              case case_1
                                              by contradiction /* from formulas */
                                            next
                                              case case_2
                                              solve( Unlock_4( '4', ~n.2, 'device' ) @ #t2.9 )
                                                case unlockdevice_0_111111111111111111112111111111
                                                solve( state_111111111111111111112111111111( ~RouterID.1,
                                                                                             ~ServerID.1,
                                                                                             ~ak_h.1,
                                                                                             ~ak_sk.1,
                                                                                             ~ssk_nms.1, a_h,
                                                                                             a_sk, obj_ap,
                                                                                             obj_h, obj_pd,
                                                                                             obj_pk, obj_sh,
                                                                                             ~n.2
                                                       ) ▶₀ #t2.7 )
                                                  case outsignobjpkobjapask_0_11111111111111111111211111111
                                                  solve( (#t2.2 < #t2.14)  ∥ (#t2.2 = #t2.14) )
                                                    case case_1
                                                    by contradiction /* from formulas */
                                                  next
                                                    case case_2
                                                    solve( (#t2.5 < #t2.13)  ∥ (#t2.5 = #t2.13) )
                                                      case case_1
                                                      by contradiction /* from formulas */
                                                    next
                                                      case case_2
                                                      solve( (#t2.6 < #t2.12)  ∥ (#t2.6 = #t2.12) )
                                                        case case_1
                                                        by contradiction /* from formulas */
                                                      next
                                                        case case_2
                                                        solve( (#t2.9 < #t2.12)  ∥ (#t2.9 = #t2.12) )
                                                          case case_1
                                                          by contradiction /* from formulas */
                                                        next
                                                          case case_2
                                                          solve( TPM_SendCommand( <'TPM2_Create', 
                                                                                   <swstate, nil>, 
                                                                                   'TPM_CC_PolicyPCR', nil>
                                                                 ) @ #t2.10 )
                                                            case eventTPMSendCommandTPMCreateswstatenilTPMCCPolicyPCRnil_0_11111111111112111
                                                            solve( state_11111111111112111( ~RouterID.1,
                                                                                            ~ServerID.1,
                                                                                            ~ak_h.1, ~ak_sk.1,
                                                                                            ~ssk_nms.1, ~tid.1
                                                                   ) ▶₀ #t2.8 )
                                                              case outTPMPCRExtendswstate_0_1111111111111211
                                                              solve( TPM_SendCommand( <'TPM2_Certify', k_sh, 
                                                                                       ~k_h, ~ak_h>
                                                                     ) @ #t2.10 )
                                                                case eventTPMSendCommandTPMCertifytlsshtlshakh_0_111111111111121111111111111
                                                                solve( state_111111111111121111111111111( ~RouterID.1,
                                                                                                          ~ServerID.1,
                                                                                                          ~ak_h,
                                                                                                          ~ak_sk.1,
                                                                                                          ~ssk_nms.1,
                                                                                                          ~tid.1,
                                                                                                          ~k_h,
                                                                                                          k_sh,
                                                                                                          tls_spk
                                                                       ) ▶₀ #t2.8 )
                                                                  case outTPMPolicyPCRtlssh_0_11111111111112111111111111
                                                                  solve( TPM_SendCommand( <'TPM2_Create', 
                                                                                           <swstate, nil>, 
                                                                                           'TPM_CC_PolicyPCR', 
                                                                                           nil>
                                                                         ) @ #t2.10 )
                                                                    case eventTPMSendCommandTPMCreateswstatenilTPMCCPolicyPCRnil_0_11111111111112111
                                                                    solve( state_11111111111112111( ~RouterID.1,
                                                                                                    ~ServerID.1,
                                                                                                    ~ak_h.1,
                                                                                                    ~ak_sk.1,
                                                                                                    ~ssk_nms.1,
                                                                                                    ~tid.1
                                                                           ) ▶₀ #t2.8 )
                                                                      case outTPMPCRExtendswstate_0_1111111111111211
                                                                      solve( Insert( <'privatePart', ~k_h>,
                                                                                     k_sk.1
                                                                             ) @ #t2.8 )
                                                                        case insertprivatePartakhaksk_0_111111111111111
                                                                        by solve( state_111111111111111( ~RouterID.1,
                                                                                                         ~ServerID.1,
                                                                                                         ~k_h,
                                                                                                         ~ak_sk.1,
                                                                                                         ~ssk_nms.1
                                                                                  ) ▶₀ #t2.8 )
                                                                      next
                                                                        case insertprivatePartkhksk_0_111111111111111111111121111111
                                                                        solve( state_111111111111111111111121111111( ~RouterID.1,
                                                                                                                     ~ServerID.1,
                                                                                                                     ~ak_h.1,
                                                                                                                     ~ak_sk.1,
                                                                                                                     ~k_h,
                                                                                                                     ~k_sk.1,
                                                                                                                     ~ssk_nms.1,
                                                                                                                     authPolicy,
                                                                                                                     lock
                                                                               ) ▶₀ #t2.8 )
                                                                          case insertauthPolicykhauthPolicy_0_11111111111111111111112111111
                                                                          by contradiction /* cyclic */
                                                                        qed
                                                                      qed
                                                                    qed
                                                                  qed
                                                                qed
                                                              qed
                                                            qed
                                                          qed
                                                        qed
                                                      qed
                                                    qed
                                                  qed
                                                qed
                                              next
                                                case unlockdevice_0_11111111111111111111211111112
                                                by solve( state_11111111111111111111211111112( ~RouterID.1,
                                                                                               ~ServerID.1,
                                                                                               ~ak_h.1,
                                                                                               ~ak_sk.1,
                                                                                               ~ssk_nms.1,
                                                                                               a_h, obj_ap,
                                                                                               obj_h, obj_pd,
                                                                                               obj_pk, obj_sh,
                                                                                               ~n.2
                                                          ) ▶₀ #t2.7 )
                                              qed
                                            next
                                              case case_3
                                              solve( Unlock_4( '4', ~n.2, 'device' ) @ #t2.9 )
                                                case unlockdevice_0_111111111111111111112111111111
                                                solve( state_111111111111111111112111111111( ~RouterID.1,
                                                                                             ~ServerID.1,
                                                                                             ~ak_h.1,
                                                                                             ~ak_sk.1,
                                                                                             ~ssk_nms.1, a_h,
                                                                                             a_sk, obj_ap,
                                                                                             obj_h, obj_pd,
                                                                                             obj_pk, obj_sh,
                                                                                             ~n.2
                                                       ) ▶₀ #t2.7 )
                                                  case outsignobjpkobjapask_0_11111111111111111111211111111
                                                  solve( (#t2.2 < #t2.15)  ∥ (#t2.2 = #t2.15) )
                                                    case case_1
                                                    by contradiction /* from formulas */
                                                  next
                                                    case case_2
                                                    solve( (#t2.5 < #t2.14)  ∥ (#t2.5 = #t2.14) )
                                                      case case_1
                                                      by contradiction /* from formulas */
                                                    next
                                                      case case_2
                                                      solve( (#t2.6 < #t2.13)  ∥ (#t2.6 = #t2.13) )
                                                        case case_1
                                                        by contradiction /* from formulas */
                                                      next
                                                        case case_2
                                                        solve( (#t2.10 < #t2.13)  ∥ (#t2.10 = #t2.13) )
                                                          case case_1
                                                          by contradiction /* from formulas */
                                                        next
                                                          case case_2
                                                          solve( TPM_SendCommand( <'TPM2_Create', 
                                                                                   <swstate, nil>, 
                                                                                   'TPM_CC_PolicyPCR', nil>
                                                                 ) @ #t2.11 )
                                                            case eventTPMSendCommandTPMCreateswstatenilTPMCCPolicyPCRnil_0_11111111111112111
                                                            solve( state_11111111111112111( ~RouterID.1,
                                                                                            ~ServerID.1,
                                                                                            ~ak_h.1, ~ak_sk.1,
                                                                                            ~ssk_nms.1, ~tid.1
                                                                   ) ▶₀ #t2.8 )
                                                              case outTPMPCRExtendswstate_0_1111111111111211
                                                              solve( TPM_SendCommand( <'TPM2_Certify', k_sh, 
                                                                                       ~k_h, ~ak_h>
                                                                     ) @ #t2.11 )
                                                                case eventTPMSendCommandTPMCertifytlsshtlshakh_0_111111111111121111111111111
                                                                solve( state_111111111111121111111111111( ~RouterID.1,
                                                                                                          ~ServerID.1,
                                                                                                          ~ak_h,
                                                                                                          ~ak_sk.1,
                                                                                                          ~ssk_nms.1,
                                                                                                          ~tid.1,
                                                                                                          ~k_h,
                                                                                                          k_sh,
                                                                                                          tls_spk
                                                                       ) ▶₀ #t2.8 )
                                                                  case outTPMPolicyPCRtlssh_0_11111111111112111111111111
                                                                  solve( TPM_SendCommand( <'TPM2_Create', 
                                                                                           <swstate, nil>, 
                                                                                           'TPM_CC_PolicyPCR', 
                                                                                           nil>
                                                                         ) @ #t2.11 )
                                                                    case eventTPMSendCommandTPMCreateswstatenilTPMCCPolicyPCRnil_0_11111111111112111
                                                                    solve( state_11111111111112111( ~RouterID.1,
                                                                                                    ~ServerID.1,
                                                                                                    ~ak_h.1,
                                                                                                    ~ak_sk.1,
                                                                                                    ~ssk_nms.1,
                                                                                                    ~tid.1
                                                                           ) ▶₀ #t2.8 )
                                                                      case outTPMPCRExtendswstate_0_1111111111111211
                                                                      solve( Insert( <'privatePart', ~k_h>,
                                                                                     k_sk.1
                                                                             ) @ #t2.8 )
                                                                        case insertprivatePartakhaksk_0_111111111111111
                                                                        by solve( state_111111111111111( ~RouterID.1,
                                                                                                         ~ServerID.1,
                                                                                                         ~k_h,
                                                                                                         ~ak_sk.1,
                                                                                                         ~ssk_nms.1
                                                                                  ) ▶₀ #t2.8 )
                                                                      next
                                                                        case insertprivatePartkhksk_0_111111111111111111111121111111
                                                                        solve( state_111111111111111111111121111111( ~RouterID.1,
                                                                                                                     ~ServerID.1,
                                                                                                                     ~ak_h.1,
                                                                                                                     ~ak_sk.1,
                                                                                                                     ~k_h,
                                                                                                                     ~k_sk.1,
                                                                                                                     ~ssk_nms.1,
                                                                                                                     authPolicy,
                                                                                                                     lock
                                                                               ) ▶₀ #t2.8 )
                                                                          case insertauthPolicykhauthPolicy_0_11111111111111111111112111111
                                                                          by contradiction /* cyclic */
                                                                        qed
                                                                      qed
                                                                    qed
                                                                  qed
                                                                qed
                                                              qed
                                                            qed
                                                          qed
                                                        qed
                                                      qed
                                                    qed
                                                  qed
                                                qed
                                              next
                                                case unlockdevice_0_11111111111111111111211111112
                                                by solve( state_11111111111111111111211111112( ~RouterID.1,
                                                                                               ~ServerID.1,
                                                                                               ~ak_h.1,
                                                                                               ~ak_sk.1,
                                                                                               ~ssk_nms.1,
                                                                                               a_h, obj_ap,
                                                                                               obj_h, obj_pd,
                                                                                               obj_pk, obj_sh,
                                                                                               ~n.2
                                                          ) ▶₀ #t2.7 )
                                              qed
                                            qed
                                          qed
                                        qed
                                      qed
                                    qed
                                  qed
                                qed
                              qed
                            next
                              case outtlsspksigntlsspkssknms_0_11111111111121111111111
                              by contradiction /* from formulas */
                            qed
                          qed
                        qed
                      qed
                    qed
                  qed
                qed
              qed
            next
              case case_2
              solve( (#vr.47 < #t2.4)  ∥ (#vr.47 = #t2.4) )
                case case_1
                solve( TPM_SendCommand( <'TPM2_Create', authPolicy> ) @ #t2.3 )
                  case eventTPMSendCommandTPMCreateswstatenilTPMCCPolicyPCRnil_0_11111111111112111
                  solve( state_11111111111112111( ~RouterID.1, ~ServerID.1, ~ak_h.1,
                                                  ~ak_sk.1, ~ssk_nms.1, ~tid.1
                         ) ▶₀ #t2.3 )
                    case outTPMPCRExtendswstate_0_1111111111111211
                    solve( TPM_SendCommand( <'TPM2_Create', <swstate, nil>, 
                                             'TPM_CC_PolicyPCR', nil>
                           ) @ #t2.6 )
                      case eventTPMSendCommandTPMCreateswstatenilTPMCCPolicyPCRnil_0_11111111111112111
                      solve( state_11111111111112111( ~RouterID.1, ~ServerID.1, ~ak_h.1,
                                                      ~ak_sk.1, ~ssk_nms.1, ~tid.1
                             ) ▶₀ #t2.4 )
                        case outTPMPCRExtendswstate_0_1111111111111211
                        solve( TPM_SendCommand( <'TPM2_Create', <swstate, nil>, 
                                                 'TPM_CC_PolicyPCR', nil>
                               ) @ #t2.6 )
                          case eventTPMSendCommandTPMCreateswstatenilTPMCCPolicyPCRnil_0_11111111111112111
                          solve( state_11111111111112111( ~RouterID.1, ~ServerID.1, ~ak_h.1,
                                                          ~ak_sk.1, ~ssk_nms.1, ~tid.1
                                 ) ▶₀ #t2.4 )
                            case outTPMPCRExtendswstate_0_1111111111111211
                            solve( !KU( sign(pk(~k_sk), ~ssk_nms) ) @ #vk.6 )
                              case c_sign
                              solve( !KU( sign(<pk(~k_sk), <swstate, nil>, 'TPM_CC_PolicyPCR', nil>,
                                               ~ak_sk)
                                     ) @ #vk.7 )
                                case c_sign
                                solve( !KU( pk(~k_sk) ) @ #vk.3 )
                                  case c_pk
                                  solve( Insert( <'privatePart', ~k_h>, k_sk.1 ) @ #t2.2 )
                                    case insertprivatePartkhksk_0_111111111111111111111121111111
                                    solve( Insert( <'authPolicy', ~k_h>, k_ap ) @ #t2.4 )
                                      case insertauthPolicyakhnil_0_11111111111111
                                      by solve( state_11111111111111( ~RouterID.1, ~ServerID.1, ~k_h,
                                                                      ~ak_sk.1, ~ssk_nms.1
                                                ) ▶₀ #t2.4 )
                                    next
                                      case insertauthPolicykhauthPolicy_0_11111111111111111111112111111
                                      solve( state_11111111111111111111112111111( ~RouterID.1, ~ServerID.1,
                                                                                  ~ak_h.1, ~ak_sk.1, ~k_h,
                                                                                  ~k_sk.1, ~ssk_nms.1, k_ap,
                                                                                  lock
                                             ) ▶₀ #t2.4 )
                                        case lockdevice_0_1111111111111111111111211111
                                        by contradiction /* cyclic */
                                      qed
                                    qed
                                  qed
                                next
                                  case outTPMSigntlsshtlshtlsspkskae_0_1111111111111211111111111111111111
                                  by contradiction /* cyclic */
                                next
                                  case outtlsspkskaecsr_0_11111111111112111111111111111111111111
                                  by contradiction /* cyclic */
                                qed
                              next
                                case outsignobjpkobjapask_0_11111111111111111111211111111
                                solve( (#vr.76 < #vr.49)  ∥ (#t2 < #vr.76) )
                                  case case_1
                                  solve( TPM_SendCommand( <'TPM2_Certify', obj_sh, obj_h, a_h> ) @ #t2.7 )
                                    case eventTPMSendCommandTPMCertifytlsshtlshakh_0_111111111111121111111111111
                                    solve( state_111111111111121111111111111( ~RouterID.1, ~ServerID.1,
                                                                              ~ak_h.1, ~ak_sk.1, ~ssk_nms.1,
                                                                              ~tid.1, obj_h, obj_sh, tls_spk
                                           ) ▶₀ #t2.4 )
                                      case outTPMPolicyPCRtlssh_0_11111111111112111111111111
                                      by contradiction /* cyclic */
                                    qed
                                  qed
                                next
                                  case case_2
                                  solve( TPM_SendCommand( <'TPM2_Certify', obj_sh, obj_h, a_h> ) @ #t2.7 )
                                    case eventTPMSendCommandTPMCertifytlsshtlshakh_0_111111111111121111111111111
                                    solve( state_111111111111121111111111111( ~RouterID.1, ~ServerID.1,
                                                                              ~ak_h.1, ~ak_sk.1, ~ssk_nms.1,
                                                                              ~tid.1, obj_h, obj_sh, tls_spk
                                           ) ▶₀ #t2.4 )
                                      case outTPMPolicyPCRtlssh_0_11111111111112111111111111
                                      solve( (#vr.40 < #t2.9)  ∥ (#vr.40 = #t2.9) )
                                        case case_1
                                        solve( (#vr.45 < #t2.10)  ∥ (#vr.45 = #t2.10) )
                                          case case_1
                                          solve( (#vr.32 < #t2.8)  ∥ (#vr.32 = #t2.8) )
                                            case case_1
                                            solve( (#t2.5 < #t2.10)  ∥ (#t2.5 = #t2.10)  ∥ (#vr.73 < #t2.5) )
                                              case case_1
                                              by contradiction /* from formulas */
                                            next
                                              case case_2
                                              solve( (#t2.6 < #t2.10)  ∥ (#t2.6 = #t2.10)  ∥
                                                     (#vr.74 < #t2.6) )
                                                case case_1
                                                by contradiction /* from formulas */
                                              next
                                                case case_2
                                                solve( Unlock_4( '4', ~n.2, 'device' ) @ #t2.7 )
                                                  case unlockdevice_0_111111111111111111112111111111
                                                  solve( state_111111111111111111112111111111( ~RouterID.1,
                                                                                               ~ServerID.1,
                                                                                               ~ak_h.1,
                                                                                               ~ak_sk.1,
                                                                                               ~ssk_nms.1,
                                                                                               a_h, a_sk,
                                                                                               obj_ap, obj_h,
                                                                                               obj_pd, obj_pk,
                                                                                               obj_sh, ~n.2
                                                         ) ▶₀ #t2.5 )
                                                    case outsignobjpkobjapask_0_11111111111111111111211111111
                                                    solve( (#t2.7 < #t2.15)  ∥ (#t2.7 = #t2.15) )
                                                      case case_1
                                                      by contradiction /* from formulas */
                                                    next
                                                      case case_2
                                                      solve( (#vr.32 < #t2.12)  ∥ (#vr.32 = #t2.12) )
                                                        case case_1
                                                        solve( (#vr.40 < #t2.13)  ∥ (#vr.40 = #t2.13) )
                                                          case case_1
                                                          solve( (#vr.45 < #t2.14)  ∥ (#vr.45 = #t2.14) )
                                                            case case_1
                                                            solve( (#t2.14 < #t2.6)  ∥ (#t2.14 = #t2.6) )
                                                              case case_1
                                                              by contradiction /* from formulas */
                                                            next
                                                              case case_2
                                                              solve( (#t2.9 < #t2.13)  ∥ (#t2.9 = #t2.13) )
                                                                case case_1
                                                                by contradiction /* from formulas */
                                                              next
                                                                case case_2
                                                                solve( (#t2.8 < #t2.12)  ∥ (#t2.8 = #t2.12) )
                                                                  case case_1
                                                                  by contradiction /* from formulas */
                                                                next
                                                                  case case_2
                                                                  solve( TPM_SendCommand( <'TPM2_Create', 
                                                                                           <swstate, nil>, 
                                                                                           'TPM_CC_PolicyPCR', 
                                                                                           nil>
                                                                         ) @ #t2.10 )
                                                                    case eventTPMSendCommandTPMCreateswstatenilTPMCCPolicyPCRnil_0_11111111111112111
                                                                    solve( state_11111111111112111( ~RouterID.1,
                                                                                                    ~ServerID.1,
                                                                                                    ~ak_h.1,
                                                                                                    ~ak_sk.1,
                                                                                                    ~ssk_nms.1,
                                                                                                    ~tid.1
                                                                           ) ▶₀ #t2.6 )
                                                                      case outTPMPCRExtendswstate_0_1111111111111211
                                                                      solve( TPM_SendCommand( <
                                                                                               'TPM2_Certify', 
                                                                                               k_sh, ~k_h, 
                                                                                               ~ak_h>
                                                                             ) @ #t2.10 )
                                                                        case eventTPMSendCommandTPMCertifytlsshtlshakh_0_111111111111121111111111111
                                                                        solve( state_111111111111121111111111111( ~RouterID.1,
                                                                                                                  ~ServerID.1,
                                                                                                                  ~ak_h,
                                                                                                                  ~ak_sk.1,
                                                                                                                  ~ssk_nms.1,
                                                                                                                  ~tid.1,
                                                                                                                  ~k_h,
                                                                                                                  k_sh,
                                                                                                                  tls_spk
                                                                               ) ▶₀ #t2.6 )
                                                                          case outTPMPolicyPCRtlssh_0_11111111111112111111111111
                                                                          solve( TPM_SendCommand( <
                                                                                                   'TPM2_Create', 
                                                                                                   <swstate, 
                                                                                                    nil>, 
                                                                                                   'TPM_CC_PolicyPCR', 
                                                                                                   nil>
                                                                                 ) @ #t2.10 )
                                                                            case eventTPMSendCommandTPMCreateswstatenilTPMCCPolicyPCRnil_0_11111111111112111
                                                                            solve( state_11111111111112111( ~RouterID.1,
                                                                                                            ~ServerID.1,
                                                                                                            ~ak_h.1,
                                                                                                            ~ak_sk.1,
                                                                                                            ~ssk_nms.1,
                                                                                                            ~tid.1
                                                                                   ) ▶₀ #t2.6 )
                                                                              case outTPMPCRExtendswstate_0_1111111111111211
                                                                              solve( Insert( <'privatePart', 
                                                                                              ~k_h>,
                                                                                             k_sk.1
                                                                                     ) @ #t2.2 )
                                                                                case insertprivatePartkhksk_0_111111111111111111111121111111
                                                                                solve( Insert( <'authPolicy', 
                                                                                                ~k_h>,
                                                                                               k_ap
                                                                                       ) @ #t2.6 )
                                                                                  case insertauthPolicyakhnil_0_11111111111111
                                                                                  by solve( state_11111111111111( ~RouterID.1,
                                                                                                                  ~ServerID.1,
                                                                                                                  ~k_h,
                                                                                                                  ~ak_sk.1,
                                                                                                                  ~ssk_nms.1
                                                                                            ) ▶₀ #t2.6 )
                                                                                next
                                                                                  case insertauthPolicykhauthPolicy_0_11111111111111111111112111111
                                                                                  solve( state_11111111111111111111112111111( ~RouterID.1,
                                                                                                                              ~ServerID.1,
                                                                                                                              ~ak_h.1,
                                                                                                                              ~ak_sk.1,
                                                                                                                              ~k_h,
                                                                                                                              ~k_sk.1,
                                                                                                                              ~ssk_nms.1,
                                                                                                                              k_ap,
                                                                                                                              lock
                                                                                         ) ▶₀ #t2.6 )
                                                                                    case lockdevice_0_1111111111111111111111211111
                                                                                    by contradiction
                                                                                       /* cyclic */
                                                                                  qed
                                                                                qed
                                                                              qed
                                                                            qed
                                                                          qed
                                                                        qed
                                                                      qed
                                                                    qed
                                                                  qed
                                                                qed
                                                              qed
                                                            qed
                                                          next
                                                            case case_2
                                                            by contradiction /* from formulas */
                                                          qed
                                                        next
                                                          case case_2
                                                          by contradiction /* from formulas */
                                                        qed
                                                      next
                                                        case case_2
                                                        by contradiction /* from formulas */
                                                      qed
                                                    qed
                                                  qed
                                                next
                                                  case unlockdevice_0_11111111111111111111211111112
                                                  by solve( state_11111111111111111111211111112( ~RouterID.1,
                                                                                                 ~ServerID.1,
                                                                                                 ~ak_h.1,
                                                                                                 ~ak_sk.1,
                                                                                                 ~ssk_nms.1,
                                                                                                 a_h, obj_ap,
                                                                                                 obj_h,
                                                                                                 obj_pd,
                                                                                                 obj_pk,
                                                                                                 obj_sh, ~n.2
                                                            ) ▶₀ #t2.5 )
                                                qed
                                              next
                                                case case_3
                                                solve( Unlock_4( '4', ~n.2, 'device' ) @ #t2.7 )
                                                  case unlockdevice_0_111111111111111111112111111111
                                                  solve( state_111111111111111111112111111111( ~RouterID.1,
                                                                                               ~ServerID.1,
                                                                                               ~ak_h.1,
                                                                                               ~ak_sk.1,
                                                                                               ~ssk_nms.1,
                                                                                               a_h, a_sk,
                                                                                               obj_ap, obj_h,
                                                                                               obj_pd, obj_pk,
                                                                                               obj_sh, ~n.2
                                                         ) ▶₀ #t2.5 )
                                                    case outsignobjpkobjapask_0_11111111111111111111211111111
                                                    solve( (#t2.10 < #t2.16)  ∥ (#t2.10 = #t2.16) )
                                                      case case_1
                                                      by contradiction /* from formulas */
                                                    next
                                                      case case_2
                                                      solve( (#vr.32 < #t2.13)  ∥ (#vr.32 = #t2.13) )
                                                        case case_1
                                                        solve( (#vr.40 < #t2.14)  ∥ (#vr.40 = #t2.14) )
                                                          case case_1
                                                          solve( (#vr.45 < #t2.15)  ∥ (#vr.45 = #t2.15) )
                                                            case case_1
                                                            solve( (#t2.15 < #t2.6)  ∥ (#t2.15 = #t2.6) )
                                                              case case_1
                                                              by contradiction /* from formulas */
                                                            next
                                                              case case_2
                                                              solve( (#t2.9 < #t2.14)  ∥ (#t2.9 = #t2.14) )
                                                                case case_1
                                                                by contradiction /* from formulas */
                                                              next
                                                                case case_2
                                                                solve( (#t2.8 < #t2.13)  ∥ (#t2.8 = #t2.13) )
                                                                  case case_1
                                                                  by contradiction /* from formulas */
                                                                next
                                                                  case case_2
                                                                  solve( TPM_SendCommand( <'TPM2_Create', 
                                                                                           <swstate, nil>, 
                                                                                           'TPM_CC_PolicyPCR', 
                                                                                           nil>
                                                                         ) @ #t2.11 )
                                                                    case eventTPMSendCommandTPMCreateswstatenilTPMCCPolicyPCRnil_0_11111111111112111
                                                                    solve( state_11111111111112111( ~RouterID.1,
                                                                                                    ~ServerID.1,
                                                                                                    ~ak_h.1,
                                                                                                    ~ak_sk.1,
                                                                                                    ~ssk_nms.1,
                                                                                                    ~tid.1
                                                                           ) ▶₀ #t2.6 )
                                                                      case outTPMPCRExtendswstate_0_1111111111111211
                                                                      solve( TPM_SendCommand( <
                                                                                               'TPM2_Certify', 
                                                                                               k_sh, ~k_h, 
                                                                                               ~ak_h>
                                                                             ) @ #t2.11 )
                                                                        case eventTPMSendCommandTPMCertifytlsshtlshakh_0_111111111111121111111111111
                                                                        solve( state_111111111111121111111111111( ~RouterID.1,
                                                                                                                  ~ServerID.1,
                                                                                                                  ~ak_h,
                                                                                                                  ~ak_sk.1,
                                                                                                                  ~ssk_nms.1,
                                                                                                                  ~tid.1,
                                                                                                                  ~k_h,
                                                                                                                  k_sh,
                                                                                                                  tls_spk
                                                                               ) ▶₀ #t2.6 )
                                                                          case outTPMPolicyPCRtlssh_0_11111111111112111111111111
                                                                          solve( TPM_SendCommand( <
                                                                                                   'TPM2_Create', 
                                                                                                   <swstate, 
                                                                                                    nil>, 
                                                                                                   'TPM_CC_PolicyPCR', 
                                                                                                   nil>
                                                                                 ) @ #t2.11 )
                                                                            case eventTPMSendCommandTPMCreateswstatenilTPMCCPolicyPCRnil_0_11111111111112111
                                                                            solve( state_11111111111112111( ~RouterID.1,
                                                                                                            ~ServerID.1,
                                                                                                            ~ak_h.1,
                                                                                                            ~ak_sk.1,
                                                                                                            ~ssk_nms.1,
                                                                                                            ~tid.1
                                                                                   ) ▶₀ #t2.6 )
                                                                              case outTPMPCRExtendswstate_0_1111111111111211
                                                                              solve( Insert( <'privatePart', 
                                                                                              ~k_h>,
                                                                                             k_sk.1
                                                                                     ) @ #t2.2 )
                                                                                case insertprivatePartkhksk_0_111111111111111111111121111111
                                                                                solve( Insert( <'authPolicy', 
                                                                                                ~k_h>,
                                                                                               k_ap
                                                                                       ) @ #t2.6 )
                                                                                  case insertauthPolicyakhnil_0_11111111111111
                                                                                  by solve( state_11111111111111( ~RouterID.1,
                                                                                                                  ~ServerID.1,
                                                                                                                  ~k_h,
                                                                                                                  ~ak_sk.1,
                                                                                                                  ~ssk_nms.1
                                                                                            ) ▶₀ #t2.6 )
                                                                                next
                                                                                  case insertauthPolicykhauthPolicy_0_11111111111111111111112111111
                                                                                  solve( state_11111111111111111111112111111( ~RouterID.1,
                                                                                                                              ~ServerID.1,
                                                                                                                              ~ak_h.1,
                                                                                                                              ~ak_sk.1,
                                                                                                                              ~k_h,
                                                                                                                              ~k_sk.1,
                                                                                                                              ~ssk_nms.1,
                                                                                                                              k_ap,
                                                                                                                              lock
                                                                                         ) ▶₀ #t2.6 )
                                                                                    case lockdevice_0_1111111111111111111111211111
                                                                                    by contradiction
                                                                                       /* cyclic */
                                                                                  qed
                                                                                qed
                                                                              qed
                                                                            qed
                                                                          qed
                                                                        qed
                                                                      qed
                                                                    qed
                                                                  qed
                                                                qed
                                                              qed
                                                            qed
                                                          next
                                                            case case_2
                                                            by contradiction /* from formulas */
                                                          qed
                                                        next
                                                          case case_2
                                                          by contradiction /* from formulas */
                                                        qed
                                                      next
                                                        case case_2
                                                        by contradiction /* from formulas */
                                                      qed
                                                    qed
                                                  qed
                                                next
                                                  case unlockdevice_0_11111111111111111111211111112
                                                  by solve( state_11111111111111111111211111112( ~RouterID.1,
                                                                                                 ~ServerID.1,
                                                                                                 ~ak_h.1,
                                                                                                 ~ak_sk.1,
                                                                                                 ~ssk_nms.1,
                                                                                                 a_h, obj_ap,
                                                                                                 obj_h,
                                                                                                 obj_pd,
                                                                                                 obj_pk,
                                                                                                 obj_sh, ~n.2
                                                            ) ▶₀ #t2.5 )
                                                qed
                                              qed
                                            next
                                              case case_3
                                              solve( (#t2.6 < #t2.11)  ∥ (#t2.6 = #t2.11)  ∥
                                                     (#vr.74 < #t2.6) )
                                                case case_1
                                                by contradiction /* from formulas */
                                              next
                                                case case_2
                                                solve( Unlock_4( '4', ~n.2, 'device' ) @ #t2.7 )
                                                  case unlockdevice_0_111111111111111111112111111111
                                                  solve( state_111111111111111111112111111111( ~RouterID.1,
                                                                                               ~ServerID.1,
                                                                                               ~ak_h.1,
                                                                                               ~ak_sk.1,
                                                                                               ~ssk_nms.1,
                                                                                               a_h, a_sk,
                                                                                               obj_ap, obj_h,
                                                                                               obj_pd, obj_pk,
                                                                                               obj_sh, ~n.2
                                                         ) ▶₀ #t2.5 )
                                                    case outsignobjpkobjapask_0_11111111111111111111211111111
                                                    solve( (#t2.7 < #t2.16)  ∥ (#t2.7 = #t2.16) )
                                                      case case_1
                                                      by contradiction /* from formulas */
                                                    next
                                                      case case_2
                                                      solve( (#vr.32 < #t2.13)  ∥ (#vr.32 = #t2.13) )
                                                        case case_1
                                                        solve( (#vr.40 < #t2.14)  ∥ (#vr.40 = #t2.14) )
                                                          case case_1
                                                          solve( (#vr.45 < #t2.15)  ∥ (#vr.45 = #t2.15) )
                                                            case case_1
                                                            solve( (#t2.10 < #t2.15)  ∥ (#t2.10 = #t2.15) )
                                                              case case_1
                                                              by contradiction /* from formulas */
                                                            next
                                                              case case_2
                                                              solve( (#t2.9 < #t2.14)  ∥ (#t2.9 = #t2.14) )
                                                                case case_1
                                                                by contradiction /* from formulas */
                                                              next
                                                                case case_2
                                                                solve( (#t2.8 < #t2.13)  ∥ (#t2.8 = #t2.13) )
                                                                  case case_1
                                                                  by contradiction /* from formulas */
                                                                next
                                                                  case case_2
                                                                  solve( TPM_SendCommand( <'TPM2_Create', 
                                                                                           <swstate, nil>, 
                                                                                           'TPM_CC_PolicyPCR', 
                                                                                           nil>
                                                                         ) @ #t2.11 )
                                                                    case eventTPMSendCommandTPMCreateswstatenilTPMCCPolicyPCRnil_0_11111111111112111
                                                                    solve( state_11111111111112111( ~RouterID.1,
                                                                                                    ~ServerID.1,
                                                                                                    ~ak_h.1,
                                                                                                    ~ak_sk.1,
                                                                                                    ~ssk_nms.1,
                                                                                                    ~tid.1
                                                                           ) ▶₀ #t2.6 )
                                                                      case outTPMPCRExtendswstate_0_1111111111111211
                                                                      solve( TPM_SendCommand( <
                                                                                               'TPM2_Certify', 
                                                                                               k_sh, ~k_h, 
                                                                                               ~ak_h>
                                                                             ) @ #t2.11 )
                                                                        case eventTPMSendCommandTPMCertifytlsshtlshakh_0_111111111111121111111111111
                                                                        solve( state_111111111111121111111111111( ~RouterID.1,
                                                                                                                  ~ServerID.1,
                                                                                                                  ~ak_h,
                                                                                                                  ~ak_sk.1,
                                                                                                                  ~ssk_nms.1,
                                                                                                                  ~tid.1,
                                                                                                                  ~k_h,
                                                                                                                  k_sh,
                                                                                                                  tls_spk
                                                                               ) ▶₀ #t2.6 )
                                                                          case outTPMPolicyPCRtlssh_0_11111111111112111111111111
                                                                          solve( TPM_SendCommand( <
                                                                                                   'TPM2_Create', 
                                                                                                   <swstate, 
                                                                                                    nil>, 
                                                                                                   'TPM_CC_PolicyPCR', 
                                                                                                   nil>
                                                                                 ) @ #t2.11 )
                                                                            case eventTPMSendCommandTPMCreateswstatenilTPMCCPolicyPCRnil_0_11111111111112111
                                                                            solve( state_11111111111112111( ~RouterID.1,
                                                                                                            ~ServerID.1,
                                                                                                            ~ak_h.1,
                                                                                                            ~ak_sk.1,
                                                                                                            ~ssk_nms.1,
                                                                                                            ~tid.1
                                                                                   ) ▶₀ #t2.6 )
                                                                              case outTPMPCRExtendswstate_0_1111111111111211
                                                                              solve( Insert( <'privatePart', 
                                                                                              ~k_h>,
                                                                                             k_sk.1
                                                                                     ) @ #t2.2 )
                                                                                case insertprivatePartkhksk_0_111111111111111111111121111111
                                                                                solve( Insert( <'authPolicy', 
                                                                                                ~k_h>,
                                                                                               k_ap
                                                                                       ) @ #t2.6 )
                                                                                  case insertauthPolicyakhnil_0_11111111111111
                                                                                  by solve( state_11111111111111( ~RouterID.1,
                                                                                                                  ~ServerID.1,
                                                                                                                  ~k_h,
                                                                                                                  ~ak_sk.1,
                                                                                                                  ~ssk_nms.1
                                                                                            ) ▶₀ #t2.6 )
                                                                                next
                                                                                  case insertauthPolicykhauthPolicy_0_11111111111111111111112111111
                                                                                  solve( state_11111111111111111111112111111( ~RouterID.1,
                                                                                                                              ~ServerID.1,
                                                                                                                              ~ak_h.1,
                                                                                                                              ~ak_sk.1,
                                                                                                                              ~k_h,
                                                                                                                              ~k_sk.1,
                                                                                                                              ~ssk_nms.1,
                                                                                                                              k_ap,
                                                                                                                              lock
                                                                                         ) ▶₀ #t2.6 )
                                                                                    case lockdevice_0_1111111111111111111111211111
                                                                                    by contradiction
                                                                                       /* cyclic */
                                                                                  qed
                                                                                qed
                                                                              qed
                                                                            qed
                                                                          qed
                                                                        qed
                                                                      qed
                                                                    qed
                                                                  qed
                                                                qed
                                                              qed
                                                            qed
                                                          next
                                                            case case_2
                                                            by contradiction /* from formulas */
                                                          qed
                                                        next
                                                          case case_2
                                                          by contradiction /* from formulas */
                                                        qed
                                                      next
                                                        case case_2
                                                        by contradiction /* from formulas */
                                                      qed
                                                    qed
                                                  qed
                                                next
                                                  case unlockdevice_0_11111111111111111111211111112
                                                  by solve( state_11111111111111111111211111112( ~RouterID.1,
                                                                                                 ~ServerID.1,
                                                                                                 ~ak_h.1,
                                                                                                 ~ak_sk.1,
                                                                                                 ~ssk_nms.1,
                                                                                                 a_h, obj_ap,
                                                                                                 obj_h,
                                                                                                 obj_pd,
                                                                                                 obj_pk,
                                                                                                 obj_sh, ~n.2
                                                            ) ▶₀ #t2.5 )
                                                qed
                                              next
                                                case case_3
                                                solve( Unlock_4( '4', ~n.2, 'device' ) @ #t2.7 )
                                                  case unlockdevice_0_111111111111111111112111111111
                                                  solve( state_111111111111111111112111111111( ~RouterID.1,
                                                                                               ~ServerID.1,
                                                                                               ~ak_h.1,
                                                                                               ~ak_sk.1,
                                                                                               ~ssk_nms.1,
                                                                                               a_h, a_sk,
                                                                                               obj_ap, obj_h,
                                                                                               obj_pd, obj_pk,
                                                                                               obj_sh, ~n.2
                                                         ) ▶₀ #t2.5 )
                                                    case outsignobjpkobjapask_0_11111111111111111111211111111
                                                    solve( (#t2.11 < #t2.17)  ∥ (#t2.11 = #t2.17) )
                                                      case case_1
                                                      by contradiction /* from formulas */
                                                    next
                                                      case case_2
                                                      solve( (#vr.32 < #t2.14)  ∥ (#vr.32 = #t2.14) )
                                                        case case_1
                                                        solve( (#vr.40 < #t2.15)  ∥ (#vr.40 = #t2.15) )
                                                          case case_1
                                                          solve( (#vr.45 < #t2.16)  ∥ (#vr.45 = #t2.16) )
                                                            case case_1
                                                            solve( (#t2.10 < #t2.16)  ∥ (#t2.10 = #t2.16) )
                                                              case case_1
                                                              by contradiction /* from formulas */
                                                            next
                                                              case case_2
                                                              solve( (#t2.9 < #t2.15)  ∥ (#t2.9 = #t2.15) )
                                                                case case_1
                                                                by contradiction /* from formulas */
                                                              next
                                                                case case_2
                                                                solve( (#t2.8 < #t2.14)  ∥ (#t2.8 = #t2.14) )
                                                                  case case_1
                                                                  by contradiction /* from formulas */
                                                                next
                                                                  case case_2
                                                                  solve( TPM_SendCommand( <'TPM2_Create', 
                                                                                           <swstate, nil>, 
                                                                                           'TPM_CC_PolicyPCR', 
                                                                                           nil>
                                                                         ) @ #t2.12 )
                                                                    case eventTPMSendCommandTPMCreateswstatenilTPMCCPolicyPCRnil_0_11111111111112111
                                                                    solve( state_11111111111112111( ~RouterID.1,
                                                                                                    ~ServerID.1,
                                                                                                    ~ak_h.1,
                                                                                                    ~ak_sk.1,
                                                                                                    ~ssk_nms.1,
                                                                                                    ~tid.1
                                                                           ) ▶₀ #t2.6 )
                                                                      case outTPMPCRExtendswstate_0_1111111111111211
                                                                      solve( TPM_SendCommand( <
                                                                                               'TPM2_Certify', 
                                                                                               k_sh, ~k_h, 
                                                                                               ~ak_h>
                                                                             ) @ #t2.12 )
                                                                        case eventTPMSendCommandTPMCertifytlsshtlshakh_0_111111111111121111111111111
                                                                        solve( state_111111111111121111111111111( ~RouterID.1,
                                                                                                                  ~ServerID.1,
                                                                                                                  ~ak_h,
                                                                                                                  ~ak_sk.1,
                                                                                                                  ~ssk_nms.1,
                                                                                                                  ~tid.1,
                                                                                                                  ~k_h,
                                                                                                                  k_sh,
                                                                                                                  tls_spk
                                                                               ) ▶₀ #t2.6 )
                                                                          case outTPMPolicyPCRtlssh_0_11111111111112111111111111
                                                                          solve( TPM_SendCommand( <
                                                                                                   'TPM2_Create', 
                                                                                                   <swstate, 
                                                                                                    nil>, 
                                                                                                   'TPM_CC_PolicyPCR', 
                                                                                                   nil>
                                                                                 ) @ #t2.12 )
                                                                            case eventTPMSendCommandTPMCreateswstatenilTPMCCPolicyPCRnil_0_11111111111112111
                                                                            solve( state_11111111111112111( ~RouterID.1,
                                                                                                            ~ServerID.1,
                                                                                                            ~ak_h.1,
                                                                                                            ~ak_sk.1,
                                                                                                            ~ssk_nms.1,
                                                                                                            ~tid.1
                                                                                   ) ▶₀ #t2.6 )
                                                                              case outTPMPCRExtendswstate_0_1111111111111211
                                                                              solve( Insert( <'privatePart', 
                                                                                              ~k_h>,
                                                                                             k_sk.1
                                                                                     ) @ #t2.2 )
                                                                                case insertprivatePartkhksk_0_111111111111111111111121111111
                                                                                solve( Insert( <'authPolicy', 
                                                                                                ~k_h>,
                                                                                               k_ap
                                                                                       ) @ #t2.6 )
                                                                                  case insertauthPolicyakhnil_0_11111111111111
                                                                                  by solve( state_11111111111111( ~RouterID.1,
                                                                                                                  ~ServerID.1,
                                                                                                                  ~k_h,
                                                                                                                  ~ak_sk.1,
                                                                                                                  ~ssk_nms.1
                                                                                            ) ▶₀ #t2.6 )
                                                                                next
                                                                                  case insertauthPolicykhauthPolicy_0_11111111111111111111112111111
                                                                                  solve( state_11111111111111111111112111111( ~RouterID.1,
                                                                                                                              ~ServerID.1,
                                                                                                                              ~ak_h.1,
                                                                                                                              ~ak_sk.1,
                                                                                                                              ~k_h,
                                                                                                                              ~k_sk.1,
                                                                                                                              ~ssk_nms.1,
                                                                                                                              k_ap,
                                                                                                                              lock
                                                                                         ) ▶₀ #t2.6 )
                                                                                    case lockdevice_0_1111111111111111111111211111
                                                                                    by contradiction
                                                                                       /* cyclic */
                                                                                  qed
                                                                                qed
                                                                              qed
                                                                            qed
                                                                          qed
                                                                        qed
                                                                      qed
                                                                    qed
                                                                  qed
                                                                qed
                                                              qed
                                                            qed
                                                          next
                                                            case case_2
                                                            by contradiction /* from formulas */
                                                          qed
                                                        next
                                                          case case_2
                                                          by contradiction /* from formulas */
                                                        qed
                                                      next
                                                        case case_2
                                                        by contradiction /* from formulas */
                                                      qed
                                                    qed
                                                  qed
                                                next
                                                  case unlockdevice_0_11111111111111111111211111112
                                                  by solve( state_11111111111111111111211111112( ~RouterID.1,
                                                                                                 ~ServerID.1,
                                                                                                 ~ak_h.1,
                                                                                                 ~ak_sk.1,
                                                                                                 ~ssk_nms.1,
                                                                                                 a_h, obj_ap,
                                                                                                 obj_h,
                                                                                                 obj_pd,
                                                                                                 obj_pk,
                                                                                                 obj_sh, ~n.2
                                                            ) ▶₀ #t2.5 )
                                                qed
                                              qed
                                            qed
                                          next
                                            case case_2
                                            solve( (#t2.6 < #t2.10)  ∥ (#t2.6 = #t2.10)  ∥ (#vr.72 < #t2.6) )
                                              case case_1
                                              by contradiction /* from formulas */
                                            next
                                              case case_2
                                              solve( (#t2.7 < #t2.10)  ∥ (#t2.7 = #t2.10)  ∥
                                                     (#vr.73 < #t2.7) )
                                                case case_1
                                                by contradiction /* from formulas */
                                              next
                                                case case_2
                                                solve( Unlock_4( '4', ~n.2, 'device' ) @ #t2.8 )
                                                  case unlockdevice_0_111111111111111111112111111111
                                                  solve( state_111111111111111111112111111111( ~RouterID.1,
                                                                                               ~ServerID.1,
                                                                                               ~ak_h.1,
                                                                                               ~ak_sk.1,
                                                                                               ~ssk_nms.1,
                                                                                               a_h, a_sk,
                                                                                               obj_ap, obj_h,
                                                                                               obj_pd, obj_pk,
                                                                                               obj_sh, ~n.2
                                                         ) ▶₀ #t2.6 )
                                                    case outsignobjpkobjapask_0_11111111111111111111211111111
                                                    solve( (#t2.5 < #t2.12)  ∥ (#t2.5 = #t2.12) )
                                                      case case_1
                                                      by contradiction /* from formulas */
                                                    next
                                                      case case_2
                                                      solve( (#t2.8 < #t2.14)  ∥ (#t2.8 = #t2.14) )
                                                        case case_1
                                                        by contradiction /* from formulas */
                                                      next
                                                        case case_2
                                                        solve( (#vr.39 < #t2.12)  ∥ (#vr.39 = #t2.12) )
                                                          case case_1
                                                          solve( (#vr.44 < #t2.13)  ∥ (#vr.44 = #t2.13) )
                                                            case case_1
                                                            solve( (#t2.13 < #t2.7)  ∥ (#t2.13 = #t2.7) )
                                                              case case_1
                                                              by contradiction /* from formulas */
                                                            next
                                                              case case_2
                                                              solve( (#t2.9 < #t2.12)  ∥ (#t2.9 = #t2.12) )
                                                                case case_1
                                                                by contradiction /* from formulas */
                                                              next
                                                                case case_2
                                                                solve( TPM_SendCommand( <'TPM2_Create', 
                                                                                         <swstate, nil>, 
                                                                                         'TPM_CC_PolicyPCR', 
                                                                                         nil>
                                                                       ) @ #t2.10 )
                                                                  case eventTPMSendCommandTPMCreateswstatenilTPMCCPolicyPCRnil_0_11111111111112111
                                                                  solve( state_11111111111112111( ~RouterID.1,
                                                                                                  ~ServerID.1,
                                                                                                  ~ak_h.1,
                                                                                                  ~ak_sk.1,
                                                                                                  ~ssk_nms.1,
                                                                                                  ~tid.1
                                                                         ) ▶₀ #t2.7 )
                                                                    case outTPMPCRExtendswstate_0_1111111111111211
                                                                    solve( TPM_SendCommand( <'TPM2_Certify', 
                                                                                             k_sh, ~k_h, ~ak_h
                                                                                            >
                                                                           ) @ #t2.10 )
                                                                      case eventTPMSendCommandTPMCertifytlsshtlshakh_0_111111111111121111111111111
                                                                      solve( state_111111111111121111111111111( ~RouterID.1,
                                                                                                                ~ServerID.1,
                                                                                                                ~ak_h,
                                                                                                                ~ak_sk.1,
                                                                                                                ~ssk_nms.1,
                                                                                                                ~tid.1,
                                                                                                                ~k_h,
                                                                                                                k_sh,
                                                                                                                tls_spk
                                                                             ) ▶₀ #t2.7 )
                                                                        case outTPMPolicyPCRtlssh_0_11111111111112111111111111
                                                                        solve( TPM_SendCommand( <
                                                                                                 'TPM2_Create', 
                                                                                                 <swstate, nil
                                                                                                 >, 
                                                                                                 'TPM_CC_PolicyPCR', 
                                                                                                 nil>
                                                                               ) @ #t2.10 )
                                                                          case eventTPMSendCommandTPMCreateswstatenilTPMCCPolicyPCRnil_0_11111111111112111
                                                                          solve( state_11111111111112111( ~RouterID.1,
                                                                                                          ~ServerID.1,
                                                                                                          ~ak_h.1,
                                                                                                          ~ak_sk.1,
                                                                                                          ~ssk_nms.1,
                                                                                                          ~tid.1
                                                                                 ) ▶₀ #t2.7 )
                                                                            case outTPMPCRExtendswstate_0_1111111111111211
                                                                            solve( Insert( <'privatePart', 
                                                                                            ~k_h>,
                                                                                           k_sk.1
                                                                                   ) @ #t2.2 )
                                                                              case insertprivatePartkhksk_0_111111111111111111111121111111
                                                                              solve( Insert( <'authPolicy', 
                                                                                              ~k_h>,
                                                                                             k_ap
                                                                                     ) @ #t2.7 )
                                                                                case insertauthPolicyakhnil_0_11111111111111
                                                                                by solve( state_11111111111111( ~RouterID.1,
                                                                                                                ~ServerID.1,
                                                                                                                ~k_h,
                                                                                                                ~ak_sk.1,
                                                                                                                ~ssk_nms.1
                                                                                          ) ▶₀ #t2.7 )
                                                                              next
                                                                                case insertauthPolicykhauthPolicy_0_11111111111111111111112111111
                                                                                solve( state_11111111111111111111112111111( ~RouterID.1,
                                                                                                                            ~ServerID.1,
                                                                                                                            ~ak_h.1,
                                                                                                                            ~ak_sk.1,
                                                                                                                            ~k_h,
                                                                                                                            ~k_sk.1,
                                                                                                                            ~ssk_nms.1,
                                                                                                                            k_ap,
                                                                                                                            lock
                                                                                       ) ▶₀ #t2.7 )
                                                                                  case lockdevice_0_1111111111111111111111211111
                                                                                  by contradiction
                                                                                     /* cyclic */
                                                                                qed
                                                                              qed
                                                                            qed
                                                                          qed
                                                                        qed
                                                                      qed
                                                                    qed
                                                                  qed
                                                                qed
                                                              qed
                                                            qed
                                                          next
                                                            case case_2
                                                            by contradiction /* from formulas */
                                                          qed
                                                        next
                                                          case case_2
                                                          by contradiction /* from formulas */
                                                        qed
                                                      qed
                                                    qed
                                                  qed
                                                next
                                                  case unlockdevice_0_11111111111111111111211111112
                                                  by solve( state_11111111111111111111211111112( ~RouterID.1,
                                                                                                 ~ServerID.1,
                                                                                                 ~ak_h.1,
                                                                                                 ~ak_sk.1,
                                                                                                 ~ssk_nms.1,
                                                                                                 a_h, obj_ap,
                                                                                                 obj_h,
                                                                                                 obj_pd,
                                                                                                 obj_pk,
                                                                                                 obj_sh, ~n.2
                                                            ) ▶₀ #t2.6 )
                                                qed
                                              next
                                                case case_3
                                                solve( Unlock_4( '4', ~n.2, 'device' ) @ #t2.8 )
                                                  case unlockdevice_0_111111111111111111112111111111
                                                  solve( state_111111111111111111112111111111( ~RouterID.1,
                                                                                               ~ServerID.1,
                                                                                               ~ak_h.1,
                                                                                               ~ak_sk.1,
                                                                                               ~ssk_nms.1,
                                                                                               a_h, a_sk,
                                                                                               obj_ap, obj_h,
                                                                                               obj_pd, obj_pk,
                                                                                               obj_sh, ~n.2
                                                         ) ▶₀ #t2.6 )
                                                    case outsignobjpkobjapask_0_11111111111111111111211111111
                                                    solve( (#t2.5 < #t2.13)  ∥ (#t2.5 = #t2.13) )
                                                      case case_1
                                                      by contradiction /* from formulas */
                                                    next
                                                      case case_2
                                                      solve( (#t2.10 < #t2.15)  ∥ (#t2.10 = #t2.15) )
                                                        case case_1
                                                        by contradiction /* from formulas */
                                                      next
                                                        case case_2
                                                        solve( (#vr.39 < #t2.13)  ∥ (#vr.39 = #t2.13) )
                                                          case case_1
                                                          solve( (#vr.44 < #t2.14)  ∥ (#vr.44 = #t2.14) )
                                                            case case_1
                                                            solve( (#t2.14 < #t2.7)  ∥ (#t2.14 = #t2.7) )
                                                              case case_1
                                                              by contradiction /* from formulas */
                                                            next
                                                              case case_2
                                                              solve( (#t2.9 < #t2.13)  ∥ (#t2.9 = #t2.13) )
                                                                case case_1
                                                                by contradiction /* from formulas */
                                                              next
                                                                case case_2
                                                                solve( TPM_SendCommand( <'TPM2_Create', 
                                                                                         <swstate, nil>, 
                                                                                         'TPM_CC_PolicyPCR', 
                                                                                         nil>
                                                                       ) @ #t2.11 )
                                                                  case eventTPMSendCommandTPMCreateswstatenilTPMCCPolicyPCRnil_0_11111111111112111
                                                                  solve( state_11111111111112111( ~RouterID.1,
                                                                                                  ~ServerID.1,
                                                                                                  ~ak_h.1,
                                                                                                  ~ak_sk.1,
                                                                                                  ~ssk_nms.1,
                                                                                                  ~tid.1
                                                                         ) ▶₀ #t2.7 )
                                                                    case outTPMPCRExtendswstate_0_1111111111111211
                                                                    solve( TPM_SendCommand( <'TPM2_Certify', 
                                                                                             k_sh, ~k_h, ~ak_h
                                                                                            >
                                                                           ) @ #t2.11 )
                                                                      case eventTPMSendCommandTPMCertifytlsshtlshakh_0_111111111111121111111111111
                                                                      solve( state_111111111111121111111111111( ~RouterID.1,
                                                                                                                ~ServerID.1,
                                                                                                                ~ak_h,
                                                                                                                ~ak_sk.1,
                                                                                                                ~ssk_nms.1,
                                                                                                                ~tid.1,
                                                                                                                ~k_h,
                                                                                                                k_sh,
                                                                                                                tls_spk
                                                                             ) ▶₀ #t2.7 )
                                                                        case outTPMPolicyPCRtlssh_0_11111111111112111111111111
                                                                        solve( TPM_SendCommand( <
                                                                                                 'TPM2_Create', 
                                                                                                 <swstate, nil
                                                                                                 >, 
                                                                                                 'TPM_CC_PolicyPCR', 
                                                                                                 nil>
                                                                               ) @ #t2.11 )
                                                                          case eventTPMSendCommandTPMCreateswstatenilTPMCCPolicyPCRnil_0_11111111111112111
                                                                          solve( state_11111111111112111( ~RouterID.1,
                                                                                                          ~ServerID.1,
                                                                                                          ~ak_h.1,
                                                                                                          ~ak_sk.1,
                                                                                                          ~ssk_nms.1,
                                                                                                          ~tid.1
                                                                                 ) ▶₀ #t2.7 )
                                                                            case outTPMPCRExtendswstate_0_1111111111111211
                                                                            solve( Insert( <'privatePart', 
                                                                                            ~k_h>,
                                                                                           k_sk.1
                                                                                   ) @ #t2.2 )
                                                                              case insertprivatePartkhksk_0_111111111111111111111121111111
                                                                              solve( Insert( <'authPolicy', 
                                                                                              ~k_h>,
                                                                                             k_ap
                                                                                     ) @ #t2.7 )
                                                                                case insertauthPolicyakhnil_0_11111111111111
                                                                                by solve( state_11111111111111( ~RouterID.1,
                                                                                                                ~ServerID.1,
                                                                                                                ~k_h,
                                                                                                                ~ak_sk.1,
                                                                                                                ~ssk_nms.1
                                                                                          ) ▶₀ #t2.7 )
                                                                              next
                                                                                case insertauthPolicykhauthPolicy_0_11111111111111111111112111111
                                                                                solve( state_11111111111111111111112111111( ~RouterID.1,
                                                                                                                            ~ServerID.1,
                                                                                                                            ~ak_h.1,
                                                                                                                            ~ak_sk.1,
                                                                                                                            ~k_h,
                                                                                                                            ~k_sk.1,
                                                                                                                            ~ssk_nms.1,
                                                                                                                            k_ap,
                                                                                                                            lock
                                                                                       ) ▶₀ #t2.7 )
                                                                                  case lockdevice_0_1111111111111111111111211111
                                                                                  by contradiction
                                                                                     /* cyclic */
                                                                                qed
                                                                              qed
                                                                            qed
                                                                          qed
                                                                        qed
                                                                      qed
                                                                    qed
                                                                  qed
                                                                qed
                                                              qed
                                                            qed
                                                          next
                                                            case case_2
                                                            by contradiction /* from formulas */
                                                          qed
                                                        next
                                                          case case_2
                                                          by contradiction /* from formulas */
                                                        qed
                                                      qed
                                                    qed
                                                  qed
                                                next
                                                  case unlockdevice_0_11111111111111111111211111112
                                                  by solve( state_11111111111111111111211111112( ~RouterID.1,
                                                                                                 ~ServerID.1,
                                                                                                 ~ak_h.1,
                                                                                                 ~ak_sk.1,
                                                                                                 ~ssk_nms.1,
                                                                                                 a_h, obj_ap,
                                                                                                 obj_h,
                                                                                                 obj_pd,
                                                                                                 obj_pk,
                                                                                                 obj_sh, ~n.2
                                                            ) ▶₀ #t2.6 )
                                                qed
                                              qed
                                            next
                                              case case_3
                                              solve( (#t2.7 < #t2.11)  ∥ (#t2.7 = #t2.11)  ∥
                                                     (#vr.73 < #t2.7) )
                                                case case_1
                                                by contradiction /* from formulas */
                                              next
                                                case case_2
                                                solve( Unlock_4( '4', ~n.2, 'device' ) @ #t2.8 )
                                                  case unlockdevice_0_111111111111111111112111111111
                                                  solve( state_111111111111111111112111111111( ~RouterID.1,
                                                                                               ~ServerID.1,
                                                                                               ~ak_h.1,
                                                                                               ~ak_sk.1,
                                                                                               ~ssk_nms.1,
                                                                                               a_h, a_sk,
                                                                                               obj_ap, obj_h,
                                                                                               obj_pd, obj_pk,
                                                                                               obj_sh, ~n.2
                                                         ) ▶₀ #t2.6 )
                                                    case outsignobjpkobjapask_0_11111111111111111111211111111
                                                    solve( (#t2.5 < #t2.13)  ∥ (#t2.5 = #t2.13) )
                                                      case case_1
                                                      by contradiction /* from formulas */
                                                    next
                                                      case case_2
                                                      solve( (#t2.8 < #t2.15)  ∥ (#t2.8 = #t2.15) )
                                                        case case_1
                                                        by contradiction /* from formulas */
                                                      next
                                                        case case_2
                                                        solve( (#vr.39 < #t2.13)  ∥ (#vr.39 = #t2.13) )
                                                          case case_1
                                                          solve( (#vr.44 < #t2.14)  ∥ (#vr.44 = #t2.14) )
                                                            case case_1
                                                            solve( (#t2.10 < #t2.14)  ∥ (#t2.10 = #t2.14) )
                                                              case case_1
                                                              by contradiction /* from formulas */
                                                            next
                                                              case case_2
                                                              solve( (#t2.9 < #t2.13)  ∥ (#t2.9 = #t2.13) )
                                                                case case_1
                                                                by contradiction /* from formulas */
                                                              next
                                                                case case_2
                                                                solve( TPM_SendCommand( <'TPM2_Create', 
                                                                                         <swstate, nil>, 
                                                                                         'TPM_CC_PolicyPCR', 
                                                                                         nil>
                                                                       ) @ #t2.11 )
                                                                  case eventTPMSendCommandTPMCreateswstatenilTPMCCPolicyPCRnil_0_11111111111112111
                                                                  solve( state_11111111111112111( ~RouterID.1,
                                                                                                  ~ServerID.1,
                                                                                                  ~ak_h.1,
                                                                                                  ~ak_sk.1,
                                                                                                  ~ssk_nms.1,
                                                                                                  ~tid.1
                                                                         ) ▶₀ #t2.7 )
                                                                    case outTPMPCRExtendswstate_0_1111111111111211
                                                                    solve( TPM_SendCommand( <'TPM2_Certify', 
                                                                                             k_sh, ~k_h, ~ak_h
                                                                                            >
                                                                           ) @ #t2.11 )
                                                                      case eventTPMSendCommandTPMCertifytlsshtlshakh_0_111111111111121111111111111
                                                                      solve( state_111111111111121111111111111( ~RouterID.1,
                                                                                                                ~ServerID.1,
                                                                                                                ~ak_h,
                                                                                                                ~ak_sk.1,
                                                                                                                ~ssk_nms.1,
                                                                                                                ~tid.1,
                                                                                                                ~k_h,
                                                                                                                k_sh,
                                                                                                                tls_spk
                                                                             ) ▶₀ #t2.7 )
                                                                        case outTPMPolicyPCRtlssh_0_11111111111112111111111111
                                                                        solve( TPM_SendCommand( <
                                                                                                 'TPM2_Create', 
                                                                                                 <swstate, nil
                                                                                                 >, 
                                                                                                 'TPM_CC_PolicyPCR', 
                                                                                                 nil>
                                                                               ) @ #t2.11 )
                                                                          case eventTPMSendCommandTPMCreateswstatenilTPMCCPolicyPCRnil_0_11111111111112111
                                                                          solve( state_11111111111112111( ~RouterID.1,
                                                                                                          ~ServerID.1,
                                                                                                          ~ak_h.1,
                                                                                                          ~ak_sk.1,
                                                                                                          ~ssk_nms.1,
                                                                                                          ~tid.1
                                                                                 ) ▶₀ #t2.7 )
                                                                            case outTPMPCRExtendswstate_0_1111111111111211
                                                                            solve( Insert( <'privatePart', 
                                                                                            ~k_h>,
                                                                                           k_sk.1
                                                                                   ) @ #t2.2 )
                                                                              case insertprivatePartkhksk_0_111111111111111111111121111111
                                                                              solve( Insert( <'authPolicy', 
                                                                                              ~k_h>,
                                                                                             k_ap
                                                                                     ) @ #t2.7 )
                                                                                case insertauthPolicyakhnil_0_11111111111111
                                                                                by solve( state_11111111111111( ~RouterID.1,
                                                                                                                ~ServerID.1,
                                                                                                                ~k_h,
                                                                                                                ~ak_sk.1,
                                                                                                                ~ssk_nms.1
                                                                                          ) ▶₀ #t2.7 )
                                                                              next
                                                                                case insertauthPolicykhauthPolicy_0_11111111111111111111112111111
                                                                                solve( state_11111111111111111111112111111( ~RouterID.1,
                                                                                                                            ~ServerID.1,
                                                                                                                            ~ak_h.1,
                                                                                                                            ~ak_sk.1,
                                                                                                                            ~k_h,
                                                                                                                            ~k_sk.1,
                                                                                                                            ~ssk_nms.1,
                                                                                                                            k_ap,
                                                                                                                            lock
                                                                                       ) ▶₀ #t2.7 )
                                                                                  case lockdevice_0_1111111111111111111111211111
                                                                                  by contradiction
                                                                                     /* cyclic */
                                                                                qed
                                                                              qed
                                                                            qed
                                                                          qed
                                                                        qed
                                                                      qed
                                                                    qed
                                                                  qed
                                                                qed
                                                              qed
                                                            qed
                                                          next
                                                            case case_2
                                                            by contradiction /* from formulas */
                                                          qed
                                                        next
                                                          case case_2
                                                          by contradiction /* from formulas */
                                                        qed
                                                      qed
                                                    qed
                                                  qed
                                                next
                                                  case unlockdevice_0_11111111111111111111211111112
                                                  by solve( state_11111111111111111111211111112( ~RouterID.1,
                                                                                                 ~ServerID.1,
                                                                                                 ~ak_h.1,
                                                                                                 ~ak_sk.1,
                                                                                                 ~ssk_nms.1,
                                                                                                 a_h, obj_ap,
                                                                                                 obj_h,
                                                                                                 obj_pd,
                                                                                                 obj_pk,
                                                                                                 obj_sh, ~n.2
                                                            ) ▶₀ #t2.6 )
                                                qed
                                              next
                                                case case_3
                                                solve( Unlock_4( '4', ~n.2, 'device' ) @ #t2.8 )
                                                  case unlockdevice_0_111111111111111111112111111111
                                                  solve( state_111111111111111111112111111111( ~RouterID.1,
                                                                                               ~ServerID.1,
                                                                                               ~ak_h.1,
                                                                                               ~ak_sk.1,
                                                                                               ~ssk_nms.1,
                                                                                               a_h, a_sk,
                                                                                               obj_ap, obj_h,
                                                                                               obj_pd, obj_pk,
                                                                                               obj_sh, ~n.2
                                                         ) ▶₀ #t2.6 )
                                                    case outsignobjpkobjapask_0_11111111111111111111211111111
                                                    solve( (#t2.5 < #t2.14)  ∥ (#t2.5 = #t2.14) )
                                                      case case_1
                                                      by contradiction /* from formulas */
                                                    next
                                                      case case_2
                                                      solve( (#t2.11 < #t2.16)  ∥ (#t2.11 = #t2.16) )
                                                        case case_1
                                                        by contradiction /* from formulas */
                                                      next
                                                        case case_2
                                                        solve( (#vr.39 < #t2.14)  ∥ (#vr.39 = #t2.14) )
                                                          case case_1
                                                          solve( (#vr.44 < #t2.15)  ∥ (#vr.44 = #t2.15) )
                                                            case case_1
                                                            solve( (#t2.10 < #t2.15)  ∥ (#t2.10 = #t2.15) )
                                                              case case_1
                                                              by contradiction /* from formulas */
                                                            next
                                                              case case_2
                                                              solve( (#t2.9 < #t2.14)  ∥ (#t2.9 = #t2.14) )
                                                                case case_1
                                                                by contradiction /* from formulas */
                                                              next
                                                                case case_2
                                                                solve( TPM_SendCommand( <'TPM2_Create', 
                                                                                         <swstate, nil>, 
                                                                                         'TPM_CC_PolicyPCR', 
                                                                                         nil>
                                                                       ) @ #t2.12 )
                                                                  case eventTPMSendCommandTPMCreateswstatenilTPMCCPolicyPCRnil_0_11111111111112111
                                                                  solve( state_11111111111112111( ~RouterID.1,
                                                                                                  ~ServerID.1,
                                                                                                  ~ak_h.1,
                                                                                                  ~ak_sk.1,
                                                                                                  ~ssk_nms.1,
                                                                                                  ~tid.1
                                                                         ) ▶₀ #t2.7 )
                                                                    case outTPMPCRExtendswstate_0_1111111111111211
                                                                    solve( TPM_SendCommand( <'TPM2_Certify', 
                                                                                             k_sh, ~k_h, ~ak_h
                                                                                            >
                                                                           ) @ #t2.12 )
                                                                      case eventTPMSendCommandTPMCertifytlsshtlshakh_0_111111111111121111111111111
                                                                      solve( state_111111111111121111111111111( ~RouterID.1,
                                                                                                                ~ServerID.1,
                                                                                                                ~ak_h,
                                                                                                                ~ak_sk.1,
                                                                                                                ~ssk_nms.1,
                                                                                                                ~tid.1,
                                                                                                                ~k_h,
                                                                                                                k_sh,
                                                                                                                tls_spk
                                                                             ) ▶₀ #t2.7 )
                                                                        case outTPMPolicyPCRtlssh_0_11111111111112111111111111
                                                                        solve( TPM_SendCommand( <
                                                                                                 'TPM2_Create', 
                                                                                                 <swstate, nil
                                                                                                 >, 
                                                                                                 'TPM_CC_PolicyPCR', 
                                                                                                 nil>
                                                                               ) @ #t2.12 )
                                                                          case eventTPMSendCommandTPMCreateswstatenilTPMCCPolicyPCRnil_0_11111111111112111
                                                                          solve( state_11111111111112111( ~RouterID.1,
                                                                                                          ~ServerID.1,
                                                                                                          ~ak_h.1,
                                                                                                          ~ak_sk.1,
                                                                                                          ~ssk_nms.1,
                                                                                                          ~tid.1
                                                                                 ) ▶₀ #t2.7 )
                                                                            case outTPMPCRExtendswstate_0_1111111111111211
                                                                            solve( Insert( <'privatePart', 
                                                                                            ~k_h>,
                                                                                           k_sk.1
                                                                                   ) @ #t2.2 )
                                                                              case insertprivatePartkhksk_0_111111111111111111111121111111
                                                                              solve( Insert( <'authPolicy', 
                                                                                              ~k_h>,
                                                                                             k_ap
                                                                                     ) @ #t2.7 )
                                                                                case insertauthPolicyakhnil_0_11111111111111
                                                                                by solve( state_11111111111111( ~RouterID.1,
                                                                                                                ~ServerID.1,
                                                                                                                ~k_h,
                                                                                                                ~ak_sk.1,
                                                                                                                ~ssk_nms.1
                                                                                          ) ▶₀ #t2.7 )
                                                                              next
                                                                                case insertauthPolicykhauthPolicy_0_11111111111111111111112111111
                                                                                solve( state_11111111111111111111112111111( ~RouterID.1,
                                                                                                                            ~ServerID.1,
                                                                                                                            ~ak_h.1,
                                                                                                                            ~ak_sk.1,
                                                                                                                            ~k_h,
                                                                                                                            ~k_sk.1,
                                                                                                                            ~ssk_nms.1,
                                                                                                                            k_ap,
                                                                                                                            lock
                                                                                       ) ▶₀ #t2.7 )
                                                                                  case lockdevice_0_1111111111111111111111211111
                                                                                  by contradiction
                                                                                     /* cyclic */
                                                                                qed
                                                                              qed
                                                                            qed
                                                                          qed
                                                                        qed
                                                                      qed
                                                                    qed
                                                                  qed
                                                                qed
                                                              qed
                                                            qed
                                                          next
                                                            case case_2
                                                            by contradiction /* from formulas */
                                                          qed
                                                        next
                                                          case case_2
                                                          by contradiction /* from formulas */
                                                        qed
                                                      qed
                                                    qed
                                                  qed
                                                next
                                                  case unlockdevice_0_11111111111111111111211111112
                                                  by solve( state_11111111111111111111211111112( ~RouterID.1,
                                                                                                 ~ServerID.1,
                                                                                                 ~ak_h.1,
                                                                                                 ~ak_sk.1,
                                                                                                 ~ssk_nms.1,
                                                                                                 a_h, obj_ap,
                                                                                                 obj_h,
                                                                                                 obj_pd,
                                                                                                 obj_pk,
                                                                                                 obj_sh, ~n.2
                                                            ) ▶₀ #t2.6 )
                                                qed
                                              qed
                                            qed
                                          qed
                                        next
                                          case case_2
                                          solve( (#vr.32 < #t2.9)  ∥ (#vr.32 = #t2.9) )
                                            case case_1
                                            solve( (#t2.7 < #t2.11)  ∥ (#t2.7 = #t2.11)  ∥ (#vr.73 < #t2.7) )
                                              case case_1
                                              by contradiction /* from formulas */
                                            next
                                              case case_2
                                              solve( Unlock_4( '4', ~n.2, 'device' ) @ #t2.8 )
                                                case unlockdevice_0_111111111111111111112111111111
                                                solve( state_111111111111111111112111111111( ~RouterID.1,
                                                                                             ~ServerID.1,
                                                                                             ~ak_h.1,
                                                                                             ~ak_sk.1,
                                                                                             ~ssk_nms.1, a_h,
                                                                                             a_sk, obj_ap,
                                                                                             obj_h, obj_pd,
                                                                                             obj_pk, obj_sh,
                                                                                             ~n.2
                                                       ) ▶₀ #t2.6 )
                                                  case outsignobjpkobjapask_0_11111111111111111111211111111
                                                  solve( (#t2.5 < #t2.15)  ∥ (#t2.5 = #t2.15) )
                                                    case case_1
                                                    by contradiction /* from formulas */
                                                  next
                                                    case case_2
                                                    solve( (#t2.8 < #t2.15)  ∥ (#t2.8 = #t2.15) )
                                                      case case_1
                                                      by contradiction /* from formulas */
                                                    next
                                                      case case_2
                                                      solve( (#vr.32 < #t2.13)  ∥ (#vr.32 = #t2.13) )
                                                        case case_1
                                                        solve( (#vr.40 < #t2.14)  ∥ (#vr.40 = #t2.14) )
                                                          case case_1
                                                          solve( (#t2.10 < #t2.14)  ∥ (#t2.10 = #t2.14) )
                                                            case case_1
                                                            by contradiction /* from formulas */
                                                          next
                                                            case case_2
                                                            solve( (#t2.9 < #t2.13)  ∥ (#t2.9 = #t2.13) )
                                                              case case_1
                                                              by contradiction /* from formulas */
                                                            next
                                                              case case_2
                                                              solve( TPM_SendCommand( <'TPM2_Create', 
                                                                                       <swstate, nil>, 
                                                                                       'TPM_CC_PolicyPCR', nil
                                                                                      >
                                                                     ) @ #t2.11 )
                                                                case eventTPMSendCommandTPMCreateswstatenilTPMCCPolicyPCRnil_0_11111111111112111
                                                                solve( state_11111111111112111( ~RouterID.1,
                                                                                                ~ServerID.1,
                                                                                                ~ak_h.1,
                                                                                                ~ak_sk.1,
                                                                                                ~ssk_nms.1,
                                                                                                ~tid.1
                                                                       ) ▶₀ #t2.7 )
                                                                  case outTPMPCRExtendswstate_0_1111111111111211
                                                                  solve( TPM_SendCommand( <'TPM2_Certify', 
                                                                                           k_sh, ~k_h, ~ak_h>
                                                                         ) @ #t2.11 )
                                                                    case eventTPMSendCommandTPMCertifytlsshtlshakh_0_111111111111121111111111111
                                                                    solve( state_111111111111121111111111111( ~RouterID.1,
                                                                                                              ~ServerID.1,
                                                                                                              ~ak_h,
                                                                                                              ~ak_sk.1,
                                                                                                              ~ssk_nms.1,
                                                                                                              ~tid.1,
                                                                                                              ~k_h,
                                                                                                              k_sh,
                                                                                                              tls_spk
                                                                           ) ▶₀ #t2.7 )
                                                                      case outTPMPolicyPCRtlssh_0_11111111111112111111111111
                                                                      solve( TPM_SendCommand( <'TPM2_Create', 
                                                                                               <swstate, nil
                                                                                               >, 
                                                                                               'TPM_CC_PolicyPCR', 
                                                                                               nil>
                                                                             ) @ #t2.11 )
                                                                        case eventTPMSendCommandTPMCreateswstatenilTPMCCPolicyPCRnil_0_11111111111112111
                                                                        solve( state_11111111111112111( ~RouterID.1,
                                                                                                        ~ServerID.1,
                                                                                                        ~ak_h.1,
                                                                                                        ~ak_sk.1,
                                                                                                        ~ssk_nms.1,
                                                                                                        ~tid.1
                                                                               ) ▶₀ #t2.7 )
                                                                          case outTPMPCRExtendswstate_0_1111111111111211
                                                                          solve( Insert( <'privatePart', ~k_h
                                                                                         >,
                                                                                         k_sk.1
                                                                                 ) @ #t2.2 )
                                                                            case insertprivatePartkhksk_0_111111111111111111111121111111
                                                                            solve( Insert( <'authPolicy', ~k_h
                                                                                           >,
                                                                                           k_ap
                                                                                   ) @ #t2.7 )
                                                                              case insertauthPolicyakhnil_0_11111111111111
                                                                              by solve( state_11111111111111( ~RouterID.1,
                                                                                                              ~ServerID.1,
                                                                                                              ~k_h,
                                                                                                              ~ak_sk.1,
                                                                                                              ~ssk_nms.1
                                                                                        ) ▶₀ #t2.7 )
                                                                            next
                                                                              case insertauthPolicykhauthPolicy_0_11111111111111111111112111111
                                                                              solve( state_11111111111111111111112111111( ~RouterID.1,
                                                                                                                          ~ServerID.1,
                                                                                                                          ~ak_h.1,
                                                                                                                          ~ak_sk.1,
                                                                                                                          ~k_h,
                                                                                                                          ~k_sk.1,
                                                                                                                          ~ssk_nms.1,
                                                                                                                          k_ap,
                                                                                                                          lock
                                                                                     ) ▶₀ #t2.7 )
                                                                                case lockdevice_0_1111111111111111111111211111
                                                                                by contradiction /* cyclic */
                                                                              qed
                                                                            qed
                                                                          qed
                                                                        qed
                                                                      qed
                                                                    qed
                                                                  qed
                                                                qed
                                                              qed
                                                            qed
                                                          qed
                                                        next
                                                          case case_2
                                                          by contradiction /* from formulas */
                                                        qed
                                                      next
                                                        case case_2
                                                        by contradiction /* from formulas */
                                                      qed
                                                    qed
                                                  qed
                                                qed
                                              next
                                                case unlockdevice_0_11111111111111111111211111112
                                                by solve( state_11111111111111111111211111112( ~RouterID.1,
                                                                                               ~ServerID.1,
                                                                                               ~ak_h.1,
                                                                                               ~ak_sk.1,
                                                                                               ~ssk_nms.1,
                                                                                               a_h, obj_ap,
                                                                                               obj_h, obj_pd,
                                                                                               obj_pk, obj_sh,
                                                                                               ~n.2
                                                          ) ▶₀ #t2.6 )
                                              qed
                                            next
                                              case case_3
                                              solve( Unlock_4( '4', ~n.2, 'device' ) @ #t2.8 )
                                                case unlockdevice_0_111111111111111111112111111111
                                                solve( state_111111111111111111112111111111( ~RouterID.1,
                                                                                             ~ServerID.1,
                                                                                             ~ak_h.1,
                                                                                             ~ak_sk.1,
                                                                                             ~ssk_nms.1, a_h,
                                                                                             a_sk, obj_ap,
                                                                                             obj_h, obj_pd,
                                                                                             obj_pk, obj_sh,
                                                                                             ~n.2
                                                       ) ▶₀ #t2.6 )
                                                  case outsignobjpkobjapask_0_11111111111111111111211111111
                                                  solve( (#t2.5 < #t2.16)  ∥ (#t2.5 = #t2.16) )
                                                    case case_1
                                                    by contradiction /* from formulas */
                                                  next
                                                    case case_2
                                                    solve( (#t2.11 < #t2.16)  ∥ (#t2.11 = #t2.16) )
                                                      case case_1
                                                      by contradiction /* from formulas */
                                                    next
                                                      case case_2
                                                      solve( (#vr.32 < #t2.14)  ∥ (#vr.32 = #t2.14) )
                                                        case case_1
                                                        solve( (#vr.40 < #t2.15)  ∥ (#vr.40 = #t2.15) )
                                                          case case_1
                                                          solve( (#t2.10 < #t2.15)  ∥ (#t2.10 = #t2.15) )
                                                            case case_1
                                                            by contradiction /* from formulas */
                                                          next
                                                            case case_2
                                                            solve( (#t2.9 < #t2.14)  ∥ (#t2.9 = #t2.14) )
                                                              case case_1
                                                              by contradiction /* from formulas */
                                                            next
                                                              case case_2
                                                              solve( TPM_SendCommand( <'TPM2_Create', 
                                                                                       <swstate, nil>, 
                                                                                       'TPM_CC_PolicyPCR', nil
                                                                                      >
                                                                     ) @ #t2.12 )
                                                                case eventTPMSendCommandTPMCreateswstatenilTPMCCPolicyPCRnil_0_11111111111112111
                                                                solve( state_11111111111112111( ~RouterID.1,
                                                                                                ~ServerID.1,
                                                                                                ~ak_h.1,
                                                                                                ~ak_sk.1,
                                                                                                ~ssk_nms.1,
                                                                                                ~tid.1
                                                                       ) ▶₀ #t2.7 )
                                                                  case outTPMPCRExtendswstate_0_1111111111111211
                                                                  solve( TPM_SendCommand( <'TPM2_Certify', 
                                                                                           k_sh, ~k_h, ~ak_h>
                                                                         ) @ #t2.12 )
                                                                    case eventTPMSendCommandTPMCertifytlsshtlshakh_0_111111111111121111111111111
                                                                    solve( state_111111111111121111111111111( ~RouterID.1,
                                                                                                              ~ServerID.1,
                                                                                                              ~ak_h,
                                                                                                              ~ak_sk.1,
                                                                                                              ~ssk_nms.1,
                                                                                                              ~tid.1,
                                                                                                              ~k_h,
                                                                                                              k_sh,
                                                                                                              tls_spk
                                                                           ) ▶₀ #t2.7 )
                                                                      case outTPMPolicyPCRtlssh_0_11111111111112111111111111
                                                                      solve( TPM_SendCommand( <'TPM2_Create', 
                                                                                               <swstate, nil
                                                                                               >, 
                                                                                               'TPM_CC_PolicyPCR', 
                                                                                               nil>
                                                                             ) @ #t2.12 )
                                                                        case eventTPMSendCommandTPMCreateswstatenilTPMCCPolicyPCRnil_0_11111111111112111
                                                                        solve( state_11111111111112111( ~RouterID.1,
                                                                                                        ~ServerID.1,
                                                                                                        ~ak_h.1,
                                                                                                        ~ak_sk.1,
                                                                                                        ~ssk_nms.1,
                                                                                                        ~tid.1
                                                                               ) ▶₀ #t2.7 )
                                                                          case outTPMPCRExtendswstate_0_1111111111111211
                                                                          solve( Insert( <'privatePart', ~k_h
                                                                                         >,
                                                                                         k_sk.1
                                                                                 ) @ #t2.2 )
                                                                            case insertprivatePartkhksk_0_111111111111111111111121111111
                                                                            solve( Insert( <'authPolicy', ~k_h
                                                                                           >,
                                                                                           k_ap
                                                                                   ) @ #t2.7 )
                                                                              case insertauthPolicyakhnil_0_11111111111111
                                                                              by solve( state_11111111111111( ~RouterID.1,
                                                                                                              ~ServerID.1,
                                                                                                              ~k_h,
                                                                                                              ~ak_sk.1,
                                                                                                              ~ssk_nms.1
                                                                                        ) ▶₀ #t2.7 )
                                                                            next
                                                                              case insertauthPolicykhauthPolicy_0_11111111111111111111112111111
                                                                              solve( state_11111111111111111111112111111( ~RouterID.1,
                                                                                                                          ~ServerID.1,
                                                                                                                          ~ak_h.1,
                                                                                                                          ~ak_sk.1,
                                                                                                                          ~k_h,
                                                                                                                          ~k_sk.1,
                                                                                                                          ~ssk_nms.1,
                                                                                                                          k_ap,
                                                                                                                          lock
                                                                                     ) ▶₀ #t2.7 )
                                                                                case lockdevice_0_1111111111111111111111211111
                                                                                by contradiction /* cyclic */
                                                                              qed
                                                                            qed
                                                                          qed
                                                                        qed
                                                                      qed
                                                                    qed
                                                                  qed
                                                                qed
                                                              qed
                                                            qed
                                                          qed
                                                        next
                                                          case case_2
                                                          by contradiction /* from formulas */
                                                        qed
                                                      next
                                                        case case_2
                                                        by contradiction /* from formulas */
                                                      qed
                                                    qed
                                                  qed
                                                qed
                                              next
                                                case unlockdevice_0_11111111111111111111211111112
                                                by solve( state_11111111111111111111211111112( ~RouterID.1,
                                                                                               ~ServerID.1,
                                                                                               ~ak_h.1,
                                                                                               ~ak_sk.1,
                                                                                               ~ssk_nms.1,
                                                                                               a_h, obj_ap,
                                                                                               obj_h, obj_pd,
                                                                                               obj_pk, obj_sh,
                                                                                               ~n.2
                                                          ) ▶₀ #t2.6 )
                                              qed
                                            qed
                                          next
                                            case case_2
                                            solve( (#t2.8 < #t2.11)  ∥ (#t2.8 = #t2.11)  ∥ (#vr.72 < #t2.8) )
                                              case case_1
                                              by contradiction /* from formulas */
                                            next
                                              case case_2
                                              solve( Unlock_4( '4', ~n.2, 'device' ) @ #t2.9 )
                                                case unlockdevice_0_111111111111111111112111111111
                                                solve( state_111111111111111111112111111111( ~RouterID.1,
                                                                                             ~ServerID.1,
                                                                                             ~ak_h.1,
                                                                                             ~ak_sk.1,
                                                                                             ~ssk_nms.1, a_h,
                                                                                             a_sk, obj_ap,
                                                                                             obj_h, obj_pd,
                                                                                             obj_pk, obj_sh,
                                                                                             ~n.2
                                                       ) ▶₀ #t2.7 )
                                                  case outsignobjpkobjapask_0_11111111111111111111211111111
                                                  solve( (#t2.5 < #t2.15)  ∥ (#t2.5 = #t2.15) )
                                                    case case_1
                                                    by contradiction /* from formulas */
                                                  next
                                                    case case_2
                                                    solve( (#t2.6 < #t2.13)  ∥ (#t2.6 = #t2.13) )
                                                      case case_1
                                                      by contradiction /* from formulas */
                                                    next
                                                      case case_2
                                                      solve( (#t2.9 < #t2.14)  ∥ (#t2.9 = #t2.14) )
                                                        case case_1
                                                        by contradiction /* from formulas */
                                                      next
                                                        case case_2
                                                        solve( (#vr.39 < #t2.13)  ∥ (#vr.39 = #t2.13) )
                                                          case case_1
                                                          solve( (#t2.10 < #t2.13)  ∥ (#t2.10 = #t2.13) )
                                                            case case_1
                                                            by contradiction /* from formulas */
                                                          next
                                                            case case_2
                                                            solve( TPM_SendCommand( <'TPM2_Create', 
                                                                                     <swstate, nil>, 
                                                                                     'TPM_CC_PolicyPCR', nil>
                                                                   ) @ #t2.11 )
                                                              case eventTPMSendCommandTPMCreateswstatenilTPMCCPolicyPCRnil_0_11111111111112111
                                                              solve( state_11111111111112111( ~RouterID.1,
                                                                                              ~ServerID.1,
                                                                                              ~ak_h.1,
                                                                                              ~ak_sk.1,
                                                                                              ~ssk_nms.1,
                                                                                              ~tid.1
                                                                     ) ▶₀ #t2.8 )
                                                                case outTPMPCRExtendswstate_0_1111111111111211
                                                                solve( TPM_SendCommand( <'TPM2_Certify', 
                                                                                         k_sh, ~k_h, ~ak_h>
                                                                       ) @ #t2.11 )
                                                                  case eventTPMSendCommandTPMCertifytlsshtlshakh_0_111111111111121111111111111
                                                                  solve( state_111111111111121111111111111( ~RouterID.1,
                                                                                                            ~ServerID.1,
                                                                                                            ~ak_h,
                                                                                                            ~ak_sk.1,
                                                                                                            ~ssk_nms.1,
                                                                                                            ~tid.1,
                                                                                                            ~k_h,
                                                                                                            k_sh,
                                                                                                            tls_spk
                                                                         ) ▶₀ #t2.8 )
                                                                    case outTPMPolicyPCRtlssh_0_11111111111112111111111111
                                                                    solve( TPM_SendCommand( <'TPM2_Create', 
                                                                                             <swstate, nil>, 
                                                                                             'TPM_CC_PolicyPCR', 
                                                                                             nil>
                                                                           ) @ #t2.11 )
                                                                      case eventTPMSendCommandTPMCreateswstatenilTPMCCPolicyPCRnil_0_11111111111112111
                                                                      solve( state_11111111111112111( ~RouterID.1,
                                                                                                      ~ServerID.1,
                                                                                                      ~ak_h.1,
                                                                                                      ~ak_sk.1,
                                                                                                      ~ssk_nms.1,
                                                                                                      ~tid.1
                                                                             ) ▶₀ #t2.8 )
                                                                        case outTPMPCRExtendswstate_0_1111111111111211
                                                                        solve( Insert( <'privatePart', ~k_h>,
                                                                                       k_sk.1
                                                                               ) @ #t2.2 )
                                                                          case insertprivatePartkhksk_0_111111111111111111111121111111
                                                                          solve( Insert( <'authPolicy', ~k_h>,
                                                                                         k_ap
                                                                                 ) @ #t2.8 )
                                                                            case insertauthPolicyakhnil_0_11111111111111
                                                                            by solve( state_11111111111111( ~RouterID.1,
                                                                                                            ~ServerID.1,
                                                                                                            ~k_h,
                                                                                                            ~ak_sk.1,
                                                                                                            ~ssk_nms.1
                                                                                      ) ▶₀ #t2.8 )
                                                                          next
                                                                            case insertauthPolicykhauthPolicy_0_11111111111111111111112111111
                                                                            solve( state_11111111111111111111112111111( ~RouterID.1,
                                                                                                                        ~ServerID.1,
                                                                                                                        ~ak_h.1,
                                                                                                                        ~ak_sk.1,
                                                                                                                        ~k_h,
                                                                                                                        ~k_sk.1,
                                                                                                                        ~ssk_nms.1,
                                                                                                                        k_ap,
                                                                                                                        lock
                                                                                   ) ▶₀ #t2.8 )
                                                                              case lockdevice_0_1111111111111111111111211111
                                                                              by contradiction /* cyclic */
                                                                            qed
                                                                          qed
                                                                        qed
                                                                      qed
                                                                    qed
                                                                  qed
                                                                qed
                                                              qed
                                                            qed
                                                          qed
                                                        next
                                                          case case_2
                                                          by contradiction /* from formulas */
                                                        qed
                                                      qed
                                                    qed
                                                  qed
                                                qed
                                              next
                                                case unlockdevice_0_11111111111111111111211111112
                                                by solve( state_11111111111111111111211111112( ~RouterID.1,
                                                                                               ~ServerID.1,
                                                                                               ~ak_h.1,
                                                                                               ~ak_sk.1,
                                                                                               ~ssk_nms.1,
                                                                                               a_h, obj_ap,
                                                                                               obj_h, obj_pd,
                                                                                               obj_pk, obj_sh,
                                                                                               ~n.2
                                                          ) ▶₀ #t2.7 )
                                              qed
                                            next
                                              case case_3
                                              solve( Unlock_4( '4', ~n.2, 'device' ) @ #t2.9 )
                                                case unlockdevice_0_111111111111111111112111111111
                                                solve( state_111111111111111111112111111111( ~RouterID.1,
                                                                                             ~ServerID.1,
                                                                                             ~ak_h.1,
                                                                                             ~ak_sk.1,
                                                                                             ~ssk_nms.1, a_h,
                                                                                             a_sk, obj_ap,
                                                                                             obj_h, obj_pd,
                                                                                             obj_pk, obj_sh,
                                                                                             ~n.2
                                                       ) ▶₀ #t2.7 )
                                                  case outsignobjpkobjapask_0_11111111111111111111211111111
                                                  solve( (#t2.5 < #t2.16)  ∥ (#t2.5 = #t2.16) )
                                                    case case_1
                                                    by contradiction /* from formulas */
                                                  next
                                                    case case_2
                                                    solve( (#t2.6 < #t2.14)  ∥ (#t2.6 = #t2.14) )
                                                      case case_1
                                                      by contradiction /* from formulas */
                                                    next
                                                      case case_2
                                                      solve( (#t2.11 < #t2.15)  ∥ (#t2.11 = #t2.15) )
                                                        case case_1
                                                        by contradiction /* from formulas */
                                                      next
                                                        case case_2
                                                        solve( (#vr.39 < #t2.14)  ∥ (#vr.39 = #t2.14) )
                                                          case case_1
                                                          solve( (#t2.10 < #t2.14)  ∥ (#t2.10 = #t2.14) )
                                                            case case_1
                                                            by contradiction /* from formulas */
                                                          next
                                                            case case_2
                                                            solve( TPM_SendCommand( <'TPM2_Create', 
                                                                                     <swstate, nil>, 
                                                                                     'TPM_CC_PolicyPCR', nil>
                                                                   ) @ #t2.12 )
                                                              case eventTPMSendCommandTPMCreateswstatenilTPMCCPolicyPCRnil_0_11111111111112111
                                                              solve( state_11111111111112111( ~RouterID.1,
                                                                                              ~ServerID.1,
                                                                                              ~ak_h.1,
                                                                                              ~ak_sk.1,
                                                                                              ~ssk_nms.1,
                                                                                              ~tid.1
                                                                     ) ▶₀ #t2.8 )
                                                                case outTPMPCRExtendswstate_0_1111111111111211
                                                                solve( TPM_SendCommand( <'TPM2_Certify', 
                                                                                         k_sh, ~k_h, ~ak_h>
                                                                       ) @ #t2.12 )
                                                                  case eventTPMSendCommandTPMCertifytlsshtlshakh_0_111111111111121111111111111
                                                                  solve( state_111111111111121111111111111( ~RouterID.1,
                                                                                                            ~ServerID.1,
                                                                                                            ~ak_h,
                                                                                                            ~ak_sk.1,
                                                                                                            ~ssk_nms.1,
                                                                                                            ~tid.1,
                                                                                                            ~k_h,
                                                                                                            k_sh,
                                                                                                            tls_spk
                                                                         ) ▶₀ #t2.8 )
                                                                    case outTPMPolicyPCRtlssh_0_11111111111112111111111111
                                                                    solve( TPM_SendCommand( <'TPM2_Create', 
                                                                                             <swstate, nil>, 
                                                                                             'TPM_CC_PolicyPCR', 
                                                                                             nil>
                                                                           ) @ #t2.12 )
                                                                      case eventTPMSendCommandTPMCreateswstatenilTPMCCPolicyPCRnil_0_11111111111112111
                                                                      solve( state_11111111111112111( ~RouterID.1,
                                                                                                      ~ServerID.1,
                                                                                                      ~ak_h.1,
                                                                                                      ~ak_sk.1,
                                                                                                      ~ssk_nms.1,
                                                                                                      ~tid.1
                                                                             ) ▶₀ #t2.8 )
                                                                        case outTPMPCRExtendswstate_0_1111111111111211
                                                                        solve( Insert( <'privatePart', ~k_h>,
                                                                                       k_sk.1
                                                                               ) @ #t2.2 )
                                                                          case insertprivatePartkhksk_0_111111111111111111111121111111
                                                                          solve( Insert( <'authPolicy', ~k_h>,
                                                                                         k_ap
                                                                                 ) @ #t2.8 )
                                                                            case insertauthPolicyakhnil_0_11111111111111
                                                                            by solve( state_11111111111111( ~RouterID.1,
                                                                                                            ~ServerID.1,
                                                                                                            ~k_h,
                                                                                                            ~ak_sk.1,
                                                                                                            ~ssk_nms.1
                                                                                      ) ▶₀ #t2.8 )
                                                                          next
                                                                            case insertauthPolicykhauthPolicy_0_11111111111111111111112111111
                                                                            solve( state_11111111111111111111112111111( ~RouterID.1,
                                                                                                                        ~ServerID.1,
                                                                                                                        ~ak_h.1,
                                                                                                                        ~ak_sk.1,
                                                                                                                        ~k_h,
                                                                                                                        ~k_sk.1,
                                                                                                                        ~ssk_nms.1,
                                                                                                                        k_ap,
                                                                                                                        lock
                                                                                   ) ▶₀ #t2.8 )
                                                                              case lockdevice_0_1111111111111111111111211111
                                                                              by contradiction /* cyclic */
                                                                            qed
                                                                          qed
                                                                        qed
                                                                      qed
                                                                    qed
                                                                  qed
                                                                qed
                                                              qed
                                                            qed
                                                          qed
                                                        next
                                                          case case_2
                                                          by contradiction /* from formulas */
                                                        qed
                                                      qed
                                                    qed
                                                  qed
                                                qed
                                              next
                                                case unlockdevice_0_11111111111111111111211111112
                                                by solve( state_11111111111111111111211111112( ~RouterID.1,
                                                                                               ~ServerID.1,
                                                                                               ~ak_h.1,
                                                                                               ~ak_sk.1,
                                                                                               ~ssk_nms.1,
                                                                                               a_h, obj_ap,
                                                                                               obj_h, obj_pd,
                                                                                               obj_pk, obj_sh,
                                                                                               ~n.2
                                                          ) ▶₀ #t2.7 )
                                              qed
                                            qed
                                          qed
                                        qed
                                      next
                                        case case_2
                                        solve( (#vr.44 < #t2.10)  ∥ (#vr.44 = #t2.10) )
                                          case case_1
                                          solve( (#vr.32 < #t2.9)  ∥ (#vr.32 = #t2.9) )
                                            case case_1
                                            solve( (#t2.6 < #t2.10)  ∥ (#t2.6 = #t2.10)  ∥ (#vr.72 < #t2.6) )
                                              case case_1
                                              by contradiction /* from formulas */
                                            next
                                              case case_2
                                              solve( (#t2.7 < #t2.10)  ∥ (#t2.7 = #t2.10)  ∥
                                                     (#vr.73 < #t2.7) )
                                                case case_1
                                                by contradiction /* from formulas */
                                              next
                                                case case_2
                                                solve( Unlock_4( '4', ~n.2, 'device' ) @ #t2.8 )
                                                  case unlockdevice_0_111111111111111111112111111111
                                                  solve( state_111111111111111111112111111111( ~RouterID.1,
                                                                                               ~ServerID.1,
                                                                                               ~ak_h.1,
                                                                                               ~ak_sk.1,
                                                                                               ~ssk_nms.1,
                                                                                               a_h, a_sk,
                                                                                               obj_ap, obj_h,
                                                                                               obj_pd, obj_pk,
                                                                                               obj_sh, ~n.2
                                                         ) ▶₀ #t2.6 )
                                                    case outsignobjpkobjapask_0_11111111111111111111211111111
                                                    solve( (#t2.5 < #t2.13)  ∥ (#t2.5 = #t2.13) )
                                                      case case_1
                                                      by contradiction /* from formulas */
                                                    next
                                                      case case_2
                                                      solve( (#t2.8 < #t2.14)  ∥ (#t2.8 = #t2.14) )
                                                        case case_1
                                                        by contradiction /* from formulas */
                                                      next
                                                        case case_2
                                                        solve( (#vr.32 < #t2.12)  ∥ (#vr.32 = #t2.12) )
                                                          case case_1
                                                          solve( (#vr.44 < #t2.13)  ∥ (#vr.44 = #t2.13) )
                                                            case case_1
                                                            solve( (#t2.13 < #t2.7)  ∥ (#t2.13 = #t2.7) )
                                                              case case_1
                                                              by contradiction /* from formulas */
                                                            next
                                                              case case_2
                                                              solve( (#t2.9 < #t2.12)  ∥ (#t2.9 = #t2.12) )
                                                                case case_1
                                                                by contradiction /* from formulas */
                                                              next
                                                                case case_2
                                                                solve( TPM_SendCommand( <'TPM2_Create', 
                                                                                         <swstate, nil>, 
                                                                                         'TPM_CC_PolicyPCR', 
                                                                                         nil>
                                                                       ) @ #t2.10 )
                                                                  case eventTPMSendCommandTPMCreateswstatenilTPMCCPolicyPCRnil_0_11111111111112111
                                                                  solve( state_11111111111112111( ~RouterID.1,
                                                                                                  ~ServerID.1,
                                                                                                  ~ak_h.1,
                                                                                                  ~ak_sk.1,
                                                                                                  ~ssk_nms.1,
                                                                                                  ~tid.1
                                                                         ) ▶₀ #t2.7 )
                                                                    case outTPMPCRExtendswstate_0_1111111111111211
                                                                    solve( TPM_SendCommand( <'TPM2_Certify', 
                                                                                             k_sh, ~k_h, ~ak_h
                                                                                            >
                                                                           ) @ #t2.10 )
                                                                      case eventTPMSendCommandTPMCertifytlsshtlshakh_0_111111111111121111111111111
                                                                      solve( state_111111111111121111111111111( ~RouterID.1,
                                                                                                                ~ServerID.1,
                                                                                                                ~ak_h,
                                                                                                                ~ak_sk.1,
                                                                                                                ~ssk_nms.1,
                                                                                                                ~tid.1,
                                                                                                                ~k_h,
                                                                                                                k_sh,
                                                                                                                tls_spk
                                                                             ) ▶₀ #t2.7 )
                                                                        case outTPMPolicyPCRtlssh_0_11111111111112111111111111
                                                                        solve( TPM_SendCommand( <
                                                                                                 'TPM2_Create', 
                                                                                                 <swstate, nil
                                                                                                 >, 
                                                                                                 'TPM_CC_PolicyPCR', 
                                                                                                 nil>
                                                                               ) @ #t2.10 )
                                                                          case eventTPMSendCommandTPMCreateswstatenilTPMCCPolicyPCRnil_0_11111111111112111
                                                                          solve( state_11111111111112111( ~RouterID.1,
                                                                                                          ~ServerID.1,
                                                                                                          ~ak_h.1,
                                                                                                          ~ak_sk.1,
                                                                                                          ~ssk_nms.1,
                                                                                                          ~tid.1
                                                                                 ) ▶₀ #t2.7 )
                                                                            case outTPMPCRExtendswstate_0_1111111111111211
                                                                            solve( Insert( <'privatePart', 
                                                                                            ~k_h>,
                                                                                           k_sk.1
                                                                                   ) @ #t2.2 )
                                                                              case insertprivatePartkhksk_0_111111111111111111111121111111
                                                                              solve( Insert( <'authPolicy', 
                                                                                              ~k_h>,
                                                                                             k_ap
                                                                                     ) @ #t2.7 )
                                                                                case insertauthPolicyakhnil_0_11111111111111
                                                                                by solve( state_11111111111111( ~RouterID.1,
                                                                                                                ~ServerID.1,
                                                                                                                ~k_h,
                                                                                                                ~ak_sk.1,
                                                                                                                ~ssk_nms.1
                                                                                          ) ▶₀ #t2.7 )
                                                                              next
                                                                                case insertauthPolicykhauthPolicy_0_11111111111111111111112111111
                                                                                solve( state_11111111111111111111112111111( ~RouterID.1,
                                                                                                                            ~ServerID.1,
                                                                                                                            ~ak_h.1,
                                                                                                                            ~ak_sk.1,
                                                                                                                            ~k_h,
                                                                                                                            ~k_sk.1,
                                                                                                                            ~ssk_nms.1,
                                                                                                                            k_ap,
                                                                                                                            lock
                                                                                       ) ▶₀ #t2.7 )
                                                                                  case lockdevice_0_1111111111111111111111211111
                                                                                  by contradiction
                                                                                     /* cyclic */
                                                                                qed
                                                                              qed
                                                                            qed
                                                                          qed
                                                                        qed
                                                                      qed
                                                                    qed
                                                                  qed
                                                                qed
                                                              qed
                                                            qed
                                                          next
                                                            case case_2
                                                            by contradiction /* from formulas */
                                                          qed
                                                        next
                                                          case case_2
                                                          by contradiction /* from formulas */
                                                        qed
                                                      qed
                                                    qed
                                                  qed
                                                next
                                                  case unlockdevice_0_11111111111111111111211111112
                                                  by solve( state_11111111111111111111211111112( ~RouterID.1,
                                                                                                 ~ServerID.1,
                                                                                                 ~ak_h.1,
                                                                                                 ~ak_sk.1,
                                                                                                 ~ssk_nms.1,
                                                                                                 a_h, obj_ap,
                                                                                                 obj_h,
                                                                                                 obj_pd,
                                                                                                 obj_pk,
                                                                                                 obj_sh, ~n.2
                                                            ) ▶₀ #t2.6 )
                                                qed
                                              next
                                                case case_3
                                                solve( Unlock_4( '4', ~n.2, 'device' ) @ #t2.8 )
                                                  case unlockdevice_0_111111111111111111112111111111
                                                  solve( state_111111111111111111112111111111( ~RouterID.1,
                                                                                               ~ServerID.1,
                                                                                               ~ak_h.1,
                                                                                               ~ak_sk.1,
                                                                                               ~ssk_nms.1,
                                                                                               a_h, a_sk,
                                                                                               obj_ap, obj_h,
                                                                                               obj_pd, obj_pk,
                                                                                               obj_sh, ~n.2
                                                         ) ▶₀ #t2.6 )
                                                    case outsignobjpkobjapask_0_11111111111111111111211111111
                                                    solve( (#t2.5 < #t2.14)  ∥ (#t2.5 = #t2.14) )
                                                      case case_1
                                                      by contradiction /* from formulas */
                                                    next
                                                      case case_2
                                                      solve( (#t2.10 < #t2.15)  ∥ (#t2.10 = #t2.15) )
                                                        case case_1
                                                        by contradiction /* from formulas */
                                                      next
                                                        case case_2
                                                        solve( (#vr.32 < #t2.13)  ∥ (#vr.32 = #t2.13) )
                                                          case case_1
                                                          solve( (#vr.44 < #t2.14)  ∥ (#vr.44 = #t2.14) )
                                                            case case_1
                                                            solve( (#t2.14 < #t2.7)  ∥ (#t2.14 = #t2.7) )
                                                              case case_1
                                                              by contradiction /* from formulas */
                                                            next
                                                              case case_2
                                                              solve( (#t2.9 < #t2.13)  ∥ (#t2.9 = #t2.13) )
                                                                case case_1
                                                                by contradiction /* from formulas */
                                                              next
                                                                case case_2
                                                                solve( TPM_SendCommand( <'TPM2_Create', 
                                                                                         <swstate, nil>, 
                                                                                         'TPM_CC_PolicyPCR', 
                                                                                         nil>
                                                                       ) @ #t2.11 )
                                                                  case eventTPMSendCommandTPMCreateswstatenilTPMCCPolicyPCRnil_0_11111111111112111
                                                                  solve( state_11111111111112111( ~RouterID.1,
                                                                                                  ~ServerID.1,
                                                                                                  ~ak_h.1,
                                                                                                  ~ak_sk.1,
                                                                                                  ~ssk_nms.1,
                                                                                                  ~tid.1
                                                                         ) ▶₀ #t2.7 )
                                                                    case outTPMPCRExtendswstate_0_1111111111111211
                                                                    solve( TPM_SendCommand( <'TPM2_Certify', 
                                                                                             k_sh, ~k_h, ~ak_h
                                                                                            >
                                                                           ) @ #t2.11 )
                                                                      case eventTPMSendCommandTPMCertifytlsshtlshakh_0_111111111111121111111111111
                                                                      solve( state_111111111111121111111111111( ~RouterID.1,
                                                                                                                ~ServerID.1,
                                                                                                                ~ak_h,
                                                                                                                ~ak_sk.1,
                                                                                                                ~ssk_nms.1,
                                                                                                                ~tid.1,
                                                                                                                ~k_h,
                                                                                                                k_sh,
                                                                                                                tls_spk
                                                                             ) ▶₀ #t2.7 )
                                                                        case outTPMPolicyPCRtlssh_0_11111111111112111111111111
                                                                        solve( TPM_SendCommand( <
                                                                                                 'TPM2_Create', 
                                                                                                 <swstate, nil
                                                                                                 >, 
                                                                                                 'TPM_CC_PolicyPCR', 
                                                                                                 nil>
                                                                               ) @ #t2.11 )
                                                                          case eventTPMSendCommandTPMCreateswstatenilTPMCCPolicyPCRnil_0_11111111111112111
                                                                          solve( state_11111111111112111( ~RouterID.1,
                                                                                                          ~ServerID.1,
                                                                                                          ~ak_h.1,
                                                                                                          ~ak_sk.1,
                                                                                                          ~ssk_nms.1,
                                                                                                          ~tid.1
                                                                                 ) ▶₀ #t2.7 )
                                                                            case outTPMPCRExtendswstate_0_1111111111111211
                                                                            solve( Insert( <'privatePart', 
                                                                                            ~k_h>,
                                                                                           k_sk.1
                                                                                   ) @ #t2.2 )
                                                                              case insertprivatePartkhksk_0_111111111111111111111121111111
                                                                              solve( Insert( <'authPolicy', 
                                                                                              ~k_h>,
                                                                                             k_ap
                                                                                     ) @ #t2.7 )
                                                                                case insertauthPolicyakhnil_0_11111111111111
                                                                                by solve( state_11111111111111( ~RouterID.1,
                                                                                                                ~ServerID.1,
                                                                                                                ~k_h,
                                                                                                                ~ak_sk.1,
                                                                                                                ~ssk_nms.1
                                                                                          ) ▶₀ #t2.7 )
                                                                              next
                                                                                case insertauthPolicykhauthPolicy_0_11111111111111111111112111111
                                                                                solve( state_11111111111111111111112111111( ~RouterID.1,
                                                                                                                            ~ServerID.1,
                                                                                                                            ~ak_h.1,
                                                                                                                            ~ak_sk.1,
                                                                                                                            ~k_h,
                                                                                                                            ~k_sk.1,
                                                                                                                            ~ssk_nms.1,
                                                                                                                            k_ap,
                                                                                                                            lock
                                                                                       ) ▶₀ #t2.7 )
                                                                                  case lockdevice_0_1111111111111111111111211111
                                                                                  by contradiction
                                                                                     /* cyclic */
                                                                                qed
                                                                              qed
                                                                            qed
                                                                          qed
                                                                        qed
                                                                      qed
                                                                    qed
                                                                  qed
                                                                qed
                                                              qed
                                                            qed
                                                          next
                                                            case case_2
                                                            by contradiction /* from formulas */
                                                          qed
                                                        next
                                                          case case_2
                                                          by contradiction /* from formulas */
                                                        qed
                                                      qed
                                                    qed
                                                  qed
                                                next
                                                  case unlockdevice_0_11111111111111111111211111112
                                                  by solve( state_11111111111111111111211111112( ~RouterID.1,
                                                                                                 ~ServerID.1,
                                                                                                 ~ak_h.1,
                                                                                                 ~ak_sk.1,
                                                                                                 ~ssk_nms.1,
                                                                                                 a_h, obj_ap,
                                                                                                 obj_h,
                                                                                                 obj_pd,
                                                                                                 obj_pk,
                                                                                                 obj_sh, ~n.2
                                                            ) ▶₀ #t2.6 )
                                                qed
                                              qed
                                            next
                                              case case_3
                                              solve( (#t2.7 < #t2.11)  ∥ (#t2.7 = #t2.11)  ∥
                                                     (#vr.73 < #t2.7) )
                                                case case_1
                                                by contradiction /* from formulas */
                                              next
                                                case case_2
                                                solve( Unlock_4( '4', ~n.2, 'device' ) @ #t2.8 )
                                                  case unlockdevice_0_111111111111111111112111111111
                                                  solve( state_111111111111111111112111111111( ~RouterID.1,
                                                                                               ~ServerID.1,
                                                                                               ~ak_h.1,
                                                                                               ~ak_sk.1,
                                                                                               ~ssk_nms.1,
                                                                                               a_h, a_sk,
                                                                                               obj_ap, obj_h,
                                                                                               obj_pd, obj_pk,
                                                                                               obj_sh, ~n.2
                                                         ) ▶₀ #t2.6 )
                                                    case outsignobjpkobjapask_0_11111111111111111111211111111
                                                    solve( (#t2.5 < #t2.14)  ∥ (#t2.5 = #t2.14) )
                                                      case case_1
                                                      by contradiction /* from formulas */
                                                    next
                                                      case case_2
                                                      solve( (#t2.8 < #t2.15)  ∥ (#t2.8 = #t2.15) )
                                                        case case_1
                                                        by contradiction /* from formulas */
                                                      next
                                                        case case_2
                                                        solve( (#vr.32 < #t2.13)  ∥ (#vr.32 = #t2.13) )
                                                          case case_1
                                                          solve( (#vr.44 < #t2.14)  ∥ (#vr.44 = #t2.14) )
                                                            case case_1
                                                            solve( (#t2.10 < #t2.14)  ∥ (#t2.10 = #t2.14) )
                                                              case case_1
                                                              by contradiction /* from formulas */
                                                            next
                                                              case case_2
                                                              solve( (#t2.9 < #t2.13)  ∥ (#t2.9 = #t2.13) )
                                                                case case_1
                                                                by contradiction /* from formulas */
                                                              next
                                                                case case_2
                                                                solve( TPM_SendCommand( <'TPM2_Create', 
                                                                                         <swstate, nil>, 
                                                                                         'TPM_CC_PolicyPCR', 
                                                                                         nil>
                                                                       ) @ #t2.11 )
                                                                  case eventTPMSendCommandTPMCreateswstatenilTPMCCPolicyPCRnil_0_11111111111112111
                                                                  solve( state_11111111111112111( ~RouterID.1,
                                                                                                  ~ServerID.1,
                                                                                                  ~ak_h.1,
                                                                                                  ~ak_sk.1,
                                                                                                  ~ssk_nms.1,
                                                                                                  ~tid.1
                                                                         ) ▶₀ #t2.7 )
                                                                    case outTPMPCRExtendswstate_0_1111111111111211
                                                                    solve( TPM_SendCommand( <'TPM2_Certify', 
                                                                                             k_sh, ~k_h, ~ak_h
                                                                                            >
                                                                           ) @ #t2.11 )
                                                                      case eventTPMSendCommandTPMCertifytlsshtlshakh_0_111111111111121111111111111
                                                                      solve( state_111111111111121111111111111( ~RouterID.1,
                                                                                                                ~ServerID.1,
                                                                                                                ~ak_h,
                                                                                                                ~ak_sk.1,
                                                                                                                ~ssk_nms.1,
                                                                                                                ~tid.1,
                                                                                                                ~k_h,
                                                                                                                k_sh,
                                                                                                                tls_spk
                                                                             ) ▶₀ #t2.7 )
                                                                        case outTPMPolicyPCRtlssh_0_11111111111112111111111111
                                                                        solve( TPM_SendCommand( <
                                                                                                 'TPM2_Create', 
                                                                                                 <swstate, nil
                                                                                                 >, 
                                                                                                 'TPM_CC_PolicyPCR', 
                                                                                                 nil>
                                                                               ) @ #t2.11 )
                                                                          case eventTPMSendCommandTPMCreateswstatenilTPMCCPolicyPCRnil_0_11111111111112111
                                                                          solve( state_11111111111112111( ~RouterID.1,
                                                                                                          ~ServerID.1,
                                                                                                          ~ak_h.1,
                                                                                                          ~ak_sk.1,
                                                                                                          ~ssk_nms.1,
                                                                                                          ~tid.1
                                                                                 ) ▶₀ #t2.7 )
                                                                            case outTPMPCRExtendswstate_0_1111111111111211
                                                                            solve( Insert( <'privatePart', 
                                                                                            ~k_h>,
                                                                                           k_sk.1
                                                                                   ) @ #t2.2 )
                                                                              case insertprivatePartkhksk_0_111111111111111111111121111111
                                                                              solve( Insert( <'authPolicy', 
                                                                                              ~k_h>,
                                                                                             k_ap
                                                                                     ) @ #t2.7 )
                                                                                case insertauthPolicyakhnil_0_11111111111111
                                                                                by solve( state_11111111111111( ~RouterID.1,
                                                                                                                ~ServerID.1,
                                                                                                                ~k_h,
                                                                                                                ~ak_sk.1,
                                                                                                                ~ssk_nms.1
                                                                                          ) ▶₀ #t2.7 )
                                                                              next
                                                                                case insertauthPolicykhauthPolicy_0_11111111111111111111112111111
                                                                                solve( state_11111111111111111111112111111( ~RouterID.1,
                                                                                                                            ~ServerID.1,
                                                                                                                            ~ak_h.1,
                                                                                                                            ~ak_sk.1,
                                                                                                                            ~k_h,
                                                                                                                            ~k_sk.1,
                                                                                                                            ~ssk_nms.1,
                                                                                                                            k_ap,
                                                                                                                            lock
                                                                                       ) ▶₀ #t2.7 )
                                                                                  case lockdevice_0_1111111111111111111111211111
                                                                                  by contradiction
                                                                                     /* cyclic */
                                                                                qed
                                                                              qed
                                                                            qed
                                                                          qed
                                                                        qed
                                                                      qed
                                                                    qed
                                                                  qed
                                                                qed
                                                              qed
                                                            qed
                                                          next
                                                            case case_2
                                                            by contradiction /* from formulas */
                                                          qed
                                                        next
                                                          case case_2
                                                          by contradiction /* from formulas */
                                                        qed
                                                      qed
                                                    qed
                                                  qed
                                                next
                                                  case unlockdevice_0_11111111111111111111211111112
                                                  by solve( state_11111111111111111111211111112( ~RouterID.1,
                                                                                                 ~ServerID.1,
                                                                                                 ~ak_h.1,
                                                                                                 ~ak_sk.1,
                                                                                                 ~ssk_nms.1,
                                                                                                 a_h, obj_ap,
                                                                                                 obj_h,
                                                                                                 obj_pd,
                                                                                                 obj_pk,
                                                                                                 obj_sh, ~n.2
                                                            ) ▶₀ #t2.6 )
                                                qed
                                              next
                                                case case_3
                                                solve( Unlock_4( '4', ~n.2, 'device' ) @ #t2.8 )
                                                  case unlockdevice_0_111111111111111111112111111111
                                                  solve( state_111111111111111111112111111111( ~RouterID.1,
                                                                                               ~ServerID.1,
                                                                                               ~ak_h.1,
                                                                                               ~ak_sk.1,
                                                                                               ~ssk_nms.1,
                                                                                               a_h, a_sk,
                                                                                               obj_ap, obj_h,
                                                                                               obj_pd, obj_pk,
                                                                                               obj_sh, ~n.2
                                                         ) ▶₀ #t2.6 )
                                                    case outsignobjpkobjapask_0_11111111111111111111211111111
                                                    solve( (#t2.5 < #t2.15)  ∥ (#t2.5 = #t2.15) )
                                                      case case_1
                                                      by contradiction /* from formulas */
                                                    next
                                                      case case_2
                                                      solve( (#t2.11 < #t2.16)  ∥ (#t2.11 = #t2.16) )
                                                        case case_1
                                                        by contradiction /* from formulas */
                                                      next
                                                        case case_2
                                                        solve( (#vr.32 < #t2.14)  ∥ (#vr.32 = #t2.14) )
                                                          case case_1
                                                          solve( (#vr.44 < #t2.15)  ∥ (#vr.44 = #t2.15) )
                                                            case case_1
                                                            solve( (#t2.10 < #t2.15)  ∥ (#t2.10 = #t2.15) )
                                                              case case_1
                                                              by contradiction /* from formulas */
                                                            next
                                                              case case_2
                                                              solve( (#t2.9 < #t2.14)  ∥ (#t2.9 = #t2.14) )
                                                                case case_1
                                                                by contradiction /* from formulas */
                                                              next
                                                                case case_2
                                                                solve( TPM_SendCommand( <'TPM2_Create', 
                                                                                         <swstate, nil>, 
                                                                                         'TPM_CC_PolicyPCR', 
                                                                                         nil>
                                                                       ) @ #t2.12 )
                                                                  case eventTPMSendCommandTPMCreateswstatenilTPMCCPolicyPCRnil_0_11111111111112111
                                                                  solve( state_11111111111112111( ~RouterID.1,
                                                                                                  ~ServerID.1,
                                                                                                  ~ak_h.1,
                                                                                                  ~ak_sk.1,
                                                                                                  ~ssk_nms.1,
                                                                                                  ~tid.1
                                                                         ) ▶₀ #t2.7 )
                                                                    case outTPMPCRExtendswstate_0_1111111111111211
                                                                    solve( TPM_SendCommand( <'TPM2_Certify', 
                                                                                             k_sh, ~k_h, ~ak_h
                                                                                            >
                                                                           ) @ #t2.12 )
                                                                      case eventTPMSendCommandTPMCertifytlsshtlshakh_0_111111111111121111111111111
                                                                      solve( state_111111111111121111111111111( ~RouterID.1,
                                                                                                                ~ServerID.1,
                                                                                                                ~ak_h,
                                                                                                                ~ak_sk.1,
                                                                                                                ~ssk_nms.1,
                                                                                                                ~tid.1,
                                                                                                                ~k_h,
                                                                                                                k_sh,
                                                                                                                tls_spk
                                                                             ) ▶₀ #t2.7 )
                                                                        case outTPMPolicyPCRtlssh_0_11111111111112111111111111
                                                                        solve( TPM_SendCommand( <
                                                                                                 'TPM2_Create', 
                                                                                                 <swstate, nil
                                                                                                 >, 
                                                                                                 'TPM_CC_PolicyPCR', 
                                                                                                 nil>
                                                                               ) @ #t2.12 )
                                                                          case eventTPMSendCommandTPMCreateswstatenilTPMCCPolicyPCRnil_0_11111111111112111
                                                                          solve( state_11111111111112111( ~RouterID.1,
                                                                                                          ~ServerID.1,
                                                                                                          ~ak_h.1,
                                                                                                          ~ak_sk.1,
                                                                                                          ~ssk_nms.1,
                                                                                                          ~tid.1
                                                                                 ) ▶₀ #t2.7 )
                                                                            case outTPMPCRExtendswstate_0_1111111111111211
                                                                            solve( Insert( <'privatePart', 
                                                                                            ~k_h>,
                                                                                           k_sk.1
                                                                                   ) @ #t2.2 )
                                                                              case insertprivatePartkhksk_0_111111111111111111111121111111
                                                                              solve( Insert( <'authPolicy', 
                                                                                              ~k_h>,
                                                                                             k_ap
                                                                                     ) @ #t2.7 )
                                                                                case insertauthPolicyakhnil_0_11111111111111
                                                                                by solve( state_11111111111111( ~RouterID.1,
                                                                                                                ~ServerID.1,
                                                                                                                ~k_h,
                                                                                                                ~ak_sk.1,
                                                                                                                ~ssk_nms.1
                                                                                          ) ▶₀ #t2.7 )
                                                                              next
                                                                                case insertauthPolicykhauthPolicy_0_11111111111111111111112111111
                                                                                solve( state_11111111111111111111112111111( ~RouterID.1,
                                                                                                                            ~ServerID.1,
                                                                                                                            ~ak_h.1,
                                                                                                                            ~ak_sk.1,
                                                                                                                            ~k_h,
                                                                                                                            ~k_sk.1,
                                                                                                                            ~ssk_nms.1,
                                                                                                                            k_ap,
                                                                                                                            lock
                                                                                       ) ▶₀ #t2.7 )
                                                                                  case lockdevice_0_1111111111111111111111211111
                                                                                  by contradiction
                                                                                     /* cyclic */
                                                                                qed
                                                                              qed
                                                                            qed
                                                                          qed
                                                                        qed
                                                                      qed
                                                                    qed
                                                                  qed
                                                                qed
                                                              qed
                                                            qed
                                                          next
                                                            case case_2
                                                            by contradiction /* from formulas */
                                                          qed
                                                        next
                                                          case case_2
                                                          by contradiction /* from formulas */
                                                        qed
                                                      qed
                                                    qed
                                                  qed
                                                next
                                                  case unlockdevice_0_11111111111111111111211111112
                                                  by solve( state_11111111111111111111211111112( ~RouterID.1,
                                                                                                 ~ServerID.1,
                                                                                                 ~ak_h.1,
                                                                                                 ~ak_sk.1,
                                                                                                 ~ssk_nms.1,
                                                                                                 a_h, obj_ap,
                                                                                                 obj_h,
                                                                                                 obj_pd,
                                                                                                 obj_pk,
                                                                                                 obj_sh, ~n.2
                                                            ) ▶₀ #t2.6 )
                                                qed
                                              qed
                                            qed
                                          next
                                            case case_2
                                            solve( (#t2.7 < #t2.10)  ∥ (#t2.7 = #t2.10)  ∥ (#vr.71 < #t2.7) )
                                              case case_1
                                              by contradiction /* from formulas */
                                            next
                                              case case_2
                                              solve( (#t2.8 < #t2.10)  ∥ (#t2.8 = #t2.10)  ∥
                                                     (#vr.72 < #t2.8) )
                                                case case_1
                                                by contradiction /* from formulas */
                                              next
                                                case case_2
                                                solve( Unlock_4( '4', ~n.2, 'device' ) @ #t2.9 )
                                                  case unlockdevice_0_111111111111111111112111111111
                                                  solve( state_111111111111111111112111111111( ~RouterID.1,
                                                                                               ~ServerID.1,
                                                                                               ~ak_h.1,
                                                                                               ~ak_sk.1,
                                                                                               ~ssk_nms.1,
                                                                                               a_h, a_sk,
                                                                                               obj_ap, obj_h,
                                                                                               obj_pd, obj_pk,
                                                                                               obj_sh, ~n.2
                                                         ) ▶₀ #t2.7 )
                                                    case outsignobjpkobjapask_0_11111111111111111111211111111
                                                    solve( (#t2.5 < #t2.13)  ∥ (#t2.5 = #t2.13) )
                                                      case case_1
                                                      by contradiction /* from formulas */
                                                    next
                                                      case case_2
                                                      solve( (#t2.6 < #t2.12)  ∥ (#t2.6 = #t2.12) )
                                                        case case_1
                                                        by contradiction /* from formulas */
                                                      next
                                                        case case_2
                                                        solve( (#t2.9 < #t2.13)  ∥ (#t2.9 = #t2.13) )
                                                          case case_1
                                                          by contradiction /* from formulas */
                                                        next
                                                          case case_2
                                                          solve( (#vr.43 < #t2.12)  ∥ (#vr.43 = #t2.12) )
                                                            case case_1
                                                            solve( (#t2.12 < #t2.8)  ∥ (#t2.12 = #t2.8) )
                                                              case case_1
                                                              by contradiction /* from formulas */
                                                            next
                                                              case case_2
                                                              solve( TPM_SendCommand( <'TPM2_Create', 
                                                                                       <swstate, nil>, 
                                                                                       'TPM_CC_PolicyPCR', nil
                                                                                      >
                                                                     ) @ #t2.10 )
                                                                case eventTPMSendCommandTPMCreateswstatenilTPMCCPolicyPCRnil_0_11111111111112111
                                                                solve( state_11111111111112111( ~RouterID.1,
                                                                                                ~ServerID.1,
                                                                                                ~ak_h.1,
                                                                                                ~ak_sk.1,
                                                                                                ~ssk_nms.1,
                                                                                                ~tid.1
                                                                       ) ▶₀ #t2.8 )
                                                                  case outTPMPCRExtendswstate_0_1111111111111211
                                                                  solve( TPM_SendCommand( <'TPM2_Certify', 
                                                                                           k_sh, ~k_h, ~ak_h>
                                                                         ) @ #t2.10 )
                                                                    case eventTPMSendCommandTPMCertifytlsshtlshakh_0_111111111111121111111111111
                                                                    solve( state_111111111111121111111111111( ~RouterID.1,
                                                                                                              ~ServerID.1,
                                                                                                              ~ak_h,
                                                                                                              ~ak_sk.1,
                                                                                                              ~ssk_nms.1,
                                                                                                              ~tid.1,
                                                                                                              ~k_h,
                                                                                                              k_sh,
                                                                                                              tls_spk
                                                                           ) ▶₀ #t2.8 )
                                                                      case outTPMPolicyPCRtlssh_0_11111111111112111111111111
                                                                      solve( TPM_SendCommand( <'TPM2_Create', 
                                                                                               <swstate, nil
                                                                                               >, 
                                                                                               'TPM_CC_PolicyPCR', 
                                                                                               nil>
                                                                             ) @ #t2.10 )
                                                                        case eventTPMSendCommandTPMCreateswstatenilTPMCCPolicyPCRnil_0_11111111111112111
                                                                        solve( state_11111111111112111( ~RouterID.1,
                                                                                                        ~ServerID.1,
                                                                                                        ~ak_h.1,
                                                                                                        ~ak_sk.1,
                                                                                                        ~ssk_nms.1,
                                                                                                        ~tid.1
                                                                               ) ▶₀ #t2.8 )
                                                                          case outTPMPCRExtendswstate_0_1111111111111211
                                                                          solve( Insert( <'privatePart', ~k_h
                                                                                         >,
                                                                                         k_sk.1
                                                                                 ) @ #t2.2 )
                                                                            case insertprivatePartkhksk_0_111111111111111111111121111111
                                                                            solve( Insert( <'authPolicy', ~k_h
                                                                                           >,
                                                                                           k_ap
                                                                                   ) @ #t2.8 )
                                                                              case insertauthPolicyakhnil_0_11111111111111
                                                                              by solve( state_11111111111111( ~RouterID.1,
                                                                                                              ~ServerID.1,
                                                                                                              ~k_h,
                                                                                                              ~ak_sk.1,
                                                                                                              ~ssk_nms.1
                                                                                        ) ▶₀ #t2.8 )
                                                                            next
                                                                              case insertauthPolicykhauthPolicy_0_11111111111111111111112111111
                                                                              solve( state_11111111111111111111112111111( ~RouterID.1,
                                                                                                                          ~ServerID.1,
                                                                                                                          ~ak_h.1,
                                                                                                                          ~ak_sk.1,
                                                                                                                          ~k_h,
                                                                                                                          ~k_sk.1,
                                                                                                                          ~ssk_nms.1,
                                                                                                                          k_ap,
                                                                                                                          lock
                                                                                     ) ▶₀ #t2.8 )
                                                                                case lockdevice_0_1111111111111111111111211111
                                                                                by contradiction /* cyclic */
                                                                              qed
                                                                            qed
                                                                          qed
                                                                        qed
                                                                      qed
                                                                    qed
                                                                  qed
                                                                qed
                                                              qed
                                                            qed
                                                          next
                                                            case case_2
                                                            by contradiction /* from formulas */
                                                          qed
                                                        qed
                                                      qed
                                                    qed
                                                  qed
                                                next
                                                  case unlockdevice_0_11111111111111111111211111112
                                                  by solve( state_11111111111111111111211111112( ~RouterID.1,
                                                                                                 ~ServerID.1,
                                                                                                 ~ak_h.1,
                                                                                                 ~ak_sk.1,
                                                                                                 ~ssk_nms.1,
                                                                                                 a_h, obj_ap,
                                                                                                 obj_h,
                                                                                                 obj_pd,
                                                                                                 obj_pk,
                                                                                                 obj_sh, ~n.2
                                                            ) ▶₀ #t2.7 )
                                                qed
                                              next
                                                case case_3
                                                solve( Unlock_4( '4', ~n.2, 'device' ) @ #t2.9 )
                                                  case unlockdevice_0_111111111111111111112111111111
                                                  solve( state_111111111111111111112111111111( ~RouterID.1,
                                                                                               ~ServerID.1,
                                                                                               ~ak_h.1,
                                                                                               ~ak_sk.1,
                                                                                               ~ssk_nms.1,
                                                                                               a_h, a_sk,
                                                                                               obj_ap, obj_h,
                                                                                               obj_pd, obj_pk,
                                                                                               obj_sh, ~n.2
                                                         ) ▶₀ #t2.7 )
                                                    case outsignobjpkobjapask_0_11111111111111111111211111111
                                                    solve( (#t2.5 < #t2.14)  ∥ (#t2.5 = #t2.14) )
                                                      case case_1
                                                      by contradiction /* from formulas */
                                                    next
                                                      case case_2
                                                      solve( (#t2.6 < #t2.13)  ∥ (#t2.6 = #t2.13) )
                                                        case case_1
                                                        by contradiction /* from formulas */
                                                      next
                                                        case case_2
                                                        solve( (#t2.10 < #t2.14)  ∥ (#t2.10 = #t2.14) )
                                                          case case_1
                                                          by contradiction /* from formulas */
                                                        next
                                                          case case_2
                                                          solve( (#vr.43 < #t2.13)  ∥ (#vr.43 = #t2.13) )
                                                            case case_1
                                                            solve( (#t2.13 < #t2.8)  ∥ (#t2.13 = #t2.8) )
                                                              case case_1
                                                              by contradiction /* from formulas */
                                                            next
                                                              case case_2
                                                              solve( TPM_SendCommand( <'TPM2_Create', 
                                                                                       <swstate, nil>, 
                                                                                       'TPM_CC_PolicyPCR', nil
                                                                                      >
                                                                     ) @ #t2.11 )
                                                                case eventTPMSendCommandTPMCreateswstatenilTPMCCPolicyPCRnil_0_11111111111112111
                                                                solve( state_11111111111112111( ~RouterID.1,
                                                                                                ~ServerID.1,
                                                                                                ~ak_h.1,
                                                                                                ~ak_sk.1,
                                                                                                ~ssk_nms.1,
                                                                                                ~tid.1
                                                                       ) ▶₀ #t2.8 )
                                                                  case outTPMPCRExtendswstate_0_1111111111111211
                                                                  solve( TPM_SendCommand( <'TPM2_Certify', 
                                                                                           k_sh, ~k_h, ~ak_h>
                                                                         ) @ #t2.11 )
                                                                    case eventTPMSendCommandTPMCertifytlsshtlshakh_0_111111111111121111111111111
                                                                    solve( state_111111111111121111111111111( ~RouterID.1,
                                                                                                              ~ServerID.1,
                                                                                                              ~ak_h,
                                                                                                              ~ak_sk.1,
                                                                                                              ~ssk_nms.1,
                                                                                                              ~tid.1,
                                                                                                              ~k_h,
                                                                                                              k_sh,
                                                                                                              tls_spk
                                                                           ) ▶₀ #t2.8 )
                                                                      case outTPMPolicyPCRtlssh_0_11111111111112111111111111
                                                                      solve( TPM_SendCommand( <'TPM2_Create', 
                                                                                               <swstate, nil
                                                                                               >, 
                                                                                               'TPM_CC_PolicyPCR', 
                                                                                               nil>
                                                                             ) @ #t2.11 )
                                                                        case eventTPMSendCommandTPMCreateswstatenilTPMCCPolicyPCRnil_0_11111111111112111
                                                                        solve( state_11111111111112111( ~RouterID.1,
                                                                                                        ~ServerID.1,
                                                                                                        ~ak_h.1,
                                                                                                        ~ak_sk.1,
                                                                                                        ~ssk_nms.1,
                                                                                                        ~tid.1
                                                                               ) ▶₀ #t2.8 )
                                                                          case outTPMPCRExtendswstate_0_1111111111111211
                                                                          solve( Insert( <'privatePart', ~k_h
                                                                                         >,
                                                                                         k_sk.1
                                                                                 ) @ #t2.2 )
                                                                            case insertprivatePartkhksk_0_111111111111111111111121111111
                                                                            solve( Insert( <'authPolicy', ~k_h
                                                                                           >,
                                                                                           k_ap
                                                                                   ) @ #t2.8 )
                                                                              case insertauthPolicyakhnil_0_11111111111111
                                                                              by solve( state_11111111111111( ~RouterID.1,
                                                                                                              ~ServerID.1,
                                                                                                              ~k_h,
                                                                                                              ~ak_sk.1,
                                                                                                              ~ssk_nms.1
                                                                                        ) ▶₀ #t2.8 )
                                                                            next
                                                                              case insertauthPolicykhauthPolicy_0_11111111111111111111112111111
                                                                              solve( state_11111111111111111111112111111( ~RouterID.1,
                                                                                                                          ~ServerID.1,
                                                                                                                          ~ak_h.1,
                                                                                                                          ~ak_sk.1,
                                                                                                                          ~k_h,
                                                                                                                          ~k_sk.1,
                                                                                                                          ~ssk_nms.1,
                                                                                                                          k_ap,
                                                                                                                          lock
                                                                                     ) ▶₀ #t2.8 )
                                                                                case lockdevice_0_1111111111111111111111211111
                                                                                by contradiction /* cyclic */
                                                                              qed
                                                                            qed
                                                                          qed
                                                                        qed
                                                                      qed
                                                                    qed
                                                                  qed
                                                                qed
                                                              qed
                                                            qed
                                                          next
                                                            case case_2
                                                            by contradiction /* from formulas */
                                                          qed
                                                        qed
                                                      qed
                                                    qed
                                                  qed
                                                next
                                                  case unlockdevice_0_11111111111111111111211111112
                                                  by solve( state_11111111111111111111211111112( ~RouterID.1,
                                                                                                 ~ServerID.1,
                                                                                                 ~ak_h.1,
                                                                                                 ~ak_sk.1,
                                                                                                 ~ssk_nms.1,
                                                                                                 a_h, obj_ap,
                                                                                                 obj_h,
                                                                                                 obj_pd,
                                                                                                 obj_pk,
                                                                                                 obj_sh, ~n.2
                                                            ) ▶₀ #t2.7 )
                                                qed
                                              qed
                                            next
                                              case case_3
                                              solve( (#t2.8 < #t2.11)  ∥ (#t2.8 = #t2.11)  ∥
                                                     (#vr.72 < #t2.8) )
                                                case case_1
                                                by contradiction /* from formulas */
                                              next
                                                case case_2
                                                solve( Unlock_4( '4', ~n.2, 'device' ) @ #t2.9 )
                                                  case unlockdevice_0_111111111111111111112111111111
                                                  solve( state_111111111111111111112111111111( ~RouterID.1,
                                                                                               ~ServerID.1,
                                                                                               ~ak_h.1,
                                                                                               ~ak_sk.1,
                                                                                               ~ssk_nms.1,
                                                                                               a_h, a_sk,
                                                                                               obj_ap, obj_h,
                                                                                               obj_pd, obj_pk,
                                                                                               obj_sh, ~n.2
                                                         ) ▶₀ #t2.7 )
                                                    case outsignobjpkobjapask_0_11111111111111111111211111111
                                                    solve( (#t2.5 < #t2.14)  ∥ (#t2.5 = #t2.14) )
                                                      case case_1
                                                      by contradiction /* from formulas */
                                                    next
                                                      case case_2
                                                      solve( (#t2.6 < #t2.13)  ∥ (#t2.6 = #t2.13) )
                                                        case case_1
                                                        by contradiction /* from formulas */
                                                      next
                                                        case case_2
                                                        solve( (#t2.9 < #t2.14)  ∥ (#t2.9 = #t2.14) )
                                                          case case_1
                                                          by contradiction /* from formulas */
                                                        next
                                                          case case_2
                                                          solve( (#vr.43 < #t2.13)  ∥ (#vr.43 = #t2.13) )
                                                            case case_1
                                                            solve( (#t2.10 < #t2.13)  ∥ (#t2.10 = #t2.13) )
                                                              case case_1
                                                              by contradiction /* from formulas */
                                                            next
                                                              case case_2
                                                              solve( TPM_SendCommand( <'TPM2_Create', 
                                                                                       <swstate, nil>, 
                                                                                       'TPM_CC_PolicyPCR', nil
                                                                                      >
                                                                     ) @ #t2.11 )
                                                                case eventTPMSendCommandTPMCreateswstatenilTPMCCPolicyPCRnil_0_11111111111112111
                                                                solve( state_11111111111112111( ~RouterID.1,
                                                                                                ~ServerID.1,
                                                                                                ~ak_h.1,
                                                                                                ~ak_sk.1,
                                                                                                ~ssk_nms.1,
                                                                                                ~tid.1
                                                                       ) ▶₀ #t2.8 )
                                                                  case outTPMPCRExtendswstate_0_1111111111111211
                                                                  solve( TPM_SendCommand( <'TPM2_Certify', 
                                                                                           k_sh, ~k_h, ~ak_h>
                                                                         ) @ #t2.11 )
                                                                    case eventTPMSendCommandTPMCertifytlsshtlshakh_0_111111111111121111111111111
                                                                    solve( state_111111111111121111111111111( ~RouterID.1,
                                                                                                              ~ServerID.1,
                                                                                                              ~ak_h,
                                                                                                              ~ak_sk.1,
                                                                                                              ~ssk_nms.1,
                                                                                                              ~tid.1,
                                                                                                              ~k_h,
                                                                                                              k_sh,
                                                                                                              tls_spk
                                                                           ) ▶₀ #t2.8 )
                                                                      case outTPMPolicyPCRtlssh_0_11111111111112111111111111
                                                                      solve( TPM_SendCommand( <'TPM2_Create', 
                                                                                               <swstate, nil
                                                                                               >, 
                                                                                               'TPM_CC_PolicyPCR', 
                                                                                               nil>
                                                                             ) @ #t2.11 )
                                                                        case eventTPMSendCommandTPMCreateswstatenilTPMCCPolicyPCRnil_0_11111111111112111
                                                                        solve( state_11111111111112111( ~RouterID.1,
                                                                                                        ~ServerID.1,
                                                                                                        ~ak_h.1,
                                                                                                        ~ak_sk.1,
                                                                                                        ~ssk_nms.1,
                                                                                                        ~tid.1
                                                                               ) ▶₀ #t2.8 )
                                                                          case outTPMPCRExtendswstate_0_1111111111111211
                                                                          solve( Insert( <'privatePart', ~k_h
                                                                                         >,
                                                                                         k_sk.1
                                                                                 ) @ #t2.2 )
                                                                            case insertprivatePartkhksk_0_111111111111111111111121111111
                                                                            solve( Insert( <'authPolicy', ~k_h
                                                                                           >,
                                                                                           k_ap
                                                                                   ) @ #t2.8 )
                                                                              case insertauthPolicyakhnil_0_11111111111111
                                                                              by solve( state_11111111111111( ~RouterID.1,
                                                                                                              ~ServerID.1,
                                                                                                              ~k_h,
                                                                                                              ~ak_sk.1,
                                                                                                              ~ssk_nms.1
                                                                                        ) ▶₀ #t2.8 )
                                                                            next
                                                                              case insertauthPolicykhauthPolicy_0_11111111111111111111112111111
                                                                              solve( state_11111111111111111111112111111( ~RouterID.1,
                                                                                                                          ~ServerID.1,
                                                                                                                          ~ak_h.1,
                                                                                                                          ~ak_sk.1,
                                                                                                                          ~k_h,
                                                                                                                          ~k_sk.1,
                                                                                                                          ~ssk_nms.1,
                                                                                                                          k_ap,
                                                                                                                          lock
                                                                                     ) ▶₀ #t2.8 )
                                                                                case lockdevice_0_1111111111111111111111211111
                                                                                by contradiction /* cyclic */
                                                                              qed
                                                                            qed
                                                                          qed
                                                                        qed
                                                                      qed
                                                                    qed
                                                                  qed
                                                                qed
                                                              qed
                                                            qed
                                                          next
                                                            case case_2
                                                            by contradiction /* from formulas */
                                                          qed
                                                        qed
                                                      qed
                                                    qed
                                                  qed
                                                next
                                                  case unlockdevice_0_11111111111111111111211111112
                                                  by solve( state_11111111111111111111211111112( ~RouterID.1,
                                                                                                 ~ServerID.1,
                                                                                                 ~ak_h.1,
                                                                                                 ~ak_sk.1,
                                                                                                 ~ssk_nms.1,
                                                                                                 a_h, obj_ap,
                                                                                                 obj_h,
                                                                                                 obj_pd,
                                                                                                 obj_pk,
                                                                                                 obj_sh, ~n.2
                                                            ) ▶₀ #t2.7 )
                                                qed
                                              next
                                                case case_3
                                                solve( Unlock_4( '4', ~n.2, 'device' ) @ #t2.9 )
                                                  case unlockdevice_0_111111111111111111112111111111
                                                  solve( state_111111111111111111112111111111( ~RouterID.1,
                                                                                               ~ServerID.1,
                                                                                               ~ak_h.1,
                                                                                               ~ak_sk.1,
                                                                                               ~ssk_nms.1,
                                                                                               a_h, a_sk,
                                                                                               obj_ap, obj_h,
                                                                                               obj_pd, obj_pk,
                                                                                               obj_sh, ~n.2
                                                         ) ▶₀ #t2.7 )
                                                    case outsignobjpkobjapask_0_11111111111111111111211111111
                                                    solve( (#t2.5 < #t2.15)  ∥ (#t2.5 = #t2.15) )
                                                      case case_1
                                                      by contradiction /* from formulas */
                                                    next
                                                      case case_2
                                                      solve( (#t2.6 < #t2.14)  ∥ (#t2.6 = #t2.14) )
                                                        case case_1
                                                        by contradiction /* from formulas */
                                                      next
                                                        case case_2
                                                        solve( (#t2.11 < #t2.15)  ∥ (#t2.11 = #t2.15) )
                                                          case case_1
                                                          by contradiction /* from formulas */
                                                        next
                                                          case case_2
                                                          solve( (#vr.43 < #t2.14)  ∥ (#vr.43 = #t2.14) )
                                                            case case_1
                                                            solve( (#t2.10 < #t2.14)  ∥ (#t2.10 = #t2.14) )
                                                              case case_1
                                                              by contradiction /* from formulas */
                                                            next
                                                              case case_2
                                                              solve( TPM_SendCommand( <'TPM2_Create', 
                                                                                       <swstate, nil>, 
                                                                                       'TPM_CC_PolicyPCR', nil
                                                                                      >
                                                                     ) @ #t2.12 )
                                                                case eventTPMSendCommandTPMCreateswstatenilTPMCCPolicyPCRnil_0_11111111111112111
                                                                solve( state_11111111111112111( ~RouterID.1,
                                                                                                ~ServerID.1,
                                                                                                ~ak_h.1,
                                                                                                ~ak_sk.1,
                                                                                                ~ssk_nms.1,
                                                                                                ~tid.1
                                                                       ) ▶₀ #t2.8 )
                                                                  case outTPMPCRExtendswstate_0_1111111111111211
                                                                  solve( TPM_SendCommand( <'TPM2_Certify', 
                                                                                           k_sh, ~k_h, ~ak_h>
                                                                         ) @ #t2.12 )
                                                                    case eventTPMSendCommandTPMCertifytlsshtlshakh_0_111111111111121111111111111
                                                                    solve( state_111111111111121111111111111( ~RouterID.1,
                                                                                                              ~ServerID.1,
                                                                                                              ~ak_h,
                                                                                                              ~ak_sk.1,
                                                                                                              ~ssk_nms.1,
                                                                                                              ~tid.1,
                                                                                                              ~k_h,
                                                                                                              k_sh,
                                                                                                              tls_spk
                                                                           ) ▶₀ #t2.8 )
                                                                      case outTPMPolicyPCRtlssh_0_11111111111112111111111111
                                                                      solve( TPM_SendCommand( <'TPM2_Create', 
                                                                                               <swstate, nil
                                                                                               >, 
                                                                                               'TPM_CC_PolicyPCR', 
                                                                                               nil>
                                                                             ) @ #t2.12 )
                                                                        case eventTPMSendCommandTPMCreateswstatenilTPMCCPolicyPCRnil_0_11111111111112111
                                                                        solve( state_11111111111112111( ~RouterID.1,
                                                                                                        ~ServerID.1,
                                                                                                        ~ak_h.1,
                                                                                                        ~ak_sk.1,
                                                                                                        ~ssk_nms.1,
                                                                                                        ~tid.1
                                                                               ) ▶₀ #t2.8 )
                                                                          case outTPMPCRExtendswstate_0_1111111111111211
                                                                          solve( Insert( <'privatePart', ~k_h
                                                                                         >,
                                                                                         k_sk.1
                                                                                 ) @ #t2.2 )
                                                                            case insertprivatePartkhksk_0_111111111111111111111121111111
                                                                            solve( Insert( <'authPolicy', ~k_h
                                                                                           >,
                                                                                           k_ap
                                                                                   ) @ #t2.8 )
                                                                              case insertauthPolicyakhnil_0_11111111111111
                                                                              by solve( state_11111111111111( ~RouterID.1,
                                                                                                              ~ServerID.1,
                                                                                                              ~k_h,
                                                                                                              ~ak_sk.1,
                                                                                                              ~ssk_nms.1
                                                                                        ) ▶₀ #t2.8 )
                                                                            next
                                                                              case insertauthPolicykhauthPolicy_0_11111111111111111111112111111
                                                                              solve( state_11111111111111111111112111111( ~RouterID.1,
                                                                                                                          ~ServerID.1,
                                                                                                                          ~ak_h.1,
                                                                                                                          ~ak_sk.1,
                                                                                                                          ~k_h,
                                                                                                                          ~k_sk.1,
                                                                                                                          ~ssk_nms.1,
                                                                                                                          k_ap,
                                                                                                                          lock
                                                                                     ) ▶₀ #t2.8 )
                                                                                case lockdevice_0_1111111111111111111111211111
                                                                                by contradiction /* cyclic */
                                                                              qed
                                                                            qed
                                                                          qed
                                                                        qed
                                                                      qed
                                                                    qed
                                                                  qed
                                                                qed
                                                              qed
                                                            qed
                                                          next
                                                            case case_2
                                                            by contradiction /* from formulas */
                                                          qed
                                                        qed
                                                      qed
                                                    qed
                                                  qed
                                                next
                                                  case unlockdevice_0_11111111111111111111211111112
                                                  by solve( state_11111111111111111111211111112( ~RouterID.1,
                                                                                                 ~ServerID.1,
                                                                                                 ~ak_h.1,
                                                                                                 ~ak_sk.1,
                                                                                                 ~ssk_nms.1,
                                                                                                 a_h, obj_ap,
                                                                                                 obj_h,
                                                                                                 obj_pd,
                                                                                                 obj_pk,
                                                                                                 obj_sh, ~n.2
                                                            ) ▶₀ #t2.7 )
                                                qed
                                              qed
                                            qed
                                          qed
                                        next
                                          case case_2
                                          solve( (#vr.32 < #t2.10)  ∥ (#vr.32 = #t2.10) )
                                            case case_1
                                            solve( (#t2.8 < #t2.11)  ∥ (#t2.8 = #t2.11)  ∥ (#vr.72 < #t2.8) )
                                              case case_1
                                              by contradiction /* from formulas */
                                            next
                                              case case_2
                                              solve( Unlock_4( '4', ~n.2, 'device' ) @ #t2.9 )
                                                case unlockdevice_0_111111111111111111112111111111
                                                solve( state_111111111111111111112111111111( ~RouterID.1,
                                                                                             ~ServerID.1,
                                                                                             ~ak_h.1,
                                                                                             ~ak_sk.1,
                                                                                             ~ssk_nms.1, a_h,
                                                                                             a_sk, obj_ap,
                                                                                             obj_h, obj_pd,
                                                                                             obj_pk, obj_sh,
                                                                                             ~n.2
                                                       ) ▶₀ #t2.7 )
                                                  case outsignobjpkobjapask_0_11111111111111111111211111111
                                                  solve( (#t2.5 < #t2.14)  ∥ (#t2.5 = #t2.14) )
                                                    case case_1
                                                    by contradiction /* from formulas */
                                                  next
                                                    case case_2
                                                    solve( (#t2.6 < #t2.14)  ∥ (#t2.6 = #t2.14) )
                                                      case case_1
                                                      by contradiction /* from formulas */
                                                    next
                                                      case case_2
                                                      solve( (#t2.9 < #t2.14)  ∥ (#t2.9 = #t2.14) )
                                                        case case_1
                                                        by contradiction /* from formulas */
                                                      next
                                                        case case_2
                                                        solve( (#vr.32 < #t2.13)  ∥ (#vr.32 = #t2.13) )
                                                          case case_1
                                                          solve( (#t2.10 < #t2.13)  ∥ (#t2.10 = #t2.13) )
                                                            case case_1
                                                            by contradiction /* from formulas */
                                                          next
                                                            case case_2
                                                            solve( TPM_SendCommand( <'TPM2_Create', 
                                                                                     <swstate, nil>, 
                                                                                     'TPM_CC_PolicyPCR', nil>
                                                                   ) @ #t2.11 )
                                                              case eventTPMSendCommandTPMCreateswstatenilTPMCCPolicyPCRnil_0_11111111111112111
                                                              solve( state_11111111111112111( ~RouterID.1,
                                                                                              ~ServerID.1,
                                                                                              ~ak_h.1,
                                                                                              ~ak_sk.1,
                                                                                              ~ssk_nms.1,
                                                                                              ~tid.1
                                                                     ) ▶₀ #t2.8 )
                                                                case outTPMPCRExtendswstate_0_1111111111111211
                                                                solve( TPM_SendCommand( <'TPM2_Certify', 
                                                                                         k_sh, ~k_h, ~ak_h>
                                                                       ) @ #t2.11 )
                                                                  case eventTPMSendCommandTPMCertifytlsshtlshakh_0_111111111111121111111111111
                                                                  solve( state_111111111111121111111111111( ~RouterID.1,
                                                                                                            ~ServerID.1,
                                                                                                            ~ak_h,
                                                                                                            ~ak_sk.1,
                                                                                                            ~ssk_nms.1,
                                                                                                            ~tid.1,
                                                                                                            ~k_h,
                                                                                                            k_sh,
                                                                                                            tls_spk
                                                                         ) ▶₀ #t2.8 )
                                                                    case outTPMPolicyPCRtlssh_0_11111111111112111111111111
                                                                    solve( TPM_SendCommand( <'TPM2_Create', 
                                                                                             <swstate, nil>, 
                                                                                             'TPM_CC_PolicyPCR', 
                                                                                             nil>
                                                                           ) @ #t2.11 )
                                                                      case eventTPMSendCommandTPMCreateswstatenilTPMCCPolicyPCRnil_0_11111111111112111
                                                                      solve( state_11111111111112111( ~RouterID.1,
                                                                                                      ~ServerID.1,
                                                                                                      ~ak_h.1,
                                                                                                      ~ak_sk.1,
                                                                                                      ~ssk_nms.1,
                                                                                                      ~tid.1
                                                                             ) ▶₀ #t2.8 )
                                                                        case outTPMPCRExtendswstate_0_1111111111111211
                                                                        solve( Insert( <'privatePart', ~k_h>,
                                                                                       k_sk.1
                                                                               ) @ #t2.2 )
                                                                          case insertprivatePartkhksk_0_111111111111111111111121111111
                                                                          solve( Insert( <'authPolicy', ~k_h>,
                                                                                         k_ap
                                                                                 ) @ #t2.8 )
                                                                            case insertauthPolicyakhnil_0_11111111111111
                                                                            by solve( state_11111111111111( ~RouterID.1,
                                                                                                            ~ServerID.1,
                                                                                                            ~k_h,
                                                                                                            ~ak_sk.1,
                                                                                                            ~ssk_nms.1
                                                                                      ) ▶₀ #t2.8 )
                                                                          next
                                                                            case insertauthPolicykhauthPolicy_0_11111111111111111111112111111
                                                                            solve( state_11111111111111111111112111111( ~RouterID.1,
                                                                                                                        ~ServerID.1,
                                                                                                                        ~ak_h.1,
                                                                                                                        ~ak_sk.1,
                                                                                                                        ~k_h,
                                                                                                                        ~k_sk.1,
                                                                                                                        ~ssk_nms.1,
                                                                                                                        k_ap,
                                                                                                                        lock
                                                                                   ) ▶₀ #t2.8 )
                                                                              case lockdevice_0_1111111111111111111111211111
                                                                              by contradiction /* cyclic */
                                                                            qed
                                                                          qed
                                                                        qed
                                                                      qed
                                                                    qed
                                                                  qed
                                                                qed
                                                              qed
                                                            qed
                                                          qed
                                                        next
                                                          case case_2
                                                          by contradiction /* from formulas */
                                                        qed
                                                      qed
                                                    qed
                                                  qed
                                                qed
                                              next
                                                case unlockdevice_0_11111111111111111111211111112
                                                by solve( state_11111111111111111111211111112( ~RouterID.1,
                                                                                               ~ServerID.1,
                                                                                               ~ak_h.1,
                                                                                               ~ak_sk.1,
                                                                                               ~ssk_nms.1,
                                                                                               a_h, obj_ap,
                                                                                               obj_h, obj_pd,
                                                                                               obj_pk, obj_sh,
                                                                                               ~n.2
                                                          ) ▶₀ #t2.7 )
                                              qed
                                            next
                                              case case_3
                                              solve( Unlock_4( '4', ~n.2, 'device' ) @ #t2.9 )
                                                case unlockdevice_0_111111111111111111112111111111
                                                solve( state_111111111111111111112111111111( ~RouterID.1,
                                                                                             ~ServerID.1,
                                                                                             ~ak_h.1,
                                                                                             ~ak_sk.1,
                                                                                             ~ssk_nms.1, a_h,
                                                                                             a_sk, obj_ap,
                                                                                             obj_h, obj_pd,
                                                                                             obj_pk, obj_sh,
                                                                                             ~n.2
                                                       ) ▶₀ #t2.7 )
                                                  case outsignobjpkobjapask_0_11111111111111111111211111111
                                                  solve( (#t2.5 < #t2.15)  ∥ (#t2.5 = #t2.15) )
                                                    case case_1
                                                    by contradiction /* from formulas */
                                                  next
                                                    case case_2
                                                    solve( (#t2.6 < #t2.15)  ∥ (#t2.6 = #t2.15) )
                                                      case case_1
                                                      by contradiction /* from formulas */
                                                    next
                                                      case case_2
                                                      solve( (#t2.11 < #t2.15)  ∥ (#t2.11 = #t2.15) )
                                                        case case_1
                                                        by contradiction /* from formulas */
                                                      next
                                                        case case_2
                                                        solve( (#vr.32 < #t2.14)  ∥ (#vr.32 = #t2.14) )
                                                          case case_1
                                                          solve( (#t2.10 < #t2.14)  ∥ (#t2.10 = #t2.14) )
                                                            case case_1
                                                            by contradiction /* from formulas */
                                                          next
                                                            case case_2
                                                            solve( TPM_SendCommand( <'TPM2_Create', 
                                                                                     <swstate, nil>, 
                                                                                     'TPM_CC_PolicyPCR', nil>
                                                                   ) @ #t2.12 )
                                                              case eventTPMSendCommandTPMCreateswstatenilTPMCCPolicyPCRnil_0_11111111111112111
                                                              solve( state_11111111111112111( ~RouterID.1,
                                                                                              ~ServerID.1,
                                                                                              ~ak_h.1,
                                                                                              ~ak_sk.1,
                                                                                              ~ssk_nms.1,
                                                                                              ~tid.1
                                                                     ) ▶₀ #t2.8 )
                                                                case outTPMPCRExtendswstate_0_1111111111111211
                                                                solve( TPM_SendCommand( <'TPM2_Certify', 
                                                                                         k_sh, ~k_h, ~ak_h>
                                                                       ) @ #t2.12 )
                                                                  case eventTPMSendCommandTPMCertifytlsshtlshakh_0_111111111111121111111111111
                                                                  solve( state_111111111111121111111111111( ~RouterID.1,
                                                                                                            ~ServerID.1,
                                                                                                            ~ak_h,
                                                                                                            ~ak_sk.1,
                                                                                                            ~ssk_nms.1,
                                                                                                            ~tid.1,
                                                                                                            ~k_h,
                                                                                                            k_sh,
                                                                                                            tls_spk
                                                                         ) ▶₀ #t2.8 )
                                                                    case outTPMPolicyPCRtlssh_0_11111111111112111111111111
                                                                    solve( TPM_SendCommand( <'TPM2_Create', 
                                                                                             <swstate, nil>, 
                                                                                             'TPM_CC_PolicyPCR', 
                                                                                             nil>
                                                                           ) @ #t2.12 )
                                                                      case eventTPMSendCommandTPMCreateswstatenilTPMCCPolicyPCRnil_0_11111111111112111
                                                                      solve( state_11111111111112111( ~RouterID.1,
                                                                                                      ~ServerID.1,
                                                                                                      ~ak_h.1,
                                                                                                      ~ak_sk.1,
                                                                                                      ~ssk_nms.1,
                                                                                                      ~tid.1
                                                                             ) ▶₀ #t2.8 )
                                                                        case outTPMPCRExtendswstate_0_1111111111111211
                                                                        solve( Insert( <'privatePart', ~k_h>,
                                                                                       k_sk.1
                                                                               ) @ #t2.2 )
                                                                          case insertprivatePartkhksk_0_111111111111111111111121111111
                                                                          solve( Insert( <'authPolicy', ~k_h>,
                                                                                         k_ap
                                                                                 ) @ #t2.8 )
                                                                            case insertauthPolicyakhnil_0_11111111111111
                                                                            by solve( state_11111111111111( ~RouterID.1,
                                                                                                            ~ServerID.1,
                                                                                                            ~k_h,
                                                                                                            ~ak_sk.1,
                                                                                                            ~ssk_nms.1
                                                                                      ) ▶₀ #t2.8 )
                                                                          next
                                                                            case insertauthPolicykhauthPolicy_0_11111111111111111111112111111
                                                                            solve( state_11111111111111111111112111111( ~RouterID.1,
                                                                                                                        ~ServerID.1,
                                                                                                                        ~ak_h.1,
                                                                                                                        ~ak_sk.1,
                                                                                                                        ~k_h,
                                                                                                                        ~k_sk.1,
                                                                                                                        ~ssk_nms.1,
                                                                                                                        k_ap,
                                                                                                                        lock
                                                                                   ) ▶₀ #t2.8 )
                                                                              case lockdevice_0_1111111111111111111111211111
                                                                              by contradiction /* cyclic */
                                                                            qed
                                                                          qed
                                                                        qed
                                                                      qed
                                                                    qed
                                                                  qed
                                                                qed
                                                              qed
                                                            qed
                                                          qed
                                                        next
                                                          case case_2
                                                          by contradiction /* from formulas */
                                                        qed
                                                      qed
                                                    qed
                                                  qed
                                                qed
                                              next
                                                case unlockdevice_0_11111111111111111111211111112
                                                by solve( state_11111111111111111111211111112( ~RouterID.1,
                                                                                               ~ServerID.1,
                                                                                               ~ak_h.1,
                                                                                               ~ak_sk.1,
                                                                                               ~ssk_nms.1,
                                                                                               a_h, obj_ap,
                                                                                               obj_h, obj_pd,
                                                                                               obj_pk, obj_sh,
                                                                                               ~n.2
                                                          ) ▶₀ #t2.7 )
                                              qed
                                            qed
                                          next
                                            case case_2
                                            solve( (#t2.9 < #t2.11)  ∥ (#t2.9 = #t2.11)  ∥ (#vr.71 < #t2.9) )
                                              case case_1
                                              by contradiction /* from formulas */
                                            next
                                              case case_2
                                              solve( Unlock_4( '4', ~n.2, 'device' ) @ #t2.10 )
                                                case unlockdevice_0_111111111111111111112111111111
                                                solve( state_111111111111111111112111111111( ~RouterID.1,
                                                                                             ~ServerID.1,
                                                                                             ~ak_h.1,
                                                                                             ~ak_sk.1,
                                                                                             ~ssk_nms.1, a_h,
                                                                                             a_sk, obj_ap,
                                                                                             obj_h, obj_pd,
                                                                                             obj_pk, obj_sh,
                                                                                             ~n.2
                                                       ) ▶₀ #t2.8 )
                                                  case outsignobjpkobjapask_0_11111111111111111111211111111
                                                  solve( (#t2.5 < #t2.14)  ∥ (#t2.5 = #t2.14) )
                                                    case case_1
                                                    by contradiction /* from formulas */
                                                  next
                                                    case case_2
                                                    solve( (#t2.6 < #t2.14)  ∥ (#t2.6 = #t2.14) )
                                                      case case_1
                                                      by contradiction /* from formulas */
                                                    next
                                                      case case_2
                                                      solve( (#t2.7 < #t2.13)  ∥ (#t2.7 = #t2.13) )
                                                        case case_1
                                                        by contradiction /* from formulas */
                                                      next
                                                        case case_2
                                                        solve( (#t2.10 < #t2.13)  ∥ (#t2.10 = #t2.13) )
                                                          case case_1
                                                          by contradiction /* from formulas */
                                                        next
                                                          case case_2
                                                          solve( TPM_SendCommand( <'TPM2_Create', 
                                                                                   <swstate, nil>, 
                                                                                   'TPM_CC_PolicyPCR', nil>
                                                                 ) @ #t2.11 )
                                                            case eventTPMSendCommandTPMCreateswstatenilTPMCCPolicyPCRnil_0_11111111111112111
                                                            solve( state_11111111111112111( ~RouterID.1,
                                                                                            ~ServerID.1,
                                                                                            ~ak_h.1, ~ak_sk.1,
                                                                                            ~ssk_nms.1, ~tid.1
                                                                   ) ▶₀ #t2.9 )
                                                              case outTPMPCRExtendswstate_0_1111111111111211
                                                              solve( TPM_SendCommand( <'TPM2_Certify', k_sh, 
                                                                                       ~k_h, ~ak_h>
                                                                     ) @ #t2.11 )
                                                                case eventTPMSendCommandTPMCertifytlsshtlshakh_0_111111111111121111111111111
                                                                solve( state_111111111111121111111111111( ~RouterID.1,
                                                                                                          ~ServerID.1,
                                                                                                          ~ak_h,
                                                                                                          ~ak_sk.1,
                                                                                                          ~ssk_nms.1,
                                                                                                          ~tid.1,
                                                                                                          ~k_h,
                                                                                                          k_sh,
                                                                                                          tls_spk
                                                                       ) ▶₀ #t2.9 )
                                                                  case outTPMPolicyPCRtlssh_0_11111111111112111111111111
                                                                  solve( TPM_SendCommand( <'TPM2_Create', 
                                                                                           <swstate, nil>, 
                                                                                           'TPM_CC_PolicyPCR', 
                                                                                           nil>
                                                                         ) @ #t2.11 )
                                                                    case eventTPMSendCommandTPMCreateswstatenilTPMCCPolicyPCRnil_0_11111111111112111
                                                                    solve( state_11111111111112111( ~RouterID.1,
                                                                                                    ~ServerID.1,
                                                                                                    ~ak_h.1,
                                                                                                    ~ak_sk.1,
                                                                                                    ~ssk_nms.1,
                                                                                                    ~tid.1
                                                                           ) ▶₀ #t2.9 )
                                                                      case outTPMPCRExtendswstate_0_1111111111111211
                                                                      solve( Insert( <'privatePart', ~k_h>,
                                                                                     k_sk.1
                                                                             ) @ #t2.2 )
                                                                        case insertprivatePartkhksk_0_111111111111111111111121111111
                                                                        solve( Insert( <'authPolicy', ~k_h>,
                                                                                       k_ap
                                                                               ) @ #t2.9 )
                                                                          case insertauthPolicyakhnil_0_11111111111111
                                                                          by solve( state_11111111111111( ~RouterID.1,
                                                                                                          ~ServerID.1,
                                                                                                          ~k_h,
                                                                                                          ~ak_sk.1,
                                                                                                          ~ssk_nms.1
                                                                                    ) ▶₀ #t2.9 )
                                                                        next
                                                                          case insertauthPolicykhauthPolicy_0_11111111111111111111112111111
                                                                          solve( state_11111111111111111111112111111( ~RouterID.1,
                                                                                                                      ~ServerID.1,
                                                                                                                      ~ak_h.1,
                                                                                                                      ~ak_sk.1,
                                                                                                                      ~k_h,
                                                                                                                      ~k_sk.1,
                                                                                                                      ~ssk_nms.1,
                                                                                                                      k_ap,
                                                                                                                      lock
                                                                                 ) ▶₀ #t2.9 )
                                                                            case lockdevice_0_1111111111111111111111211111
                                                                            by contradiction /* cyclic */
                                                                          qed
                                                                        qed
                                                                      qed
                                                                    qed
                                                                  qed
                                                                qed
                                                              qed
                                                            qed
                                                          qed
                                                        qed
                                                      qed
                                                    qed
                                                  qed
                                                qed
                                              next
                                                case unlockdevice_0_11111111111111111111211111112
                                                by solve( state_11111111111111111111211111112( ~RouterID.1,
                                                                                               ~ServerID.1,
                                                                                               ~ak_h.1,
                                                                                               ~ak_sk.1,
                                                                                               ~ssk_nms.1,
                                                                                               a_h, obj_ap,
                                                                                               obj_h, obj_pd,
                                                                                               obj_pk, obj_sh,
                                                                                               ~n.2
                                                          ) ▶₀ #t2.8 )
                                              qed
                                            next
                                              case case_3
                                              solve( Unlock_4( '4', ~n.2, 'device' ) @ #t2.10 )
                                                case unlockdevice_0_111111111111111111112111111111
                                                solve( state_111111111111111111112111111111( ~RouterID.1,
                                                                                             ~ServerID.1,
                                                                                             ~ak_h.1,
                                                                                             ~ak_sk.1,
                                                                                             ~ssk_nms.1, a_h,
                                                                                             a_sk, obj_ap,
                                                                                             obj_h, obj_pd,
                                                                                             obj_pk, obj_sh,
                                                                                             ~n.2
                                                       ) ▶₀ #t2.8 )
                                                  case outsignobjpkobjapask_0_11111111111111111111211111111
                                                  solve( (#t2.5 < #t2.15)  ∥ (#t2.5 = #t2.15) )
                                                    case case_1
                                                    by contradiction /* from formulas */
                                                  next
                                                    case case_2
                                                    solve( (#t2.6 < #t2.15)  ∥ (#t2.6 = #t2.15) )
                                                      case case_1
                                                      by contradiction /* from formulas */
                                                    next
                                                      case case_2
                                                      solve( (#t2.7 < #t2.14)  ∥ (#t2.7 = #t2.14) )
                                                        case case_1
                                                        by contradiction /* from formulas */
                                                      next
                                                        case case_2
                                                        solve( (#t2.11 < #t2.14)  ∥ (#t2.11 = #t2.14) )
                                                          case case_1
                                                          by contradiction /* from formulas */
                                                        next
                                                          case case_2
                                                          solve( TPM_SendCommand( <'TPM2_Create', 
                                                                                   <swstate, nil>, 
                                                                                   'TPM_CC_PolicyPCR', nil>
                                                                 ) @ #t2.12 )
                                                            case eventTPMSendCommandTPMCreateswstatenilTPMCCPolicyPCRnil_0_11111111111112111
                                                            solve( state_11111111111112111( ~RouterID.1,
                                                                                            ~ServerID.1,
                                                                                            ~ak_h.1, ~ak_sk.1,
                                                                                            ~ssk_nms.1, ~tid.1
                                                                   ) ▶₀ #t2.9 )
                                                              case outTPMPCRExtendswstate_0_1111111111111211
                                                              solve( TPM_SendCommand( <'TPM2_Certify', k_sh, 
                                                                                       ~k_h, ~ak_h>
                                                                     ) @ #t2.12 )
                                                                case eventTPMSendCommandTPMCertifytlsshtlshakh_0_111111111111121111111111111
                                                                solve( state_111111111111121111111111111( ~RouterID.1,
                                                                                                          ~ServerID.1,
                                                                                                          ~ak_h,
                                                                                                          ~ak_sk.1,
                                                                                                          ~ssk_nms.1,
                                                                                                          ~tid.1,
                                                                                                          ~k_h,
                                                                                                          k_sh,
                                                                                                          tls_spk
                                                                       ) ▶₀ #t2.9 )
                                                                  case outTPMPolicyPCRtlssh_0_11111111111112111111111111
                                                                  solve( TPM_SendCommand( <'TPM2_Create', 
                                                                                           <swstate, nil>, 
                                                                                           'TPM_CC_PolicyPCR', 
                                                                                           nil>
                                                                         ) @ #t2.12 )
                                                                    case eventTPMSendCommandTPMCreateswstatenilTPMCCPolicyPCRnil_0_11111111111112111
                                                                    solve( state_11111111111112111( ~RouterID.1,
                                                                                                    ~ServerID.1,
                                                                                                    ~ak_h.1,
                                                                                                    ~ak_sk.1,
                                                                                                    ~ssk_nms.1,
                                                                                                    ~tid.1
                                                                           ) ▶₀ #t2.9 )
                                                                      case outTPMPCRExtendswstate_0_1111111111111211
                                                                      solve( Insert( <'privatePart', ~k_h>,
                                                                                     k_sk.1
                                                                             ) @ #t2.2 )
                                                                        case insertprivatePartkhksk_0_111111111111111111111121111111
                                                                        solve( Insert( <'authPolicy', ~k_h>,
                                                                                       k_ap
                                                                               ) @ #t2.9 )
                                                                          case insertauthPolicyakhnil_0_11111111111111
                                                                          by solve( state_11111111111111( ~RouterID.1,
                                                                                                          ~ServerID.1,
                                                                                                          ~k_h,
                                                                                                          ~ak_sk.1,
                                                                                                          ~ssk_nms.1
                                                                                    ) ▶₀ #t2.9 )
                                                                        next
                                                                          case insertauthPolicykhauthPolicy_0_11111111111111111111112111111
                                                                          solve( state_11111111111111111111112111111( ~RouterID.1,
                                                                                                                      ~ServerID.1,
                                                                                                                      ~ak_h.1,
                                                                                                                      ~ak_sk.1,
                                                                                                                      ~k_h,
                                                                                                                      ~k_sk.1,
                                                                                                                      ~ssk_nms.1,
                                                                                                                      k_ap,
                                                                                                                      lock
                                                                                 ) ▶₀ #t2.9 )
                                                                            case lockdevice_0_1111111111111111111111211111
                                                                            by contradiction /* cyclic */
                                                                          qed
                                                                        qed
                                                                      qed
                                                                    qed
                                                                  qed
                                                                qed
                                                              qed
                                                            qed
                                                          qed
                                                        qed
                                                      qed
                                                    qed
                                                  qed
                                                qed
                                              next
                                                case unlockdevice_0_11111111111111111111211111112
                                                by solve( state_11111111111111111111211111112( ~RouterID.1,
                                                                                               ~ServerID.1,
                                                                                               ~ak_h.1,
                                                                                               ~ak_sk.1,
                                                                                               ~ssk_nms.1,
                                                                                               a_h, obj_ap,
                                                                                               obj_h, obj_pd,
                                                                                               obj_pk, obj_sh,
                                                                                               ~n.2
                                                          ) ▶₀ #t2.8 )
                                              qed
                                            qed
                                          qed
                                        qed
                                      qed
                                    qed
                                  qed
                                qed
                              qed
                            next
                              case outtlsspksigntlsspkssknms_0_11111111111121111111111
                              by contradiction /* from formulas */
                            qed
                          qed
                        qed
                      qed
                    qed
                  qed
                qed
              next
                case case_2
                solve( TPM_SendCommand( <'TPM2_Create', authPolicy> ) @ #t2.4 )
                  case eventTPMSendCommandTPMCreateswstatenilTPMCCPolicyPCRnil_0_11111111111112111
                  solve( state_11111111111112111( ~RouterID.1, ~ServerID.1, ~ak_h.1,
                                                  ~ak_sk.1, ~ssk_nms.1, ~tid.1
                         ) ▶₀ #t2.4 )
                    case outTPMPCRExtendswstate_0_1111111111111211
                    solve( TPM_SendCommand( <'TPM2_Create', <swstate, nil>, 
                                             'TPM_CC_PolicyPCR', nil>
                           ) @ #t2.6 )
                      case eventTPMSendCommandTPMCreateswstatenilTPMCCPolicyPCRnil_0_11111111111112111
                      solve( state_11111111111112111( ~RouterID.1, ~ServerID.1, ~ak_h.1,
                                                      ~ak_sk.1, ~ssk_nms.1, ~tid.1
                             ) ▶₀ #t2.5 )
                        case outTPMPCRExtendswstate_0_1111111111111211
                        solve( TPM_SendCommand( <'TPM2_Create', <swstate, nil>, 
                                                 'TPM_CC_PolicyPCR', nil>
                               ) @ #t2.6 )
                          case eventTPMSendCommandTPMCreateswstatenilTPMCCPolicyPCRnil_0_11111111111112111
                          solve( state_11111111111112111( ~RouterID.1, ~ServerID.1, ~ak_h.1,
                                                          ~ak_sk.1, ~ssk_nms.1, ~tid.1
                                 ) ▶₀ #t2.5 )
                            case outTPMPCRExtendswstate_0_1111111111111211
                            solve( !KU( sign(pk(~k_sk), ~ssk_nms) ) @ #vk.6 )
                              case c_sign
                              solve( !KU( sign(<pk(~k_sk), <swstate, nil>, 'TPM_CC_PolicyPCR', nil>,
                                               ~ak_sk)
                                     ) @ #vk.7 )
                                case c_sign
                                solve( !KU( pk(~k_sk) ) @ #vk.3 )
                                  case c_pk
                                  solve( Insert( <'privatePart', ~k_h>, k_sk.1 ) @ #t2.2 )
                                    case insertprivatePartkhksk_0_111111111111111111111121111111
                                    solve( Insert( <'authPolicy', ~k_h>, k_ap ) @ #t2.3 )
                                      case insertauthPolicykhauthPolicy_0_11111111111111111111112111111
                                      solve( Insert( <'policyDigest', k_sh>,
                                                     <<swstate, nil>, 'TPM_CC_PolicyPCR', nil>
                                             ) @ #t2.5 )
                                        case insertpolicyDigestshpcrLTPMCCPolicyPCRpL_0_111111111111111111111112111111
                                        solve( state_111111111111111111111112111111( ~RouterID.1, ~ServerID.1,
                                                                                     ~ak_h.1, ~ak_sk.1,
                                                                                     ~ssk_nms.1, nil,
                                                                                     <swstate, nil>, k_sh,
                                                                                     lock
                                               ) ▶₀ #t2.5 )
                                          case eventPolicyPCRshpL_0_11111111111111111111111211111
                                          solve( (#vr.72 < #vr.48)  ∥ (#t2 < #vr.72) )
                                            case case_1
                                            solve( (#vr.29 < #t2.9)  ∥ (#vr.29 = #t2.9) )
                                              case case_1
                                              solve( state_1111111111111111111111121111111( ~RouterID.1,
                                                                                            ~ServerID.1,
                                                                                            ~ak_h.1, ~ak_sk.1,
                                                                                            ~ssk_nms.1, pL,
                                                                                            pcrL, s_h, ~n.2
                                                     ) ▶₀ #t2.6 )
                                                case insertpolicyDigestshpcrLTPMCCPolicyPCRpL_0_111111111111111111111112111111
                                                solve( (#vr.29 < #t2.12)  ∥ (#vr.29 = #t2.12) )
                                                  case case_1
                                                  solve( (#t2.9 < #t2.12)  ∥ (#t2.9 = #t2.12) )
                                                    case case_1
                                                    by contradiction /* from formulas */
                                                  next
                                                    case case_2
                                                    solve( (#t2.8 < #t2.11)  ∥ (#t2.8 = #t2.11) )
                                                      case case_1
                                                      by contradiction /* from formulas */
                                                    next
                                                      case case_2
                                                      solve( TPM_SendCommand( <'TPM2_PolicyPCR', k_sh>
                                                             ) @ #t2.7 )
                                                        case eventTPMSendCommandTPMPolicyPCRtlssh_0_1111111111111211111111111
                                                        solve( state_1111111111111211111111111( ~RouterID.1,
                                                                                                ~ServerID.1,
                                                                                                ~ak_h.1,
                                                                                                ~ak_sk.1,
                                                                                                ~ssk_nms.1,
                                                                                                ~tid.1, tls_h,
                                                                                                k_sh, tls_spk
                                                               ) ▶₀ #t2.7 )
                                                          case eventGenerateTLStidtlsspk_0_111111111111121111111111
                                                          by contradiction /* cyclic */
                                                        qed
                                                      qed
                                                    qed
                                                  qed
                                                next
                                                  case case_2
                                                  by contradiction /* from formulas */
                                                qed
                                              qed
                                            next
                                              case case_2
                                              solve( state_1111111111111111111111121111111( ~RouterID.1,
                                                                                            ~ServerID.1,
                                                                                            ~ak_h.1, ~ak_sk.1,
                                                                                            ~ssk_nms.1, pL,
                                                                                            pcrL, s_h, ~n.2
                                                     ) ▶₀ #t2.6 )
                                                case insertpolicyDigestshpcrLTPMCCPolicyPCRpL_0_111111111111111111111112111111
                                                solve( (#t2.7 < #t2.12)  ∥ (#t2.7 = #t2.12) )
                                                  case case_1
                                                  by contradiction /* from formulas */
                                                next
                                                  case case_2
                                                  solve( (#t2.9 < #t2.11)  ∥ (#t2.9 = #t2.11) )
                                                    case case_1
                                                    by contradiction /* from formulas */
                                                  next
                                                    case case_2
                                                    solve( TPM_SendCommand( <'TPM2_PolicyPCR', k_sh>
                                                           ) @ #t2.8 )
                                                      case eventTPMSendCommandTPMPolicyPCRtlssh_0_1111111111111211111111111
                                                      solve( state_1111111111111211111111111( ~RouterID.1,
                                                                                              ~ServerID.1,
                                                                                              ~ak_h.1,
                                                                                              ~ak_sk.1,
                                                                                              ~ssk_nms.1,
                                                                                              ~tid.1, tls_h,
                                                                                              k_sh, tls_spk
                                                             ) ▶₀ #t2.8 )
                                                        case eventGenerateTLStidtlsspk_0_111111111111121111111111
                                                        by contradiction /* cyclic */
                                                      qed
                                                    qed
                                                  qed
                                                qed
                                              qed
                                            qed
                                          next
                                            case case_2
                                            solve( ((#vr.17 < #vr.72) ∧
                                                    (∃ #t2.
                                                      (Unlock_5( '5', ~n.1, 'device' ) @ #t2)
                                                     ∧
                                                      (#vr.17 < #t2) ∧
                                                      (#t2 < #vr.72) ∧
                                                      (∀ #t0 pp.
                                                        (Unlock( pp, ~n.1, 'device' ) @ #t0) ⇒ #t0 = #t2) ∧
                                                      (∀ pp lpp #t0.
                                                        (Lock( pp, lpp, 'device' ) @ #t0)
                                                       ⇒
                                                        ((#t0 < #vr.17) ∨ (#t0 = #vr.17) ∨ (#t2 < #t0))) ∧
                                                      (∀ pp lpp #t0.
                                                        (Unlock( pp, lpp, 'device' ) @ #t0)
                                                       ⇒
                                                        ((#t0 < #vr.17) ∨ (#t2 < #t0) ∨ (#t2 = #t0)))))  ∥
                                                   (#vr.72 < #vr.17) )
                                              case case_1
                                              solve( (#vr.29 < #t2.8)  ∥ (#vr.29 = #t2.8) )
                                                case case_1
                                                solve( TPM_SendCommand( <'TPM2_PolicyPCR', k_sh> ) @ #t2.6 )
                                                  case eventTPMSendCommandTPMPolicyPCRtlssh_0_1111111111111211111111111
                                                  solve( state_1111111111111211111111111( ~RouterID.1,
                                                                                          ~ServerID.1,
                                                                                          ~ak_h.1, ~ak_sk.1,
                                                                                          ~ssk_nms.1, ~tid.1,
                                                                                          tls_h, k_sh, tls_spk
                                                         ) ▶₀ #t2.6 )
                                                    case eventGenerateTLStidtlsspk_0_111111111111121111111111
                                                    solve( Unlock_5( '5', ~n.1, 'device' ) @ #t2.9 )
                                                      case unlockdevice_0_1111111111111111111211111111
                                                      solve( state_1111111111111111111211111111( ~RouterID.1,
                                                                                                 ~ServerID.1,
                                                                                                 ~ak_h.1,
                                                                                                 ~ak_sk.1,
                                                                                                 ~ssk_nms.1,
                                                                                                 k_ap, k_h.1,
                                                                                                 k_pd, k_sh.1,
                                                                                                 k_sk.1, m,
                                                                                                 ~n.1
                                                             ) ▶₀ #t2.7 )
                                                        case TpmSignOutsignmksk_0_111111111111111111121111111
                                                        by contradiction /* cyclic */
                                                      qed
                                                    next
                                                      case unlockdevice_0_111111111111111111121111112
                                                      by solve( state_111111111111111111121111112( ~RouterID.1,
                                                                                                   ~ServerID.1,
                                                                                                   ~ak_h.1,
                                                                                                   ~ak_sk.1,
                                                                                                   ~ssk_nms.1,
                                                                                                   k_ap,
                                                                                                   k_h.1,
                                                                                                   k_pd,
                                                                                                   k_sh.1, m,
                                                                                                   ~n.1
                                                                ) ▶₀ #t2.7 )
                                                    qed
                                                  qed
                                                qed
                                              next
                                                case case_2
                                                solve( TPM_SendCommand( <'TPM2_PolicyPCR', k_sh> ) @ #t2.7 )
                                                  case eventTPMSendCommandTPMPolicyPCRtlssh_0_1111111111111211111111111
                                                  solve( state_1111111111111211111111111( ~RouterID.1,
                                                                                          ~ServerID.1,
                                                                                          ~ak_h.1, ~ak_sk.1,
                                                                                          ~ssk_nms.1, ~tid.1,
                                                                                          tls_h, k_sh, tls_spk
                                                         ) ▶₀ #t2.7 )
                                                    case eventGenerateTLStidtlsspk_0_111111111111121111111111
                                                    solve( Unlock_5( '5', ~n.1, 'device' ) @ #t2.9 )
                                                      case unlockdevice_0_1111111111111111111211111111
                                                      solve( state_1111111111111111111211111111( ~RouterID.1,
                                                                                                 ~ServerID.1,
                                                                                                 ~ak_h.1,
                                                                                                 ~ak_sk.1,
                                                                                                 ~ssk_nms.1,
                                                                                                 k_ap, k_h.1,
                                                                                                 k_pd, k_sh.1,
                                                                                                 k_sk.1, m,
                                                                                                 ~n.1
                                                             ) ▶₀ #t2.8 )
                                                        case TpmSignOutsignmksk_0_111111111111111111121111111
                                                        by contradiction /* cyclic */
                                                      qed
                                                    next
                                                      case unlockdevice_0_111111111111111111121111112
                                                      by solve( state_111111111111111111121111112( ~RouterID.1,
                                                                                                   ~ServerID.1,
                                                                                                   ~ak_h.1,
                                                                                                   ~ak_sk.1,
                                                                                                   ~ssk_nms.1,
                                                                                                   k_ap,
                                                                                                   k_h.1,
                                                                                                   k_pd,
                                                                                                   k_sh.1, m,
                                                                                                   ~n.1
                                                                ) ▶₀ #t2.8 )
                                                    qed
                                                  qed
                                                qed
                                              qed
                                            next
                                              case case_2
                                              solve( (#vr.29 < #t2.9)  ∥ (#vr.29 = #t2.9) )
                                                case case_1
                                                solve( state_1111111111111111111111121111111( ~RouterID.1,
                                                                                              ~ServerID.1,
                                                                                              ~ak_h.1,
                                                                                              ~ak_sk.1,
                                                                                              ~ssk_nms.1, pL,
                                                                                              pcrL, s_h, ~n.2
                                                       ) ▶₀ #t2.6 )
                                                  case insertpolicyDigestshpcrLTPMCCPolicyPCRpL_0_111111111111111111111112111111
                                                  solve( (#vr.29 < #t2.12)  ∥ (#vr.29 = #t2.12) )
                                                    case case_1
                                                    solve( (#t2.9 < #t2.12)  ∥ (#t2.9 = #t2.12) )
                                                      case case_1
                                                      by contradiction /* from formulas */
                                                    next
                                                      case case_2
                                                      solve( (#t2.8 < #t2.11)  ∥ (#t2.8 = #t2.11) )
                                                        case case_1
                                                        by contradiction /* from formulas */
                                                      next
                                                        case case_2
                                                        solve( TPM_SendCommand( <'TPM2_PolicyPCR', k_sh>
                                                               ) @ #t2.7 )
                                                          case eventTPMSendCommandTPMPolicyPCRtlssh_0_1111111111111211111111111
                                                          solve( state_1111111111111211111111111( ~RouterID.1,
                                                                                                  ~ServerID.1,
                                                                                                  ~ak_h.1,
                                                                                                  ~ak_sk.1,
                                                                                                  ~ssk_nms.1,
                                                                                                  ~tid.1,
                                                                                                  tls_h, k_sh,
                                                                                                  tls_spk
                                                                 ) ▶₀ #t2.7 )
                                                            case eventGenerateTLStidtlsspk_0_111111111111121111111111
                                                            solve( TPM_SendCommand( <'TPM2_PolicyPCR', k_sh>
                                                                   ) @ #t2.10 )
                                                              case eventTPMSendCommandTPMPolicyPCRtlssh_0_1111111111111211111111111
                                                              solve( state_1111111111111211111111111( ~RouterID.1,
                                                                                                      ~ServerID.1,
                                                                                                      ~ak_h.1,
                                                                                                      ~ak_sk.1,
                                                                                                      ~ssk_nms.1,
                                                                                                      ~tid.1,
                                                                                                      tls_h,
                                                                                                      k_sh,
                                                                                                      tls_spk
                                                                     ) ▶₀ #t2.8 )
                                                                case eventGenerateTLStidtlsspk_0_111111111111121111111111
                                                                solve( TPM_SendCommand( <'TPM2_Create', 
                                                                                         <swstate, nil>, 
                                                                                         'TPM_CC_PolicyPCR', 
                                                                                         nil>
                                                                       ) @ #t2.10 )
                                                                  case eventTPMSendCommandTPMCreateswstatenilTPMCCPolicyPCRnil_0_11111111111112111
                                                                  solve( state_11111111111112111( ~RouterID.1,
                                                                                                  ~ServerID.1,
                                                                                                  ~ak_h.1,
                                                                                                  ~ak_sk.1,
                                                                                                  ~ssk_nms.1,
                                                                                                  ~tid.1
                                                                         ) ▶₀ #t2.8 )
                                                                    case outTPMPCRExtendswstate_0_1111111111111211
                                                                    solve( TPM_SendCommand( <'TPM2_Create', 
                                                                                             <swstate, nil>, 
                                                                                             'TPM_CC_PolicyPCR', 
                                                                                             nil>
                                                                           ) @ #t2.10 )
                                                                      case eventTPMSendCommandTPMCreateswstatenilTPMCCPolicyPCRnil_0_11111111111112111
                                                                      solve( state_11111111111112111( ~RouterID.1,
                                                                                                      ~ServerID.1,
                                                                                                      ~ak_h.1,
                                                                                                      ~ak_sk.1,
                                                                                                      ~ssk_nms.1,
                                                                                                      ~tid.1
                                                                             ) ▶₀ #t2.8 )
                                                                        case outTPMPCRExtendswstate_0_1111111111111211
                                                                        by solve( !KU( ~ssk_nms ) @ #vk.21 )
                                                                      qed
                                                                    qed
                                                                  qed
                                                                qed
                                                              qed
                                                            qed
                                                          qed
                                                        qed
                                                      qed
                                                    qed
                                                  next
                                                    case case_2
                                                    by contradiction /* from formulas */
                                                  qed
                                                qed
                                              next
                                                case case_2
                                                solve( state_1111111111111111111111121111111( ~RouterID.1,
                                                                                              ~ServerID.1,
                                                                                              ~ak_h.1,
                                                                                              ~ak_sk.1,
                                                                                              ~ssk_nms.1, pL,
                                                                                              pcrL, s_h, ~n.2
                                                       ) ▶₀ #t2.6 )
                                                  case insertpolicyDigestshpcrLTPMCCPolicyPCRpL_0_111111111111111111111112111111
                                                  solve( (#t2.7 < #t2.12)  ∥ (#t2.7 = #t2.12) )
                                                    case case_1
                                                    by contradiction /* from formulas */
                                                  next
                                                    case case_2
                                                    solve( (#t2.9 < #t2.11)  ∥ (#t2.9 = #t2.11) )
                                                      case case_1
                                                      by contradiction /* from formulas */
                                                    next
                                                      case case_2
                                                      solve( TPM_SendCommand( <'TPM2_PolicyPCR', k_sh>
                                                             ) @ #t2.8 )
                                                        case eventTPMSendCommandTPMPolicyPCRtlssh_0_1111111111111211111111111
                                                        solve( state_1111111111111211111111111( ~RouterID.1,
                                                                                                ~ServerID.1,
                                                                                                ~ak_h.1,
                                                                                                ~ak_sk.1,
                                                                                                ~ssk_nms.1,
                                                                                                ~tid.1, tls_h,
                                                                                                k_sh, tls_spk
                                                               ) ▶₀ #t2.8 )
                                                          case eventGenerateTLStidtlsspk_0_111111111111121111111111
                                                          solve( TPM_SendCommand( <'TPM2_PolicyPCR', k_sh>
                                                                 ) @ #t2.10 )
                                                            case eventTPMSendCommandTPMPolicyPCRtlssh_0_1111111111111211111111111
                                                            solve( state_1111111111111211111111111( ~RouterID.1,
                                                                                                    ~ServerID.1,
                                                                                                    ~ak_h.1,
                                                                                                    ~ak_sk.1,
                                                                                                    ~ssk_nms.1,
                                                                                                    ~tid.1,
                                                                                                    tls_h,
                                                                                                    k_sh,
                                                                                                    tls_spk
                                                                   ) ▶₀ #t2.9 )
                                                              case eventGenerateTLStidtlsspk_0_111111111111121111111111
                                                              solve( TPM_SendCommand( <'TPM2_Create', 
                                                                                       <swstate, nil>, 
                                                                                       'TPM_CC_PolicyPCR', nil
                                                                                      >
                                                                     ) @ #t2.10 )
                                                                case eventTPMSendCommandTPMCreateswstatenilTPMCCPolicyPCRnil_0_11111111111112111
                                                                solve( state_11111111111112111( ~RouterID.1,
                                                                                                ~ServerID.1,
                                                                                                ~ak_h.1,
                                                                                                ~ak_sk.1,
                                                                                                ~ssk_nms.1,
                                                                                                ~tid.1
                                                                       ) ▶₀ #t2.9 )
                                                                  case outTPMPCRExtendswstate_0_1111111111111211
                                                                  solve( TPM_SendCommand( <'TPM2_Create', 
                                                                                           <swstate, nil>, 
                                                                                           'TPM_CC_PolicyPCR', 
                                                                                           nil>
                                                                         ) @ #t2.10 )
                                                                    case eventTPMSendCommandTPMCreateswstatenilTPMCCPolicyPCRnil_0_11111111111112111
                                                                    solve( state_11111111111112111( ~RouterID.1,
                                                                                                    ~ServerID.1,
                                                                                                    ~ak_h.1,
                                                                                                    ~ak_sk.1,
                                                                                                    ~ssk_nms.1,
                                                                                                    ~tid.1
                                                                           ) ▶₀ #t2.9 )
                                                                      case outTPMPCRExtendswstate_0_1111111111111211
                                                                      by solve( !KU( ~ssk_nms ) @ #vk.21 )
                                                                    qed
                                                                  qed
                                                                qed
                                                              qed
                                                            qed
                                                          qed
                                                        qed
                                                      qed
                                                    qed
                                                  qed
                                                qed
                                              qed
                                            qed
                                          qed
                                        qed
                                      qed
                                    qed
                                  qed
                                next
                                  case outTPMSigntlsshtlshtlsspkskae_0_1111111111111211111111111111111111
                                  by contradiction /* cyclic */
                                next
                                  case outtlsspkskaecsr_0_11111111111112111111111111111111111111
                                  by contradiction /* cyclic */
                                qed
                              next
                                case outsignobjpkobjapask_0_11111111111111111111211111111
                                solve( (#vr.75 < #vr.48)  ∥ (#t2 < #vr.75) )
                                  case case_1
                                  solve( TPM_SendCommand( <'TPM2_Certify', obj_sh, obj_h, a_h> ) @ #t2.7 )
                                    case eventTPMSendCommandTPMCertifytlsshtlshakh_0_111111111111121111111111111
                                    solve( state_111111111111121111111111111( ~RouterID.1, ~ServerID.1,
                                                                              ~ak_h.1, ~ak_sk.1, ~ssk_nms.1,
                                                                              ~tid.1, obj_h, obj_sh, tls_spk
                                           ) ▶₀ #t2.5 )
                                      case outTPMPolicyPCRtlssh_0_11111111111112111111111111
                                      by contradiction /* cyclic */
                                    qed
                                  qed
                                next
                                  case case_2
                                  solve( TPM_SendCommand( <'TPM2_Certify', obj_sh, obj_h, a_h> ) @ #t2.7 )
                                    case eventTPMSendCommandTPMCertifytlsshtlshakh_0_111111111111121111111111111
                                    solve( state_111111111111121111111111111( ~RouterID.1, ~ServerID.1,
                                                                              ~ak_h.1, ~ak_sk.1, ~ssk_nms.1,
                                                                              ~tid.1, obj_h, obj_sh, tls_spk
                                           ) ▶₀ #t2.5 )
                                      case outTPMPolicyPCRtlssh_0_11111111111112111111111111
                                      solve( (#vr.40 < #t2.9)  ∥ (#vr.40 = #t2.9) )
                                        case case_1
                                        solve( (#t2.3 < #t2.10)  ∥ (#t2.3 = #t2.10) )
                                          case case_1
                                          by contradiction /* from formulas */
                                        next
                                          case case_2
                                          solve( (#vr.32 < #t2.8)  ∥ (#vr.32 = #t2.8) )
                                            case case_1
                                            solve( (#t2.6 < #t2.10)  ∥ (#t2.6 = #t2.10)  ∥ (#vr.73 < #t2.6) )
                                              case case_1
                                              by contradiction /* from formulas */
                                            next
                                              case case_2
                                              solve( Unlock_4( '4', ~n.2, 'device' ) @ #t2.7 )
                                                case unlockdevice_0_111111111111111111112111111111
                                                solve( state_111111111111111111112111111111( ~RouterID.1,
                                                                                             ~ServerID.1,
                                                                                             ~ak_h.1,
                                                                                             ~ak_sk.1,
                                                                                             ~ssk_nms.1, a_h,
                                                                                             a_sk, obj_ap,
                                                                                             obj_h, obj_pd,
                                                                                             obj_pk, obj_sh,
                                                                                             ~n.2
                                                       ) ▶₀ #t2.6 )
                                                  case outsignobjpkobjapask_0_11111111111111111111211111111
                                                  solve( (#t2.3 < #t2.14)  ∥ (#t2.3 = #t2.14) )
                                                    case case_1
                                                    by contradiction /* from formulas */
                                                  next
                                                    case case_2
                                                    solve( (#t2.7 < #t2.14)  ∥ (#t2.7 = #t2.14) )
                                                      case case_1
                                                      by contradiction /* from formulas */
                                                    next
                                                      case case_2
                                                      solve( (#vr.32 < #t2.12)  ∥ (#vr.32 = #t2.12) )
                                                        case case_1
                                                        solve( (#vr.40 < #t2.13)  ∥ (#vr.40 = #t2.13) )
                                                          case case_1
                                                          solve( (#t2.9 < #t2.13)  ∥ (#t2.9 = #t2.13) )
                                                            case case_1
                                                            by contradiction /* from formulas */
                                                          next
                                                            case case_2
                                                            solve( (#t2.8 < #t2.12)  ∥ (#t2.8 = #t2.12) )
                                                              case case_1
                                                              by contradiction /* from formulas */
                                                            next
                                                              case case_2
                                                              solve( TPM_SendCommand( <'TPM2_Create', 
                                                                                       <swstate, nil>, 
                                                                                       'TPM_CC_PolicyPCR', nil
                                                                                      >
                                                                     ) @ #t2.10 )
                                                                case eventTPMSendCommandTPMCreateswstatenilTPMCCPolicyPCRnil_0_11111111111112111
                                                                solve( state_11111111111112111( ~RouterID.1,
                                                                                                ~ServerID.1,
                                                                                                ~ak_h.1,
                                                                                                ~ak_sk.1,
                                                                                                ~ssk_nms.1,
                                                                                                ~tid.1
                                                                       ) ▶₀ #t2.7 )
                                                                  case outTPMPCRExtendswstate_0_1111111111111211
                                                                  solve( TPM_SendCommand( <'TPM2_Certify', 
                                                                                           k_sh, ~k_h, ~ak_h>
                                                                         ) @ #t2.10 )
                                                                    case eventTPMSendCommandTPMCertifytlsshtlshakh_0_111111111111121111111111111
                                                                    solve( state_111111111111121111111111111( ~RouterID.1,
                                                                                                              ~ServerID.1,
                                                                                                              ~ak_h,
                                                                                                              ~ak_sk.1,
                                                                                                              ~ssk_nms.1,
                                                                                                              ~tid.1,
                                                                                                              ~k_h,
                                                                                                              k_sh,
                                                                                                              tls_spk
                                                                           ) ▶₀ #t2.7 )
                                                                      case outTPMPolicyPCRtlssh_0_11111111111112111111111111
                                                                      solve( TPM_SendCommand( <'TPM2_Create', 
                                                                                               <swstate, nil
                                                                                               >, 
                                                                                               'TPM_CC_PolicyPCR', 
                                                                                               nil>
                                                                             ) @ #t2.10 )
                                                                        case eventTPMSendCommandTPMCreateswstatenilTPMCCPolicyPCRnil_0_11111111111112111
                                                                        solve( state_11111111111112111( ~RouterID.1,
                                                                                                        ~ServerID.1,
                                                                                                        ~ak_h.1,
                                                                                                        ~ak_sk.1,
                                                                                                        ~ssk_nms.1,
                                                                                                        ~tid.1
                                                                               ) ▶₀ #t2.7 )
                                                                          case outTPMPCRExtendswstate_0_1111111111111211
                                                                          solve( Insert( <'privatePart', ~k_h
                                                                                         >,
                                                                                         k_sk.1
                                                                                 ) @ #t2.2 )
                                                                            case insertprivatePartkhksk_0_111111111111111111111121111111
                                                                            solve( Insert( <'authPolicy', ~k_h
                                                                                           >,
                                                                                           k_ap
                                                                                   ) @ #t2.3 )
                                                                              case insertauthPolicykhauthPolicy_0_11111111111111111111112111111
                                                                              solve( Insert( <'policyDigest', 
                                                                                              k_sh>,
                                                                                             <<swstate, nil>, 
                                                                                              'TPM_CC_PolicyPCR', 
                                                                                              nil>
                                                                                     ) @ #t2.7 )
                                                                                case insertpolicyDigestshpcrLTPMCCPolicyPCRpL_0_111111111111111111111112111111
                                                                                solve( state_111111111111111111111112111111( ~RouterID.1,
                                                                                                                             ~ServerID.1,
                                                                                                                             ~ak_h.1,
                                                                                                                             ~ak_sk.1,
                                                                                                                             ~ssk_nms.1,
                                                                                                                             nil,
                                                                                                                             <
                                                                                                                              swstate, 
                                                                                                                              nil
                                                                                                                             >,
                                                                                                                             k_sh,
                                                                                                                             lock
                                                                                       ) ▶₀ #t2.7 )
                                                                                  case eventPolicyPCRshpL_0_11111111111111111111111211111
                                                                                  solve( (#vr.83 < #vr.47)  ∥
                                                                                         (#t2 < #vr.83) )
                                                                                    case case_1
                                                                                    solve( (#vr.28 < #t2.13)  ∥
                                                                                           (#vr.28 = #t2.13) )
                                                                                      case case_1
                                                                                      solve( state_1111111111111111111111121111111( ~RouterID.1,
                                                                                                                                    ~ServerID.1,
                                                                                                                                    ~ak_h.1,
                                                                                                                                    ~ak_sk.1,
                                                                                                                                    ~ssk_nms.1,
                                                                                                                                    pL,
                                                                                                                                    pcrL,
                                                                                                                                    s_h,
                                                                                                                                    ~n.3
                                                                                             ) ▶₀ #t2.8 )
                                                                                        case insertpolicyDigestshpcrLTPMCCPolicyPCRpL_0_111111111111111111111112111111
                                                                                        solve( (#vr.28 < #t2.16)  ∥
                                                                                               (#vr.28 =
                                                                                                #t2.16) )
                                                                                          case case_1
                                                                                          solve( (#t2.13 < #t2.16)  ∥
                                                                                                 (#t2.13 =
                                                                                                  #t2.16) )
                                                                                            case case_1
                                                                                            by contradiction
                                                                                               /*
                                                                                               from formulas
                                                                                               */
                                                                                          next
                                                                                            case case_2
                                                                                            solve( (#t2.12 < #t2.15)  ∥
                                                                                                   (#t2.12 =
                                                                                                    #t2.15) )
                                                                                              case case_1
                                                                                              by contradiction
                                                                                                 /*
                                                                                                 from formulas
                                                                                                 */
                                                                                            next
                                                                                              case case_2
                                                                                              solve( TPM_SendCommand( <
                                                                                                                       'TPM2_PolicyPCR', 
                                                                                                                       k_sh
                                                                                                                      >
                                                                                                     ) @ #t2.11 )
                                                                                                case eventTPMSendCommandTPMPolicyPCRtlssh_0_1111111111111211111111111
                                                                                                solve( state_1111111111111211111111111( ~RouterID.1,
                                                                                                                                        ~ServerID.1,
                                                                                                                                        ~ak_h.1,
                                                                                                                                        ~ak_sk.1,
                                                                                                                                        ~ssk_nms.1,
                                                                                                                                        ~tid.1,
                                                                                                                                        tls_h,
                                                                                                                                        k_sh,
                                                                                                                                        tls_spk
                                                                                                       ) ▶₀ #t2.9 )
                                                                                                  case eventGenerateTLStidtlsspk_0_111111111111121111111111
                                                                                                  by contradiction
                                                                                                     /* cyclic
                                                                                                     */
                                                                                                qed
                                                                                              qed
                                                                                            qed
                                                                                          qed
                                                                                        next
                                                                                          case case_2
                                                                                          by contradiction
                                                                                             /* from formulas
                                                                                             */
                                                                                        qed
                                                                                      qed
                                                                                    next
                                                                                      case case_2
                                                                                      solve( state_1111111111111111111111121111111( ~RouterID.1,
                                                                                                                                    ~ServerID.1,
                                                                                                                                    ~ak_h.1,
                                                                                                                                    ~ak_sk.1,
                                                                                                                                    ~ssk_nms.1,
                                                                                                                                    pL,
                                                                                                                                    pcrL,
                                                                                                                                    s_h,
                                                                                                                                    ~n.3
                                                                                             ) ▶₀ #t2.8 )
                                                                                        case insertpolicyDigestshpcrLTPMCCPolicyPCRpL_0_111111111111111111111112111111
                                                                                        solve( (#t2.9 < #t2.16)  ∥
                                                                                               (#t2.9 =
                                                                                                #t2.16) )
                                                                                          case case_1
                                                                                          by contradiction
                                                                                             /* from formulas
                                                                                             */
                                                                                        next
                                                                                          case case_2
                                                                                          solve( (#t2.13 < #t2.15)  ∥
                                                                                                 (#t2.13 =
                                                                                                  #t2.15) )
                                                                                            case case_1
                                                                                            by contradiction
                                                                                               /*
                                                                                               from formulas
                                                                                               */
                                                                                          next
                                                                                            case case_2
                                                                                            solve( TPM_SendCommand( <
                                                                                                                     'TPM2_PolicyPCR', 
                                                                                                                     k_sh
                                                                                                                    >
                                                                                                   ) @ #t2.12 )
                                                                                              case eventTPMSendCommandTPMPolicyPCRtlssh_0_1111111111111211111111111
                                                                                              solve( state_1111111111111211111111111( ~RouterID.1,
                                                                                                                                      ~ServerID.1,
                                                                                                                                      ~ak_h.1,
                                                                                                                                      ~ak_sk.1,
                                                                                                                                      ~ssk_nms.1,
                                                                                                                                      ~tid.1,
                                                                                                                                      tls_h,
                                                                                                                                      k_sh,
                                                                                                                                      tls_spk
                                                                                                     ) ▶₀ #t2.10 )
                                                                                                case eventGenerateTLStidtlsspk_0_111111111111121111111111
                                                                                                by contradiction
                                                                                                   /* cyclic
                                                                                                   */
                                                                                              qed
                                                                                            qed
                                                                                          qed
                                                                                        qed
                                                                                      qed
                                                                                    qed
                                                                                  next
                                                                                    case case_2
                                                                                    solve( (#vr.28 < #t2.13)  ∥
                                                                                           (#vr.28 = #t2.13) )
                                                                                      case case_1
                                                                                      solve( state_1111111111111111111111121111111( ~RouterID.1,
                                                                                                                                    ~ServerID.1,
                                                                                                                                    ~ak_h.1,
                                                                                                                                    ~ak_sk.1,
                                                                                                                                    ~ssk_nms.1,
                                                                                                                                    pL,
                                                                                                                                    pcrL,
                                                                                                                                    s_h,
                                                                                                                                    ~n.3
                                                                                             ) ▶₀ #t2.8 )
                                                                                        case insertpolicyDigestshpcrLTPMCCPolicyPCRpL_0_111111111111111111111112111111
                                                                                        solve( (#vr.28 < #t2.16)  ∥
                                                                                               (#vr.28 =
                                                                                                #t2.16) )
                                                                                          case case_1
                                                                                          solve( (#t2.13 < #t2.16)  ∥
                                                                                                 (#t2.13 =
                                                                                                  #t2.16) )
                                                                                            case case_1
                                                                                            by contradiction
                                                                                               /*
                                                                                               from formulas
                                                                                               */
                                                                                          next
                                                                                            case case_2
                                                                                            solve( (#t2.12 < #t2.15)  ∥
                                                                                                   (#t2.12 =
                                                                                                    #t2.15) )
                                                                                              case case_1
                                                                                              by contradiction
                                                                                                 /*
                                                                                                 from formulas
                                                                                                 */
                                                                                            next
                                                                                              case case_2
                                                                                              solve( TPM_SendCommand( <
                                                                                                                       'TPM2_PolicyPCR', 
                                                                                                                       k_sh
                                                                                                                      >
                                                                                                     ) @ #t2.11 )
                                                                                                case eventTPMSendCommandTPMPolicyPCRtlssh_0_1111111111111211111111111
                                                                                                solve( state_1111111111111211111111111( ~RouterID.1,
                                                                                                                                        ~ServerID.1,
                                                                                                                                        ~ak_h.1,
                                                                                                                                        ~ak_sk.1,
                                                                                                                                        ~ssk_nms.1,
                                                                                                                                        ~tid.1,
                                                                                                                                        tls_h,
                                                                                                                                        k_sh,
                                                                                                                                        tls_spk
                                                                                                       ) ▶₀ #t2.9 )
                                                                                                  case eventGenerateTLStidtlsspk_0_111111111111121111111111
                                                                                                  solve( TPM_SendCommand( <
                                                                                                                           'TPM2_PolicyPCR', 
                                                                                                                           k_sh
                                                                                                                          >
                                                                                                         ) @ #t2.14 )
                                                                                                    case eventTPMSendCommandTPMPolicyPCRtlssh_0_1111111111111211111111111
                                                                                                    solve( state_1111111111111211111111111( ~RouterID.1,
                                                                                                                                            ~ServerID.1,
                                                                                                                                            ~ak_h.1,
                                                                                                                                            ~ak_sk.1,
                                                                                                                                            ~ssk_nms.1,
                                                                                                                                            ~tid.1,
                                                                                                                                            tls_h,
                                                                                                                                            k_sh,
                                                                                                                                            tls_spk
                                                                                                           ) ▶₀ #t2.10 )
                                                                                                      case eventGenerateTLStidtlsspk_0_111111111111121111111111
                                                                                                      solve( TPM_SendCommand( <
                                                                                                                               'TPM2_Create', 
                                                                                                                               <
                                                                                                                                swstate, 
                                                                                                                                nil
                                                                                                                               >, 
                                                                                                                               'TPM_CC_PolicyPCR', 
                                                                                                                               nil
                                                                                                                              >
                                                                                                             ) @ #t2.14 )
                                                                                                        case eventTPMSendCommandTPMCreateswstatenilTPMCCPolicyPCRnil_0_11111111111112111
                                                                                                        solve( state_11111111111112111( ~RouterID.1,
                                                                                                                                        ~ServerID.1,
                                                                                                                                        ~ak_h.1,
                                                                                                                                        ~ak_sk.1,
                                                                                                                                        ~ssk_nms.1,
                                                                                                                                        ~tid.1
                                                                                                               ) ▶₀ #t2.10 )
                                                                                                          case outTPMPCRExtendswstate_0_1111111111111211
                                                                                                          solve( TPM_SendCommand( <
                                                                                                                                   'TPM2_Create', 
                                                                                                                                   <
                                                                                                                                    swstate, 
                                                                                                                                    nil
                                                                                                                                   >, 
                                                                                                                                   'TPM_CC_PolicyPCR', 
                                                                                                                                   nil
                                                                                                                                  >
                                                                                                                 ) @ #t2.14 )
                                                                                                            case eventTPMSendCommandTPMCreateswstatenilTPMCCPolicyPCRnil_0_11111111111112111
                                                                                                            solve( state_11111111111112111( ~RouterID.1,
                                                                                                                                            ~ServerID.1,
                                                                                                                                            ~ak_h.1,
                                                                                                                                            ~ak_sk.1,
                                                                                                                                            ~ssk_nms.1,
                                                                                                                                            ~tid.1
                                                                                                                   ) ▶₀ #t2.10 )
                                                                                                              case outTPMPCRExtendswstate_0_1111111111111211
                                                                                                              by solve( !KU( ~ssk_nms
                                                                                                                        ) @ #vk.23 )
                                                                                                            qed
                                                                                                          qed
                                                                                                        qed
                                                                                                      qed
                                                                                                    qed
                                                                                                  qed
                                                                                                qed
                                                                                              qed
                                                                                            qed
                                                                                          qed
                                                                                        next
                                                                                          case case_2
                                                                                          by contradiction
                                                                                             /* from formulas
                                                                                             */
                                                                                        qed
                                                                                      qed
                                                                                    next
                                                                                      case case_2
                                                                                      solve( state_1111111111111111111111121111111( ~RouterID.1,
                                                                                                                                    ~ServerID.1,
                                                                                                                                    ~ak_h.1,
                                                                                                                                    ~ak_sk.1,
                                                                                                                                    ~ssk_nms.1,
                                                                                                                                    pL,
                                                                                                                                    pcrL,
                                                                                                                                    s_h,
                                                                                                                                    ~n.3
                                                                                             ) ▶₀ #t2.8 )
                                                                                        case insertpolicyDigestshpcrLTPMCCPolicyPCRpL_0_111111111111111111111112111111
                                                                                        solve( (#t2.9 < #t2.16)  ∥
                                                                                               (#t2.9 =
                                                                                                #t2.16) )
                                                                                          case case_1
                                                                                          by contradiction
                                                                                             /* from formulas
                                                                                             */
                                                                                        next
                                                                                          case case_2
                                                                                          solve( (#t2.13 < #t2.15)  ∥
                                                                                                 (#t2.13 =
                                                                                                  #t2.15) )
                                                                                            case case_1
                                                                                            by contradiction
                                                                                               /*
                                                                                               from formulas
                                                                                               */
                                                                                          next
                                                                                            case case_2
                                                                                            solve( TPM_SendCommand( <
                                                                                                                     'TPM2_PolicyPCR', 
                                                                                                                     k_sh
                                                                                                                    >
                                                                                                   ) @ #t2.12 )
                                                                                              case eventTPMSendCommandTPMPolicyPCRtlssh_0_1111111111111211111111111
                                                                                              solve( state_1111111111111211111111111( ~RouterID.1,
                                                                                                                                      ~ServerID.1,
                                                                                                                                      ~ak_h.1,
                                                                                                                                      ~ak_sk.1,
                                                                                                                                      ~ssk_nms.1,
                                                                                                                                      ~tid.1,
                                                                                                                                      tls_h,
                                                                                                                                      k_sh,
                                                                                                                                      tls_spk
                                                                                                     ) ▶₀ #t2.10 )
                                                                                                case eventGenerateTLStidtlsspk_0_111111111111121111111111
                                                                                                solve( TPM_SendCommand( <
                                                                                                                         'TPM2_PolicyPCR', 
                                                                                                                         k_sh
                                                                                                                        >
                                                                                                       ) @ #t2.14 )
                                                                                                  case eventTPMSendCommandTPMPolicyPCRtlssh_0_1111111111111211111111111
                                                                                                  solve( state_1111111111111211111111111( ~RouterID.1,
                                                                                                                                          ~ServerID.1,
                                                                                                                                          ~ak_h.1,
                                                                                                                                          ~ak_sk.1,
                                                                                                                                          ~ssk_nms.1,
                                                                                                                                          ~tid.1,
                                                                                                                                          tls_h,
                                                                                                                                          k_sh,
                                                                                                                                          tls_spk
                                                                                                         ) ▶₀ #t2.11 )
                                                                                                    case eventGenerateTLStidtlsspk_0_111111111111121111111111
                                                                                                    solve( TPM_SendCommand( <
                                                                                                                             'TPM2_Create', 
                                                                                                                             <
                                                                                                                              swstate, 
                                                                                                                              nil
                                                                                                                             >, 
                                                                                                                             'TPM_CC_PolicyPCR', 
                                                                                                                             nil
                                                                                                                            >
                                                                                                           ) @ #t2.14 )
                                                                                                      case eventTPMSendCommandTPMCreateswstatenilTPMCCPolicyPCRnil_0_11111111111112111
                                                                                                      solve( state_11111111111112111( ~RouterID.1,
                                                                                                                                      ~ServerID.1,
                                                                                                                                      ~ak_h.1,
                                                                                                                                      ~ak_sk.1,
                                                                                                                                      ~ssk_nms.1,
                                                                                                                                      ~tid.1
                                                                                                             ) ▶₀ #t2.11 )
                                                                                                        case outTPMPCRExtendswstate_0_1111111111111211
                                                                                                        solve( TPM_SendCommand( <
                                                                                                                                 'TPM2_Create', 
                                                                                                                                 <
                                                                                                                                  swstate, 
                                                                                                                                  nil
                                                                                                                                 >, 
                                                                                                                                 'TPM_CC_PolicyPCR', 
                                                                                                                                 nil
                                                                                                                                >
                                                                                                               ) @ #t2.14 )
                                                                                                          case eventTPMSendCommandTPMCreateswstatenilTPMCCPolicyPCRnil_0_11111111111112111
                                                                                                          solve( state_11111111111112111( ~RouterID.1,
                                                                                                                                          ~ServerID.1,
                                                                                                                                          ~ak_h.1,
                                                                                                                                          ~ak_sk.1,
                                                                                                                                          ~ssk_nms.1,
                                                                                                                                          ~tid.1
                                                                                                                 ) ▶₀ #t2.11 )
                                                                                                            case outTPMPCRExtendswstate_0_1111111111111211
                                                                                                            by solve( !KU( ~ssk_nms
                                                                                                                      ) @ #vk.23 )
                                                                                                          qed
                                                                                                        qed
                                                                                                      qed
                                                                                                    qed
                                                                                                  qed
                                                                                                qed
                                                                                              qed
                                                                                            qed
                                                                                          qed
                                                                                        qed
                                                                                      qed
                                                                                    qed
                                                                                  qed
                                                                                qed
                                                                              qed
                                                                            qed
                                                                          qed
                                                                        qed
                                                                      qed
                                                                    qed
                                                                  qed
                                                                qed
                                                              qed
                                                            qed
                                                          qed
                                                        next
                                                          case case_2
                                                          by contradiction /* from formulas */
                                                        qed
                                                      next
                                                        case case_2
                                                        by contradiction /* from formulas */
                                                      qed
                                                    qed
                                                  qed
                                                qed
                                              next
                                                case unlockdevice_0_11111111111111111111211111112
                                                by solve( state_11111111111111111111211111112( ~RouterID.1,
                                                                                               ~ServerID.1,
                                                                                               ~ak_h.1,
                                                                                               ~ak_sk.1,
                                                                                               ~ssk_nms.1,
                                                                                               a_h, obj_ap,
                                                                                               obj_h, obj_pd,
                                                                                               obj_pk, obj_sh,
                                                                                               ~n.2
                                                          ) ▶₀ #t2.6 )
                                              qed
                                            next
                                              case case_3
                                              solve( Unlock_4( '4', ~n.2, 'device' ) @ #t2.7 )
                                                case unlockdevice_0_111111111111111111112111111111
                                                solve( state_111111111111111111112111111111( ~RouterID.1,
                                                                                             ~ServerID.1,
                                                                                             ~ak_h.1,
                                                                                             ~ak_sk.1,
                                                                                             ~ssk_nms.1, a_h,
                                                                                             a_sk, obj_ap,
                                                                                             obj_h, obj_pd,
                                                                                             obj_pk, obj_sh,
                                                                                             ~n.2
                                                       ) ▶₀ #t2.6 )
                                                  case outsignobjpkobjapask_0_11111111111111111111211111111
                                                  solve( (#t2.3 < #t2.15)  ∥ (#t2.3 = #t2.15) )
                                                    case case_1
                                                    by contradiction /* from formulas */
                                                  next
                                                    case case_2
                                                    solve( (#t2.10 < #t2.15)  ∥ (#t2.10 = #t2.15) )
                                                      case case_1
                                                      by contradiction /* from formulas */
                                                    next
                                                      case case_2
                                                      solve( (#vr.32 < #t2.13)  ∥ (#vr.32 = #t2.13) )
                                                        case case_1
                                                        solve( (#vr.40 < #t2.14)  ∥ (#vr.40 = #t2.14) )
                                                          case case_1
                                                          solve( (#t2.9 < #t2.14)  ∥ (#t2.9 = #t2.14) )
                                                            case case_1
                                                            by contradiction /* from formulas */
                                                          next
                                                            case case_2
                                                            solve( (#t2.8 < #t2.13)  ∥ (#t2.8 = #t2.13) )
                                                              case case_1
                                                              by contradiction /* from formulas */
                                                            next
                                                              case case_2
                                                              solve( TPM_SendCommand( <'TPM2_Create', 
                                                                                       <swstate, nil>, 
                                                                                       'TPM_CC_PolicyPCR', nil
                                                                                      >
                                                                     ) @ #t2.11 )
                                                                case eventTPMSendCommandTPMCreateswstatenilTPMCCPolicyPCRnil_0_11111111111112111
                                                                solve( state_11111111111112111( ~RouterID.1,
                                                                                                ~ServerID.1,
                                                                                                ~ak_h.1,
                                                                                                ~ak_sk.1,
                                                                                                ~ssk_nms.1,
                                                                                                ~tid.1
                                                                       ) ▶₀ #t2.7 )
                                                                  case outTPMPCRExtendswstate_0_1111111111111211
                                                                  solve( TPM_SendCommand( <'TPM2_Certify', 
                                                                                           k_sh, ~k_h, ~ak_h>
                                                                         ) @ #t2.11 )
                                                                    case eventTPMSendCommandTPMCertifytlsshtlshakh_0_111111111111121111111111111
                                                                    solve( state_111111111111121111111111111( ~RouterID.1,
                                                                                                              ~ServerID.1,
                                                                                                              ~ak_h,
                                                                                                              ~ak_sk.1,
                                                                                                              ~ssk_nms.1,
                                                                                                              ~tid.1,
                                                                                                              ~k_h,
                                                                                                              k_sh,
                                                                                                              tls_spk
                                                                           ) ▶₀ #t2.7 )
                                                                      case outTPMPolicyPCRtlssh_0_11111111111112111111111111
                                                                      solve( TPM_SendCommand( <'TPM2_Create', 
                                                                                               <swstate, nil
                                                                                               >, 
                                                                                               'TPM_CC_PolicyPCR', 
                                                                                               nil>
                                                                             ) @ #t2.11 )
                                                                        case eventTPMSendCommandTPMCreateswstatenilTPMCCPolicyPCRnil_0_11111111111112111
                                                                        solve( state_11111111111112111( ~RouterID.1,
                                                                                                        ~ServerID.1,
                                                                                                        ~ak_h.1,
                                                                                                        ~ak_sk.1,
                                                                                                        ~ssk_nms.1,
                                                                                                        ~tid.1
                                                                               ) ▶₀ #t2.7 )
                                                                          case outTPMPCRExtendswstate_0_1111111111111211
                                                                          solve( Insert( <'privatePart', ~k_h
                                                                                         >,
                                                                                         k_sk.1
                                                                                 ) @ #t2.2 )
                                                                            case insertprivatePartkhksk_0_111111111111111111111121111111
                                                                            solve( Insert( <'authPolicy', ~k_h
                                                                                           >,
                                                                                           k_ap
                                                                                   ) @ #t2.3 )
                                                                              case insertauthPolicykhauthPolicy_0_11111111111111111111112111111
                                                                              solve( Insert( <'policyDigest', 
                                                                                              k_sh>,
                                                                                             <<swstate, nil>, 
                                                                                              'TPM_CC_PolicyPCR', 
                                                                                              nil>
                                                                                     ) @ #t2.7 )
                                                                                case insertpolicyDigestshpcrLTPMCCPolicyPCRpL_0_111111111111111111111112111111
                                                                                solve( state_111111111111111111111112111111( ~RouterID.1,
                                                                                                                             ~ServerID.1,
                                                                                                                             ~ak_h.1,
                                                                                                                             ~ak_sk.1,
                                                                                                                             ~ssk_nms.1,
                                                                                                                             nil,
                                                                                                                             <
                                                                                                                              swstate, 
                                                                                                                              nil
                                                                                                                             >,
                                                                                                                             k_sh,
                                                                                                                             lock
                                                                                       ) ▶₀ #t2.7 )
                                                                                  case eventPolicyPCRshpL_0_11111111111111111111111211111
                                                                                  solve( (#vr.83 < #vr.47)  ∥
                                                                                         (#t2 < #vr.83) )
                                                                                    case case_1
                                                                                    solve( (#t2.13 < #t2.11)  ∥
                                                                                           (#t2.13 =
                                                                                            #t2.11)  ∥
                                                                                           (#vr.73 < #t2.13) )
                                                                                      case case_1
                                                                                      solve( (#vr.28 < #t2.14)  ∥
                                                                                             (#vr.28 =
                                                                                              #t2.14) )
                                                                                        case case_1
                                                                                        solve( state_1111111111111111111111121111111( ~RouterID.1,
                                                                                                                                      ~ServerID.1,
                                                                                                                                      ~ak_h.1,
                                                                                                                                      ~ak_sk.1,
                                                                                                                                      ~ssk_nms.1,
                                                                                                                                      pL,
                                                                                                                                      pcrL,
                                                                                                                                      s_h,
                                                                                                                                      ~n.3
                                                                                               ) ▶₀ #t2.8 )
                                                                                          case insertpolicyDigestshpcrLTPMCCPolicyPCRpL_0_111111111111111111111112111111
                                                                                          by contradiction
                                                                                             /* cyclic */
                                                                                        qed
                                                                                      next
                                                                                        case case_2
                                                                                        solve( state_1111111111111111111111121111111( ~RouterID.1,
                                                                                                                                      ~ServerID.1,
                                                                                                                                      ~ak_h.1,
                                                                                                                                      ~ak_sk.1,
                                                                                                                                      ~ssk_nms.1,
                                                                                                                                      pL,
                                                                                                                                      pcrL,
                                                                                                                                      s_h,
                                                                                                                                      ~n.3
                                                                                               ) ▶₀ #t2.8 )
                                                                                          case insertpolicyDigestshpcrLTPMCCPolicyPCRpL_0_111111111111111111111112111111
                                                                                          by contradiction
                                                                                             /* cyclic */
                                                                                        qed
                                                                                      qed
                                                                                    next
                                                                                      case case_2
                                                                                      solve( (#vr.28 < #t2.13)  ∥
                                                                                             (#vr.28 =
                                                                                              #t2.13) )
                                                                                        case case_1
                                                                                        solve( state_1111111111111111111111121111111( ~RouterID.1,
                                                                                                                                      ~ServerID.1,
                                                                                                                                      ~ak_h.1,
                                                                                                                                      ~ak_sk.1,
                                                                                                                                      ~ssk_nms.1,
                                                                                                                                      pL,
                                                                                                                                      pcrL,
                                                                                                                                      s_h,
                                                                                                                                      ~n.3
                                                                                               ) ▶₀ #t2.8 )
                                                                                          case insertpolicyDigestshpcrLTPMCCPolicyPCRpL_0_111111111111111111111112111111
                                                                                          by contradiction
                                                                                             /* cyclic */
                                                                                        qed
                                                                                      next
                                                                                        case case_2
                                                                                        solve( state_1111111111111111111111121111111( ~RouterID.1,
                                                                                                                                      ~ServerID.1,
                                                                                                                                      ~ak_h.1,
                                                                                                                                      ~ak_sk.1,
                                                                                                                                      ~ssk_nms.1,
                                                                                                                                      pL,
                                                                                                                                      pcrL,
                                                                                                                                      s_h,
                                                                                                                                      ~n.3
                                                                                               ) ▶₀ #t2.8 )
                                                                                          case insertpolicyDigestshpcrLTPMCCPolicyPCRpL_0_111111111111111111111112111111
                                                                                          by contradiction
                                                                                             /* cyclic */
                                                                                        qed
                                                                                      qed
                                                                                    next
                                                                                      case case_3
                                                                                      solve( (#vr.28 < #t2.14)  ∥
                                                                                             (#vr.28 =
                                                                                              #t2.14) )
                                                                                        case case_1
                                                                                        solve( state_1111111111111111111111121111111( ~RouterID.1,
                                                                                                                                      ~ServerID.1,
                                                                                                                                      ~ak_h.1,
                                                                                                                                      ~ak_sk.1,
                                                                                                                                      ~ssk_nms.1,
                                                                                                                                      pL,
                                                                                                                                      pcrL,
                                                                                                                                      s_h,
                                                                                                                                      ~n.3
                                                                                               ) ▶₀ #t2.8 )
                                                                                          case insertpolicyDigestshpcrLTPMCCPolicyPCRpL_0_111111111111111111111112111111
                                                                                          by contradiction
                                                                                             /* cyclic */
                                                                                        qed
                                                                                      next
                                                                                        case case_2
                                                                                        solve( state_1111111111111111111111121111111( ~RouterID.1,
                                                                                                                                      ~ServerID.1,
                                                                                                                                      ~ak_h.1,
                                                                                                                                      ~ak_sk.1,
                                                                                                                                      ~ssk_nms.1,
                                                                                                                                      pL,
                                                                                                                                      pcrL,
                                                                                                                                      s_h,
                                                                                                                                      ~n.3
                                                                                               ) ▶₀ #t2.8 )
                                                                                          case insertpolicyDigestshpcrLTPMCCPolicyPCRpL_0_111111111111111111111112111111
                                                                                          by contradiction
                                                                                             /* cyclic */
                                                                                        qed
                                                                                      qed
                                                                                    qed
                                                                                  next
                                                                                    case case_2
                                                                                    solve( (#vr.83 < #vr.74)  ∥
                                                                                           (#t2.6 < #vr.83) )
                                                                                      case case_1
                                                                                      solve( (#t2.13 < #t2.11)  ∥
                                                                                             (#t2.13 =
                                                                                              #t2.11)  ∥
                                                                                             (#vr.73 < #t2.13) )
                                                                                        case case_1
                                                                                        solve( (#vr.28 < #t2.14)  ∥
                                                                                               (#vr.28 =
                                                                                                #t2.14) )
                                                                                          case case_1
                                                                                          solve( state_1111111111111111111111121111111( ~RouterID.1,
                                                                                                                                        ~ServerID.1,
                                                                                                                                        ~ak_h.1,
                                                                                                                                        ~ak_sk.1,
                                                                                                                                        ~ssk_nms.1,
                                                                                                                                        pL,
                                                                                                                                        pcrL,
                                                                                                                                        s_h,
                                                                                                                                        ~n.3
                                                                                                 ) ▶₀ #t2.8 )
                                                                                            case insertpolicyDigestshpcrLTPMCCPolicyPCRpL_0_111111111111111111111112111111
                                                                                            by contradiction
                                                                                               /* cyclic */
                                                                                          qed
                                                                                        next
                                                                                          case case_2
                                                                                          solve( state_1111111111111111111111121111111( ~RouterID.1,
                                                                                                                                        ~ServerID.1,
                                                                                                                                        ~ak_h.1,
                                                                                                                                        ~ak_sk.1,
                                                                                                                                        ~ssk_nms.1,
                                                                                                                                        pL,
                                                                                                                                        pcrL,
                                                                                                                                        s_h,
                                                                                                                                        ~n.3
                                                                                                 ) ▶₀ #t2.8 )
                                                                                            case insertpolicyDigestshpcrLTPMCCPolicyPCRpL_0_111111111111111111111112111111
                                                                                            by contradiction
                                                                                               /* cyclic */
                                                                                          qed
                                                                                        qed
                                                                                      next
                                                                                        case case_2
                                                                                        solve( (#vr.28 < #t2.13)  ∥
                                                                                               (#vr.28 =
                                                                                                #t2.13) )
                                                                                          case case_1
                                                                                          solve( state_1111111111111111111111121111111( ~RouterID.1,
                                                                                                                                        ~ServerID.1,
                                                                                                                                        ~ak_h.1,
                                                                                                                                        ~ak_sk.1,
                                                                                                                                        ~ssk_nms.1,
                                                                                                                                        pL,
                                                                                                                                        pcrL,
                                                                                                                                        s_h,
                                                                                                                                        ~n.3
                                                                                                 ) ▶₀ #t2.8 )
                                                                                            case insertpolicyDigestshpcrLTPMCCPolicyPCRpL_0_111111111111111111111112111111
                                                                                            by contradiction
                                                                                               /* cyclic */
                                                                                          qed
                                                                                        next
                                                                                          case case_2
                                                                                          solve( state_1111111111111111111111121111111( ~RouterID.1,
                                                                                                                                        ~ServerID.1,
                                                                                                                                        ~ak_h.1,
                                                                                                                                        ~ak_sk.1,
                                                                                                                                        ~ssk_nms.1,
                                                                                                                                        pL,
                                                                                                                                        pcrL,
                                                                                                                                        s_h,
                                                                                                                                        ~n.3
                                                                                                 ) ▶₀ #t2.8 )
                                                                                            case insertpolicyDigestshpcrLTPMCCPolicyPCRpL_0_111111111111111111111112111111
                                                                                            by contradiction
                                                                                               /* cyclic */
                                                                                          qed
                                                                                        qed
                                                                                      next
                                                                                        case case_3
                                                                                        solve( (#vr.28 < #t2.14)  ∥
                                                                                               (#vr.28 =
                                                                                                #t2.14) )
                                                                                          case case_1
                                                                                          solve( state_1111111111111111111111121111111( ~RouterID.1,
                                                                                                                                        ~ServerID.1,
                                                                                                                                        ~ak_h.1,
                                                                                                                                        ~ak_sk.1,
                                                                                                                                        ~ssk_nms.1,
                                                                                                                                        pL,
                                                                                                                                        pcrL,
                                                                                                                                        s_h,
                                                                                                                                        ~n.3
                                                                                                 ) ▶₀ #t2.8 )
                                                                                            case insertpolicyDigestshpcrLTPMCCPolicyPCRpL_0_111111111111111111111112111111
                                                                                            by contradiction
                                                                                               /* cyclic */
                                                                                          qed
                                                                                        next
                                                                                          case case_2
                                                                                          solve( state_1111111111111111111111121111111( ~RouterID.1,
                                                                                                                                        ~ServerID.1,
                                                                                                                                        ~ak_h.1,
                                                                                                                                        ~ak_sk.1,
                                                                                                                                        ~ssk_nms.1,
                                                                                                                                        pL,
                                                                                                                                        pcrL,
                                                                                                                                        s_h,
                                                                                                                                        ~n.3
                                                                                                 ) ▶₀ #t2.8 )
                                                                                            case insertpolicyDigestshpcrLTPMCCPolicyPCRpL_0_111111111111111111111112111111
                                                                                            by contradiction
                                                                                               /* cyclic */
                                                                                          qed
                                                                                        qed
                                                                                      qed
                                                                                    next
                                                                                      case case_2
                                                                                      solve( ((#vr.17 < #vr.83) ∧
                                                                                              (∃ #t2.
                                                                                                (Unlock_5( '5',
                                                                                                           ~n.1,
                                                                                                           'device'
                                                                                                 ) @ #t2)
                                                                                               ∧
                                                                                                (#vr.17 < #t2) ∧
                                                                                                (#t2 < #vr.83) ∧
                                                                                                (∀ #t0 pp.
                                                                                                  (Unlock( pp,
                                                                                                           ~n.1,
                                                                                                           'device'
                                                                                                   ) @ #t0)
                                                                                                 ⇒
                                                                                                  #t0 = #t2) ∧
                                                                                                (∀ pp lpp #t0.
                                                                                                  (Lock( pp,
                                                                                                         lpp,
                                                                                                         'device'
                                                                                                   ) @ #t0)
                                                                                                 ⇒
                                                                                                  ((#t0 < #vr.17) ∨
                                                                                                   (#t0 =
                                                                                                    #vr.17) ∨
                                                                                                   (#t2 < #t0))) ∧
                                                                                                (∀ pp lpp #t0.
                                                                                                  (Unlock( pp,
                                                                                                           lpp,
                                                                                                           'device'
                                                                                                   ) @ #t0)
                                                                                                 ⇒
                                                                                                  ((#t0 < #vr.17) ∨
                                                                                                   (#t2 < #t0) ∨
                                                                                                   (#t2 =
                                                                                                    #t0)))))  ∥
                                                                                             (#vr.83 < #vr.17) )
                                                                                        case case_1
                                                                                        solve( (#t2.12 < #t2.10)  ∥
                                                                                               (#t2.12 =
                                                                                                #t2.10)  ∥
                                                                                               (#vr.73 < #t2.12) )
                                                                                          case case_1
                                                                                          by contradiction
                                                                                             /* from formulas
                                                                                             */
                                                                                        next
                                                                                          case case_2
                                                                                          solve( (#vr.28 < #t2.12)  ∥
                                                                                                 (#vr.28 =
                                                                                                  #t2.12) )
                                                                                            case case_1
                                                                                            solve( TPM_SendCommand( <
                                                                                                                     'TPM2_PolicyPCR', 
                                                                                                                     k_sh
                                                                                                                    >
                                                                                                   ) @ #t2.11 )
                                                                                              case eventTPMSendCommandTPMPolicyPCRtlssh_0_1111111111111211111111111
                                                                                              solve( state_1111111111111211111111111( ~RouterID.1,
                                                                                                                                      ~ServerID.1,
                                                                                                                                      ~ak_h.1,
                                                                                                                                      ~ak_sk.1,
                                                                                                                                      ~ssk_nms.1,
                                                                                                                                      ~tid.1,
                                                                                                                                      tls_h,
                                                                                                                                      k_sh,
                                                                                                                                      tls_spk
                                                                                                     ) ▶₀ #t2.8 )
                                                                                                case eventGenerateTLStidtlsspk_0_111111111111121111111111
                                                                                                solve( Unlock_5( '5',
                                                                                                                 ~n.1,
                                                                                                                 'device'
                                                                                                       ) @ #t2.13 )
                                                                                                  case unlockdevice_0_1111111111111111111211111111
                                                                                                  solve( state_1111111111111111111211111111( ~RouterID.1,
                                                                                                                                             ~ServerID.1,
                                                                                                                                             ~ak_h.1,
                                                                                                                                             ~ak_sk.1,
                                                                                                                                             ~ssk_nms.1,
                                                                                                                                             k_ap,
                                                                                                                                             k_h.1,
                                                                                                                                             k_pd,
                                                                                                                                             k_sh.1,
                                                                                                                                             k_sk.1,
                                                                                                                                             m,
                                                                                                                                             ~n.1
                                                                                                         ) ▶₀ #t2.9 )
                                                                                                    case TpmSignOutsignmksk_0_111111111111111111121111111
                                                                                                    by contradiction
                                                                                                       /*
                                                                                                       cyclic
                                                                                                       */
                                                                                                  qed
                                                                                                next
                                                                                                  case unlockdevice_0_111111111111111111121111112
                                                                                                  by solve( state_111111111111111111121111112( ~RouterID.1,
                                                                                                                                               ~ServerID.1,
                                                                                                                                               ~ak_h.1,
                                                                                                                                               ~ak_sk.1,
                                                                                                                                               ~ssk_nms.1,
                                                                                                                                               k_ap,
                                                                                                                                               k_h.1,
                                                                                                                                               k_pd,
                                                                                                                                               k_sh.1,
                                                                                                                                               m,
                                                                                                                                               ~n.1
                                                                                                            ) ▶₀ #t2.9 )
                                                                                                qed
                                                                                              qed
                                                                                            qed
                                                                                          next
                                                                                            case case_2
                                                                                            solve( TPM_SendCommand( <
                                                                                                                     'TPM2_PolicyPCR', 
                                                                                                                     k_sh
                                                                                                                    >
                                                                                                   ) @ #t2.12 )
                                                                                              case eventTPMSendCommandTPMPolicyPCRtlssh_0_1111111111111211111111111
                                                                                              solve( state_1111111111111211111111111( ~RouterID.1,
                                                                                                                                      ~ServerID.1,
                                                                                                                                      ~ak_h.1,
                                                                                                                                      ~ak_sk.1,
                                                                                                                                      ~ssk_nms.1,
                                                                                                                                      ~tid.1,
                                                                                                                                      tls_h,
                                                                                                                                      k_sh,
                                                                                                                                      tls_spk
                                                                                                     ) ▶₀ #t2.9 )
                                                                                                case eventGenerateTLStidtlsspk_0_111111111111121111111111
                                                                                                solve( Unlock_5( '5',
                                                                                                                 ~n.1,
                                                                                                                 'device'
                                                                                                       ) @ #t2.13 )
                                                                                                  case unlockdevice_0_1111111111111111111211111111
                                                                                                  solve( state_1111111111111111111211111111( ~RouterID.1,
                                                                                                                                             ~ServerID.1,
                                                                                                                                             ~ak_h.1,
                                                                                                                                             ~ak_sk.1,
                                                                                                                                             ~ssk_nms.1,
                                                                                                                                             k_ap,
                                                                                                                                             k_h.1,
                                                                                                                                             k_pd,
                                                                                                                                             k_sh.1,
                                                                                                                                             k_sk.1,
                                                                                                                                             m,
                                                                                                                                             ~n.1
                                                                                                         ) ▶₀ #t2.10 )
                                                                                                    case TpmSignOutsignmksk_0_111111111111111111121111111
                                                                                                    by contradiction
                                                                                                       /*
                                                                                                       cyclic
                                                                                                       */
                                                                                                  qed
                                                                                                next
                                                                                                  case unlockdevice_0_111111111111111111121111112
                                                                                                  by solve( state_111111111111111111121111112( ~RouterID.1,
                                                                                                                                               ~ServerID.1,
                                                                                                                                               ~ak_h.1,
                                                                                                                                               ~ak_sk.1,
                                                                                                                                               ~ssk_nms.1,
                                                                                                                                               k_ap,
                                                                                                                                               k_h.1,
                                                                                                                                               k_pd,
                                                                                                                                               k_sh.1,
                                                                                                                                               m,
                                                                                                                                               ~n.1
                                                                                                            ) ▶₀ #t2.10 )
                                                                                                qed
                                                                                              qed
                                                                                            qed
                                                                                          qed
                                                                                        next
                                                                                          case case_3
                                                                                          solve( (#vr.28 < #t2.13)  ∥
                                                                                                 (#vr.28 =
                                                                                                  #t2.13) )
                                                                                            case case_1
                                                                                            solve( TPM_SendCommand( <
                                                                                                                     'TPM2_PolicyPCR', 
                                                                                                                     k_sh
                                                                                                                    >
                                                                                                   ) @ #t2.11 )
                                                                                              case eventTPMSendCommandTPMPolicyPCRtlssh_0_1111111111111211111111111
                                                                                              solve( state_1111111111111211111111111( ~RouterID.1,
                                                                                                                                      ~ServerID.1,
                                                                                                                                      ~ak_h.1,
                                                                                                                                      ~ak_sk.1,
                                                                                                                                      ~ssk_nms.1,
                                                                                                                                      ~tid.1,
                                                                                                                                      tls_h,
                                                                                                                                      k_sh,
                                                                                                                                      tls_spk
                                                                                                     ) ▶₀ #t2.8 )
                                                                                                case eventGenerateTLStidtlsspk_0_111111111111121111111111
                                                                                                solve( Unlock_5( '5',
                                                                                                                 ~n.1,
                                                                                                                 'device'
                                                                                                       ) @ #t2.14 )
                                                                                                  case unlockdevice_0_1111111111111111111211111111
                                                                                                  solve( state_1111111111111111111211111111( ~RouterID.1,
                                                                                                                                             ~ServerID.1,
                                                                                                                                             ~ak_h.1,
                                                                                                                                             ~ak_sk.1,
                                                                                                                                             ~ssk_nms.1,
                                                                                                                                             k_ap,
                                                                                                                                             k_h.1,
                                                                                                                                             k_pd,
                                                                                                                                             k_sh.1,
                                                                                                                                             k_sk.1,
                                                                                                                                             m,
                                                                                                                                             ~n.1
                                                                                                         ) ▶₀ #t2.9 )
                                                                                                    case TpmSignOutsignmksk_0_111111111111111111121111111
                                                                                                    by contradiction
                                                                                                       /*
                                                                                                       cyclic
                                                                                                       */
                                                                                                  qed
                                                                                                next
                                                                                                  case unlockdevice_0_111111111111111111121111112
                                                                                                  by solve( state_111111111111111111121111112( ~RouterID.1,
                                                                                                                                               ~ServerID.1,
                                                                                                                                               ~ak_h.1,
                                                                                                                                               ~ak_sk.1,
                                                                                                                                               ~ssk_nms.1,
                                                                                                                                               k_ap,
                                                                                                                                               k_h.1,
                                                                                                                                               k_pd,
                                                                                                                                               k_sh.1,
                                                                                                                                               m,
                                                                                                                                               ~n.1
                                                                                                            ) ▶₀ #t2.9 )
                                                                                                qed
                                                                                              qed
                                                                                            qed
                                                                                          next
                                                                                            case case_2
                                                                                            solve( TPM_SendCommand( <
                                                                                                                     'TPM2_PolicyPCR', 
                                                                                                                     k_sh
                                                                                                                    >
                                                                                                   ) @ #t2.12 )
                                                                                              case eventTPMSendCommandTPMPolicyPCRtlssh_0_1111111111111211111111111
                                                                                              solve( state_1111111111111211111111111( ~RouterID.1,
                                                                                                                                      ~ServerID.1,
                                                                                                                                      ~ak_h.1,
                                                                                                                                      ~ak_sk.1,
                                                                                                                                      ~ssk_nms.1,
                                                                                                                                      ~tid.1,
                                                                                                                                      tls_h,
                                                                                                                                      k_sh,
                                                                                                                                      tls_spk
                                                                                                     ) ▶₀ #t2.9 )
                                                                                                case eventGenerateTLStidtlsspk_0_111111111111121111111111
                                                                                                solve( Unlock_5( '5',
                                                                                                                 ~n.1,
                                                                                                                 'device'
                                                                                                       ) @ #t2.14 )
                                                                                                  case unlockdevice_0_1111111111111111111211111111
                                                                                                  solve( state_1111111111111111111211111111( ~RouterID.1,
                                                                                                                                             ~ServerID.1,
                                                                                                                                             ~ak_h.1,
                                                                                                                                             ~ak_sk.1,
                                                                                                                                             ~ssk_nms.1,
                                                                                                                                             k_ap,
                                                                                                                                             k_h.1,
                                                                                                                                             k_pd,
                                                                                                                                             k_sh.1,
                                                                                                                                             k_sk.1,
                                                                                                                                             m,
                                                                                                                                             ~n.1
                                                                                                         ) ▶₀ #t2.10 )
                                                                                                    case TpmSignOutsignmksk_0_111111111111111111121111111
                                                                                                    by contradiction
                                                                                                       /*
                                                                                                       cyclic
                                                                                                       */
                                                                                                  qed
                                                                                                next
                                                                                                  case unlockdevice_0_111111111111111111121111112
                                                                                                  by solve( state_111111111111111111121111112( ~RouterID.1,
                                                                                                                                               ~ServerID.1,
                                                                                                                                               ~ak_h.1,
                                                                                                                                               ~ak_sk.1,
                                                                                                                                               ~ssk_nms.1,
                                                                                                                                               k_ap,
                                                                                                                                               k_h.1,
                                                                                                                                               k_pd,
                                                                                                                                               k_sh.1,
                                                                                                                                               m,
                                                                                                                                               ~n.1
                                                                                                            ) ▶₀ #t2.10 )
                                                                                                qed
                                                                                              qed
                                                                                            qed
                                                                                          qed
                                                                                        qed
                                                                                      next
                                                                                        case case_2
                                                                                        solve( (#t2.13 < #t2.11)  ∥
                                                                                               (#t2.13 =
                                                                                                #t2.11)  ∥
                                                                                               (#vr.73 < #t2.13) )
                                                                                          case case_1
                                                                                          by contradiction
                                                                                             /* from formulas
                                                                                             */
                                                                                        next
                                                                                          case case_2
                                                                                          solve( (#vr.28 < #t2.13)  ∥
                                                                                                 (#vr.28 =
                                                                                                  #t2.13) )
                                                                                            case case_1
                                                                                            solve( state_1111111111111111111111121111111( ~RouterID.1,
                                                                                                                                          ~ServerID.1,
                                                                                                                                          ~ak_h.1,
                                                                                                                                          ~ak_sk.1,
                                                                                                                                          ~ssk_nms.1,
                                                                                                                                          pL,
                                                                                                                                          pcrL,
                                                                                                                                          s_h,
                                                                                                                                          ~n.3
                                                                                                   ) ▶₀ #t2.8 )
                                                                                              case insertpolicyDigestshpcrLTPMCCPolicyPCRpL_0_111111111111111111111112111111
                                                                                              solve( (#vr.28 < #t2.16)  ∥
                                                                                                     (#vr.28 =
                                                                                                      #t2.16) )
                                                                                                case case_1
                                                                                                solve( (#t2.15 < #t2.11)  ∥
                                                                                                       (#t2.15 =
                                                                                                        #t2.11)  ∥
                                                                                                       (#vr.73 < #t2.15) )
                                                                                                  case case_1
                                                                                                  by contradiction
                                                                                                     /*
                                                                                                     from formulas
                                                                                                     */
                                                                                                next
                                                                                                  case case_2
                                                                                                  solve( (#t2.13 < #t2.15)  ∥
                                                                                                         (#t2.13 =
                                                                                                          #t2.15) )
                                                                                                    case case_1
                                                                                                    by contradiction
                                                                                                       /*
                                                                                                       from formulas
                                                                                                       */
                                                                                                  next
                                                                                                    case case_2
                                                                                                    solve( TPM_SendCommand( <
                                                                                                                             'TPM2_PolicyPCR', 
                                                                                                                             k_sh
                                                                                                                            >
                                                                                                           ) @ #t2.12 )
                                                                                                      case eventTPMSendCommandTPMPolicyPCRtlssh_0_1111111111111211111111111
                                                                                                      solve( state_1111111111111211111111111( ~RouterID.1,
                                                                                                                                              ~ServerID.1,
                                                                                                                                              ~ak_h.1,
                                                                                                                                              ~ak_sk.1,
                                                                                                                                              ~ssk_nms.1,
                                                                                                                                              ~tid.1,
                                                                                                                                              tls_h,
                                                                                                                                              k_sh,
                                                                                                                                              tls_spk
                                                                                                             ) ▶₀ #t2.9 )
                                                                                                        case eventGenerateTLStidtlsspk_0_111111111111121111111111
                                                                                                        solve( TPM_SendCommand( <
                                                                                                                                 'TPM2_PolicyPCR', 
                                                                                                                                 k_sh
                                                                                                                                >
                                                                                                               ) @ #t2.14 )
                                                                                                          case eventTPMSendCommandTPMPolicyPCRtlssh_0_1111111111111211111111111
                                                                                                          solve( state_1111111111111211111111111( ~RouterID.1,
                                                                                                                                                  ~ServerID.1,
                                                                                                                                                  ~ak_h.1,
                                                                                                                                                  ~ak_sk.1,
                                                                                                                                                  ~ssk_nms.1,
                                                                                                                                                  ~tid.1,
                                                                                                                                                  tls_h,
                                                                                                                                                  k_sh,
                                                                                                                                                  tls_spk
                                                                                                                 ) ▶₀ #t2.10 )
                                                                                                            case eventGenerateTLStidtlsspk_0_111111111111121111111111
                                                                                                            solve( TPM_SendCommand( <
                                                                                                                                     'TPM2_Create', 
                                                                                                                                     <
                                                                                                                                      swstate, 
                                                                                                                                      nil
                                                                                                                                     >, 
                                                                                                                                     'TPM_CC_PolicyPCR', 
                                                                                                                                     nil
                                                                                                                                    >
                                                                                                                   ) @ #t2.14 )
                                                                                                              case eventTPMSendCommandTPMCreateswstatenilTPMCCPolicyPCRnil_0_11111111111112111
                                                                                                              solve( state_11111111111112111( ~RouterID.1,
                                                                                                                                              ~ServerID.1,
                                                                                                                                              ~ak_h.1,
                                                                                                                                              ~ak_sk.1,
                                                                                                                                              ~ssk_nms.1,
                                                                                                                                              ~tid.1
                                                                                                                     ) ▶₀ #t2.10 )
                                                                                                                case outTPMPCRExtendswstate_0_1111111111111211
                                                                                                                solve( TPM_SendCommand( <
                                                                                                                                         'TPM2_Create', 
                                                                                                                                         <
                                                                                                                                          swstate, 
                                                                                                                                          nil
                                                                                                                                         >, 
                                                                                                                                         'TPM_CC_PolicyPCR', 
                                                                                                                                         nil
                                                                                                                                        >
                                                                                                                       ) @ #t2.14 )
                                                                                                                  case eventTPMSendCommandTPMCreateswstatenilTPMCCPolicyPCRnil_0_11111111111112111
                                                                                                                  solve( state_11111111111112111( ~RouterID.1,
                                                                                                                                                  ~ServerID.1,
                                                                                                                                                  ~ak_h.1,
                                                                                                                                                  ~ak_sk.1,
                                                                                                                                                  ~ssk_nms.1,
                                                                                                                                                  ~tid.1
                                                                                                                         ) ▶₀ #t2.10 )
                                                                                                                    case outTPMPCRExtendswstate_0_1111111111111211
                                                                                                                    by solve( !KU( ~ssk_nms
                                                                                                                              ) @ #vk.23 )
                                                                                                                  qed
                                                                                                                qed
                                                                                                              qed
                                                                                                            qed
                                                                                                          qed
                                                                                                        qed
                                                                                                      qed
                                                                                                    qed
                                                                                                  qed
                                                                                                next
                                                                                                  case case_3
                                                                                                  by contradiction
                                                                                                     /*
                                                                                                     from formulas
                                                                                                     */
                                                                                                qed
                                                                                              next
                                                                                                case case_2
                                                                                                by contradiction
                                                                                                   /*
                                                                                                   from formulas
                                                                                                   */
                                                                                              qed
                                                                                            qed
                                                                                          next
                                                                                            case case_2
                                                                                            solve( state_1111111111111111111111121111111( ~RouterID.1,
                                                                                                                                          ~ServerID.1,
                                                                                                                                          ~ak_h.1,
                                                                                                                                          ~ak_sk.1,
                                                                                                                                          ~ssk_nms.1,
                                                                                                                                          pL,
                                                                                                                                          pcrL,
                                                                                                                                          s_h,
                                                                                                                                          ~n.3
                                                                                                   ) ▶₀ #t2.8 )
                                                                                              case insertpolicyDigestshpcrLTPMCCPolicyPCRpL_0_111111111111111111111112111111
                                                                                              solve( (#t2.9 < #t2.16)  ∥
                                                                                                     (#t2.9 =
                                                                                                      #t2.16) )
                                                                                                case case_1
                                                                                                by contradiction
                                                                                                   /*
                                                                                                   from formulas
                                                                                                   */
                                                                                              next
                                                                                                case case_2
                                                                                                solve( (#t2.15 < #t2.12)  ∥
                                                                                                       (#t2.15 =
                                                                                                        #t2.12)  ∥
                                                                                                       (#vr.72 < #t2.15) )
                                                                                                  case case_1
                                                                                                  by contradiction
                                                                                                     /*
                                                                                                     from formulas
                                                                                                     */
                                                                                                next
                                                                                                  case case_2
                                                                                                  solve( TPM_SendCommand( <
                                                                                                                           'TPM2_PolicyPCR', 
                                                                                                                           k_sh
                                                                                                                          >
                                                                                                         ) @ #t2.13 )
                                                                                                    case eventTPMSendCommandTPMPolicyPCRtlssh_0_1111111111111211111111111
                                                                                                    solve( state_1111111111111211111111111( ~RouterID.1,
                                                                                                                                            ~ServerID.1,
                                                                                                                                            ~ak_h.1,
                                                                                                                                            ~ak_sk.1,
                                                                                                                                            ~ssk_nms.1,
                                                                                                                                            ~tid.1,
                                                                                                                                            tls_h,
                                                                                                                                            k_sh,
                                                                                                                                            tls_spk
                                                                                                           ) ▶₀ #t2.10 )
                                                                                                      case eventGenerateTLStidtlsspk_0_111111111111121111111111
                                                                                                      solve( TPM_SendCommand( <
                                                                                                                               'TPM2_PolicyPCR', 
                                                                                                                               k_sh
                                                                                                                              >
                                                                                                             ) @ #t2.14 )
                                                                                                        case eventTPMSendCommandTPMPolicyPCRtlssh_0_1111111111111211111111111
                                                                                                        solve( state_1111111111111211111111111( ~RouterID.1,
                                                                                                                                                ~ServerID.1,
                                                                                                                                                ~ak_h.1,
                                                                                                                                                ~ak_sk.1,
                                                                                                                                                ~ssk_nms.1,
                                                                                                                                                ~tid.1,
                                                                                                                                                tls_h,
                                                                                                                                                k_sh,
                                                                                                                                                tls_spk
                                                                                                               ) ▶₀ #t2.11 )
                                                                                                          case eventGenerateTLStidtlsspk_0_111111111111121111111111
                                                                                                          solve( TPM_SendCommand( <
                                                                                                                                   'TPM2_Create', 
                                                                                                                                   <
                                                                                                                                    swstate, 
                                                                                                                                    nil
                                                                                                                                   >, 
                                                                                                                                   'TPM_CC_PolicyPCR', 
                                                                                                                                   nil
                                                                                                                                  >
                                                                                                                 ) @ #t2.14 )
                                                                                                            case eventTPMSendCommandTPMCreateswstatenilTPMCCPolicyPCRnil_0_11111111111112111
                                                                                                            solve( state_11111111111112111( ~RouterID.1,
                                                                                                                                            ~ServerID.1,
                                                                                                                                            ~ak_h.1,
                                                                                                                                            ~ak_sk.1,
                                                                                                                                            ~ssk_nms.1,
                                                                                                                                            ~tid.1
                                                                                                                   ) ▶₀ #t2.11 )
                                                                                                              case outTPMPCRExtendswstate_0_1111111111111211
                                                                                                              solve( TPM_SendCommand( <
                                                                                                                                       'TPM2_Create', 
                                                                                                                                       <
                                                                                                                                        swstate, 
                                                                                                                                        nil
                                                                                                                                       >, 
                                                                                                                                       'TPM_CC_PolicyPCR', 
                                                                                                                                       nil
                                                                                                                                      >
                                                                                                                     ) @ #t2.14 )
                                                                                                                case eventTPMSendCommandTPMCreateswstatenilTPMCCPolicyPCRnil_0_11111111111112111
                                                                                                                solve( state_11111111111112111( ~RouterID.1,
                                                                                                                                                ~ServerID.1,
                                                                                                                                                ~ak_h.1,
                                                                                                                                                ~ak_sk.1,
                                                                                                                                                ~ssk_nms.1,
                                                                                                                                                ~tid.1
                                                                                                                       ) ▶₀ #t2.11 )
                                                                                                                  case outTPMPCRExtendswstate_0_1111111111111211
                                                                                                                  by solve( !KU( ~ssk_nms
                                                                                                                            ) @ #vk.23 )
                                                                                                                qed
                                                                                                              qed
                                                                                                            qed
                                                                                                          qed
                                                                                                        qed
                                                                                                      qed
                                                                                                    qed
                                                                                                  qed
                                                                                                next
                                                                                                  case case_3
                                                                                                  by contradiction
                                                                                                     /*
                                                                                                     from formulas
                                                                                                     */
                                                                                                qed
                                                                                              qed
                                                                                            qed
                                                                                          qed
                                                                                        next
                                                                                          case case_3
                                                                                          solve( (#vr.28 < #t2.14)  ∥
                                                                                                 (#vr.28 =
                                                                                                  #t2.14) )
                                                                                            case case_1
                                                                                            solve( state_1111111111111111111111121111111( ~RouterID.1,
                                                                                                                                          ~ServerID.1,
                                                                                                                                          ~ak_h.1,
                                                                                                                                          ~ak_sk.1,
                                                                                                                                          ~ssk_nms.1,
                                                                                                                                          pL,
                                                                                                                                          pcrL,
                                                                                                                                          s_h,
                                                                                                                                          ~n.3
                                                                                                   ) ▶₀ #t2.8 )
                                                                                              case insertpolicyDigestshpcrLTPMCCPolicyPCRpL_0_111111111111111111111112111111
                                                                                              solve( (#vr.28 < #t2.17)  ∥
                                                                                                     (#vr.28 =
                                                                                                      #t2.17) )
                                                                                                case case_1
                                                                                                solve( (#t2.16 < #t2.11)  ∥
                                                                                                       (#t2.16 =
                                                                                                        #t2.11)  ∥
                                                                                                       (#vr.73 < #t2.16) )
                                                                                                  case case_1
                                                                                                  by contradiction
                                                                                                     /*
                                                                                                     from formulas
                                                                                                     */
                                                                                                next
                                                                                                  case case_2
                                                                                                  by contradiction
                                                                                                     /*
                                                                                                     from formulas
                                                                                                     */
                                                                                                next
                                                                                                  case case_3
                                                                                                  solve( (#t2.14 < #t2.17)  ∥
                                                                                                         (#t2.14 =
                                                                                                          #t2.17) )
                                                                                                    case case_1
                                                                                                    by contradiction
                                                                                                       /*
                                                                                                       from formulas
                                                                                                       */
                                                                                                  next
                                                                                                    case case_2
                                                                                                    solve( (#t2.13 < #t2.16)  ∥
                                                                                                           (#t2.13 =
                                                                                                            #t2.16) )
                                                                                                      case case_1
                                                                                                      by contradiction
                                                                                                         /*
                                                                                                         from formulas
                                                                                                         */
                                                                                                    next
                                                                                                      case case_2
                                                                                                      solve( TPM_SendCommand( <
                                                                                                                               'TPM2_PolicyPCR', 
                                                                                                                               k_sh
                                                                                                                              >
                                                                                                             ) @ #t2.12 )
                                                                                                        case eventTPMSendCommandTPMPolicyPCRtlssh_0_1111111111111211111111111
                                                                                                        solve( state_1111111111111211111111111( ~RouterID.1,
                                                                                                                                                ~ServerID.1,
                                                                                                                                                ~ak_h.1,
                                                                                                                                                ~ak_sk.1,
                                                                                                                                                ~ssk_nms.1,
                                                                                                                                                ~tid.1,
                                                                                                                                                tls_h,
                                                                                                                                                k_sh,
                                                                                                                                                tls_spk
                                                                                                               ) ▶₀ #t2.9 )
                                                                                                          case eventGenerateTLStidtlsspk_0_111111111111121111111111
                                                                                                          solve( TPM_SendCommand( <
                                                                                                                                   'TPM2_PolicyPCR', 
                                                                                                                                   k_sh
                                                                                                                                  >
                                                                                                                 ) @ #t2.15 )
                                                                                                            case eventTPMSendCommandTPMPolicyPCRtlssh_0_1111111111111211111111111
                                                                                                            solve( state_1111111111111211111111111( ~RouterID.1,
                                                                                                                                                    ~ServerID.1,
                                                                                                                                                    ~ak_h.1,
                                                                                                                                                    ~ak_sk.1,
                                                                                                                                                    ~ssk_nms.1,
                                                                                                                                                    ~tid.1,
                                                                                                                                                    tls_h,
                                                                                                                                                    k_sh,
                                                                                                                                                    tls_spk
                                                                                                                   ) ▶₀ #t2.10 )
                                                                                                              case eventGenerateTLStidtlsspk_0_111111111111121111111111
                                                                                                              solve( TPM_SendCommand( <
                                                                                                                                       'TPM2_Create', 
                                                                                                                                       <
                                                                                                                                        swstate, 
                                                                                                                                        nil
                                                                                                                                       >, 
                                                                                                                                       'TPM_CC_PolicyPCR', 
                                                                                                                                       nil
                                                                                                                                      >
                                                                                                                     ) @ #t2.15 )
                                                                                                                case eventTPMSendCommandTPMCreateswstatenilTPMCCPolicyPCRnil_0_11111111111112111
                                                                                                                solve( state_11111111111112111( ~RouterID.1,
                                                                                                                                                ~ServerID.1,
                                                                                                                                                ~ak_h.1,
                                                                                                                                                ~ak_sk.1,
                                                                                                                                                ~ssk_nms.1,
                                                                                                                                                ~tid.1
                                                                                                                       ) ▶₀ #t2.10 )
                                                                                                                  case outTPMPCRExtendswstate_0_1111111111111211
                                                                                                                  solve( TPM_SendCommand( <
                                                                                                                                           'TPM2_Create', 
                                                                                                                                           <
                                                                                                                                            swstate, 
                                                                                                                                            nil
                                                                                                                                           >, 
                                                                                                                                           'TPM_CC_PolicyPCR', 
                                                                                                                                           nil
                                                                                                                                          >
                                                                                                                         ) @ #t2.15 )
                                                                                                                    case eventTPMSendCommandTPMCreateswstatenilTPMCCPolicyPCRnil_0_11111111111112111
                                                                                                                    solve( state_11111111111112111( ~RouterID.1,
                                                                                                                                                    ~ServerID.1,
                                                                                                                                                    ~ak_h.1,
                                                                                                                                                    ~ak_sk.1,
                                                                                                                                                    ~ssk_nms.1,
                                                                                                                                                    ~tid.1
                                                                                                                           ) ▶₀ #t2.10 )
                                                                                                                      case outTPMPCRExtendswstate_0_1111111111111211
                                                                                                                      by solve( !KU( ~ssk_nms
                                                                                                                                ) @ #vk.23 )
                                                                                                                    qed
                                                                                                                  qed
                                                                                                                qed
                                                                                                              qed
                                                                                                            qed
                                                                                                          qed
                                                                                                        qed
                                                                                                      qed
                                                                                                    qed
                                                                                                  qed
                                                                                                qed
                                                                                              next
                                                                                                case case_2
                                                                                                by contradiction
                                                                                                   /*
                                                                                                   from formulas
                                                                                                   */
                                                                                              qed
                                                                                            qed
                                                                                          next
                                                                                            case case_2
                                                                                            solve( state_1111111111111111111111121111111( ~RouterID.1,
                                                                                                                                          ~ServerID.1,
                                                                                                                                          ~ak_h.1,
                                                                                                                                          ~ak_sk.1,
                                                                                                                                          ~ssk_nms.1,
                                                                                                                                          pL,
                                                                                                                                          pcrL,
                                                                                                                                          s_h,
                                                                                                                                          ~n.3
                                                                                                   ) ▶₀ #t2.8 )
                                                                                              case insertpolicyDigestshpcrLTPMCCPolicyPCRpL_0_111111111111111111111112111111
                                                                                              solve( (#t2.9 < #t2.17)  ∥
                                                                                                     (#t2.9 =
                                                                                                      #t2.17) )
                                                                                                case case_1
                                                                                                by contradiction
                                                                                                   /*
                                                                                                   from formulas
                                                                                                   */
                                                                                              next
                                                                                                case case_2
                                                                                                solve( (#t2.16 < #t2.12)  ∥
                                                                                                       (#t2.16 =
                                                                                                        #t2.12)  ∥
                                                                                                       (#vr.72 < #t2.16) )
                                                                                                  case case_1
                                                                                                  by contradiction
                                                                                                     /*
                                                                                                     from formulas
                                                                                                     */
                                                                                                next
                                                                                                  case case_2
                                                                                                  by contradiction
                                                                                                     /*
                                                                                                     from formulas
                                                                                                     */
                                                                                                next
                                                                                                  case case_3
                                                                                                  solve( (#t2.14 < #t2.16)  ∥
                                                                                                         (#t2.14 =
                                                                                                          #t2.16) )
                                                                                                    case case_1
                                                                                                    by contradiction
                                                                                                       /*
                                                                                                       from formulas
                                                                                                       */
                                                                                                  next
                                                                                                    case case_2
                                                                                                    solve( TPM_SendCommand( <
                                                                                                                             'TPM2_PolicyPCR', 
                                                                                                                             k_sh
                                                                                                                            >
                                                                                                           ) @ #t2.13 )
                                                                                                      case eventTPMSendCommandTPMPolicyPCRtlssh_0_1111111111111211111111111
                                                                                                      solve( state_1111111111111211111111111( ~RouterID.1,
                                                                                                                                              ~ServerID.1,
                                                                                                                                              ~ak_h.1,
                                                                                                                                              ~ak_sk.1,
                                                                                                                                              ~ssk_nms.1,
                                                                                                                                              ~tid.1,
                                                                                                                                              tls_h,
                                                                                                                                              k_sh,
                                                                                                                                              tls_spk
                                                                                                             ) ▶₀ #t2.10 )
                                                                                                        case eventGenerateTLStidtlsspk_0_111111111111121111111111
                                                                                                        solve( TPM_SendCommand( <
                                                                                                                                 'TPM2_PolicyPCR', 
                                                                                                                                 k_sh
                                                                                                                                >
                                                                                                               ) @ #t2.15 )
                                                                                                          case eventTPMSendCommandTPMPolicyPCRtlssh_0_1111111111111211111111111
                                                                                                          solve( state_1111111111111211111111111( ~RouterID.1,
                                                                                                                                                  ~ServerID.1,
                                                                                                                                                  ~ak_h.1,
                                                                                                                                                  ~ak_sk.1,
                                                                                                                                                  ~ssk_nms.1,
                                                                                                                                                  ~tid.1,
                                                                                                                                                  tls_h,
                                                                                                                                                  k_sh,
                                                                                                                                                  tls_spk
                                                                                                                 ) ▶₀ #t2.11 )
                                                                                                            case eventGenerateTLStidtlsspk_0_111111111111121111111111
                                                                                                            solve( TPM_SendCommand( <
                                                                                                                                     'TPM2_Create', 
                                                                                                                                     <
                                                                                                                                      swstate, 
                                                                                                                                      nil
                                                                                                                                     >, 
                                                                                                                                     'TPM_CC_PolicyPCR', 
                                                                                                                                     nil
                                                                                                                                    >
                                                                                                                   ) @ #t2.15 )
                                                                                                              case eventTPMSendCommandTPMCreateswstatenilTPMCCPolicyPCRnil_0_11111111111112111
                                                                                                              solve( state_11111111111112111( ~RouterID.1,
                                                                                                                                              ~ServerID.1,
                                                                                                                                              ~ak_h.1,
                                                                                                                                              ~ak_sk.1,
                                                                                                                                              ~ssk_nms.1,
                                                                                                                                              ~tid.1
                                                                                                                     ) ▶₀ #t2.11 )
                                                                                                                case outTPMPCRExtendswstate_0_1111111111111211
                                                                                                                solve( TPM_SendCommand( <
                                                                                                                                         'TPM2_Create', 
                                                                                                                                         <
                                                                                                                                          swstate, 
                                                                                                                                          nil
                                                                                                                                         >, 
                                                                                                                                         'TPM_CC_PolicyPCR', 
                                                                                                                                         nil
                                                                                                                                        >
                                                                                                                       ) @ #t2.15 )
                                                                                                                  case eventTPMSendCommandTPMCreateswstatenilTPMCCPolicyPCRnil_0_11111111111112111
                                                                                                                  solve( state_11111111111112111( ~RouterID.1,
                                                                                                                                                  ~ServerID.1,
                                                                                                                                                  ~ak_h.1,
                                                                                                                                                  ~ak_sk.1,
                                                                                                                                                  ~ssk_nms.1,
                                                                                                                                                  ~tid.1
                                                                                                                         ) ▶₀ #t2.11 )
                                                                                                                    case outTPMPCRExtendswstate_0_1111111111111211
                                                                                                                    by solve( !KU( ~ssk_nms
                                                                                                                              ) @ #vk.23 )
                                                                                                                  qed
                                                                                                                qed
                                                                                                              qed
                                                                                                            qed
                                                                                                          qed
                                                                                                        qed
                                                                                                      qed
                                                                                                    qed
                                                                                                  qed
                                                                                                qed
                                                                                              qed
                                                                                            qed
                                                                                          qed
                                                                                        qed
                                                                                      qed
                                                                                    qed
                                                                                  qed
                                                                                qed
                                                                              qed
                                                                            qed
                                                                          qed
                                                                        qed
                                                                      qed
                                                                    qed
                                                                  qed
                                                                qed
                                                              qed
                                                            qed
                                                          qed
                                                        next
                                                          case case_2
                                                          by contradiction /* from formulas */
                                                        qed
                                                      next
                                                        case case_2
                                                        by contradiction /* from formulas */
                                                      qed
                                                    qed
                                                  qed
                                                qed
                                              next
                                                case unlockdevice_0_11111111111111111111211111112
                                                by solve( state_11111111111111111111211111112( ~RouterID.1,
                                                                                               ~ServerID.1,
                                                                                               ~ak_h.1,
                                                                                               ~ak_sk.1,
                                                                                               ~ssk_nms.1,
                                                                                               a_h, obj_ap,
                                                                                               obj_h, obj_pd,
                                                                                               obj_pk, obj_sh,
                                                                                               ~n.2
                                                          ) ▶₀ #t2.6 )
                                              qed
                                            qed
                                          next
                                            case case_2
                                            solve( (#t2.7 < #t2.10)  ∥ (#t2.7 = #t2.10)  ∥ (#vr.72 < #t2.7) )
                                              case case_1
                                              by contradiction /* from formulas */
                                            next
                                              case case_2
                                              solve( Unlock_4( '4', ~n.2, 'device' ) @ #t2.8 )
                                                case unlockdevice_0_111111111111111111112111111111
                                                solve( state_111111111111111111112111111111( ~RouterID.1,
                                                                                             ~ServerID.1,
                                                                                             ~ak_h.1,
                                                                                             ~ak_sk.1,
                                                                                             ~ssk_nms.1, a_h,
                                                                                             a_sk, obj_ap,
                                                                                             obj_h, obj_pd,
                                                                                             obj_pk, obj_sh,
                                                                                             ~n.2
                                                       ) ▶₀ #t2.7 )
                                                  case outsignobjpkobjapask_0_11111111111111111111211111111
                                                  solve( (#t2.3 < #t2.14)  ∥ (#t2.3 = #t2.14) )
                                                    case case_1
                                                    by contradiction /* from formulas */
                                                  next
                                                    case case_2
                                                    solve( (#t2.6 < #t2.12)  ∥ (#t2.6 = #t2.12) )
                                                      case case_1
                                                      by contradiction /* from formulas */
                                                    next
                                                      case case_2
                                                      solve( (#t2.8 < #t2.13)  ∥ (#t2.8 = #t2.13) )
                                                        case case_1
                                                        by contradiction /* from formulas */
                                                      next
                                                        case case_2
                                                        solve( (#vr.39 < #t2.12)  ∥ (#vr.39 = #t2.12) )
                                                          case case_1
                                                          solve( (#t2.9 < #t2.12)  ∥ (#t2.9 = #t2.12) )
                                                            case case_1
                                                            by contradiction /* from formulas */
                                                          next
                                                            case case_2
                                                            solve( TPM_SendCommand( <'TPM2_Create', 
                                                                                     <swstate, nil>, 
                                                                                     'TPM_CC_PolicyPCR', nil>
                                                                   ) @ #t2.10 )
                                                              case eventTPMSendCommandTPMCreateswstatenilTPMCCPolicyPCRnil_0_11111111111112111
                                                              solve( state_11111111111112111( ~RouterID.1,
                                                                                              ~ServerID.1,
                                                                                              ~ak_h.1,
                                                                                              ~ak_sk.1,
                                                                                              ~ssk_nms.1,
                                                                                              ~tid.1
                                                                     ) ▶₀ #t2.8 )
                                                                case outTPMPCRExtendswstate_0_1111111111111211
                                                                solve( TPM_SendCommand( <'TPM2_Certify', 
                                                                                         k_sh, ~k_h, ~ak_h>
                                                                       ) @ #t2.10 )
                                                                  case eventTPMSendCommandTPMCertifytlsshtlshakh_0_111111111111121111111111111
                                                                  solve( state_111111111111121111111111111( ~RouterID.1,
                                                                                                            ~ServerID.1,
                                                                                                            ~ak_h,
                                                                                                            ~ak_sk.1,
                                                                                                            ~ssk_nms.1,
                                                                                                            ~tid.1,
                                                                                                            ~k_h,
                                                                                                            k_sh,
                                                                                                            tls_spk
                                                                         ) ▶₀ #t2.8 )
                                                                    case outTPMPolicyPCRtlssh_0_11111111111112111111111111
                                                                    solve( TPM_SendCommand( <'TPM2_Create', 
                                                                                             <swstate, nil>, 
                                                                                             'TPM_CC_PolicyPCR', 
                                                                                             nil>
                                                                           ) @ #t2.10 )
                                                                      case eventTPMSendCommandTPMCreateswstatenilTPMCCPolicyPCRnil_0_11111111111112111
                                                                      solve( state_11111111111112111( ~RouterID.1,
                                                                                                      ~ServerID.1,
                                                                                                      ~ak_h.1,
                                                                                                      ~ak_sk.1,
                                                                                                      ~ssk_nms.1,
                                                                                                      ~tid.1
                                                                             ) ▶₀ #t2.8 )
                                                                        case outTPMPCRExtendswstate_0_1111111111111211
                                                                        solve( Insert( <'privatePart', ~k_h>,
                                                                                       k_sk.1
                                                                               ) @ #t2.2 )
                                                                          case insertprivatePartkhksk_0_111111111111111111111121111111
                                                                          solve( Insert( <'authPolicy', ~k_h>,
                                                                                         k_ap
                                                                                 ) @ #t2.3 )
                                                                            case insertauthPolicykhauthPolicy_0_11111111111111111111112111111
                                                                            solve( Insert( <'policyDigest', 
                                                                                            k_sh>,
                                                                                           <<swstate, nil>, 
                                                                                            'TPM_CC_PolicyPCR', 
                                                                                            nil>
                                                                                   ) @ #t2.8 )
                                                                              case insertpolicyDigestshpcrLTPMCCPolicyPCRpL_0_111111111111111111111112111111
                                                                              solve( state_111111111111111111111112111111( ~RouterID.1,
                                                                                                                           ~ServerID.1,
                                                                                                                           ~ak_h.1,
                                                                                                                           ~ak_sk.1,
                                                                                                                           ~ssk_nms.1,
                                                                                                                           nil,
                                                                                                                           <
                                                                                                                            swstate, 
                                                                                                                            nil
                                                                                                                           >,
                                                                                                                           k_sh,
                                                                                                                           lock
                                                                                     ) ▶₀ #t2.8 )
                                                                                case eventPolicyPCRshpL_0_11111111111111111111111211111
                                                                                solve( (#vr.82 < #vr.46)  ∥
                                                                                       (#t2 < #vr.82) )
                                                                                  case case_1
                                                                                  solve( (#vr.28 < #t2.13)  ∥
                                                                                         (#vr.28 = #t2.13) )
                                                                                    case case_1
                                                                                    solve( state_1111111111111111111111121111111( ~RouterID.1,
                                                                                                                                  ~ServerID.1,
                                                                                                                                  ~ak_h.1,
                                                                                                                                  ~ak_sk.1,
                                                                                                                                  ~ssk_nms.1,
                                                                                                                                  pL,
                                                                                                                                  pcrL,
                                                                                                                                  s_h,
                                                                                                                                  ~n.3
                                                                                           ) ▶₀ #t2.9 )
                                                                                      case insertpolicyDigestshpcrLTPMCCPolicyPCRpL_0_111111111111111111111112111111
                                                                                      solve( (#vr.28 < #t2.16)  ∥
                                                                                             (#vr.28 =
                                                                                              #t2.16) )
                                                                                        case case_1
                                                                                        solve( (#t2.13 < #t2.16)  ∥
                                                                                               (#t2.13 =
                                                                                                #t2.16) )
                                                                                          case case_1
                                                                                          by contradiction
                                                                                             /* from formulas
                                                                                             */
                                                                                        next
                                                                                          case case_2
                                                                                          solve( (#t2.12 < #t2.15)  ∥
                                                                                                 (#t2.12 =
                                                                                                  #t2.15) )
                                                                                            case case_1
                                                                                            by contradiction
                                                                                               /*
                                                                                               from formulas
                                                                                               */
                                                                                          next
                                                                                            case case_2
                                                                                            solve( TPM_SendCommand( <
                                                                                                                     'TPM2_PolicyPCR', 
                                                                                                                     k_sh
                                                                                                                    >
                                                                                                   ) @ #t2.11 )
                                                                                              case eventTPMSendCommandTPMPolicyPCRtlssh_0_1111111111111211111111111
                                                                                              solve( state_1111111111111211111111111( ~RouterID.1,
                                                                                                                                      ~ServerID.1,
                                                                                                                                      ~ak_h.1,
                                                                                                                                      ~ak_sk.1,
                                                                                                                                      ~ssk_nms.1,
                                                                                                                                      ~tid.1,
                                                                                                                                      tls_h,
                                                                                                                                      k_sh,
                                                                                                                                      tls_spk
                                                                                                     ) ▶₀ #t2.10 )
                                                                                                case eventGenerateTLStidtlsspk_0_111111111111121111111111
                                                                                                by contradiction
                                                                                                   /* cyclic
                                                                                                   */
                                                                                              qed
                                                                                            qed
                                                                                          qed
                                                                                        qed
                                                                                      next
                                                                                        case case_2
                                                                                        by contradiction
                                                                                           /* from formulas */
                                                                                      qed
                                                                                    qed
                                                                                  next
                                                                                    case case_2
                                                                                    solve( state_1111111111111111111111121111111( ~RouterID.1,
                                                                                                                                  ~ServerID.1,
                                                                                                                                  ~ak_h.1,
                                                                                                                                  ~ak_sk.1,
                                                                                                                                  ~ssk_nms.1,
                                                                                                                                  pL,
                                                                                                                                  pcrL,
                                                                                                                                  s_h,
                                                                                                                                  ~n.3
                                                                                           ) ▶₀ #t2.9 )
                                                                                      case insertpolicyDigestshpcrLTPMCCPolicyPCRpL_0_111111111111111111111112111111
                                                                                      solve( (#t2.10 < #t2.16)  ∥
                                                                                             (#t2.10 =
                                                                                              #t2.16) )
                                                                                        case case_1
                                                                                        by contradiction
                                                                                           /* from formulas */
                                                                                      next
                                                                                        case case_2
                                                                                        solve( (#t2.13 < #t2.15)  ∥
                                                                                               (#t2.13 =
                                                                                                #t2.15) )
                                                                                          case case_1
                                                                                          by contradiction
                                                                                             /* from formulas
                                                                                             */
                                                                                        next
                                                                                          case case_2
                                                                                          solve( TPM_SendCommand( <
                                                                                                                   'TPM2_PolicyPCR', 
                                                                                                                   k_sh
                                                                                                                  >
                                                                                                 ) @ #t2.12 )
                                                                                            case eventTPMSendCommandTPMPolicyPCRtlssh_0_1111111111111211111111111
                                                                                            solve( state_1111111111111211111111111( ~RouterID.1,
                                                                                                                                    ~ServerID.1,
                                                                                                                                    ~ak_h.1,
                                                                                                                                    ~ak_sk.1,
                                                                                                                                    ~ssk_nms.1,
                                                                                                                                    ~tid.1,
                                                                                                                                    tls_h,
                                                                                                                                    k_sh,
                                                                                                                                    tls_spk
                                                                                                   ) ▶₀ #t2.11 )
                                                                                              case eventGenerateTLStidtlsspk_0_111111111111121111111111
                                                                                              by contradiction
                                                                                                 /* cyclic */
                                                                                            qed
                                                                                          qed
                                                                                        qed
                                                                                      qed
                                                                                    qed
                                                                                  qed
                                                                                next
                                                                                  case case_2
                                                                                  solve( (#vr.28 < #t2.13)  ∥
                                                                                         (#vr.28 = #t2.13) )
                                                                                    case case_1
                                                                                    solve( state_1111111111111111111111121111111( ~RouterID.1,
                                                                                                                                  ~ServerID.1,
                                                                                                                                  ~ak_h.1,
                                                                                                                                  ~ak_sk.1,
                                                                                                                                  ~ssk_nms.1,
                                                                                                                                  pL,
                                                                                                                                  pcrL,
                                                                                                                                  s_h,
                                                                                                                                  ~n.3
                                                                                           ) ▶₀ #t2.9 )
                                                                                      case insertpolicyDigestshpcrLTPMCCPolicyPCRpL_0_111111111111111111111112111111
                                                                                      solve( (#vr.28 < #t2.16)  ∥
                                                                                             (#vr.28 =
                                                                                              #t2.16) )
                                                                                        case case_1
                                                                                        solve( (#t2.13 < #t2.16)  ∥
                                                                                               (#t2.13 =
                                                                                                #t2.16) )
                                                                                          case case_1
                                                                                          by contradiction
                                                                                             /* from formulas
                                                                                             */
                                                                                        next
                                                                                          case case_2
                                                                                          solve( (#t2.12 < #t2.15)  ∥
                                                                                                 (#t2.12 =
                                                                                                  #t2.15) )
                                                                                            case case_1
                                                                                            by contradiction
                                                                                               /*
                                                                                               from formulas
                                                                                               */
                                                                                          next
                                                                                            case case_2
                                                                                            solve( TPM_SendCommand( <
                                                                                                                     'TPM2_PolicyPCR', 
                                                                                                                     k_sh
                                                                                                                    >
                                                                                                   ) @ #t2.11 )
                                                                                              case eventTPMSendCommandTPMPolicyPCRtlssh_0_1111111111111211111111111
                                                                                              solve( state_1111111111111211111111111( ~RouterID.1,
                                                                                                                                      ~ServerID.1,
                                                                                                                                      ~ak_h.1,
                                                                                                                                      ~ak_sk.1,
                                                                                                                                      ~ssk_nms.1,
                                                                                                                                      ~tid.1,
                                                                                                                                      tls_h,
                                                                                                                                      k_sh,
                                                                                                                                      tls_spk
                                                                                                     ) ▶₀ #t2.10 )
                                                                                                case eventGenerateTLStidtlsspk_0_111111111111121111111111
                                                                                                solve( TPM_SendCommand( <
                                                                                                                         'TPM2_PolicyPCR', 
                                                                                                                         k_sh
                                                                                                                        >
                                                                                                       ) @ #t2.14 )
                                                                                                  case eventTPMSendCommandTPMPolicyPCRtlssh_0_1111111111111211111111111
                                                                                                  solve( state_1111111111111211111111111( ~RouterID.1,
                                                                                                                                          ~ServerID.1,
                                                                                                                                          ~ak_h.1,
                                                                                                                                          ~ak_sk.1,
                                                                                                                                          ~ssk_nms.1,
                                                                                                                                          ~tid.1,
                                                                                                                                          tls_h,
                                                                                                                                          k_sh,
                                                                                                                                          tls_spk
                                                                                                         ) ▶₀ #t2.11 )
                                                                                                    case eventGenerateTLStidtlsspk_0_111111111111121111111111
                                                                                                    solve( TPM_SendCommand( <
                                                                                                                             'TPM2_Create', 
                                                                                                                             <
                                                                                                                              swstate, 
                                                                                                                              nil
                                                                                                                             >, 
                                                                                                                             'TPM_CC_PolicyPCR', 
                                                                                                                             nil
                                                                                                                            >
                                                                                                           ) @ #t2.14 )
                                                                                                      case eventTPMSendCommandTPMCreateswstatenilTPMCCPolicyPCRnil_0_11111111111112111
                                                                                                      solve( state_11111111111112111( ~RouterID.1,
                                                                                                                                      ~ServerID.1,
                                                                                                                                      ~ak_h.1,
                                                                                                                                      ~ak_sk.1,
                                                                                                                                      ~ssk_nms.1,
                                                                                                                                      ~tid.1
                                                                                                             ) ▶₀ #t2.11 )
                                                                                                        case outTPMPCRExtendswstate_0_1111111111111211
                                                                                                        solve( TPM_SendCommand( <
                                                                                                                                 'TPM2_Create', 
                                                                                                                                 <
                                                                                                                                  swstate, 
                                                                                                                                  nil
                                                                                                                                 >, 
                                                                                                                                 'TPM_CC_PolicyPCR', 
                                                                                                                                 nil
                                                                                                                                >
                                                                                                               ) @ #t2.14 )
                                                                                                          case eventTPMSendCommandTPMCreateswstatenilTPMCCPolicyPCRnil_0_11111111111112111
                                                                                                          solve( state_11111111111112111( ~RouterID.1,
                                                                                                                                          ~ServerID.1,
                                                                                                                                          ~ak_h.1,
                                                                                                                                          ~ak_sk.1,
                                                                                                                                          ~ssk_nms.1,
                                                                                                                                          ~tid.1
                                                                                                                 ) ▶₀ #t2.11 )
                                                                                                            case outTPMPCRExtendswstate_0_1111111111111211
                                                                                                            by solve( !KU( ~ssk_nms
                                                                                                                      ) @ #vk.23 )
                                                                                                          qed
                                                                                                        qed
                                                                                                      qed
                                                                                                    qed
                                                                                                  qed
                                                                                                qed
                                                                                              qed
                                                                                            qed
                                                                                          qed
                                                                                        qed
                                                                                      next
                                                                                        case case_2
                                                                                        by contradiction
                                                                                           /* from formulas */
                                                                                      qed
                                                                                    qed
                                                                                  next
                                                                                    case case_2
                                                                                    solve( state_1111111111111111111111121111111( ~RouterID.1,
                                                                                                                                  ~ServerID.1,
                                                                                                                                  ~ak_h.1,
                                                                                                                                  ~ak_sk.1,
                                                                                                                                  ~ssk_nms.1,
                                                                                                                                  pL,
                                                                                                                                  pcrL,
                                                                                                                                  s_h,
                                                                                                                                  ~n.3
                                                                                           ) ▶₀ #t2.9 )
                                                                                      case insertpolicyDigestshpcrLTPMCCPolicyPCRpL_0_111111111111111111111112111111
                                                                                      solve( (#t2.10 < #t2.16)  ∥
                                                                                             (#t2.10 =
                                                                                              #t2.16) )
                                                                                        case case_1
                                                                                        by contradiction
                                                                                           /* from formulas */
                                                                                      next
                                                                                        case case_2
                                                                                        solve( (#t2.13 < #t2.15)  ∥
                                                                                               (#t2.13 =
                                                                                                #t2.15) )
                                                                                          case case_1
                                                                                          by contradiction
                                                                                             /* from formulas
                                                                                             */
                                                                                        next
                                                                                          case case_2
                                                                                          solve( TPM_SendCommand( <
                                                                                                                   'TPM2_PolicyPCR', 
                                                                                                                   k_sh
                                                                                                                  >
                                                                                                 ) @ #t2.12 )
                                                                                            case eventTPMSendCommandTPMPolicyPCRtlssh_0_1111111111111211111111111
                                                                                            solve( state_1111111111111211111111111( ~RouterID.1,
                                                                                                                                    ~ServerID.1,
                                                                                                                                    ~ak_h.1,
                                                                                                                                    ~ak_sk.1,
                                                                                                                                    ~ssk_nms.1,
                                                                                                                                    ~tid.1,
                                                                                                                                    tls_h,
                                                                                                                                    k_sh,
                                                                                                                                    tls_spk
                                                                                                   ) ▶₀ #t2.11 )
                                                                                              case eventGenerateTLStidtlsspk_0_111111111111121111111111
                                                                                              solve( TPM_SendCommand( <
                                                                                                                       'TPM2_PolicyPCR', 
                                                                                                                       k_sh
                                                                                                                      >
                                                                                                     ) @ #t2.14 )
                                                                                                case eventTPMSendCommandTPMPolicyPCRtlssh_0_1111111111111211111111111
                                                                                                solve( state_1111111111111211111111111( ~RouterID.1,
                                                                                                                                        ~ServerID.1,
                                                                                                                                        ~ak_h.1,
                                                                                                                                        ~ak_sk.1,
                                                                                                                                        ~ssk_nms.1,
                                                                                                                                        ~tid.1,
                                                                                                                                        tls_h,
                                                                                                                                        k_sh,
                                                                                                                                        tls_spk
                                                                                                       ) ▶₀ #t2.12 )
                                                                                                  case eventGenerateTLStidtlsspk_0_111111111111121111111111
                                                                                                  solve( TPM_SendCommand( <
                                                                                                                           'TPM2_Create', 
                                                                                                                           <
                                                                                                                            swstate, 
                                                                                                                            nil
                                                                                                                           >, 
                                                                                                                           'TPM_CC_PolicyPCR', 
                                                                                                                           nil
                                                                                                                          >
                                                                                                         ) @ #t2.14 )
                                                                                                    case eventTPMSendCommandTPMCreateswstatenilTPMCCPolicyPCRnil_0_11111111111112111
                                                                                                    solve( state_11111111111112111( ~RouterID.1,
                                                                                                                                    ~ServerID.1,
                                                                                                                                    ~ak_h.1,
                                                                                                                                    ~ak_sk.1,
                                                                                                                                    ~ssk_nms.1,
                                                                                                                                    ~tid.1
                                                                                                           ) ▶₀ #t2.12 )
                                                                                                      case outTPMPCRExtendswstate_0_1111111111111211
                                                                                                      solve( TPM_SendCommand( <
                                                                                                                               'TPM2_Create', 
                                                                                                                               <
                                                                                                                                swstate, 
                                                                                                                                nil
                                                                                                                               >, 
                                                                                                                               'TPM_CC_PolicyPCR', 
                                                                                                                               nil
                                                                                                                              >
                                                                                                             ) @ #t2.14 )
                                                                                                        case eventTPMSendCommandTPMCreateswstatenilTPMCCPolicyPCRnil_0_11111111111112111
                                                                                                        solve( state_11111111111112111( ~RouterID.1,
                                                                                                                                        ~ServerID.1,
                                                                                                                                        ~ak_h.1,
                                                                                                                                        ~ak_sk.1,
                                                                                                                                        ~ssk_nms.1,
                                                                                                                                        ~tid.1
                                                                                                               ) ▶₀ #t2.12 )
                                                                                                          case outTPMPCRExtendswstate_0_1111111111111211
                                                                                                          by solve( !KU( ~ssk_nms
                                                                                                                    ) @ #vk.23 )
                                                                                                        qed
                                                                                                      qed
                                                                                                    qed
                                                                                                  qed
                                                                                                qed
                                                                                              qed
                                                                                            qed
                                                                                          qed
                                                                                        qed
                                                                                      qed
                                                                                    qed
                                                                                  qed
                                                                                qed
                                                                              qed
                                                                            qed
                                                                          qed
                                                                        qed
                                                                      qed
                                                                    qed
                                                                  qed
                                                                qed
                                                              qed
                                                            qed
                                                          qed
                                                        next
                                                          case case_2
                                                          by contradiction /* from formulas */
                                                        qed
                                                      qed
                                                    qed
                                                  qed
                                                qed
                                              next
                                                case unlockdevice_0_11111111111111111111211111112
                                                by solve( state_11111111111111111111211111112( ~RouterID.1,
                                                                                               ~ServerID.1,
                                                                                               ~ak_h.1,
                                                                                               ~ak_sk.1,
                                                                                               ~ssk_nms.1,
                                                                                               a_h, obj_ap,
                                                                                               obj_h, obj_pd,
                                                                                               obj_pk, obj_sh,
                                                                                               ~n.2
                                                          ) ▶₀ #t2.7 )
                                              qed
                                            next
                                              case case_3
                                              solve( Unlock_4( '4', ~n.2, 'device' ) @ #t2.8 )
                                                case unlockdevice_0_111111111111111111112111111111
                                                solve( state_111111111111111111112111111111( ~RouterID.1,
                                                                                             ~ServerID.1,
                                                                                             ~ak_h.1,
                                                                                             ~ak_sk.1,
                                                                                             ~ssk_nms.1, a_h,
                                                                                             a_sk, obj_ap,
                                                                                             obj_h, obj_pd,
                                                                                             obj_pk, obj_sh,
                                                                                             ~n.2
                                                       ) ▶₀ #t2.7 )
                                                  case outsignobjpkobjapask_0_11111111111111111111211111111
                                                  solve( (#t2.3 < #t2.15)  ∥ (#t2.3 = #t2.15) )
                                                    case case_1
                                                    by contradiction /* from formulas */
                                                  next
                                                    case case_2
                                                    solve( (#t2.6 < #t2.13)  ∥ (#t2.6 = #t2.13) )
                                                      case case_1
                                                      by contradiction /* from formulas */
                                                    next
                                                      case case_2
                                                      solve( (#t2.10 < #t2.14)  ∥ (#t2.10 = #t2.14) )
                                                        case case_1
                                                        by contradiction /* from formulas */
                                                      next
                                                        case case_2
                                                        solve( (#vr.39 < #t2.13)  ∥ (#vr.39 = #t2.13) )
                                                          case case_1
                                                          solve( (#t2.9 < #t2.13)  ∥ (#t2.9 = #t2.13) )
                                                            case case_1
                                                            by contradiction /* from formulas */
                                                          next
                                                            case case_2
                                                            solve( TPM_SendCommand( <'TPM2_Create', 
                                                                                     <swstate, nil>, 
                                                                                     'TPM_CC_PolicyPCR', nil>
                                                                   ) @ #t2.11 )
                                                              case eventTPMSendCommandTPMCreateswstatenilTPMCCPolicyPCRnil_0_11111111111112111
                                                              solve( state_11111111111112111( ~RouterID.1,
                                                                                              ~ServerID.1,
                                                                                              ~ak_h.1,
                                                                                              ~ak_sk.1,
                                                                                              ~ssk_nms.1,
                                                                                              ~tid.1
                                                                     ) ▶₀ #t2.8 )
                                                                case outTPMPCRExtendswstate_0_1111111111111211
                                                                solve( TPM_SendCommand( <'TPM2_Certify', 
                                                                                         k_sh, ~k_h, ~ak_h>
                                                                       ) @ #t2.11 )
                                                                  case eventTPMSendCommandTPMCertifytlsshtlshakh_0_111111111111121111111111111
                                                                  solve( state_111111111111121111111111111( ~RouterID.1,
                                                                                                            ~ServerID.1,
                                                                                                            ~ak_h,
                                                                                                            ~ak_sk.1,
                                                                                                            ~ssk_nms.1,
                                                                                                            ~tid.1,
                                                                                                            ~k_h,
                                                                                                            k_sh,
                                                                                                            tls_spk
                                                                         ) ▶₀ #t2.8 )
                                                                    case outTPMPolicyPCRtlssh_0_11111111111112111111111111
                                                                    solve( TPM_SendCommand( <'TPM2_Create', 
                                                                                             <swstate, nil>, 
                                                                                             'TPM_CC_PolicyPCR', 
                                                                                             nil>
                                                                           ) @ #t2.11 )
                                                                      case eventTPMSendCommandTPMCreateswstatenilTPMCCPolicyPCRnil_0_11111111111112111
                                                                      solve( state_11111111111112111( ~RouterID.1,
                                                                                                      ~ServerID.1,
                                                                                                      ~ak_h.1,
                                                                                                      ~ak_sk.1,
                                                                                                      ~ssk_nms.1,
                                                                                                      ~tid.1
                                                                             ) ▶₀ #t2.8 )
                                                                        case outTPMPCRExtendswstate_0_1111111111111211
                                                                        solve( Insert( <'privatePart', ~k_h>,
                                                                                       k_sk.1
                                                                               ) @ #t2.2 )
                                                                          case insertprivatePartkhksk_0_111111111111111111111121111111
                                                                          solve( Insert( <'authPolicy', ~k_h>,
                                                                                         k_ap
                                                                                 ) @ #t2.3 )
                                                                            case insertauthPolicykhauthPolicy_0_11111111111111111111112111111
                                                                            solve( Insert( <'policyDigest', 
                                                                                            k_sh>,
                                                                                           <<swstate, nil>, 
                                                                                            'TPM_CC_PolicyPCR', 
                                                                                            nil>
                                                                                   ) @ #t2.8 )
                                                                              case insertpolicyDigestshpcrLTPMCCPolicyPCRpL_0_111111111111111111111112111111
                                                                              solve( state_111111111111111111111112111111( ~RouterID.1,
                                                                                                                           ~ServerID.1,
                                                                                                                           ~ak_h.1,
                                                                                                                           ~ak_sk.1,
                                                                                                                           ~ssk_nms.1,
                                                                                                                           nil,
                                                                                                                           <
                                                                                                                            swstate, 
                                                                                                                            nil
                                                                                                                           >,
                                                                                                                           k_sh,
                                                                                                                           lock
                                                                                     ) ▶₀ #t2.8 )
                                                                                case eventPolicyPCRshpL_0_11111111111111111111111211111
                                                                                solve( (#vr.82 < #vr.46)  ∥
                                                                                       (#t2 < #vr.82) )
                                                                                  case case_1
                                                                                  solve( (#t2.13 < #t2.11)  ∥
                                                                                         (#t2.13 = #t2.11)  ∥
                                                                                         (#vr.72 < #t2.13) )
                                                                                    case case_1
                                                                                    solve( (#vr.28 < #t2.14)  ∥
                                                                                           (#vr.28 = #t2.14) )
                                                                                      case case_1
                                                                                      solve( state_1111111111111111111111121111111( ~RouterID.1,
                                                                                                                                    ~ServerID.1,
                                                                                                                                    ~ak_h.1,
                                                                                                                                    ~ak_sk.1,
                                                                                                                                    ~ssk_nms.1,
                                                                                                                                    pL,
                                                                                                                                    pcrL,
                                                                                                                                    s_h,
                                                                                                                                    ~n.3
                                                                                             ) ▶₀ #t2.9 )
                                                                                        case insertpolicyDigestshpcrLTPMCCPolicyPCRpL_0_111111111111111111111112111111
                                                                                        by contradiction
                                                                                           /* cyclic */
                                                                                      qed
                                                                                    next
                                                                                      case case_2
                                                                                      solve( state_1111111111111111111111121111111( ~RouterID.1,
                                                                                                                                    ~ServerID.1,
                                                                                                                                    ~ak_h.1,
                                                                                                                                    ~ak_sk.1,
                                                                                                                                    ~ssk_nms.1,
                                                                                                                                    pL,
                                                                                                                                    pcrL,
                                                                                                                                    s_h,
                                                                                                                                    ~n.3
                                                                                             ) ▶₀ #t2.9 )
                                                                                        case insertpolicyDigestshpcrLTPMCCPolicyPCRpL_0_111111111111111111111112111111
                                                                                        by contradiction
                                                                                           /* cyclic */
                                                                                      qed
                                                                                    qed
                                                                                  next
                                                                                    case case_2
                                                                                    solve( (#vr.28 < #t2.13)  ∥
                                                                                           (#vr.28 = #t2.13) )
                                                                                      case case_1
                                                                                      solve( state_1111111111111111111111121111111( ~RouterID.1,
                                                                                                                                    ~ServerID.1,
                                                                                                                                    ~ak_h.1,
                                                                                                                                    ~ak_sk.1,
                                                                                                                                    ~ssk_nms.1,
                                                                                                                                    pL,
                                                                                                                                    pcrL,
                                                                                                                                    s_h,
                                                                                                                                    ~n.3
                                                                                             ) ▶₀ #t2.9 )
                                                                                        case insertpolicyDigestshpcrLTPMCCPolicyPCRpL_0_111111111111111111111112111111
                                                                                        by contradiction
                                                                                           /* cyclic */
                                                                                      qed
                                                                                    next
                                                                                      case case_2
                                                                                      solve( state_1111111111111111111111121111111( ~RouterID.1,
                                                                                                                                    ~ServerID.1,
                                                                                                                                    ~ak_h.1,
                                                                                                                                    ~ak_sk.1,
                                                                                                                                    ~ssk_nms.1,
                                                                                                                                    pL,
                                                                                                                                    pcrL,
                                                                                                                                    s_h,
                                                                                                                                    ~n.3
                                                                                             ) ▶₀ #t2.9 )
                                                                                        case insertpolicyDigestshpcrLTPMCCPolicyPCRpL_0_111111111111111111111112111111
                                                                                        by contradiction
                                                                                           /* cyclic */
                                                                                      qed
                                                                                    qed
                                                                                  next
                                                                                    case case_3
                                                                                    solve( (#vr.28 < #t2.14)  ∥
                                                                                           (#vr.28 = #t2.14) )
                                                                                      case case_1
                                                                                      solve( state_1111111111111111111111121111111( ~RouterID.1,
                                                                                                                                    ~ServerID.1,
                                                                                                                                    ~ak_h.1,
                                                                                                                                    ~ak_sk.1,
                                                                                                                                    ~ssk_nms.1,
                                                                                                                                    pL,
                                                                                                                                    pcrL,
                                                                                                                                    s_h,
                                                                                                                                    ~n.3
                                                                                             ) ▶₀ #t2.9 )
                                                                                        case insertpolicyDigestshpcrLTPMCCPolicyPCRpL_0_111111111111111111111112111111
                                                                                        by contradiction
                                                                                           /* cyclic */
                                                                                      qed
                                                                                    next
                                                                                      case case_2
                                                                                      solve( state_1111111111111111111111121111111( ~RouterID.1,
                                                                                                                                    ~ServerID.1,
                                                                                                                                    ~ak_h.1,
                                                                                                                                    ~ak_sk.1,
                                                                                                                                    ~ssk_nms.1,
                                                                                                                                    pL,
                                                                                                                                    pcrL,
                                                                                                                                    s_h,
                                                                                                                                    ~n.3
                                                                                             ) ▶₀ #t2.9 )
                                                                                        case insertpolicyDigestshpcrLTPMCCPolicyPCRpL_0_111111111111111111111112111111
                                                                                        by contradiction
                                                                                           /* cyclic */
                                                                                      qed
                                                                                    qed
                                                                                  qed
                                                                                next
                                                                                  case case_2
                                                                                  solve( (#vr.82 < #vr.73)  ∥
                                                                                         (#t2.7 < #vr.82) )
                                                                                    case case_1
                                                                                    solve( (#t2.13 < #t2.11)  ∥
                                                                                           (#t2.13 =
                                                                                            #t2.11)  ∥
                                                                                           (#vr.72 < #t2.13) )
                                                                                      case case_1
                                                                                      solve( (#vr.28 < #t2.14)  ∥
                                                                                             (#vr.28 =
                                                                                              #t2.14) )
                                                                                        case case_1
                                                                                        solve( state_1111111111111111111111121111111( ~RouterID.1,
                                                                                                                                      ~ServerID.1,
                                                                                                                                      ~ak_h.1,
                                                                                                                                      ~ak_sk.1,
                                                                                                                                      ~ssk_nms.1,
                                                                                                                                      pL,
                                                                                                                                      pcrL,
                                                                                                                                      s_h,
                                                                                                                                      ~n.3
                                                                                               ) ▶₀ #t2.9 )
                                                                                          case insertpolicyDigestshpcrLTPMCCPolicyPCRpL_0_111111111111111111111112111111
                                                                                          by contradiction
                                                                                             /* cyclic */
                                                                                        qed
                                                                                      next
                                                                                        case case_2
                                                                                        solve( state_1111111111111111111111121111111( ~RouterID.1,
                                                                                                                                      ~ServerID.1,
                                                                                                                                      ~ak_h.1,
                                                                                                                                      ~ak_sk.1,
                                                                                                                                      ~ssk_nms.1,
                                                                                                                                      pL,
                                                                                                                                      pcrL,
                                                                                                                                      s_h,
                                                                                                                                      ~n.3
                                                                                               ) ▶₀ #t2.9 )
                                                                                          case insertpolicyDigestshpcrLTPMCCPolicyPCRpL_0_111111111111111111111112111111
                                                                                          by contradiction
                                                                                             /* cyclic */
                                                                                        qed
                                                                                      qed
                                                                                    next
                                                                                      case case_2
                                                                                      solve( (#vr.28 < #t2.13)  ∥
                                                                                             (#vr.28 =
                                                                                              #t2.13) )
                                                                                        case case_1
                                                                                        solve( state_1111111111111111111111121111111( ~RouterID.1,
                                                                                                                                      ~ServerID.1,
                                                                                                                                      ~ak_h.1,
                                                                                                                                      ~ak_sk.1,
                                                                                                                                      ~ssk_nms.1,
                                                                                                                                      pL,
                                                                                                                                      pcrL,
                                                                                                                                      s_h,
                                                                                                                                      ~n.3
                                                                                               ) ▶₀ #t2.9 )
                                                                                          case insertpolicyDigestshpcrLTPMCCPolicyPCRpL_0_111111111111111111111112111111
                                                                                          by contradiction
                                                                                             /* cyclic */
                                                                                        qed
                                                                                      next
                                                                                        case case_2
                                                                                        solve( state_1111111111111111111111121111111( ~RouterID.1,
                                                                                                                                      ~ServerID.1,
                                                                                                                                      ~ak_h.1,
                                                                                                                                      ~ak_sk.1,
                                                                                                                                      ~ssk_nms.1,
                                                                                                                                      pL,
                                                                                                                                      pcrL,
                                                                                                                                      s_h,
                                                                                                                                      ~n.3
                                                                                               ) ▶₀ #t2.9 )
                                                                                          case insertpolicyDigestshpcrLTPMCCPolicyPCRpL_0_111111111111111111111112111111
                                                                                          by contradiction
                                                                                             /* cyclic */
                                                                                        qed
                                                                                      qed
                                                                                    next
                                                                                      case case_3
                                                                                      solve( (#vr.28 < #t2.14)  ∥
                                                                                             (#vr.28 =
                                                                                              #t2.14) )
                                                                                        case case_1
                                                                                        solve( state_1111111111111111111111121111111( ~RouterID.1,
                                                                                                                                      ~ServerID.1,
                                                                                                                                      ~ak_h.1,
                                                                                                                                      ~ak_sk.1,
                                                                                                                                      ~ssk_nms.1,
                                                                                                                                      pL,
                                                                                                                                      pcrL,
                                                                                                                                      s_h,
                                                                                                                                      ~n.3
                                                                                               ) ▶₀ #t2.9 )
                                                                                          case insertpolicyDigestshpcrLTPMCCPolicyPCRpL_0_111111111111111111111112111111
                                                                                          by contradiction
                                                                                             /* cyclic */
                                                                                        qed
                                                                                      next
                                                                                        case case_2
                                                                                        solve( state_1111111111111111111111121111111( ~RouterID.1,
                                                                                                                                      ~ServerID.1,
                                                                                                                                      ~ak_h.1,
                                                                                                                                      ~ak_sk.1,
                                                                                                                                      ~ssk_nms.1,
                                                                                                                                      pL,
                                                                                                                                      pcrL,
                                                                                                                                      s_h,
                                                                                                                                      ~n.3
                                                                                               ) ▶₀ #t2.9 )
                                                                                          case insertpolicyDigestshpcrLTPMCCPolicyPCRpL_0_111111111111111111111112111111
                                                                                          by contradiction
                                                                                             /* cyclic */
                                                                                        qed
                                                                                      qed
                                                                                    qed
                                                                                  next
                                                                                    case case_2
                                                                                    solve( ((#vr.17 < #vr.82) ∧
                                                                                            (∃ #t2.
                                                                                              (Unlock_5( '5',
                                                                                                         ~n.1,
                                                                                                         'device'
                                                                                               ) @ #t2)
                                                                                             ∧
                                                                                              (#vr.17 < #t2) ∧
                                                                                              (#t2 < #vr.82) ∧
                                                                                              (∀ #t0 pp.
                                                                                                (Unlock( pp,
                                                                                                         ~n.1,
                                                                                                         'device'
                                                                                                 ) @ #t0)
                                                                                               ⇒
                                                                                                #t0 = #t2) ∧
                                                                                              (∀ pp lpp #t0.
                                                                                                (Lock( pp,
                                                                                                       lpp,
                                                                                                       'device'
                                                                                                 ) @ #t0)
                                                                                               ⇒
                                                                                                ((#t0 < #vr.17) ∨
                                                                                                 (#t0 =
                                                                                                  #vr.17) ∨
                                                                                                 (#t2 < #t0))) ∧
                                                                                              (∀ pp lpp #t0.
                                                                                                (Unlock( pp,
                                                                                                         lpp,
                                                                                                         'device'
                                                                                                 ) @ #t0)
                                                                                               ⇒
                                                                                                ((#t0 < #vr.17) ∨
                                                                                                 (#t2 < #t0) ∨
                                                                                                 (#t2 =
                                                                                                  #t0)))))  ∥
                                                                                           (#vr.82 < #vr.17) )
                                                                                      case case_1
                                                                                      solve( (#t2.12 < #t2.10)  ∥
                                                                                             (#t2.12 =
                                                                                              #t2.10)  ∥
                                                                                             (#vr.72 < #t2.12) )
                                                                                        case case_1
                                                                                        by contradiction
                                                                                           /* from formulas */
                                                                                      next
                                                                                        case case_2
                                                                                        solve( (#vr.28 < #t2.12)  ∥
                                                                                               (#vr.28 =
                                                                                                #t2.12) )
                                                                                          case case_1
                                                                                          solve( TPM_SendCommand( <
                                                                                                                   'TPM2_PolicyPCR', 
                                                                                                                   k_sh
                                                                                                                  >
                                                                                                 ) @ #t2.11 )
                                                                                            case eventTPMSendCommandTPMPolicyPCRtlssh_0_1111111111111211111111111
                                                                                            solve( state_1111111111111211111111111( ~RouterID.1,
                                                                                                                                    ~ServerID.1,
                                                                                                                                    ~ak_h.1,
                                                                                                                                    ~ak_sk.1,
                                                                                                                                    ~ssk_nms.1,
                                                                                                                                    ~tid.1,
                                                                                                                                    tls_h,
                                                                                                                                    k_sh,
                                                                                                                                    tls_spk
                                                                                                   ) ▶₀ #t2.9 )
                                                                                              case eventGenerateTLStidtlsspk_0_111111111111121111111111
                                                                                              solve( Unlock_5( '5',
                                                                                                               ~n.1,
                                                                                                               'device'
                                                                                                     ) @ #t2.13 )
                                                                                                case unlockdevice_0_1111111111111111111211111111
                                                                                                solve( state_1111111111111111111211111111( ~RouterID.1,
                                                                                                                                           ~ServerID.1,
                                                                                                                                           ~ak_h.1,
                                                                                                                                           ~ak_sk.1,
                                                                                                                                           ~ssk_nms.1,
                                                                                                                                           k_ap,
                                                                                                                                           k_h.1,
                                                                                                                                           k_pd,
                                                                                                                                           k_sh.1,
                                                                                                                                           k_sk.1,
                                                                                                                                           m,
                                                                                                                                           ~n.1
                                                                                                       ) ▶₀ #t2.10 )
                                                                                                  case TpmSignOutsignmksk_0_111111111111111111121111111
                                                                                                  by contradiction
                                                                                                     /* cyclic
                                                                                                     */
                                                                                                qed
                                                                                              next
                                                                                                case unlockdevice_0_111111111111111111121111112
                                                                                                by solve( state_111111111111111111121111112( ~RouterID.1,
                                                                                                                                             ~ServerID.1,
                                                                                                                                             ~ak_h.1,
                                                                                                                                             ~ak_sk.1,
                                                                                                                                             ~ssk_nms.1,
                                                                                                                                             k_ap,
                                                                                                                                             k_h.1,
                                                                                                                                             k_pd,
                                                                                                                                             k_sh.1,
                                                                                                                                             m,
                                                                                                                                             ~n.1
                                                                                                          ) ▶₀ #t2.10 )
                                                                                              qed
                                                                                            qed
                                                                                          qed
                                                                                        next
                                                                                          case case_2
                                                                                          solve( TPM_SendCommand( <
                                                                                                                   'TPM2_PolicyPCR', 
                                                                                                                   k_sh
                                                                                                                  >
                                                                                                 ) @ #t2.12 )
                                                                                            case eventTPMSendCommandTPMPolicyPCRtlssh_0_1111111111111211111111111
                                                                                            solve( state_1111111111111211111111111( ~RouterID.1,
                                                                                                                                    ~ServerID.1,
                                                                                                                                    ~ak_h.1,
                                                                                                                                    ~ak_sk.1,
                                                                                                                                    ~ssk_nms.1,
                                                                                                                                    ~tid.1,
                                                                                                                                    tls_h,
                                                                                                                                    k_sh,
                                                                                                                                    tls_spk
                                                                                                   ) ▶₀ #t2.10 )
                                                                                              case eventGenerateTLStidtlsspk_0_111111111111121111111111
                                                                                              solve( Unlock_5( '5',
                                                                                                               ~n.1,
                                                                                                               'device'
                                                                                                     ) @ #t2.13 )
                                                                                                case unlockdevice_0_1111111111111111111211111111
                                                                                                solve( state_1111111111111111111211111111( ~RouterID.1,
                                                                                                                                           ~ServerID.1,
                                                                                                                                           ~ak_h.1,
                                                                                                                                           ~ak_sk.1,
                                                                                                                                           ~ssk_nms.1,
                                                                                                                                           k_ap,
                                                                                                                                           k_h.1,
                                                                                                                                           k_pd,
                                                                                                                                           k_sh.1,
                                                                                                                                           k_sk.1,
                                                                                                                                           m,
                                                                                                                                           ~n.1
                                                                                                       ) ▶₀ #t2.11 )
                                                                                                  case TpmSignOutsignmksk_0_111111111111111111121111111
                                                                                                  by contradiction
                                                                                                     /* cyclic
                                                                                                     */
                                                                                                qed
                                                                                              next
                                                                                                case unlockdevice_0_111111111111111111121111112
                                                                                                by solve( state_111111111111111111121111112( ~RouterID.1,
                                                                                                                                             ~ServerID.1,
                                                                                                                                             ~ak_h.1,
                                                                                                                                             ~ak_sk.1,
                                                                                                                                             ~ssk_nms.1,
                                                                                                                                             k_ap,
                                                                                                                                             k_h.1,
                                                                                                                                             k_pd,
                                                                                                                                             k_sh.1,
                                                                                                                                             m,
                                                                                                                                             ~n.1
                                                                                                          ) ▶₀ #t2.11 )
                                                                                              qed
                                                                                            qed
                                                                                          qed
                                                                                        qed
                                                                                      next
                                                                                        case case_3
                                                                                        solve( (#vr.28 < #t2.13)  ∥
                                                                                               (#vr.28 =
                                                                                                #t2.13) )
                                                                                          case case_1
                                                                                          solve( TPM_SendCommand( <
                                                                                                                   'TPM2_PolicyPCR', 
                                                                                                                   k_sh
                                                                                                                  >
                                                                                                 ) @ #t2.11 )
                                                                                            case eventTPMSendCommandTPMPolicyPCRtlssh_0_1111111111111211111111111
                                                                                            solve( state_1111111111111211111111111( ~RouterID.1,
                                                                                                                                    ~ServerID.1,
                                                                                                                                    ~ak_h.1,
                                                                                                                                    ~ak_sk.1,
                                                                                                                                    ~ssk_nms.1,
                                                                                                                                    ~tid.1,
                                                                                                                                    tls_h,
                                                                                                                                    k_sh,
                                                                                                                                    tls_spk
                                                                                                   ) ▶₀ #t2.9 )
                                                                                              case eventGenerateTLStidtlsspk_0_111111111111121111111111
                                                                                              solve( Unlock_5( '5',
                                                                                                               ~n.1,
                                                                                                               'device'
                                                                                                     ) @ #t2.14 )
                                                                                                case unlockdevice_0_1111111111111111111211111111
                                                                                                solve( state_1111111111111111111211111111( ~RouterID.1,
                                                                                                                                           ~ServerID.1,
                                                                                                                                           ~ak_h.1,
                                                                                                                                           ~ak_sk.1,
                                                                                                                                           ~ssk_nms.1,
                                                                                                                                           k_ap,
                                                                                                                                           k_h.1,
                                                                                                                                           k_pd,
                                                                                                                                           k_sh.1,
                                                                                                                                           k_sk.1,
                                                                                                                                           m,
                                                                                                                                           ~n.1
                                                                                                       ) ▶₀ #t2.10 )
                                                                                                  case TpmSignOutsignmksk_0_111111111111111111121111111
                                                                                                  by contradiction
                                                                                                     /* cyclic
                                                                                                     */
                                                                                                qed
                                                                                              next
                                                                                                case unlockdevice_0_111111111111111111121111112
                                                                                                by solve( state_111111111111111111121111112( ~RouterID.1,
                                                                                                                                             ~ServerID.1,
                                                                                                                                             ~ak_h.1,
                                                                                                                                             ~ak_sk.1,
                                                                                                                                             ~ssk_nms.1,
                                                                                                                                             k_ap,
                                                                                                                                             k_h.1,
                                                                                                                                             k_pd,
                                                                                                                                             k_sh.1,
                                                                                                                                             m,
                                                                                                                                             ~n.1
                                                                                                          ) ▶₀ #t2.10 )
                                                                                              qed
                                                                                            qed
                                                                                          qed
                                                                                        next
                                                                                          case case_2
                                                                                          solve( TPM_SendCommand( <
                                                                                                                   'TPM2_PolicyPCR', 
                                                                                                                   k_sh
                                                                                                                  >
                                                                                                 ) @ #t2.12 )
                                                                                            case eventTPMSendCommandTPMPolicyPCRtlssh_0_1111111111111211111111111
                                                                                            solve( state_1111111111111211111111111( ~RouterID.1,
                                                                                                                                    ~ServerID.1,
                                                                                                                                    ~ak_h.1,
                                                                                                                                    ~ak_sk.1,
                                                                                                                                    ~ssk_nms.1,
                                                                                                                                    ~tid.1,
                                                                                                                                    tls_h,
                                                                                                                                    k_sh,
                                                                                                                                    tls_spk
                                                                                                   ) ▶₀ #t2.10 )
                                                                                              case eventGenerateTLStidtlsspk_0_111111111111121111111111
                                                                                              solve( Unlock_5( '5',
                                                                                                               ~n.1,
                                                                                                               'device'
                                                                                                     ) @ #t2.14 )
                                                                                                case unlockdevice_0_1111111111111111111211111111
                                                                                                solve( state_1111111111111111111211111111( ~RouterID.1,
                                                                                                                                           ~ServerID.1,
                                                                                                                                           ~ak_h.1,
                                                                                                                                           ~ak_sk.1,
                                                                                                                                           ~ssk_nms.1,
                                                                                                                                           k_ap,
                                                                                                                                           k_h.1,
                                                                                                                                           k_pd,
                                                                                                                                           k_sh.1,
                                                                                                                                           k_sk.1,
                                                                                                                                           m,
                                                                                                                                           ~n.1
                                                                                                       ) ▶₀ #t2.11 )
                                                                                                  case TpmSignOutsignmksk_0_111111111111111111121111111
                                                                                                  by contradiction
                                                                                                     /* cyclic
                                                                                                     */
                                                                                                qed
                                                                                              next
                                                                                                case unlockdevice_0_111111111111111111121111112
                                                                                                by solve( state_111111111111111111121111112( ~RouterID.1,
                                                                                                                                             ~ServerID.1,
                                                                                                                                             ~ak_h.1,
                                                                                                                                             ~ak_sk.1,
                                                                                                                                             ~ssk_nms.1,
                                                                                                                                             k_ap,
                                                                                                                                             k_h.1,
                                                                                                                                             k_pd,
                                                                                                                                             k_sh.1,
                                                                                                                                             m,
                                                                                                                                             ~n.1
                                                                                                          ) ▶₀ #t2.11 )
                                                                                              qed
                                                                                            qed
                                                                                          qed
                                                                                        qed
                                                                                      qed
                                                                                    next
                                                                                      case case_2
                                                                                      solve( (#t2.13 < #t2.11)  ∥
                                                                                             (#t2.13 =
                                                                                              #t2.11)  ∥
                                                                                             (#vr.72 < #t2.13) )
                                                                                        case case_1
                                                                                        by contradiction
                                                                                           /* from formulas */
                                                                                      next
                                                                                        case case_2
                                                                                        solve( (#vr.28 < #t2.13)  ∥
                                                                                               (#vr.28 =
                                                                                                #t2.13) )
                                                                                          case case_1
                                                                                          solve( state_1111111111111111111111121111111( ~RouterID.1,
                                                                                                                                        ~ServerID.1,
                                                                                                                                        ~ak_h.1,
                                                                                                                                        ~ak_sk.1,
                                                                                                                                        ~ssk_nms.1,
                                                                                                                                        pL,
                                                                                                                                        pcrL,
                                                                                                                                        s_h,
                                                                                                                                        ~n.3
                                                                                                 ) ▶₀ #t2.9 )
                                                                                            case insertpolicyDigestshpcrLTPMCCPolicyPCRpL_0_111111111111111111111112111111
                                                                                            solve( (#vr.28 < #t2.16)  ∥
                                                                                                   (#vr.28 =
                                                                                                    #t2.16) )
                                                                                              case case_1
                                                                                              solve( (#t2.15 < #t2.11)  ∥
                                                                                                     (#t2.15 =
                                                                                                      #t2.11)  ∥
                                                                                                     (#vr.72 < #t2.15) )
                                                                                                case case_1
                                                                                                by contradiction
                                                                                                   /*
                                                                                                   from formulas
                                                                                                   */
                                                                                              next
                                                                                                case case_2
                                                                                                solve( (#t2.13 < #t2.15)  ∥
                                                                                                       (#t2.13 =
                                                                                                        #t2.15) )
                                                                                                  case case_1
                                                                                                  by contradiction
                                                                                                     /*
                                                                                                     from formulas
                                                                                                     */
                                                                                                next
                                                                                                  case case_2
                                                                                                  solve( TPM_SendCommand( <
                                                                                                                           'TPM2_PolicyPCR', 
                                                                                                                           k_sh
                                                                                                                          >
                                                                                                         ) @ #t2.12 )
                                                                                                    case eventTPMSendCommandTPMPolicyPCRtlssh_0_1111111111111211111111111
                                                                                                    solve( state_1111111111111211111111111( ~RouterID.1,
                                                                                                                                            ~ServerID.1,
                                                                                                                                            ~ak_h.1,
                                                                                                                                            ~ak_sk.1,
                                                                                                                                            ~ssk_nms.1,
                                                                                                                                            ~tid.1,
                                                                                                                                            tls_h,
                                                                                                                                            k_sh,
                                                                                                                                            tls_spk
                                                                                                           ) ▶₀ #t2.10 )
                                                                                                      case eventGenerateTLStidtlsspk_0_111111111111121111111111
                                                                                                      solve( TPM_SendCommand( <
                                                                                                                               'TPM2_PolicyPCR', 
                                                                                                                               k_sh
                                                                                                                              >
                                                                                                             ) @ #t2.14 )
                                                                                                        case eventTPMSendCommandTPMPolicyPCRtlssh_0_1111111111111211111111111
                                                                                                        solve( state_1111111111111211111111111( ~RouterID.1,
                                                                                                                                                ~ServerID.1,
                                                                                                                                                ~ak_h.1,
                                                                                                                                                ~ak_sk.1,
                                                                                                                                                ~ssk_nms.1,
                                                                                                                                                ~tid.1,
                                                                                                                                                tls_h,
                                                                                                                                                k_sh,
                                                                                                                                                tls_spk
                                                                                                               ) ▶₀ #t2.11 )
                                                                                                          case eventGenerateTLStidtlsspk_0_111111111111121111111111
                                                                                                          solve( TPM_SendCommand( <
                                                                                                                                   'TPM2_Create', 
                                                                                                                                   <
                                                                                                                                    swstate, 
                                                                                                                                    nil
                                                                                                                                   >, 
                                                                                                                                   'TPM_CC_PolicyPCR', 
                                                                                                                                   nil
                                                                                                                                  >
                                                                                                                 ) @ #t2.14 )
                                                                                                            case eventTPMSendCommandTPMCreateswstatenilTPMCCPolicyPCRnil_0_11111111111112111
                                                                                                            solve( state_11111111111112111( ~RouterID.1,
                                                                                                                                            ~ServerID.1,
                                                                                                                                            ~ak_h.1,
                                                                                                                                            ~ak_sk.1,
                                                                                                                                            ~ssk_nms.1,
                                                                                                                                            ~tid.1
                                                                                                                   ) ▶₀ #t2.11 )
                                                                                                              case outTPMPCRExtendswstate_0_1111111111111211
                                                                                                              solve( TPM_SendCommand( <
                                                                                                                                       'TPM2_Create', 
                                                                                                                                       <
                                                                                                                                        swstate, 
                                                                                                                                        nil
                                                                                                                                       >, 
                                                                                                                                       'TPM_CC_PolicyPCR', 
                                                                                                                                       nil
                                                                                                                                      >
                                                                                                                     ) @ #t2.14 )
                                                                                                                case eventTPMSendCommandTPMCreateswstatenilTPMCCPolicyPCRnil_0_11111111111112111
                                                                                                                solve( state_11111111111112111( ~RouterID.1,
                                                                                                                                                ~ServerID.1,
                                                                                                                                                ~ak_h.1,
                                                                                                                                                ~ak_sk.1,
                                                                                                                                                ~ssk_nms.1,
                                                                                                                                                ~tid.1
                                                                                                                       ) ▶₀ #t2.11 )
                                                                                                                  case outTPMPCRExtendswstate_0_1111111111111211
                                                                                                                  by solve( !KU( ~ssk_nms
                                                                                                                            ) @ #vk.23 )
                                                                                                                qed
                                                                                                              qed
                                                                                                            qed
                                                                                                          qed
                                                                                                        qed
                                                                                                      qed
                                                                                                    qed
                                                                                                  qed
                                                                                                qed
                                                                                              next
                                                                                                case case_3
                                                                                                by contradiction
                                                                                                   /*
                                                                                                   from formulas
                                                                                                   */
                                                                                              qed
                                                                                            next
                                                                                              case case_2
                                                                                              by contradiction
                                                                                                 /*
                                                                                                 from formulas
                                                                                                 */
                                                                                            qed
                                                                                          qed
                                                                                        next
                                                                                          case case_2
                                                                                          solve( state_1111111111111111111111121111111( ~RouterID.1,
                                                                                                                                        ~ServerID.1,
                                                                                                                                        ~ak_h.1,
                                                                                                                                        ~ak_sk.1,
                                                                                                                                        ~ssk_nms.1,
                                                                                                                                        pL,
                                                                                                                                        pcrL,
                                                                                                                                        s_h,
                                                                                                                                        ~n.3
                                                                                                 ) ▶₀ #t2.9 )
                                                                                            case insertpolicyDigestshpcrLTPMCCPolicyPCRpL_0_111111111111111111111112111111
                                                                                            solve( (#t2.10 < #t2.16)  ∥
                                                                                                   (#t2.10 =
                                                                                                    #t2.16) )
                                                                                              case case_1
                                                                                              by contradiction
                                                                                                 /*
                                                                                                 from formulas
                                                                                                 */
                                                                                            next
                                                                                              case case_2
                                                                                              solve( (#t2.15 < #t2.12)  ∥
                                                                                                     (#t2.15 =
                                                                                                      #t2.12)  ∥
                                                                                                     (#vr.71 < #t2.15) )
                                                                                                case case_1
                                                                                                by contradiction
                                                                                                   /*
                                                                                                   from formulas
                                                                                                   */
                                                                                              next
                                                                                                case case_2
                                                                                                solve( TPM_SendCommand( <
                                                                                                                         'TPM2_PolicyPCR', 
                                                                                                                         k_sh
                                                                                                                        >
                                                                                                       ) @ #t2.13 )
                                                                                                  case eventTPMSendCommandTPMPolicyPCRtlssh_0_1111111111111211111111111
                                                                                                  solve( state_1111111111111211111111111( ~RouterID.1,
                                                                                                                                          ~ServerID.1,
                                                                                                                                          ~ak_h.1,
                                                                                                                                          ~ak_sk.1,
                                                                                                                                          ~ssk_nms.1,
                                                                                                                                          ~tid.1,
                                                                                                                                          tls_h,
                                                                                                                                          k_sh,
                                                                                                                                          tls_spk
                                                                                                         ) ▶₀ #t2.11 )
                                                                                                    case eventGenerateTLStidtlsspk_0_111111111111121111111111
                                                                                                    solve( TPM_SendCommand( <
                                                                                                                             'TPM2_PolicyPCR', 
                                                                                                                             k_sh
                                                                                                                            >
                                                                                                           ) @ #t2.14 )
                                                                                                      case eventTPMSendCommandTPMPolicyPCRtlssh_0_1111111111111211111111111
                                                                                                      solve( state_1111111111111211111111111( ~RouterID.1,
                                                                                                                                              ~ServerID.1,
                                                                                                                                              ~ak_h.1,
                                                                                                                                              ~ak_sk.1,
                                                                                                                                              ~ssk_nms.1,
                                                                                                                                              ~tid.1,
                                                                                                                                              tls_h,
                                                                                                                                              k_sh,
                                                                                                                                              tls_spk
                                                                                                             ) ▶₀ #t2.12 )
                                                                                                        case eventGenerateTLStidtlsspk_0_111111111111121111111111
                                                                                                        solve( TPM_SendCommand( <
                                                                                                                                 'TPM2_Create', 
                                                                                                                                 <
                                                                                                                                  swstate, 
                                                                                                                                  nil
                                                                                                                                 >, 
                                                                                                                                 'TPM_CC_PolicyPCR', 
                                                                                                                                 nil
                                                                                                                                >
                                                                                                               ) @ #t2.14 )
                                                                                                          case eventTPMSendCommandTPMCreateswstatenilTPMCCPolicyPCRnil_0_11111111111112111
                                                                                                          solve( state_11111111111112111( ~RouterID.1,
                                                                                                                                          ~ServerID.1,
                                                                                                                                          ~ak_h.1,
                                                                                                                                          ~ak_sk.1,
                                                                                                                                          ~ssk_nms.1,
                                                                                                                                          ~tid.1
                                                                                                                 ) ▶₀ #t2.12 )
                                                                                                            case outTPMPCRExtendswstate_0_1111111111111211
                                                                                                            solve( TPM_SendCommand( <
                                                                                                                                     'TPM2_Create', 
                                                                                                                                     <
                                                                                                                                      swstate, 
                                                                                                                                      nil
                                                                                                                                     >, 
                                                                                                                                     'TPM_CC_PolicyPCR', 
                                                                                                                                     nil
                                                                                                                                    >
                                                                                                                   ) @ #t2.14 )
                                                                                                              case eventTPMSendCommandTPMCreateswstatenilTPMCCPolicyPCRnil_0_11111111111112111
                                                                                                              solve( state_11111111111112111( ~RouterID.1,
                                                                                                                                              ~ServerID.1,
                                                                                                                                              ~ak_h.1,
                                                                                                                                              ~ak_sk.1,
                                                                                                                                              ~ssk_nms.1,
                                                                                                                                              ~tid.1
                                                                                                                     ) ▶₀ #t2.12 )
                                                                                                                case outTPMPCRExtendswstate_0_1111111111111211
                                                                                                                by solve( !KU( ~ssk_nms
                                                                                                                          ) @ #vk.23 )
                                                                                                              qed
                                                                                                            qed
                                                                                                          qed
                                                                                                        qed
                                                                                                      qed
                                                                                                    qed
                                                                                                  qed
                                                                                                qed
                                                                                              next
                                                                                                case case_3
                                                                                                by contradiction
                                                                                                   /*
                                                                                                   from formulas
                                                                                                   */
                                                                                              qed
                                                                                            qed
                                                                                          qed
                                                                                        qed
                                                                                      next
                                                                                        case case_3
                                                                                        solve( (#vr.28 < #t2.14)  ∥
                                                                                               (#vr.28 =
                                                                                                #t2.14) )
                                                                                          case case_1
                                                                                          solve( state_1111111111111111111111121111111( ~RouterID.1,
                                                                                                                                        ~ServerID.1,
                                                                                                                                        ~ak_h.1,
                                                                                                                                        ~ak_sk.1,
                                                                                                                                        ~ssk_nms.1,
                                                                                                                                        pL,
                                                                                                                                        pcrL,
                                                                                                                                        s_h,
                                                                                                                                        ~n.3
                                                                                                 ) ▶₀ #t2.9 )
                                                                                            case insertpolicyDigestshpcrLTPMCCPolicyPCRpL_0_111111111111111111111112111111
                                                                                            solve( (#vr.28 < #t2.17)  ∥
                                                                                                   (#vr.28 =
                                                                                                    #t2.17) )
                                                                                              case case_1
                                                                                              solve( (#t2.16 < #t2.11)  ∥
                                                                                                     (#t2.16 =
                                                                                                      #t2.11)  ∥
                                                                                                     (#vr.72 < #t2.16) )
                                                                                                case case_1
                                                                                                by contradiction
                                                                                                   /*
                                                                                                   from formulas
                                                                                                   */
                                                                                              next
                                                                                                case case_2
                                                                                                by contradiction
                                                                                                   /*
                                                                                                   from formulas
                                                                                                   */
                                                                                              next
                                                                                                case case_3
                                                                                                solve( (#t2.14 < #t2.17)  ∥
                                                                                                       (#t2.14 =
                                                                                                        #t2.17) )
                                                                                                  case case_1
                                                                                                  by contradiction
                                                                                                     /*
                                                                                                     from formulas
                                                                                                     */
                                                                                                next
                                                                                                  case case_2
                                                                                                  solve( (#t2.13 < #t2.16)  ∥
                                                                                                         (#t2.13 =
                                                                                                          #t2.16) )
                                                                                                    case case_1
                                                                                                    by contradiction
                                                                                                       /*
                                                                                                       from formulas
                                                                                                       */
                                                                                                  next
                                                                                                    case case_2
                                                                                                    solve( TPM_SendCommand( <
                                                                                                                             'TPM2_PolicyPCR', 
                                                                                                                             k_sh
                                                                                                                            >
                                                                                                           ) @ #t2.12 )
                                                                                                      case eventTPMSendCommandTPMPolicyPCRtlssh_0_1111111111111211111111111
                                                                                                      solve( state_1111111111111211111111111( ~RouterID.1,
                                                                                                                                              ~ServerID.1,
                                                                                                                                              ~ak_h.1,
                                                                                                                                              ~ak_sk.1,
                                                                                                                                              ~ssk_nms.1,
                                                                                                                                              ~tid.1,
                                                                                                                                              tls_h,
                                                                                                                                              k_sh,
                                                                                                                                              tls_spk
                                                                                                             ) ▶₀ #t2.10 )
                                                                                                        case eventGenerateTLStidtlsspk_0_111111111111121111111111
                                                                                                        solve( TPM_SendCommand( <
                                                                                                                                 'TPM2_PolicyPCR', 
                                                                                                                                 k_sh
                                                                                                                                >
                                                                                                               ) @ #t2.15 )
                                                                                                          case eventTPMSendCommandTPMPolicyPCRtlssh_0_1111111111111211111111111
                                                                                                          solve( state_1111111111111211111111111( ~RouterID.1,
                                                                                                                                                  ~ServerID.1,
                                                                                                                                                  ~ak_h.1,
                                                                                                                                                  ~ak_sk.1,
                                                                                                                                                  ~ssk_nms.1,
                                                                                                                                                  ~tid.1,
                                                                                                                                                  tls_h,
                                                                                                                                                  k_sh,
                                                                                                                                                  tls_spk
                                                                                                                 ) ▶₀ #t2.11 )
                                                                                                            case eventGenerateTLStidtlsspk_0_111111111111121111111111
                                                                                                            solve( TPM_SendCommand( <
                                                                                                                                     'TPM2_Create', 
                                                                                                                                     <
                                                                                                                                      swstate, 
                                                                                                                                      nil
                                                                                                                                     >, 
                                                                                                                                     'TPM_CC_PolicyPCR', 
                                                                                                                                     nil
                                                                                                                                    >
                                                                                                                   ) @ #t2.15 )
                                                                                                              case eventTPMSendCommandTPMCreateswstatenilTPMCCPolicyPCRnil_0_11111111111112111
                                                                                                              solve( state_11111111111112111( ~RouterID.1,
                                                                                                                                              ~ServerID.1,
                                                                                                                                              ~ak_h.1,
                                                                                                                                              ~ak_sk.1,
                                                                                                                                              ~ssk_nms.1,
                                                                                                                                              ~tid.1
                                                                                                                     ) ▶₀ #t2.11 )
                                                                                                                case outTPMPCRExtendswstate_0_1111111111111211
                                                                                                                solve( TPM_SendCommand( <
                                                                                                                                         'TPM2_Create', 
                                                                                                                                         <
                                                                                                                                          swstate, 
                                                                                                                                          nil
                                                                                                                                         >, 
                                                                                                                                         'TPM_CC_PolicyPCR', 
                                                                                                                                         nil
                                                                                                                                        >
                                                                                                                       ) @ #t2.15 )
                                                                                                                  case eventTPMSendCommandTPMCreateswstatenilTPMCCPolicyPCRnil_0_11111111111112111
                                                                                                                  solve( state_11111111111112111( ~RouterID.1,
                                                                                                                                                  ~ServerID.1,
                                                                                                                                                  ~ak_h.1,
                                                                                                                                                  ~ak_sk.1,
                                                                                                                                                  ~ssk_nms.1,
                                                                                                                                                  ~tid.1
                                                                                                                         ) ▶₀ #t2.11 )
                                                                                                                    case outTPMPCRExtendswstate_0_1111111111111211
                                                                                                                    by solve( !KU( ~ssk_nms
                                                                                                                              ) @ #vk.23 )
                                                                                                                  qed
                                                                                                                qed
                                                                                                              qed
                                                                                                            qed
                                                                                                          qed
                                                                                                        qed
                                                                                                      qed
                                                                                                    qed
                                                                                                  qed
                                                                                                qed
                                                                                              qed
                                                                                            next
                                                                                              case case_2
                                                                                              by contradiction
                                                                                                 /*
                                                                                                 from formulas
                                                                                                 */
                                                                                            qed
                                                                                          qed
                                                                                        next
                                                                                          case case_2
                                                                                          solve( state_1111111111111111111111121111111( ~RouterID.1,
                                                                                                                                        ~ServerID.1,
                                                                                                                                        ~ak_h.1,
                                                                                                                                        ~ak_sk.1,
                                                                                                                                        ~ssk_nms.1,
                                                                                                                                        pL,
                                                                                                                                        pcrL,
                                                                                                                                        s_h,
                                                                                                                                        ~n.3
                                                                                                 ) ▶₀ #t2.9 )
                                                                                            case insertpolicyDigestshpcrLTPMCCPolicyPCRpL_0_111111111111111111111112111111
                                                                                            solve( (#t2.10 < #t2.17)  ∥
                                                                                                   (#t2.10 =
                                                                                                    #t2.17) )
                                                                                              case case_1
                                                                                              by contradiction
                                                                                                 /*
                                                                                                 from formulas
                                                                                                 */
                                                                                            next
                                                                                              case case_2
                                                                                              solve( (#t2.16 < #t2.12)  ∥
                                                                                                     (#t2.16 =
                                                                                                      #t2.12)  ∥
                                                                                                     (#vr.71 < #t2.16) )
                                                                                                case case_1
                                                                                                by contradiction
                                                                                                   /*
                                                                                                   from formulas
                                                                                                   */
                                                                                              next
                                                                                                case case_2
                                                                                                by contradiction
                                                                                                   /*
                                                                                                   from formulas
                                                                                                   */
                                                                                              next
                                                                                                case case_3
                                                                                                solve( (#t2.14 < #t2.16)  ∥
                                                                                                       (#t2.14 =
                                                                                                        #t2.16) )
                                                                                                  case case_1
                                                                                                  by contradiction
                                                                                                     /*
                                                                                                     from formulas
                                                                                                     */
                                                                                                next
                                                                                                  case case_2
                                                                                                  solve( TPM_SendCommand( <
                                                                                                                           'TPM2_PolicyPCR', 
                                                                                                                           k_sh
                                                                                                                          >
                                                                                                         ) @ #t2.13 )
                                                                                                    case eventTPMSendCommandTPMPolicyPCRtlssh_0_1111111111111211111111111
                                                                                                    solve( state_1111111111111211111111111( ~RouterID.1,
                                                                                                                                            ~ServerID.1,
                                                                                                                                            ~ak_h.1,
                                                                                                                                            ~ak_sk.1,
                                                                                                                                            ~ssk_nms.1,
                                                                                                                                            ~tid.1,
                                                                                                                                            tls_h,
                                                                                                                                            k_sh,
                                                                                                                                            tls_spk
                                                                                                           ) ▶₀ #t2.11 )
                                                                                                      case eventGenerateTLStidtlsspk_0_111111111111121111111111
                                                                                                      solve( TPM_SendCommand( <
                                                                                                                               'TPM2_PolicyPCR', 
                                                                                                                               k_sh
                                                                                                                              >
                                                                                                             ) @ #t2.15 )
                                                                                                        case eventTPMSendCommandTPMPolicyPCRtlssh_0_1111111111111211111111111
                                                                                                        solve( state_1111111111111211111111111( ~RouterID.1,
                                                                                                                                                ~ServerID.1,
                                                                                                                                                ~ak_h.1,
                                                                                                                                                ~ak_sk.1,
                                                                                                                                                ~ssk_nms.1,
                                                                                                                                                ~tid.1,
                                                                                                                                                tls_h,
                                                                                                                                                k_sh,
                                                                                                                                                tls_spk
                                                                                                               ) ▶₀ #t2.12 )
                                                                                                          case eventGenerateTLStidtlsspk_0_111111111111121111111111
                                                                                                          solve( TPM_SendCommand( <
                                                                                                                                   'TPM2_Create', 
                                                                                                                                   <
                                                                                                                                    swstate, 
                                                                                                                                    nil
                                                                                                                                   >, 
                                                                                                                                   'TPM_CC_PolicyPCR', 
                                                                                                                                   nil
                                                                                                                                  >
                                                                                                                 ) @ #t2.15 )
                                                                                                            case eventTPMSendCommandTPMCreateswstatenilTPMCCPolicyPCRnil_0_11111111111112111
                                                                                                            solve( state_11111111111112111( ~RouterID.1,
                                                                                                                                            ~ServerID.1,
                                                                                                                                            ~ak_h.1,
                                                                                                                                            ~ak_sk.1,
                                                                                                                                            ~ssk_nms.1,
                                                                                                                                            ~tid.1
                                                                                                                   ) ▶₀ #t2.12 )
                                                                                                              case outTPMPCRExtendswstate_0_1111111111111211
                                                                                                              solve( TPM_SendCommand( <
                                                                                                                                       'TPM2_Create', 
                                                                                                                                       <
                                                                                                                                        swstate, 
                                                                                                                                        nil
                                                                                                                                       >, 
                                                                                                                                       'TPM_CC_PolicyPCR', 
                                                                                                                                       nil
                                                                                                                                      >
                                                                                                                     ) @ #t2.15 )
                                                                                                                case eventTPMSendCommandTPMCreateswstatenilTPMCCPolicyPCRnil_0_11111111111112111
                                                                                                                solve( state_11111111111112111( ~RouterID.1,
                                                                                                                                                ~ServerID.1,
                                                                                                                                                ~ak_h.1,
                                                                                                                                                ~ak_sk.1,
                                                                                                                                                ~ssk_nms.1,
                                                                                                                                                ~tid.1
                                                                                                                       ) ▶₀ #t2.12 )
                                                                                                                  case outTPMPCRExtendswstate_0_1111111111111211
                                                                                                                  by solve( !KU( ~ssk_nms
                                                                                                                            ) @ #vk.23 )
                                                                                                                qed
                                                                                                              qed
                                                                                                            qed
                                                                                                          qed
                                                                                                        qed
                                                                                                      qed
                                                                                                    qed
                                                                                                  qed
                                                                                                qed
                                                                                              qed
                                                                                            qed
                                                                                          qed
                                                                                        qed
                                                                                      qed
                                                                                    qed
                                                                                  qed
                                                                                qed
                                                                              qed
                                                                            qed
                                                                          qed
                                                                        qed
                                                                      qed
                                                                    qed
                                                                  qed
                                                                qed
                                                              qed
                                                            qed
                                                          qed
                                                        next
                                                          case case_2
                                                          by contradiction /* from formulas */
                                                        qed
                                                      qed
                                                    qed
                                                  qed
                                                qed
                                              next
                                                case unlockdevice_0_11111111111111111111211111112
                                                by solve( state_11111111111111111111211111112( ~RouterID.1,
                                                                                               ~ServerID.1,
                                                                                               ~ak_h.1,
                                                                                               ~ak_sk.1,
                                                                                               ~ssk_nms.1,
                                                                                               a_h, obj_ap,
                                                                                               obj_h, obj_pd,
                                                                                               obj_pk, obj_sh,
                                                                                               ~n.2
                                                          ) ▶₀ #t2.7 )
                                              qed
                                            qed
                                          qed
                                        qed
                                      next
                                        case case_2
                                        solve( (#t2.3 < #t2.10)  ∥ (#t2.3 = #t2.10) )
                                          case case_1
                                          by contradiction /* from formulas */
                                        next
                                          case case_2
                                          solve( (#vr.32 < #t2.9)  ∥ (#vr.32 = #t2.9) )
                                            case case_1
                                            solve( (#t2.7 < #t2.10)  ∥ (#t2.7 = #t2.10)  ∥ (#vr.72 < #t2.7) )
                                              case case_1
                                              by contradiction /* from formulas */
                                            next
                                              case case_2
                                              solve( Unlock_4( '4', ~n.2, 'device' ) @ #t2.8 )
                                                case unlockdevice_0_111111111111111111112111111111
                                                solve( state_111111111111111111112111111111( ~RouterID.1,
                                                                                             ~ServerID.1,
                                                                                             ~ak_h.1,
                                                                                             ~ak_sk.1,
                                                                                             ~ssk_nms.1, a_h,
                                                                                             a_sk, obj_ap,
                                                                                             obj_h, obj_pd,
                                                                                             obj_pk, obj_sh,
                                                                                             ~n.2
                                                       ) ▶₀ #t2.7 )
                                                  case outsignobjpkobjapask_0_11111111111111111111211111111
                                                  solve( (#t2.3 < #t2.14)  ∥ (#t2.3 = #t2.14) )
                                                    case case_1
                                                    by contradiction /* from formulas */
                                                  next
                                                    case case_2
                                                    solve( (#t2.6 < #t2.13)  ∥ (#t2.6 = #t2.13) )
                                                      case case_1
                                                      by contradiction /* from formulas */
                                                    next
                                                      case case_2
                                                      solve( (#t2.8 < #t2.13)  ∥ (#t2.8 = #t2.13) )
                                                        case case_1
                                                        by contradiction /* from formulas */
                                                      next
                                                        case case_2
                                                        solve( (#vr.32 < #t2.12)  ∥ (#vr.32 = #t2.12) )
                                                          case case_1
                                                          solve( (#t2.9 < #t2.12)  ∥ (#t2.9 = #t2.12) )
                                                            case case_1
                                                            by contradiction /* from formulas */
                                                          next
                                                            case case_2
                                                            solve( TPM_SendCommand( <'TPM2_Create', 
                                                                                     <swstate, nil>, 
                                                                                     'TPM_CC_PolicyPCR', nil>
                                                                   ) @ #t2.10 )
                                                              case eventTPMSendCommandTPMCreateswstatenilTPMCCPolicyPCRnil_0_11111111111112111
                                                              solve( state_11111111111112111( ~RouterID.1,
                                                                                              ~ServerID.1,
                                                                                              ~ak_h.1,
                                                                                              ~ak_sk.1,
                                                                                              ~ssk_nms.1,
                                                                                              ~tid.1
                                                                     ) ▶₀ #t2.8 )
                                                                case outTPMPCRExtendswstate_0_1111111111111211
                                                                solve( TPM_SendCommand( <'TPM2_Certify', 
                                                                                         k_sh, ~k_h, ~ak_h>
                                                                       ) @ #t2.10 )
                                                                  case eventTPMSendCommandTPMCertifytlsshtlshakh_0_111111111111121111111111111
                                                                  solve( state_111111111111121111111111111( ~RouterID.1,
                                                                                                            ~ServerID.1,
                                                                                                            ~ak_h,
                                                                                                            ~ak_sk.1,
                                                                                                            ~ssk_nms.1,
                                                                                                            ~tid.1,
                                                                                                            ~k_h,
                                                                                                            k_sh,
                                                                                                            tls_spk
                                                                         ) ▶₀ #t2.8 )
                                                                    case outTPMPolicyPCRtlssh_0_11111111111112111111111111
                                                                    solve( TPM_SendCommand( <'TPM2_Create', 
                                                                                             <swstate, nil>, 
                                                                                             'TPM_CC_PolicyPCR', 
                                                                                             nil>
                                                                           ) @ #t2.10 )
                                                                      case eventTPMSendCommandTPMCreateswstatenilTPMCCPolicyPCRnil_0_11111111111112111
                                                                      solve( state_11111111111112111( ~RouterID.1,
                                                                                                      ~ServerID.1,
                                                                                                      ~ak_h.1,
                                                                                                      ~ak_sk.1,
                                                                                                      ~ssk_nms.1,
                                                                                                      ~tid.1
                                                                             ) ▶₀ #t2.8 )
                                                                        case outTPMPCRExtendswstate_0_1111111111111211
                                                                        solve( Insert( <'privatePart', ~k_h>,
                                                                                       k_sk.1
                                                                               ) @ #t2.2 )
                                                                          case insertprivatePartkhksk_0_111111111111111111111121111111
                                                                          solve( Insert( <'authPolicy', ~k_h>,
                                                                                         k_ap
                                                                                 ) @ #t2.3 )
                                                                            case insertauthPolicykhauthPolicy_0_11111111111111111111112111111
                                                                            solve( Insert( <'policyDigest', 
                                                                                            k_sh>,
                                                                                           <<swstate, nil>, 
                                                                                            'TPM_CC_PolicyPCR', 
                                                                                            nil>
                                                                                   ) @ #t2.8 )
                                                                              case insertpolicyDigestshpcrLTPMCCPolicyPCRpL_0_111111111111111111111112111111
                                                                              solve( state_111111111111111111111112111111( ~RouterID.1,
                                                                                                                           ~ServerID.1,
                                                                                                                           ~ak_h.1,
                                                                                                                           ~ak_sk.1,
                                                                                                                           ~ssk_nms.1,
                                                                                                                           nil,
                                                                                                                           <
                                                                                                                            swstate, 
                                                                                                                            nil
                                                                                                                           >,
                                                                                                                           k_sh,
                                                                                                                           lock
                                                                                     ) ▶₀ #t2.8 )
                                                                                case eventPolicyPCRshpL_0_11111111111111111111111211111
                                                                                solve( (#vr.82 < #vr.46)  ∥
                                                                                       (#t2 < #vr.82) )
                                                                                  case case_1
                                                                                  solve( (#vr.28 < #t2.13)  ∥
                                                                                         (#vr.28 = #t2.13) )
                                                                                    case case_1
                                                                                    solve( state_1111111111111111111111121111111( ~RouterID.1,
                                                                                                                                  ~ServerID.1,
                                                                                                                                  ~ak_h.1,
                                                                                                                                  ~ak_sk.1,
                                                                                                                                  ~ssk_nms.1,
                                                                                                                                  pL,
                                                                                                                                  pcrL,
                                                                                                                                  s_h,
                                                                                                                                  ~n.3
                                                                                           ) ▶₀ #t2.9 )
                                                                                      case insertpolicyDigestshpcrLTPMCCPolicyPCRpL_0_111111111111111111111112111111
                                                                                      solve( (#vr.28 < #t2.16)  ∥
                                                                                             (#vr.28 =
                                                                                              #t2.16) )
                                                                                        case case_1
                                                                                        solve( (#t2.13 < #t2.16)  ∥
                                                                                               (#t2.13 =
                                                                                                #t2.16) )
                                                                                          case case_1
                                                                                          by contradiction
                                                                                             /* from formulas
                                                                                             */
                                                                                        next
                                                                                          case case_2
                                                                                          solve( (#t2.12 < #t2.15)  ∥
                                                                                                 (#t2.12 =
                                                                                                  #t2.15) )
                                                                                            case case_1
                                                                                            by contradiction
                                                                                               /*
                                                                                               from formulas
                                                                                               */
                                                                                          next
                                                                                            case case_2
                                                                                            solve( TPM_SendCommand( <
                                                                                                                     'TPM2_PolicyPCR', 
                                                                                                                     k_sh
                                                                                                                    >
                                                                                                   ) @ #t2.11 )
                                                                                              case eventTPMSendCommandTPMPolicyPCRtlssh_0_1111111111111211111111111
                                                                                              solve( state_1111111111111211111111111( ~RouterID.1,
                                                                                                                                      ~ServerID.1,
                                                                                                                                      ~ak_h.1,
                                                                                                                                      ~ak_sk.1,
                                                                                                                                      ~ssk_nms.1,
                                                                                                                                      ~tid.1,
                                                                                                                                      tls_h,
                                                                                                                                      k_sh,
                                                                                                                                      tls_spk
                                                                                                     ) ▶₀ #t2.10 )
                                                                                                case eventGenerateTLStidtlsspk_0_111111111111121111111111
                                                                                                by contradiction
                                                                                                   /* cyclic
                                                                                                   */
                                                                                              qed
                                                                                            qed
                                                                                          qed
                                                                                        qed
                                                                                      next
                                                                                        case case_2
                                                                                        by contradiction
                                                                                           /* from formulas */
                                                                                      qed
                                                                                    qed
                                                                                  next
                                                                                    case case_2
                                                                                    solve( state_1111111111111111111111121111111( ~RouterID.1,
                                                                                                                                  ~ServerID.1,
                                                                                                                                  ~ak_h.1,
                                                                                                                                  ~ak_sk.1,
                                                                                                                                  ~ssk_nms.1,
                                                                                                                                  pL,
                                                                                                                                  pcrL,
                                                                                                                                  s_h,
                                                                                                                                  ~n.3
                                                                                           ) ▶₀ #t2.9 )
                                                                                      case insertpolicyDigestshpcrLTPMCCPolicyPCRpL_0_111111111111111111111112111111
                                                                                      solve( (#t2.10 < #t2.16)  ∥
                                                                                             (#t2.10 =
                                                                                              #t2.16) )
                                                                                        case case_1
                                                                                        by contradiction
                                                                                           /* from formulas */
                                                                                      next
                                                                                        case case_2
                                                                                        solve( (#t2.13 < #t2.15)  ∥
                                                                                               (#t2.13 =
                                                                                                #t2.15) )
                                                                                          case case_1
                                                                                          by contradiction
                                                                                             /* from formulas
                                                                                             */
                                                                                        next
                                                                                          case case_2
                                                                                          solve( TPM_SendCommand( <
                                                                                                                   'TPM2_PolicyPCR', 
                                                                                                                   k_sh
                                                                                                                  >
                                                                                                 ) @ #t2.12 )
                                                                                            case eventTPMSendCommandTPMPolicyPCRtlssh_0_1111111111111211111111111
                                                                                            solve( state_1111111111111211111111111( ~RouterID.1,
                                                                                                                                    ~ServerID.1,
                                                                                                                                    ~ak_h.1,
                                                                                                                                    ~ak_sk.1,
                                                                                                                                    ~ssk_nms.1,
                                                                                                                                    ~tid.1,
                                                                                                                                    tls_h,
                                                                                                                                    k_sh,
                                                                                                                                    tls_spk
                                                                                                   ) ▶₀ #t2.11 )
                                                                                              case eventGenerateTLStidtlsspk_0_111111111111121111111111
                                                                                              by contradiction
                                                                                                 /* cyclic */
                                                                                            qed
                                                                                          qed
                                                                                        qed
                                                                                      qed
                                                                                    qed
                                                                                  qed
                                                                                next
                                                                                  case case_2
                                                                                  solve( (#vr.28 < #t2.13)  ∥
                                                                                         (#vr.28 = #t2.13) )
                                                                                    case case_1
                                                                                    solve( state_1111111111111111111111121111111( ~RouterID.1,
                                                                                                                                  ~ServerID.1,
                                                                                                                                  ~ak_h.1,
                                                                                                                                  ~ak_sk.1,
                                                                                                                                  ~ssk_nms.1,
                                                                                                                                  pL,
                                                                                                                                  pcrL,
                                                                                                                                  s_h,
                                                                                                                                  ~n.3
                                                                                           ) ▶₀ #t2.9 )
                                                                                      case insertpolicyDigestshpcrLTPMCCPolicyPCRpL_0_111111111111111111111112111111
                                                                                      solve( (#vr.28 < #t2.16)  ∥
                                                                                             (#vr.28 =
                                                                                              #t2.16) )
                                                                                        case case_1
                                                                                        solve( (#t2.13 < #t2.16)  ∥
                                                                                               (#t2.13 =
                                                                                                #t2.16) )
                                                                                          case case_1
                                                                                          by contradiction
                                                                                             /* from formulas
                                                                                             */
                                                                                        next
                                                                                          case case_2
                                                                                          solve( (#t2.12 < #t2.15)  ∥
                                                                                                 (#t2.12 =
                                                                                                  #t2.15) )
                                                                                            case case_1
                                                                                            by contradiction
                                                                                               /*
                                                                                               from formulas
                                                                                               */
                                                                                          next
                                                                                            case case_2
                                                                                            solve( TPM_SendCommand( <
                                                                                                                     'TPM2_PolicyPCR', 
                                                                                                                     k_sh
                                                                                                                    >
                                                                                                   ) @ #t2.11 )
                                                                                              case eventTPMSendCommandTPMPolicyPCRtlssh_0_1111111111111211111111111
                                                                                              solve( state_1111111111111211111111111( ~RouterID.1,
                                                                                                                                      ~ServerID.1,
                                                                                                                                      ~ak_h.1,
                                                                                                                                      ~ak_sk.1,
                                                                                                                                      ~ssk_nms.1,
                                                                                                                                      ~tid.1,
                                                                                                                                      tls_h,
                                                                                                                                      k_sh,
                                                                                                                                      tls_spk
                                                                                                     ) ▶₀ #t2.10 )
                                                                                                case eventGenerateTLStidtlsspk_0_111111111111121111111111
                                                                                                solve( TPM_SendCommand( <
                                                                                                                         'TPM2_PolicyPCR', 
                                                                                                                         k_sh
                                                                                                                        >
                                                                                                       ) @ #t2.14 )
                                                                                                  case eventTPMSendCommandTPMPolicyPCRtlssh_0_1111111111111211111111111
                                                                                                  solve( state_1111111111111211111111111( ~RouterID.1,
                                                                                                                                          ~ServerID.1,
                                                                                                                                          ~ak_h.1,
                                                                                                                                          ~ak_sk.1,
                                                                                                                                          ~ssk_nms.1,
                                                                                                                                          ~tid.1,
                                                                                                                                          tls_h,
                                                                                                                                          k_sh,
                                                                                                                                          tls_spk
                                                                                                         ) ▶₀ #t2.11 )
                                                                                                    case eventGenerateTLStidtlsspk_0_111111111111121111111111
                                                                                                    solve( TPM_SendCommand( <
                                                                                                                             'TPM2_Create', 
                                                                                                                             <
                                                                                                                              swstate, 
                                                                                                                              nil
                                                                                                                             >, 
                                                                                                                             'TPM_CC_PolicyPCR', 
                                                                                                                             nil
                                                                                                                            >
                                                                                                           ) @ #t2.14 )
                                                                                                      case eventTPMSendCommandTPMCreateswstatenilTPMCCPolicyPCRnil_0_11111111111112111
                                                                                                      solve( state_11111111111112111( ~RouterID.1,
                                                                                                                                      ~ServerID.1,
                                                                                                                                      ~ak_h.1,
                                                                                                                                      ~ak_sk.1,
                                                                                                                                      ~ssk_nms.1,
                                                                                                                                      ~tid.1
                                                                                                             ) ▶₀ #t2.11 )
                                                                                                        case outTPMPCRExtendswstate_0_1111111111111211
                                                                                                        solve( TPM_SendCommand( <
                                                                                                                                 'TPM2_Create', 
                                                                                                                                 <
                                                                                                                                  swstate, 
                                                                                                                                  nil
                                                                                                                                 >, 
                                                                                                                                 'TPM_CC_PolicyPCR', 
                                                                                                                                 nil
                                                                                                                                >
                                                                                                               ) @ #t2.14 )
                                                                                                          case eventTPMSendCommandTPMCreateswstatenilTPMCCPolicyPCRnil_0_11111111111112111
                                                                                                          solve( state_11111111111112111( ~RouterID.1,
                                                                                                                                          ~ServerID.1,
                                                                                                                                          ~ak_h.1,
                                                                                                                                          ~ak_sk.1,
                                                                                                                                          ~ssk_nms.1,
                                                                                                                                          ~tid.1
                                                                                                                 ) ▶₀ #t2.11 )
                                                                                                            case outTPMPCRExtendswstate_0_1111111111111211
                                                                                                            by solve( !KU( ~ssk_nms
                                                                                                                      ) @ #vk.23 )
                                                                                                          qed
                                                                                                        qed
                                                                                                      qed
                                                                                                    qed
                                                                                                  qed
                                                                                                qed
                                                                                              qed
                                                                                            qed
                                                                                          qed
                                                                                        qed
                                                                                      next
                                                                                        case case_2
                                                                                        by contradiction
                                                                                           /* from formulas */
                                                                                      qed
                                                                                    qed
                                                                                  next
                                                                                    case case_2
                                                                                    solve( state_1111111111111111111111121111111( ~RouterID.1,
                                                                                                                                  ~ServerID.1,
                                                                                                                                  ~ak_h.1,
                                                                                                                                  ~ak_sk.1,
                                                                                                                                  ~ssk_nms.1,
                                                                                                                                  pL,
                                                                                                                                  pcrL,
                                                                                                                                  s_h,
                                                                                                                                  ~n.3
                                                                                           ) ▶₀ #t2.9 )
                                                                                      case insertpolicyDigestshpcrLTPMCCPolicyPCRpL_0_111111111111111111111112111111
                                                                                      solve( (#t2.10 < #t2.16)  ∥
                                                                                             (#t2.10 =
                                                                                              #t2.16) )
                                                                                        case case_1
                                                                                        by contradiction
                                                                                           /* from formulas */
                                                                                      next
                                                                                        case case_2
                                                                                        solve( (#t2.13 < #t2.15)  ∥
                                                                                               (#t2.13 =
                                                                                                #t2.15) )
                                                                                          case case_1
                                                                                          by contradiction
                                                                                             /* from formulas
                                                                                             */
                                                                                        next
                                                                                          case case_2
                                                                                          solve( TPM_SendCommand( <
                                                                                                                   'TPM2_PolicyPCR', 
                                                                                                                   k_sh
                                                                                                                  >
                                                                                                 ) @ #t2.12 )
                                                                                            case eventTPMSendCommandTPMPolicyPCRtlssh_0_1111111111111211111111111
                                                                                            solve( state_1111111111111211111111111( ~RouterID.1,
                                                                                                                                    ~ServerID.1,
                                                                                                                                    ~ak_h.1,
                                                                                                                                    ~ak_sk.1,
                                                                                                                                    ~ssk_nms.1,
                                                                                                                                    ~tid.1,
                                                                                                                                    tls_h,
                                                                                                                                    k_sh,
                                                                                                                                    tls_spk
                                                                                                   ) ▶₀ #t2.11 )
                                                                                              case eventGenerateTLStidtlsspk_0_111111111111121111111111
                                                                                              solve( TPM_SendCommand( <
                                                                                                                       'TPM2_PolicyPCR', 
                                                                                                                       k_sh
                                                                                                                      >
                                                                                                     ) @ #t2.14 )
                                                                                                case eventTPMSendCommandTPMPolicyPCRtlssh_0_1111111111111211111111111
                                                                                                solve( state_1111111111111211111111111( ~RouterID.1,
                                                                                                                                        ~ServerID.1,
                                                                                                                                        ~ak_h.1,
                                                                                                                                        ~ak_sk.1,
                                                                                                                                        ~ssk_nms.1,
                                                                                                                                        ~tid.1,
                                                                                                                                        tls_h,
                                                                                                                                        k_sh,
                                                                                                                                        tls_spk
                                                                                                       ) ▶₀ #t2.12 )
                                                                                                  case eventGenerateTLStidtlsspk_0_111111111111121111111111
                                                                                                  solve( TPM_SendCommand( <
                                                                                                                           'TPM2_Create', 
                                                                                                                           <
                                                                                                                            swstate, 
                                                                                                                            nil
                                                                                                                           >, 
                                                                                                                           'TPM_CC_PolicyPCR', 
                                                                                                                           nil
                                                                                                                          >
                                                                                                         ) @ #t2.14 )
                                                                                                    case eventTPMSendCommandTPMCreateswstatenilTPMCCPolicyPCRnil_0_11111111111112111
                                                                                                    solve( state_11111111111112111( ~RouterID.1,
                                                                                                                                    ~ServerID.1,
                                                                                                                                    ~ak_h.1,
                                                                                                                                    ~ak_sk.1,
                                                                                                                                    ~ssk_nms.1,
                                                                                                                                    ~tid.1
                                                                                                           ) ▶₀ #t2.12 )
                                                                                                      case outTPMPCRExtendswstate_0_1111111111111211
                                                                                                      solve( TPM_SendCommand( <
                                                                                                                               'TPM2_Create', 
                                                                                                                               <
                                                                                                                                swstate, 
                                                                                                                                nil
                                                                                                                               >, 
                                                                                                                               'TPM_CC_PolicyPCR', 
                                                                                                                               nil
                                                                                                                              >
                                                                                                             ) @ #t2.14 )
                                                                                                        case eventTPMSendCommandTPMCreateswstatenilTPMCCPolicyPCRnil_0_11111111111112111
                                                                                                        solve( state_11111111111112111( ~RouterID.1,
                                                                                                                                        ~ServerID.1,
                                                                                                                                        ~ak_h.1,
                                                                                                                                        ~ak_sk.1,
                                                                                                                                        ~ssk_nms.1,
                                                                                                                                        ~tid.1
                                                                                                               ) ▶₀ #t2.12 )
                                                                                                          case outTPMPCRExtendswstate_0_1111111111111211
                                                                                                          by solve( !KU( ~ssk_nms
                                                                                                                    ) @ #vk.23 )
                                                                                                        qed
                                                                                                      qed
                                                                                                    qed
                                                                                                  qed
                                                                                                qed
                                                                                              qed
                                                                                            qed
                                                                                          qed
                                                                                        qed
                                                                                      qed
                                                                                    qed
                                                                                  qed
                                                                                qed
                                                                              qed
                                                                            qed
                                                                          qed
                                                                        qed
                                                                      qed
                                                                    qed
                                                                  qed
                                                                qed
                                                              qed
                                                            qed
                                                          qed
                                                        next
                                                          case case_2
                                                          by contradiction /* from formulas */
                                                        qed
                                                      qed
                                                    qed
                                                  qed
                                                qed
                                              next
                                                case unlockdevice_0_11111111111111111111211111112
                                                by solve( state_11111111111111111111211111112( ~RouterID.1,
                                                                                               ~ServerID.1,
                                                                                               ~ak_h.1,
                                                                                               ~ak_sk.1,
                                                                                               ~ssk_nms.1,
                                                                                               a_h, obj_ap,
                                                                                               obj_h, obj_pd,
                                                                                               obj_pk, obj_sh,
                                                                                               ~n.2
                                                          ) ▶₀ #t2.7 )
                                              qed
                                            next
                                              case case_3
                                              solve( Unlock_4( '4', ~n.2, 'device' ) @ #t2.8 )
                                                case unlockdevice_0_111111111111111111112111111111
                                                solve( state_111111111111111111112111111111( ~RouterID.1,
                                                                                             ~ServerID.1,
                                                                                             ~ak_h.1,
                                                                                             ~ak_sk.1,
                                                                                             ~ssk_nms.1, a_h,
                                                                                             a_sk, obj_ap,
                                                                                             obj_h, obj_pd,
                                                                                             obj_pk, obj_sh,
                                                                                             ~n.2
                                                       ) ▶₀ #t2.7 )
                                                  case outsignobjpkobjapask_0_11111111111111111111211111111
                                                  solve( (#t2.3 < #t2.15)  ∥ (#t2.3 = #t2.15) )
                                                    case case_1
                                                    by contradiction /* from formulas */
                                                  next
                                                    case case_2
                                                    solve( (#t2.6 < #t2.14)  ∥ (#t2.6 = #t2.14) )
                                                      case case_1
                                                      by contradiction /* from formulas */
                                                    next
                                                      case case_2
                                                      solve( (#t2.10 < #t2.14)  ∥ (#t2.10 = #t2.14) )
                                                        case case_1
                                                        by contradiction /* from formulas */
                                                      next
                                                        case case_2
                                                        solve( (#vr.32 < #t2.13)  ∥ (#vr.32 = #t2.13) )
                                                          case case_1
                                                          solve( (#t2.9 < #t2.13)  ∥ (#t2.9 = #t2.13) )
                                                            case case_1
                                                            by contradiction /* from formulas */
                                                          next
                                                            case case_2
                                                            solve( TPM_SendCommand( <'TPM2_Create', 
                                                                                     <swstate, nil>, 
                                                                                     'TPM_CC_PolicyPCR', nil>
                                                                   ) @ #t2.11 )
                                                              case eventTPMSendCommandTPMCreateswstatenilTPMCCPolicyPCRnil_0_11111111111112111
                                                              solve( state_11111111111112111( ~RouterID.1,
                                                                                              ~ServerID.1,
                                                                                              ~ak_h.1,
                                                                                              ~ak_sk.1,
                                                                                              ~ssk_nms.1,
                                                                                              ~tid.1
                                                                     ) ▶₀ #t2.8 )
                                                                case outTPMPCRExtendswstate_0_1111111111111211
                                                                solve( TPM_SendCommand( <'TPM2_Certify', 
                                                                                         k_sh, ~k_h, ~ak_h>
                                                                       ) @ #t2.11 )
                                                                  case eventTPMSendCommandTPMCertifytlsshtlshakh_0_111111111111121111111111111
                                                                  solve( state_111111111111121111111111111( ~RouterID.1,
                                                                                                            ~ServerID.1,
                                                                                                            ~ak_h,
                                                                                                            ~ak_sk.1,
                                                                                                            ~ssk_nms.1,
                                                                                                            ~tid.1,
                                                                                                            ~k_h,
                                                                                                            k_sh,
                                                                                                            tls_spk
                                                                         ) ▶₀ #t2.8 )
                                                                    case outTPMPolicyPCRtlssh_0_11111111111112111111111111
                                                                    solve( TPM_SendCommand( <'TPM2_Create', 
                                                                                             <swstate, nil>, 
                                                                                             'TPM_CC_PolicyPCR', 
                                                                                             nil>
                                                                           ) @ #t2.11 )
                                                                      case eventTPMSendCommandTPMCreateswstatenilTPMCCPolicyPCRnil_0_11111111111112111
                                                                      solve( state_11111111111112111( ~RouterID.1,
                                                                                                      ~ServerID.1,
                                                                                                      ~ak_h.1,
                                                                                                      ~ak_sk.1,
                                                                                                      ~ssk_nms.1,
                                                                                                      ~tid.1
                                                                             ) ▶₀ #t2.8 )
                                                                        case outTPMPCRExtendswstate_0_1111111111111211
                                                                        solve( Insert( <'privatePart', ~k_h>,
                                                                                       k_sk.1
                                                                               ) @ #t2.2 )
                                                                          case insertprivatePartkhksk_0_111111111111111111111121111111
                                                                          solve( Insert( <'authPolicy', ~k_h>,
                                                                                         k_ap
                                                                                 ) @ #t2.3 )
                                                                            case insertauthPolicykhauthPolicy_0_11111111111111111111112111111
                                                                            solve( Insert( <'policyDigest', 
                                                                                            k_sh>,
                                                                                           <<swstate, nil>, 
                                                                                            'TPM_CC_PolicyPCR', 
                                                                                            nil>
                                                                                   ) @ #t2.8 )
                                                                              case insertpolicyDigestshpcrLTPMCCPolicyPCRpL_0_111111111111111111111112111111
                                                                              solve( state_111111111111111111111112111111( ~RouterID.1,
                                                                                                                           ~ServerID.1,
                                                                                                                           ~ak_h.1,
                                                                                                                           ~ak_sk.1,
                                                                                                                           ~ssk_nms.1,
                                                                                                                           nil,
                                                                                                                           <
                                                                                                                            swstate, 
                                                                                                                            nil
                                                                                                                           >,
                                                                                                                           k_sh,
                                                                                                                           lock
                                                                                     ) ▶₀ #t2.8 )
                                                                                case eventPolicyPCRshpL_0_11111111111111111111111211111
                                                                                solve( (#vr.82 < #vr.46)  ∥
                                                                                       (#t2 < #vr.82) )
                                                                                  case case_1
                                                                                  solve( (#t2.13 < #t2.11)  ∥
                                                                                         (#t2.13 = #t2.11)  ∥
                                                                                         (#vr.72 < #t2.13) )
                                                                                    case case_1
                                                                                    solve( (#vr.28 < #t2.14)  ∥
                                                                                           (#vr.28 = #t2.14) )
                                                                                      case case_1
                                                                                      solve( state_1111111111111111111111121111111( ~RouterID.1,
                                                                                                                                    ~ServerID.1,
                                                                                                                                    ~ak_h.1,
                                                                                                                                    ~ak_sk.1,
                                                                                                                                    ~ssk_nms.1,
                                                                                                                                    pL,
                                                                                                                                    pcrL,
                                                                                                                                    s_h,
                                                                                                                                    ~n.3
                                                                                             ) ▶₀ #t2.9 )
                                                                                        case insertpolicyDigestshpcrLTPMCCPolicyPCRpL_0_111111111111111111111112111111
                                                                                        by contradiction
                                                                                           /* cyclic */
                                                                                      qed
                                                                                    next
                                                                                      case case_2
                                                                                      solve( state_1111111111111111111111121111111( ~RouterID.1,
                                                                                                                                    ~ServerID.1,
                                                                                                                                    ~ak_h.1,
                                                                                                                                    ~ak_sk.1,
                                                                                                                                    ~ssk_nms.1,
                                                                                                                                    pL,
                                                                                                                                    pcrL,
                                                                                                                                    s_h,
                                                                                                                                    ~n.3
                                                                                             ) ▶₀ #t2.9 )
                                                                                        case insertpolicyDigestshpcrLTPMCCPolicyPCRpL_0_111111111111111111111112111111
                                                                                        by contradiction
                                                                                           /* cyclic */
                                                                                      qed
                                                                                    qed
                                                                                  next
                                                                                    case case_2
                                                                                    solve( (#vr.28 < #t2.13)  ∥
                                                                                           (#vr.28 = #t2.13) )
                                                                                      case case_1
                                                                                      solve( state_1111111111111111111111121111111( ~RouterID.1,
                                                                                                                                    ~ServerID.1,
                                                                                                                                    ~ak_h.1,
                                                                                                                                    ~ak_sk.1,
                                                                                                                                    ~ssk_nms.1,
                                                                                                                                    pL,
                                                                                                                                    pcrL,
                                                                                                                                    s_h,
                                                                                                                                    ~n.3
                                                                                             ) ▶₀ #t2.9 )
                                                                                        case insertpolicyDigestshpcrLTPMCCPolicyPCRpL_0_111111111111111111111112111111
                                                                                        by contradiction
                                                                                           /* cyclic */
                                                                                      qed
                                                                                    next
                                                                                      case case_2
                                                                                      solve( state_1111111111111111111111121111111( ~RouterID.1,
                                                                                                                                    ~ServerID.1,
                                                                                                                                    ~ak_h.1,
                                                                                                                                    ~ak_sk.1,
                                                                                                                                    ~ssk_nms.1,
                                                                                                                                    pL,
                                                                                                                                    pcrL,
                                                                                                                                    s_h,
                                                                                                                                    ~n.3
                                                                                             ) ▶₀ #t2.9 )
                                                                                        case insertpolicyDigestshpcrLTPMCCPolicyPCRpL_0_111111111111111111111112111111
                                                                                        by contradiction
                                                                                           /* cyclic */
                                                                                      qed
                                                                                    qed
                                                                                  next
                                                                                    case case_3
                                                                                    solve( (#vr.28 < #t2.14)  ∥
                                                                                           (#vr.28 = #t2.14) )
                                                                                      case case_1
                                                                                      solve( state_1111111111111111111111121111111( ~RouterID.1,
                                                                                                                                    ~ServerID.1,
                                                                                                                                    ~ak_h.1,
                                                                                                                                    ~ak_sk.1,
                                                                                                                                    ~ssk_nms.1,
                                                                                                                                    pL,
                                                                                                                                    pcrL,
                                                                                                                                    s_h,
                                                                                                                                    ~n.3
                                                                                             ) ▶₀ #t2.9 )
                                                                                        case insertpolicyDigestshpcrLTPMCCPolicyPCRpL_0_111111111111111111111112111111
                                                                                        by contradiction
                                                                                           /* cyclic */
                                                                                      qed
                                                                                    next
                                                                                      case case_2
                                                                                      solve( state_1111111111111111111111121111111( ~RouterID.1,
                                                                                                                                    ~ServerID.1,
                                                                                                                                    ~ak_h.1,
                                                                                                                                    ~ak_sk.1,
                                                                                                                                    ~ssk_nms.1,
                                                                                                                                    pL,
                                                                                                                                    pcrL,
                                                                                                                                    s_h,
                                                                                                                                    ~n.3
                                                                                             ) ▶₀ #t2.9 )
                                                                                        case insertpolicyDigestshpcrLTPMCCPolicyPCRpL_0_111111111111111111111112111111
                                                                                        by contradiction
                                                                                           /* cyclic */
                                                                                      qed
                                                                                    qed
                                                                                  qed
                                                                                next
                                                                                  case case_2
                                                                                  solve( (#vr.82 < #vr.73)  ∥
                                                                                         (#t2.7 < #vr.82) )
                                                                                    case case_1
                                                                                    solve( (#t2.13 < #t2.11)  ∥
                                                                                           (#t2.13 =
                                                                                            #t2.11)  ∥
                                                                                           (#vr.72 < #t2.13) )
                                                                                      case case_1
                                                                                      solve( (#vr.28 < #t2.14)  ∥
                                                                                             (#vr.28 =
                                                                                              #t2.14) )
                                                                                        case case_1
                                                                                        solve( state_1111111111111111111111121111111( ~RouterID.1,
                                                                                                                                      ~ServerID.1,
                                                                                                                                      ~ak_h.1,
                                                                                                                                      ~ak_sk.1,
                                                                                                                                      ~ssk_nms.1,
                                                                                                                                      pL,
                                                                                                                                      pcrL,
                                                                                                                                      s_h,
                                                                                                                                      ~n.3
                                                                                               ) ▶₀ #t2.9 )
                                                                                          case insertpolicyDigestshpcrLTPMCCPolicyPCRpL_0_111111111111111111111112111111
                                                                                          by contradiction
                                                                                             /* cyclic */
                                                                                        qed
                                                                                      next
                                                                                        case case_2
                                                                                        solve( state_1111111111111111111111121111111( ~RouterID.1,
                                                                                                                                      ~ServerID.1,
                                                                                                                                      ~ak_h.1,
                                                                                                                                      ~ak_sk.1,
                                                                                                                                      ~ssk_nms.1,
                                                                                                                                      pL,
                                                                                                                                      pcrL,
                                                                                                                                      s_h,
                                                                                                                                      ~n.3
                                                                                               ) ▶₀ #t2.9 )
                                                                                          case insertpolicyDigestshpcrLTPMCCPolicyPCRpL_0_111111111111111111111112111111
                                                                                          by contradiction
                                                                                             /* cyclic */
                                                                                        qed
                                                                                      qed
                                                                                    next
                                                                                      case case_2
                                                                                      solve( (#vr.28 < #t2.13)  ∥
                                                                                             (#vr.28 =
                                                                                              #t2.13) )
                                                                                        case case_1
                                                                                        solve( state_1111111111111111111111121111111( ~RouterID.1,
                                                                                                                                      ~ServerID.1,
                                                                                                                                      ~ak_h.1,
                                                                                                                                      ~ak_sk.1,
                                                                                                                                      ~ssk_nms.1,
                                                                                                                                      pL,
                                                                                                                                      pcrL,
                                                                                                                                      s_h,
                                                                                                                                      ~n.3
                                                                                               ) ▶₀ #t2.9 )
                                                                                          case insertpolicyDigestshpcrLTPMCCPolicyPCRpL_0_111111111111111111111112111111
                                                                                          by contradiction
                                                                                             /* cyclic */
                                                                                        qed
                                                                                      next
                                                                                        case case_2
                                                                                        solve( state_1111111111111111111111121111111( ~RouterID.1,
                                                                                                                                      ~ServerID.1,
                                                                                                                                      ~ak_h.1,
                                                                                                                                      ~ak_sk.1,
                                                                                                                                      ~ssk_nms.1,
                                                                                                                                      pL,
                                                                                                                                      pcrL,
                                                                                                                                      s_h,
                                                                                                                                      ~n.3
                                                                                               ) ▶₀ #t2.9 )
                                                                                          case insertpolicyDigestshpcrLTPMCCPolicyPCRpL_0_111111111111111111111112111111
                                                                                          by contradiction
                                                                                             /* cyclic */
                                                                                        qed
                                                                                      qed
                                                                                    next
                                                                                      case case_3
                                                                                      solve( (#vr.28 < #t2.14)  ∥
                                                                                             (#vr.28 =
                                                                                              #t2.14) )
                                                                                        case case_1
                                                                                        solve( state_1111111111111111111111121111111( ~RouterID.1,
                                                                                                                                      ~ServerID.1,
                                                                                                                                      ~ak_h.1,
                                                                                                                                      ~ak_sk.1,
                                                                                                                                      ~ssk_nms.1,
                                                                                                                                      pL,
                                                                                                                                      pcrL,
                                                                                                                                      s_h,
                                                                                                                                      ~n.3
                                                                                               ) ▶₀ #t2.9 )
                                                                                          case insertpolicyDigestshpcrLTPMCCPolicyPCRpL_0_111111111111111111111112111111
                                                                                          by contradiction
                                                                                             /* cyclic */
                                                                                        qed
                                                                                      next
                                                                                        case case_2
                                                                                        solve( state_1111111111111111111111121111111( ~RouterID.1,
                                                                                                                                      ~ServerID.1,
                                                                                                                                      ~ak_h.1,
                                                                                                                                      ~ak_sk.1,
                                                                                                                                      ~ssk_nms.1,
                                                                                                                                      pL,
                                                                                                                                      pcrL,
                                                                                                                                      s_h,
                                                                                                                                      ~n.3
                                                                                               ) ▶₀ #t2.9 )
                                                                                          case insertpolicyDigestshpcrLTPMCCPolicyPCRpL_0_111111111111111111111112111111
                                                                                          by contradiction
                                                                                             /* cyclic */
                                                                                        qed
                                                                                      qed
                                                                                    qed
                                                                                  next
                                                                                    case case_2
                                                                                    solve( ((#vr.17 < #vr.82) ∧
                                                                                            (∃ #t2.
                                                                                              (Unlock_5( '5',
                                                                                                         ~n.1,
                                                                                                         'device'
                                                                                               ) @ #t2)
                                                                                             ∧
                                                                                              (#vr.17 < #t2) ∧
                                                                                              (#t2 < #vr.82) ∧
                                                                                              (∀ #t0 pp.
                                                                                                (Unlock( pp,
                                                                                                         ~n.1,
                                                                                                         'device'
                                                                                                 ) @ #t0)
                                                                                               ⇒
                                                                                                #t0 = #t2) ∧
                                                                                              (∀ pp lpp #t0.
                                                                                                (Lock( pp,
                                                                                                       lpp,
                                                                                                       'device'
                                                                                                 ) @ #t0)
                                                                                               ⇒
                                                                                                ((#t0 < #vr.17) ∨
                                                                                                 (#t0 =
                                                                                                  #vr.17) ∨
                                                                                                 (#t2 < #t0))) ∧
                                                                                              (∀ pp lpp #t0.
                                                                                                (Unlock( pp,
                                                                                                         lpp,
                                                                                                         'device'
                                                                                                 ) @ #t0)
                                                                                               ⇒
                                                                                                ((#t0 < #vr.17) ∨
                                                                                                 (#t2 < #t0) ∨
                                                                                                 (#t2 =
                                                                                                  #t0)))))  ∥
                                                                                           (#vr.82 < #vr.17) )
                                                                                      case case_1
                                                                                      solve( (#t2.12 < #t2.10)  ∥
                                                                                             (#t2.12 =
                                                                                              #t2.10)  ∥
                                                                                             (#vr.72 < #t2.12) )
                                                                                        case case_1
                                                                                        by contradiction
                                                                                           /* from formulas */
                                                                                      next
                                                                                        case case_2
                                                                                        solve( (#vr.28 < #t2.12)  ∥
                                                                                               (#vr.28 =
                                                                                                #t2.12) )
                                                                                          case case_1
                                                                                          solve( TPM_SendCommand( <
                                                                                                                   'TPM2_PolicyPCR', 
                                                                                                                   k_sh
                                                                                                                  >
                                                                                                 ) @ #t2.11 )
                                                                                            case eventTPMSendCommandTPMPolicyPCRtlssh_0_1111111111111211111111111
                                                                                            solve( state_1111111111111211111111111( ~RouterID.1,
                                                                                                                                    ~ServerID.1,
                                                                                                                                    ~ak_h.1,
                                                                                                                                    ~ak_sk.1,
                                                                                                                                    ~ssk_nms.1,
                                                                                                                                    ~tid.1,
                                                                                                                                    tls_h,
                                                                                                                                    k_sh,
                                                                                                                                    tls_spk
                                                                                                   ) ▶₀ #t2.9 )
                                                                                              case eventGenerateTLStidtlsspk_0_111111111111121111111111
                                                                                              solve( Unlock_5( '5',
                                                                                                               ~n.1,
                                                                                                               'device'
                                                                                                     ) @ #t2.13 )
                                                                                                case unlockdevice_0_1111111111111111111211111111
                                                                                                solve( state_1111111111111111111211111111( ~RouterID.1,
                                                                                                                                           ~ServerID.1,
                                                                                                                                           ~ak_h.1,
                                                                                                                                           ~ak_sk.1,
                                                                                                                                           ~ssk_nms.1,
                                                                                                                                           k_ap,
                                                                                                                                           k_h.1,
                                                                                                                                           k_pd,
                                                                                                                                           k_sh.1,
                                                                                                                                           k_sk.1,
                                                                                                                                           m,
                                                                                                                                           ~n.1
                                                                                                       ) ▶₀ #t2.10 )
                                                                                                  case TpmSignOutsignmksk_0_111111111111111111121111111
                                                                                                  by contradiction
                                                                                                     /* cyclic
                                                                                                     */
                                                                                                qed
                                                                                              next
                                                                                                case unlockdevice_0_111111111111111111121111112
                                                                                                by solve( state_111111111111111111121111112( ~RouterID.1,
                                                                                                                                             ~ServerID.1,
                                                                                                                                             ~ak_h.1,
                                                                                                                                             ~ak_sk.1,
                                                                                                                                             ~ssk_nms.1,
                                                                                                                                             k_ap,
                                                                                                                                             k_h.1,
                                                                                                                                             k_pd,
                                                                                                                                             k_sh.1,
                                                                                                                                             m,
                                                                                                                                             ~n.1
                                                                                                          ) ▶₀ #t2.10 )
                                                                                              qed
                                                                                            qed
                                                                                          qed
                                                                                        next
                                                                                          case case_2
                                                                                          solve( TPM_SendCommand( <
                                                                                                                   'TPM2_PolicyPCR', 
                                                                                                                   k_sh
                                                                                                                  >
                                                                                                 ) @ #t2.12 )
                                                                                            case eventTPMSendCommandTPMPolicyPCRtlssh_0_1111111111111211111111111
                                                                                            solve( state_1111111111111211111111111( ~RouterID.1,
                                                                                                                                    ~ServerID.1,
                                                                                                                                    ~ak_h.1,
                                                                                                                                    ~ak_sk.1,
                                                                                                                                    ~ssk_nms.1,
                                                                                                                                    ~tid.1,
                                                                                                                                    tls_h,
                                                                                                                                    k_sh,
                                                                                                                                    tls_spk
                                                                                                   ) ▶₀ #t2.10 )
                                                                                              case eventGenerateTLStidtlsspk_0_111111111111121111111111
                                                                                              solve( Unlock_5( '5',
                                                                                                               ~n.1,
                                                                                                               'device'
                                                                                                     ) @ #t2.13 )
                                                                                                case unlockdevice_0_1111111111111111111211111111
                                                                                                solve( state_1111111111111111111211111111( ~RouterID.1,
                                                                                                                                           ~ServerID.1,
                                                                                                                                           ~ak_h.1,
                                                                                                                                           ~ak_sk.1,
                                                                                                                                           ~ssk_nms.1,
                                                                                                                                           k_ap,
                                                                                                                                           k_h.1,
                                                                                                                                           k_pd,
                                                                                                                                           k_sh.1,
                                                                                                                                           k_sk.1,
                                                                                                                                           m,
                                                                                                                                           ~n.1
                                                                                                       ) ▶₀ #t2.11 )
                                                                                                  case TpmSignOutsignmksk_0_111111111111111111121111111
                                                                                                  by contradiction
                                                                                                     /* cyclic
                                                                                                     */
                                                                                                qed
                                                                                              next
                                                                                                case unlockdevice_0_111111111111111111121111112
                                                                                                by solve( state_111111111111111111121111112( ~RouterID.1,
                                                                                                                                             ~ServerID.1,
                                                                                                                                             ~ak_h.1,
                                                                                                                                             ~ak_sk.1,
                                                                                                                                             ~ssk_nms.1,
                                                                                                                                             k_ap,
                                                                                                                                             k_h.1,
                                                                                                                                             k_pd,
                                                                                                                                             k_sh.1,
                                                                                                                                             m,
                                                                                                                                             ~n.1
                                                                                                          ) ▶₀ #t2.11 )
                                                                                              qed
                                                                                            qed
                                                                                          qed
                                                                                        qed
                                                                                      next
                                                                                        case case_3
                                                                                        solve( (#vr.28 < #t2.13)  ∥
                                                                                               (#vr.28 =
                                                                                                #t2.13) )
                                                                                          case case_1
                                                                                          solve( TPM_SendCommand( <
                                                                                                                   'TPM2_PolicyPCR', 
                                                                                                                   k_sh
                                                                                                                  >
                                                                                                 ) @ #t2.11 )
                                                                                            case eventTPMSendCommandTPMPolicyPCRtlssh_0_1111111111111211111111111
                                                                                            solve( state_1111111111111211111111111( ~RouterID.1,
                                                                                                                                    ~ServerID.1,
                                                                                                                                    ~ak_h.1,
                                                                                                                                    ~ak_sk.1,
                                                                                                                                    ~ssk_nms.1,
                                                                                                                                    ~tid.1,
                                                                                                                                    tls_h,
                                                                                                                                    k_sh,
                                                                                                                                    tls_spk
                                                                                                   ) ▶₀ #t2.9 )
                                                                                              case eventGenerateTLStidtlsspk_0_111111111111121111111111
                                                                                              solve( Unlock_5( '5',
                                                                                                               ~n.1,
                                                                                                               'device'
                                                                                                     ) @ #t2.14 )
                                                                                                case unlockdevice_0_1111111111111111111211111111
                                                                                                solve( state_1111111111111111111211111111( ~RouterID.1,
                                                                                                                                           ~ServerID.1,
                                                                                                                                           ~ak_h.1,
                                                                                                                                           ~ak_sk.1,
                                                                                                                                           ~ssk_nms.1,
                                                                                                                                           k_ap,
                                                                                                                                           k_h.1,
                                                                                                                                           k_pd,
                                                                                                                                           k_sh.1,
                                                                                                                                           k_sk.1,
                                                                                                                                           m,
                                                                                                                                           ~n.1
                                                                                                       ) ▶₀ #t2.10 )
                                                                                                  case TpmSignOutsignmksk_0_111111111111111111121111111
                                                                                                  by contradiction
                                                                                                     /* cyclic
                                                                                                     */
                                                                                                qed
                                                                                              next
                                                                                                case unlockdevice_0_111111111111111111121111112
                                                                                                by solve( state_111111111111111111121111112( ~RouterID.1,
                                                                                                                                             ~ServerID.1,
                                                                                                                                             ~ak_h.1,
                                                                                                                                             ~ak_sk.1,
                                                                                                                                             ~ssk_nms.1,
                                                                                                                                             k_ap,
                                                                                                                                             k_h.1,
                                                                                                                                             k_pd,
                                                                                                                                             k_sh.1,
                                                                                                                                             m,
                                                                                                                                             ~n.1
                                                                                                          ) ▶₀ #t2.10 )
                                                                                              qed
                                                                                            qed
                                                                                          qed
                                                                                        next
                                                                                          case case_2
                                                                                          solve( TPM_SendCommand( <
                                                                                                                   'TPM2_PolicyPCR', 
                                                                                                                   k_sh
                                                                                                                  >
                                                                                                 ) @ #t2.12 )
                                                                                            case eventTPMSendCommandTPMPolicyPCRtlssh_0_1111111111111211111111111
                                                                                            solve( state_1111111111111211111111111( ~RouterID.1,
                                                                                                                                    ~ServerID.1,
                                                                                                                                    ~ak_h.1,
                                                                                                                                    ~ak_sk.1,
                                                                                                                                    ~ssk_nms.1,
                                                                                                                                    ~tid.1,
                                                                                                                                    tls_h,
                                                                                                                                    k_sh,
                                                                                                                                    tls_spk
                                                                                                   ) ▶₀ #t2.10 )
                                                                                              case eventGenerateTLStidtlsspk_0_111111111111121111111111
                                                                                              solve( Unlock_5( '5',
                                                                                                               ~n.1,
                                                                                                               'device'
                                                                                                     ) @ #t2.14 )
                                                                                                case unlockdevice_0_1111111111111111111211111111
                                                                                                solve( state_1111111111111111111211111111( ~RouterID.1,
                                                                                                                                           ~ServerID.1,
                                                                                                                                           ~ak_h.1,
                                                                                                                                           ~ak_sk.1,
                                                                                                                                           ~ssk_nms.1,
                                                                                                                                           k_ap,
                                                                                                                                           k_h.1,
                                                                                                                                           k_pd,
                                                                                                                                           k_sh.1,
                                                                                                                                           k_sk.1,
                                                                                                                                           m,
                                                                                                                                           ~n.1
                                                                                                       ) ▶₀ #t2.11 )
                                                                                                  case TpmSignOutsignmksk_0_111111111111111111121111111
                                                                                                  by contradiction
                                                                                                     /* cyclic
                                                                                                     */
                                                                                                qed
                                                                                              next
                                                                                                case unlockdevice_0_111111111111111111121111112
                                                                                                by solve( state_111111111111111111121111112( ~RouterID.1,
                                                                                                                                             ~ServerID.1,
                                                                                                                                             ~ak_h.1,
                                                                                                                                             ~ak_sk.1,
                                                                                                                                             ~ssk_nms.1,
                                                                                                                                             k_ap,
                                                                                                                                             k_h.1,
                                                                                                                                             k_pd,
                                                                                                                                             k_sh.1,
                                                                                                                                             m,
                                                                                                                                             ~n.1
                                                                                                          ) ▶₀ #t2.11 )
                                                                                              qed
                                                                                            qed
                                                                                          qed
                                                                                        qed
                                                                                      qed
                                                                                    next
                                                                                      case case_2
                                                                                      solve( (#t2.13 < #t2.11)  ∥
                                                                                             (#t2.13 =
                                                                                              #t2.11)  ∥
                                                                                             (#vr.72 < #t2.13) )
                                                                                        case case_1
                                                                                        by contradiction
                                                                                           /* from formulas */
                                                                                      next
                                                                                        case case_2
                                                                                        solve( (#vr.28 < #t2.13)  ∥
                                                                                               (#vr.28 =
                                                                                                #t2.13) )
                                                                                          case case_1
                                                                                          solve( state_1111111111111111111111121111111( ~RouterID.1,
                                                                                                                                        ~ServerID.1,
                                                                                                                                        ~ak_h.1,
                                                                                                                                        ~ak_sk.1,
                                                                                                                                        ~ssk_nms.1,
                                                                                                                                        pL,
                                                                                                                                        pcrL,
                                                                                                                                        s_h,
                                                                                                                                        ~n.3
                                                                                                 ) ▶₀ #t2.9 )
                                                                                            case insertpolicyDigestshpcrLTPMCCPolicyPCRpL_0_111111111111111111111112111111
                                                                                            solve( (#vr.28 < #t2.16)  ∥
                                                                                                   (#vr.28 =
                                                                                                    #t2.16) )
                                                                                              case case_1
                                                                                              solve( (#t2.15 < #t2.11)  ∥
                                                                                                     (#t2.15 =
                                                                                                      #t2.11)  ∥
                                                                                                     (#vr.72 < #t2.15) )
                                                                                                case case_1
                                                                                                by contradiction
                                                                                                   /*
                                                                                                   from formulas
                                                                                                   */
                                                                                              next
                                                                                                case case_2
                                                                                                solve( (#t2.13 < #t2.15)  ∥
                                                                                                       (#t2.13 =
                                                                                                        #t2.15) )
                                                                                                  case case_1
                                                                                                  by contradiction
                                                                                                     /*
                                                                                                     from formulas
                                                                                                     */
                                                                                                next
                                                                                                  case case_2
                                                                                                  solve( TPM_SendCommand( <
                                                                                                                           'TPM2_PolicyPCR', 
                                                                                                                           k_sh
                                                                                                                          >
                                                                                                         ) @ #t2.12 )
                                                                                                    case eventTPMSendCommandTPMPolicyPCRtlssh_0_1111111111111211111111111
                                                                                                    solve( state_1111111111111211111111111( ~RouterID.1,
                                                                                                                                            ~ServerID.1,
                                                                                                                                            ~ak_h.1,
                                                                                                                                            ~ak_sk.1,
                                                                                                                                            ~ssk_nms.1,
                                                                                                                                            ~tid.1,
                                                                                                                                            tls_h,
                                                                                                                                            k_sh,
                                                                                                                                            tls_spk
                                                                                                           ) ▶₀ #t2.10 )
                                                                                                      case eventGenerateTLStidtlsspk_0_111111111111121111111111
                                                                                                      solve( TPM_SendCommand( <
                                                                                                                               'TPM2_PolicyPCR', 
                                                                                                                               k_sh
                                                                                                                              >
                                                                                                             ) @ #t2.14 )
                                                                                                        case eventTPMSendCommandTPMPolicyPCRtlssh_0_1111111111111211111111111
                                                                                                        solve( state_1111111111111211111111111( ~RouterID.1,
                                                                                                                                                ~ServerID.1,
                                                                                                                                                ~ak_h.1,
                                                                                                                                                ~ak_sk.1,
                                                                                                                                                ~ssk_nms.1,
                                                                                                                                                ~tid.1,
                                                                                                                                                tls_h,
                                                                                                                                                k_sh,
                                                                                                                                                tls_spk
                                                                                                               ) ▶₀ #t2.11 )
                                                                                                          case eventGenerateTLStidtlsspk_0_111111111111121111111111
                                                                                                          solve( TPM_SendCommand( <
                                                                                                                                   'TPM2_Create', 
                                                                                                                                   <
                                                                                                                                    swstate, 
                                                                                                                                    nil
                                                                                                                                   >, 
                                                                                                                                   'TPM_CC_PolicyPCR', 
                                                                                                                                   nil
                                                                                                                                  >
                                                                                                                 ) @ #t2.14 )
                                                                                                            case eventTPMSendCommandTPMCreateswstatenilTPMCCPolicyPCRnil_0_11111111111112111
                                                                                                            solve( state_11111111111112111( ~RouterID.1,
                                                                                                                                            ~ServerID.1,
                                                                                                                                            ~ak_h.1,
                                                                                                                                            ~ak_sk.1,
                                                                                                                                            ~ssk_nms.1,
                                                                                                                                            ~tid.1
                                                                                                                   ) ▶₀ #t2.11 )
                                                                                                              case outTPMPCRExtendswstate_0_1111111111111211
                                                                                                              solve( TPM_SendCommand( <
                                                                                                                                       'TPM2_Create', 
                                                                                                                                       <
                                                                                                                                        swstate, 
                                                                                                                                        nil
                                                                                                                                       >, 
                                                                                                                                       'TPM_CC_PolicyPCR', 
                                                                                                                                       nil
                                                                                                                                      >
                                                                                                                     ) @ #t2.14 )
                                                                                                                case eventTPMSendCommandTPMCreateswstatenilTPMCCPolicyPCRnil_0_11111111111112111
                                                                                                                solve( state_11111111111112111( ~RouterID.1,
                                                                                                                                                ~ServerID.1,
                                                                                                                                                ~ak_h.1,
                                                                                                                                                ~ak_sk.1,
                                                                                                                                                ~ssk_nms.1,
                                                                                                                                                ~tid.1
                                                                                                                       ) ▶₀ #t2.11 )
                                                                                                                  case outTPMPCRExtendswstate_0_1111111111111211
                                                                                                                  by solve( !KU( ~ssk_nms
                                                                                                                            ) @ #vk.23 )
                                                                                                                qed
                                                                                                              qed
                                                                                                            qed
                                                                                                          qed
                                                                                                        qed
                                                                                                      qed
                                                                                                    qed
                                                                                                  qed
                                                                                                qed
                                                                                              next
                                                                                                case case_3
                                                                                                by contradiction
                                                                                                   /*
                                                                                                   from formulas
                                                                                                   */
                                                                                              qed
                                                                                            next
                                                                                              case case_2
                                                                                              by contradiction
                                                                                                 /*
                                                                                                 from formulas
                                                                                                 */
                                                                                            qed
                                                                                          qed
                                                                                        next
                                                                                          case case_2
                                                                                          solve( state_1111111111111111111111121111111( ~RouterID.1,
                                                                                                                                        ~ServerID.1,
                                                                                                                                        ~ak_h.1,
                                                                                                                                        ~ak_sk.1,
                                                                                                                                        ~ssk_nms.1,
                                                                                                                                        pL,
                                                                                                                                        pcrL,
                                                                                                                                        s_h,
                                                                                                                                        ~n.3
                                                                                                 ) ▶₀ #t2.9 )
                                                                                            case insertpolicyDigestshpcrLTPMCCPolicyPCRpL_0_111111111111111111111112111111
                                                                                            solve( (#t2.10 < #t2.16)  ∥
                                                                                                   (#t2.10 =
                                                                                                    #t2.16) )
                                                                                              case case_1
                                                                                              by contradiction
                                                                                                 /*
                                                                                                 from formulas
                                                                                                 */
                                                                                            next
                                                                                              case case_2
                                                                                              solve( (#t2.15 < #t2.12)  ∥
                                                                                                     (#t2.15 =
                                                                                                      #t2.12)  ∥
                                                                                                     (#vr.71 < #t2.15) )
                                                                                                case case_1
                                                                                                by contradiction
                                                                                                   /*
                                                                                                   from formulas
                                                                                                   */
                                                                                              next
                                                                                                case case_2
                                                                                                solve( TPM_SendCommand( <
                                                                                                                         'TPM2_PolicyPCR', 
                                                                                                                         k_sh
                                                                                                                        >
                                                                                                       ) @ #t2.13 )
                                                                                                  case eventTPMSendCommandTPMPolicyPCRtlssh_0_1111111111111211111111111
                                                                                                  solve( state_1111111111111211111111111( ~RouterID.1,
                                                                                                                                          ~ServerID.1,
                                                                                                                                          ~ak_h.1,
                                                                                                                                          ~ak_sk.1,
                                                                                                                                          ~ssk_nms.1,
                                                                                                                                          ~tid.1,
                                                                                                                                          tls_h,
                                                                                                                                          k_sh,
                                                                                                                                          tls_spk
                                                                                                         ) ▶₀ #t2.11 )
                                                                                                    case eventGenerateTLStidtlsspk_0_111111111111121111111111
                                                                                                    solve( TPM_SendCommand( <
                                                                                                                             'TPM2_PolicyPCR', 
                                                                                                                             k_sh
                                                                                                                            >
                                                                                                           ) @ #t2.14 )
                                                                                                      case eventTPMSendCommandTPMPolicyPCRtlssh_0_1111111111111211111111111
                                                                                                      solve( state_1111111111111211111111111( ~RouterID.1,
                                                                                                                                              ~ServerID.1,
                                                                                                                                              ~ak_h.1,
                                                                                                                                              ~ak_sk.1,
                                                                                                                                              ~ssk_nms.1,
                                                                                                                                              ~tid.1,
                                                                                                                                              tls_h,
                                                                                                                                              k_sh,
                                                                                                                                              tls_spk
                                                                                                             ) ▶₀ #t2.12 )
                                                                                                        case eventGenerateTLStidtlsspk_0_111111111111121111111111
                                                                                                        solve( TPM_SendCommand( <
                                                                                                                                 'TPM2_Create', 
                                                                                                                                 <
                                                                                                                                  swstate, 
                                                                                                                                  nil
                                                                                                                                 >, 
                                                                                                                                 'TPM_CC_PolicyPCR', 
                                                                                                                                 nil
                                                                                                                                >
                                                                                                               ) @ #t2.14 )
                                                                                                          case eventTPMSendCommandTPMCreateswstatenilTPMCCPolicyPCRnil_0_11111111111112111
                                                                                                          solve( state_11111111111112111( ~RouterID.1,
                                                                                                                                          ~ServerID.1,
                                                                                                                                          ~ak_h.1,
                                                                                                                                          ~ak_sk.1,
                                                                                                                                          ~ssk_nms.1,
                                                                                                                                          ~tid.1
                                                                                                                 ) ▶₀ #t2.12 )
                                                                                                            case outTPMPCRExtendswstate_0_1111111111111211
                                                                                                            solve( TPM_SendCommand( <
                                                                                                                                     'TPM2_Create', 
                                                                                                                                     <
                                                                                                                                      swstate, 
                                                                                                                                      nil
                                                                                                                                     >, 
                                                                                                                                     'TPM_CC_PolicyPCR', 
                                                                                                                                     nil
                                                                                                                                    >
                                                                                                                   ) @ #t2.14 )
                                                                                                              case eventTPMSendCommandTPMCreateswstatenilTPMCCPolicyPCRnil_0_11111111111112111
                                                                                                              solve( state_11111111111112111( ~RouterID.1,
                                                                                                                                              ~ServerID.1,
                                                                                                                                              ~ak_h.1,
                                                                                                                                              ~ak_sk.1,
                                                                                                                                              ~ssk_nms.1,
                                                                                                                                              ~tid.1
                                                                                                                     ) ▶₀ #t2.12 )
                                                                                                                case outTPMPCRExtendswstate_0_1111111111111211
                                                                                                                by solve( !KU( ~ssk_nms
                                                                                                                          ) @ #vk.23 )
                                                                                                              qed
                                                                                                            qed
                                                                                                          qed
                                                                                                        qed
                                                                                                      qed
                                                                                                    qed
                                                                                                  qed
                                                                                                qed
                                                                                              next
                                                                                                case case_3
                                                                                                by contradiction
                                                                                                   /*
                                                                                                   from formulas
                                                                                                   */
                                                                                              qed
                                                                                            qed
                                                                                          qed
                                                                                        qed
                                                                                      next
                                                                                        case case_3
                                                                                        solve( (#vr.28 < #t2.14)  ∥
                                                                                               (#vr.28 =
                                                                                                #t2.14) )
                                                                                          case case_1
                                                                                          solve( state_1111111111111111111111121111111( ~RouterID.1,
                                                                                                                                        ~ServerID.1,
                                                                                                                                        ~ak_h.1,
                                                                                                                                        ~ak_sk.1,
                                                                                                                                        ~ssk_nms.1,
                                                                                                                                        pL,
                                                                                                                                        pcrL,
                                                                                                                                        s_h,
                                                                                                                                        ~n.3
                                                                                                 ) ▶₀ #t2.9 )
                                                                                            case insertpolicyDigestshpcrLTPMCCPolicyPCRpL_0_111111111111111111111112111111
                                                                                            solve( (#vr.28 < #t2.17)  ∥
                                                                                                   (#vr.28 =
                                                                                                    #t2.17) )
                                                                                              case case_1
                                                                                              solve( (#t2.16 < #t2.11)  ∥
                                                                                                     (#t2.16 =
                                                                                                      #t2.11)  ∥
                                                                                                     (#vr.72 < #t2.16) )
                                                                                                case case_1
                                                                                                by contradiction
                                                                                                   /*
                                                                                                   from formulas
                                                                                                   */
                                                                                              next
                                                                                                case case_2
                                                                                                by contradiction
                                                                                                   /*
                                                                                                   from formulas
                                                                                                   */
                                                                                              next
                                                                                                case case_3
                                                                                                solve( (#t2.14 < #t2.17)  ∥
                                                                                                       (#t2.14 =
                                                                                                        #t2.17) )
                                                                                                  case case_1
                                                                                                  by contradiction
                                                                                                     /*
                                                                                                     from formulas
                                                                                                     */
                                                                                                next
                                                                                                  case case_2
                                                                                                  solve( (#t2.13 < #t2.16)  ∥
                                                                                                         (#t2.13 =
                                                                                                          #t2.16) )
                                                                                                    case case_1
                                                                                                    by contradiction
                                                                                                       /*
                                                                                                       from formulas
                                                                                                       */
                                                                                                  next
                                                                                                    case case_2
                                                                                                    solve( TPM_SendCommand( <
                                                                                                                             'TPM2_PolicyPCR', 
                                                                                                                             k_sh
                                                                                                                            >
                                                                                                           ) @ #t2.12 )
                                                                                                      case eventTPMSendCommandTPMPolicyPCRtlssh_0_1111111111111211111111111
                                                                                                      solve( state_1111111111111211111111111( ~RouterID.1,
                                                                                                                                              ~ServerID.1,
                                                                                                                                              ~ak_h.1,
                                                                                                                                              ~ak_sk.1,
                                                                                                                                              ~ssk_nms.1,
                                                                                                                                              ~tid.1,
                                                                                                                                              tls_h,
                                                                                                                                              k_sh,
                                                                                                                                              tls_spk
                                                                                                             ) ▶₀ #t2.10 )
                                                                                                        case eventGenerateTLStidtlsspk_0_111111111111121111111111
                                                                                                        solve( TPM_SendCommand( <
                                                                                                                                 'TPM2_PolicyPCR', 
                                                                                                                                 k_sh
                                                                                                                                >
                                                                                                               ) @ #t2.15 )
                                                                                                          case eventTPMSendCommandTPMPolicyPCRtlssh_0_1111111111111211111111111
                                                                                                          solve( state_1111111111111211111111111( ~RouterID.1,
                                                                                                                                                  ~ServerID.1,
                                                                                                                                                  ~ak_h.1,
                                                                                                                                                  ~ak_sk.1,
                                                                                                                                                  ~ssk_nms.1,
                                                                                                                                                  ~tid.1,
                                                                                                                                                  tls_h,
                                                                                                                                                  k_sh,
                                                                                                                                                  tls_spk
                                                                                                                 ) ▶₀ #t2.11 )
                                                                                                            case eventGenerateTLStidtlsspk_0_111111111111121111111111
                                                                                                            solve( TPM_SendCommand( <
                                                                                                                                     'TPM2_Create', 
                                                                                                                                     <
                                                                                                                                      swstate, 
                                                                                                                                      nil
                                                                                                                                     >, 
                                                                                                                                     'TPM_CC_PolicyPCR', 
                                                                                                                                     nil
                                                                                                                                    >
                                                                                                                   ) @ #t2.15 )
                                                                                                              case eventTPMSendCommandTPMCreateswstatenilTPMCCPolicyPCRnil_0_11111111111112111
                                                                                                              solve( state_11111111111112111( ~RouterID.1,
                                                                                                                                              ~ServerID.1,
                                                                                                                                              ~ak_h.1,
                                                                                                                                              ~ak_sk.1,
                                                                                                                                              ~ssk_nms.1,
                                                                                                                                              ~tid.1
                                                                                                                     ) ▶₀ #t2.11 )
                                                                                                                case outTPMPCRExtendswstate_0_1111111111111211
                                                                                                                solve( TPM_SendCommand( <
                                                                                                                                         'TPM2_Create', 
                                                                                                                                         <
                                                                                                                                          swstate, 
                                                                                                                                          nil
                                                                                                                                         >, 
                                                                                                                                         'TPM_CC_PolicyPCR', 
                                                                                                                                         nil
                                                                                                                                        >
                                                                                                                       ) @ #t2.15 )
                                                                                                                  case eventTPMSendCommandTPMCreateswstatenilTPMCCPolicyPCRnil_0_11111111111112111
                                                                                                                  solve( state_11111111111112111( ~RouterID.1,
                                                                                                                                                  ~ServerID.1,
                                                                                                                                                  ~ak_h.1,
                                                                                                                                                  ~ak_sk.1,
                                                                                                                                                  ~ssk_nms.1,
                                                                                                                                                  ~tid.1
                                                                                                                         ) ▶₀ #t2.11 )
                                                                                                                    case outTPMPCRExtendswstate_0_1111111111111211
                                                                                                                    by solve( !KU( ~ssk_nms
                                                                                                                              ) @ #vk.23 )
                                                                                                                  qed
                                                                                                                qed
                                                                                                              qed
                                                                                                            qed
                                                                                                          qed
                                                                                                        qed
                                                                                                      qed
                                                                                                    qed
                                                                                                  qed
                                                                                                qed
                                                                                              qed
                                                                                            next
                                                                                              case case_2
                                                                                              by contradiction
                                                                                                 /*
                                                                                                 from formulas
                                                                                                 */
                                                                                            qed
                                                                                          qed
                                                                                        next
                                                                                          case case_2
                                                                                          solve( state_1111111111111111111111121111111( ~RouterID.1,
                                                                                                                                        ~ServerID.1,
                                                                                                                                        ~ak_h.1,
                                                                                                                                        ~ak_sk.1,
                                                                                                                                        ~ssk_nms.1,
                                                                                                                                        pL,
                                                                                                                                        pcrL,
                                                                                                                                        s_h,
                                                                                                                                        ~n.3
                                                                                                 ) ▶₀ #t2.9 )
                                                                                            case insertpolicyDigestshpcrLTPMCCPolicyPCRpL_0_111111111111111111111112111111
                                                                                            solve( (#t2.10 < #t2.17)  ∥
                                                                                                   (#t2.10 =
                                                                                                    #t2.17) )
                                                                                              case case_1
                                                                                              by contradiction
                                                                                                 /*
                                                                                                 from formulas
                                                                                                 */
                                                                                            next
                                                                                              case case_2
                                                                                              solve( (#t2.16 < #t2.12)  ∥
                                                                                                     (#t2.16 =
                                                                                                      #t2.12)  ∥
                                                                                                     (#vr.71 < #t2.16) )
                                                                                                case case_1
                                                                                                by contradiction
                                                                                                   /*
                                                                                                   from formulas
                                                                                                   */
                                                                                              next
                                                                                                case case_2
                                                                                                by contradiction
                                                                                                   /*
                                                                                                   from formulas
                                                                                                   */
                                                                                              next
                                                                                                case case_3
                                                                                                solve( (#t2.14 < #t2.16)  ∥
                                                                                                       (#t2.14 =
                                                                                                        #t2.16) )
                                                                                                  case case_1
                                                                                                  by contradiction
                                                                                                     /*
                                                                                                     from formulas
                                                                                                     */
                                                                                                next
                                                                                                  case case_2
                                                                                                  solve( TPM_SendCommand( <
                                                                                                                           'TPM2_PolicyPCR', 
                                                                                                                           k_sh
                                                                                                                          >
                                                                                                         ) @ #t2.13 )
                                                                                                    case eventTPMSendCommandTPMPolicyPCRtlssh_0_1111111111111211111111111
                                                                                                    solve( state_1111111111111211111111111( ~RouterID.1,
                                                                                                                                            ~ServerID.1,
                                                                                                                                            ~ak_h.1,
                                                                                                                                            ~ak_sk.1,
                                                                                                                                            ~ssk_nms.1,
                                                                                                                                            ~tid.1,
                                                                                                                                            tls_h,
                                                                                                                                            k_sh,
                                                                                                                                            tls_spk
                                                                                                           ) ▶₀ #t2.11 )
                                                                                                      case eventGenerateTLStidtlsspk_0_111111111111121111111111
                                                                                                      solve( TPM_SendCommand( <
                                                                                                                               'TPM2_PolicyPCR', 
                                                                                                                               k_sh
                                                                                                                              >
                                                                                                             ) @ #t2.15 )
                                                                                                        case eventTPMSendCommandTPMPolicyPCRtlssh_0_1111111111111211111111111
                                                                                                        solve( state_1111111111111211111111111( ~RouterID.1,
                                                                                                                                                ~ServerID.1,
                                                                                                                                                ~ak_h.1,
                                                                                                                                                ~ak_sk.1,
                                                                                                                                                ~ssk_nms.1,
                                                                                                                                                ~tid.1,
                                                                                                                                                tls_h,
                                                                                                                                                k_sh,
                                                                                                                                                tls_spk
                                                                                                               ) ▶₀ #t2.12 )
                                                                                                          case eventGenerateTLStidtlsspk_0_111111111111121111111111
                                                                                                          solve( TPM_SendCommand( <
                                                                                                                                   'TPM2_Create', 
                                                                                                                                   <
                                                                                                                                    swstate, 
                                                                                                                                    nil
                                                                                                                                   >, 
                                                                                                                                   'TPM_CC_PolicyPCR', 
                                                                                                                                   nil
                                                                                                                                  >
                                                                                                                 ) @ #t2.15 )
                                                                                                            case eventTPMSendCommandTPMCreateswstatenilTPMCCPolicyPCRnil_0_11111111111112111
                                                                                                            solve( state_11111111111112111( ~RouterID.1,
                                                                                                                                            ~ServerID.1,
                                                                                                                                            ~ak_h.1,
                                                                                                                                            ~ak_sk.1,
                                                                                                                                            ~ssk_nms.1,
                                                                                                                                            ~tid.1
                                                                                                                   ) ▶₀ #t2.12 )
                                                                                                              case outTPMPCRExtendswstate_0_1111111111111211
                                                                                                              solve( TPM_SendCommand( <
                                                                                                                                       'TPM2_Create', 
                                                                                                                                       <
                                                                                                                                        swstate, 
                                                                                                                                        nil
                                                                                                                                       >, 
                                                                                                                                       'TPM_CC_PolicyPCR', 
                                                                                                                                       nil
                                                                                                                                      >
                                                                                                                     ) @ #t2.15 )
                                                                                                                case eventTPMSendCommandTPMCreateswstatenilTPMCCPolicyPCRnil_0_11111111111112111
                                                                                                                solve( state_11111111111112111( ~RouterID.1,
                                                                                                                                                ~ServerID.1,
                                                                                                                                                ~ak_h.1,
                                                                                                                                                ~ak_sk.1,
                                                                                                                                                ~ssk_nms.1,
                                                                                                                                                ~tid.1
                                                                                                                       ) ▶₀ #t2.12 )
                                                                                                                  case outTPMPCRExtendswstate_0_1111111111111211
                                                                                                                  by solve( !KU( ~ssk_nms
                                                                                                                            ) @ #vk.23 )
                                                                                                                qed
                                                                                                              qed
                                                                                                            qed
                                                                                                          qed
                                                                                                        qed
                                                                                                      qed
                                                                                                    qed
                                                                                                  qed
                                                                                                qed
                                                                                              qed
                                                                                            qed
                                                                                          qed
                                                                                        qed
                                                                                      qed
                                                                                    qed
                                                                                  qed
                                                                                qed
                                                                              qed
                                                                            qed
                                                                          qed
                                                                        qed
                                                                      qed
                                                                    qed
                                                                  qed
                                                                qed
                                                              qed
                                                            qed
                                                          qed
                                                        next
                                                          case case_2
                                                          by contradiction /* from formulas */
                                                        qed
                                                      qed
                                                    qed
                                                  qed
                                                qed
                                              next
                                                case unlockdevice_0_11111111111111111111211111112
                                                by solve( state_11111111111111111111211111112( ~RouterID.1,
                                                                                               ~ServerID.1,
                                                                                               ~ak_h.1,
                                                                                               ~ak_sk.1,
                                                                                               ~ssk_nms.1,
                                                                                               a_h, obj_ap,
                                                                                               obj_h, obj_pd,
                                                                                               obj_pk, obj_sh,
                                                                                               ~n.2
                                                          ) ▶₀ #t2.7 )
                                              qed
                                            qed
                                          next
                                            case case_2
                                            solve( (#t2.8 < #t2.10)  ∥ (#t2.8 = #t2.10)  ∥ (#vr.71 < #t2.8) )
                                              case case_1
                                              by contradiction /* from formulas */
                                            next
                                              case case_2
                                              solve( Unlock_4( '4', ~n.2, 'device' ) @ #t2.9 )
                                                case unlockdevice_0_111111111111111111112111111111
                                                solve( state_111111111111111111112111111111( ~RouterID.1,
                                                                                             ~ServerID.1,
                                                                                             ~ak_h.1,
                                                                                             ~ak_sk.1,
                                                                                             ~ssk_nms.1, a_h,
                                                                                             a_sk, obj_ap,
                                                                                             obj_h, obj_pd,
                                                                                             obj_pk, obj_sh,
                                                                                             ~n.2
                                                       ) ▶₀ #t2.8 )
                                                  case outsignobjpkobjapask_0_11111111111111111111211111111
                                                  solve( (#t2.3 < #t2.14)  ∥ (#t2.3 = #t2.14) )
                                                    case case_1
                                                    by contradiction /* from formulas */
                                                  next
                                                    case case_2
                                                    solve( (#t2.6 < #t2.13)  ∥ (#t2.6 = #t2.13) )
                                                      case case_1
                                                      by contradiction /* from formulas */
                                                    next
                                                      case case_2
                                                      solve( (#t2.7 < #t2.12)  ∥ (#t2.7 = #t2.12) )
                                                        case case_1
                                                        by contradiction /* from formulas */
                                                      next
                                                        case case_2
                                                        solve( (#t2.9 < #t2.12)  ∥ (#t2.9 = #t2.12) )
                                                          case case_1
                                                          by contradiction /* from formulas */
                                                        next
                                                          case case_2
                                                          solve( TPM_SendCommand( <'TPM2_Create', 
                                                                                   <swstate, nil>, 
                                                                                   'TPM_CC_PolicyPCR', nil>
                                                                 ) @ #t2.10 )
                                                            case eventTPMSendCommandTPMCreateswstatenilTPMCCPolicyPCRnil_0_11111111111112111
                                                            solve( state_11111111111112111( ~RouterID.1,
                                                                                            ~ServerID.1,
                                                                                            ~ak_h.1, ~ak_sk.1,
                                                                                            ~ssk_nms.1, ~tid.1
                                                                   ) ▶₀ #t2.9 )
                                                              case outTPMPCRExtendswstate_0_1111111111111211
                                                              solve( TPM_SendCommand( <'TPM2_Certify', k_sh, 
                                                                                       ~k_h, ~ak_h>
                                                                     ) @ #t2.10 )
                                                                case eventTPMSendCommandTPMCertifytlsshtlshakh_0_111111111111121111111111111
                                                                solve( state_111111111111121111111111111( ~RouterID.1,
                                                                                                          ~ServerID.1,
                                                                                                          ~ak_h,
                                                                                                          ~ak_sk.1,
                                                                                                          ~ssk_nms.1,
                                                                                                          ~tid.1,
                                                                                                          ~k_h,
                                                                                                          k_sh,
                                                                                                          tls_spk
                                                                       ) ▶₀ #t2.9 )
                                                                  case outTPMPolicyPCRtlssh_0_11111111111112111111111111
                                                                  solve( TPM_SendCommand( <'TPM2_Create', 
                                                                                           <swstate, nil>, 
                                                                                           'TPM_CC_PolicyPCR', 
                                                                                           nil>
                                                                         ) @ #t2.10 )
                                                                    case eventTPMSendCommandTPMCreateswstatenilTPMCCPolicyPCRnil_0_11111111111112111
                                                                    solve( state_11111111111112111( ~RouterID.1,
                                                                                                    ~ServerID.1,
                                                                                                    ~ak_h.1,
                                                                                                    ~ak_sk.1,
                                                                                                    ~ssk_nms.1,
                                                                                                    ~tid.1
                                                                           ) ▶₀ #t2.9 )
                                                                      case outTPMPCRExtendswstate_0_1111111111111211
                                                                      solve( Insert( <'privatePart', ~k_h>,
                                                                                     k_sk.1
                                                                             ) @ #t2.2 )
                                                                        case insertprivatePartkhksk_0_111111111111111111111121111111
                                                                        solve( Insert( <'authPolicy', ~k_h>,
                                                                                       k_ap
                                                                               ) @ #t2.3 )
                                                                          case insertauthPolicykhauthPolicy_0_11111111111111111111112111111
                                                                          solve( Insert( <'policyDigest', k_sh
                                                                                         >,
                                                                                         <<swstate, nil>, 
                                                                                          'TPM_CC_PolicyPCR', 
                                                                                          nil>
                                                                                 ) @ #t2.9 )
                                                                            case insertpolicyDigestshpcrLTPMCCPolicyPCRpL_0_111111111111111111111112111111
                                                                            solve( state_111111111111111111111112111111( ~RouterID.1,
                                                                                                                         ~ServerID.1,
                                                                                                                         ~ak_h.1,
                                                                                                                         ~ak_sk.1,
                                                                                                                         ~ssk_nms.1,
                                                                                                                         nil,
                                                                                                                         <
                                                                                                                          swstate, 
                                                                                                                          nil
                                                                                                                         >,
                                                                                                                         k_sh,
                                                                                                                         lock
                                                                                   ) ▶₀ #t2.9 )
                                                                              case eventPolicyPCRshpL_0_11111111111111111111111211111
                                                                              solve( (#vr.81 < #vr.45)  ∥
                                                                                     (#t2 < #vr.81) )
                                                                                case case_1
                                                                                solve( (#vr.28 < #t2.13)  ∥
                                                                                       (#vr.28 = #t2.13) )
                                                                                  case case_1
                                                                                  solve( state_1111111111111111111111121111111( ~RouterID.1,
                                                                                                                                ~ServerID.1,
                                                                                                                                ~ak_h.1,
                                                                                                                                ~ak_sk.1,
                                                                                                                                ~ssk_nms.1,
                                                                                                                                pL,
                                                                                                                                pcrL,
                                                                                                                                s_h,
                                                                                                                                ~n.3
                                                                                         ) ▶₀ #t2.10 )
                                                                                    case insertpolicyDigestshpcrLTPMCCPolicyPCRpL_0_111111111111111111111112111111
                                                                                    solve( (#vr.28 < #t2.16)  ∥
                                                                                           (#vr.28 = #t2.16) )
                                                                                      case case_1
                                                                                      solve( (#t2.13 < #t2.16)  ∥
                                                                                             (#t2.13 =
                                                                                              #t2.16) )
                                                                                        case case_1
                                                                                        by contradiction
                                                                                           /* from formulas */
                                                                                      next
                                                                                        case case_2
                                                                                        solve( (#t2.12 < #t2.15)  ∥
                                                                                               (#t2.12 =
                                                                                                #t2.15) )
                                                                                          case case_1
                                                                                          by contradiction
                                                                                             /* from formulas
                                                                                             */
                                                                                        next
                                                                                          case case_2
                                                                                          solve( TPM_SendCommand( <
                                                                                                                   'TPM2_PolicyPCR', 
                                                                                                                   k_sh
                                                                                                                  >
                                                                                                 ) @ #t2.11 )
                                                                                            case eventTPMSendCommandTPMPolicyPCRtlssh_0_1111111111111211111111111
                                                                                            solve( state_1111111111111211111111111( ~RouterID.1,
                                                                                                                                    ~ServerID.1,
                                                                                                                                    ~ak_h.1,
                                                                                                                                    ~ak_sk.1,
                                                                                                                                    ~ssk_nms.1,
                                                                                                                                    ~tid.1,
                                                                                                                                    tls_h,
                                                                                                                                    k_sh,
                                                                                                                                    tls_spk
                                                                                                   ) ▶₀ #t2.11 )
                                                                                              case eventGenerateTLStidtlsspk_0_111111111111121111111111
                                                                                              by contradiction
                                                                                                 /* cyclic */
                                                                                            qed
                                                                                          qed
                                                                                        qed
                                                                                      qed
                                                                                    next
                                                                                      case case_2
                                                                                      by contradiction
                                                                                         /* from formulas */
                                                                                    qed
                                                                                  qed
                                                                                next
                                                                                  case case_2
                                                                                  solve( state_1111111111111111111111121111111( ~RouterID.1,
                                                                                                                                ~ServerID.1,
                                                                                                                                ~ak_h.1,
                                                                                                                                ~ak_sk.1,
                                                                                                                                ~ssk_nms.1,
                                                                                                                                pL,
                                                                                                                                pcrL,
                                                                                                                                s_h,
                                                                                                                                ~n.3
                                                                                         ) ▶₀ #t2.10 )
                                                                                    case insertpolicyDigestshpcrLTPMCCPolicyPCRpL_0_111111111111111111111112111111
                                                                                    solve( (#t2.11 < #t2.16)  ∥
                                                                                           (#t2.11 = #t2.16) )
                                                                                      case case_1
                                                                                      by contradiction
                                                                                         /* from formulas */
                                                                                    next
                                                                                      case case_2
                                                                                      solve( (#t2.13 < #t2.15)  ∥
                                                                                             (#t2.13 =
                                                                                              #t2.15) )
                                                                                        case case_1
                                                                                        by contradiction
                                                                                           /* from formulas */
                                                                                      next
                                                                                        case case_2
                                                                                        solve( TPM_SendCommand( <
                                                                                                                 'TPM2_PolicyPCR', 
                                                                                                                 k_sh
                                                                                                                >
                                                                                               ) @ #t2.12 )
                                                                                          case eventTPMSendCommandTPMPolicyPCRtlssh_0_1111111111111211111111111
                                                                                          solve( state_1111111111111211111111111( ~RouterID.1,
                                                                                                                                  ~ServerID.1,
                                                                                                                                  ~ak_h.1,
                                                                                                                                  ~ak_sk.1,
                                                                                                                                  ~ssk_nms.1,
                                                                                                                                  ~tid.1,
                                                                                                                                  tls_h,
                                                                                                                                  k_sh,
                                                                                                                                  tls_spk
                                                                                                 ) ▶₀ #t2.12 )
                                                                                            case eventGenerateTLStidtlsspk_0_111111111111121111111111
                                                                                            by contradiction
                                                                                               /* cyclic */
                                                                                          qed
                                                                                        qed
                                                                                      qed
                                                                                    qed
                                                                                  qed
                                                                                qed
                                                                              next
                                                                                case case_2
                                                                                solve( (#vr.28 < #t2.13)  ∥
                                                                                       (#vr.28 = #t2.13) )
                                                                                  case case_1
                                                                                  solve( state_1111111111111111111111121111111( ~RouterID.1,
                                                                                                                                ~ServerID.1,
                                                                                                                                ~ak_h.1,
                                                                                                                                ~ak_sk.1,
                                                                                                                                ~ssk_nms.1,
                                                                                                                                pL,
                                                                                                                                pcrL,
                                                                                                                                s_h,
                                                                                                                                ~n.3
                                                                                         ) ▶₀ #t2.10 )
                                                                                    case insertpolicyDigestshpcrLTPMCCPolicyPCRpL_0_111111111111111111111112111111
                                                                                    solve( (#vr.28 < #t2.16)  ∥
                                                                                           (#vr.28 = #t2.16) )
                                                                                      case case_1
                                                                                      solve( (#t2.13 < #t2.16)  ∥
                                                                                             (#t2.13 =
                                                                                              #t2.16) )
                                                                                        case case_1
                                                                                        by contradiction
                                                                                           /* from formulas */
                                                                                      next
                                                                                        case case_2
                                                                                        solve( (#t2.12 < #t2.15)  ∥
                                                                                               (#t2.12 =
                                                                                                #t2.15) )
                                                                                          case case_1
                                                                                          by contradiction
                                                                                             /* from formulas
                                                                                             */
                                                                                        next
                                                                                          case case_2
                                                                                          solve( TPM_SendCommand( <
                                                                                                                   'TPM2_PolicyPCR', 
                                                                                                                   k_sh
                                                                                                                  >
                                                                                                 ) @ #t2.11 )
                                                                                            case eventTPMSendCommandTPMPolicyPCRtlssh_0_1111111111111211111111111
                                                                                            solve( state_1111111111111211111111111( ~RouterID.1,
                                                                                                                                    ~ServerID.1,
                                                                                                                                    ~ak_h.1,
                                                                                                                                    ~ak_sk.1,
                                                                                                                                    ~ssk_nms.1,
                                                                                                                                    ~tid.1,
                                                                                                                                    tls_h,
                                                                                                                                    k_sh,
                                                                                                                                    tls_spk
                                                                                                   ) ▶₀ #t2.11 )
                                                                                              case eventGenerateTLStidtlsspk_0_111111111111121111111111
                                                                                              solve( TPM_SendCommand( <
                                                                                                                       'TPM2_PolicyPCR', 
                                                                                                                       k_sh
                                                                                                                      >
                                                                                                     ) @ #t2.14 )
                                                                                                case eventTPMSendCommandTPMPolicyPCRtlssh_0_1111111111111211111111111
                                                                                                solve( state_1111111111111211111111111( ~RouterID.1,
                                                                                                                                        ~ServerID.1,
                                                                                                                                        ~ak_h.1,
                                                                                                                                        ~ak_sk.1,
                                                                                                                                        ~ssk_nms.1,
                                                                                                                                        ~tid.1,
                                                                                                                                        tls_h,
                                                                                                                                        k_sh,
                                                                                                                                        tls_spk
                                                                                                       ) ▶₀ #t2.12 )
                                                                                                  case eventGenerateTLStidtlsspk_0_111111111111121111111111
                                                                                                  solve( TPM_SendCommand( <
                                                                                                                           'TPM2_Create', 
                                                                                                                           <
                                                                                                                            swstate, 
                                                                                                                            nil
                                                                                                                           >, 
                                                                                                                           'TPM_CC_PolicyPCR', 
                                                                                                                           nil
                                                                                                                          >
                                                                                                         ) @ #t2.14 )
                                                                                                    case eventTPMSendCommandTPMCreateswstatenilTPMCCPolicyPCRnil_0_11111111111112111
                                                                                                    solve( state_11111111111112111( ~RouterID.1,
                                                                                                                                    ~ServerID.1,
                                                                                                                                    ~ak_h.1,
                                                                                                                                    ~ak_sk.1,
                                                                                                                                    ~ssk_nms.1,
                                                                                                                                    ~tid.1
                                                                                                           ) ▶₀ #t2.12 )
                                                                                                      case outTPMPCRExtendswstate_0_1111111111111211
                                                                                                      solve( TPM_SendCommand( <
                                                                                                                               'TPM2_Create', 
                                                                                                                               <
                                                                                                                                swstate, 
                                                                                                                                nil
                                                                                                                               >, 
                                                                                                                               'TPM_CC_PolicyPCR', 
                                                                                                                               nil
                                                                                                                              >
                                                                                                             ) @ #t2.14 )
                                                                                                        case eventTPMSendCommandTPMCreateswstatenilTPMCCPolicyPCRnil_0_11111111111112111
                                                                                                        solve( state_11111111111112111( ~RouterID.1,
                                                                                                                                        ~ServerID.1,
                                                                                                                                        ~ak_h.1,
                                                                                                                                        ~ak_sk.1,
                                                                                                                                        ~ssk_nms.1,
                                                                                                                                        ~tid.1
                                                                                                               ) ▶₀ #t2.12 )
                                                                                                          case outTPMPCRExtendswstate_0_1111111111111211
                                                                                                          by solve( !KU( ~ssk_nms
                                                                                                                    ) @ #vk.23 )
                                                                                                        qed
                                                                                                      qed
                                                                                                    qed
                                                                                                  qed
                                                                                                qed
                                                                                              qed
                                                                                            qed
                                                                                          qed
                                                                                        qed
                                                                                      qed
                                                                                    next
                                                                                      case case_2
                                                                                      by contradiction
                                                                                         /* from formulas */
                                                                                    qed
                                                                                  qed
                                                                                next
                                                                                  case case_2
                                                                                  solve( state_1111111111111111111111121111111( ~RouterID.1,
                                                                                                                                ~ServerID.1,
                                                                                                                                ~ak_h.1,
                                                                                                                                ~ak_sk.1,
                                                                                                                                ~ssk_nms.1,
                                                                                                                                pL,
                                                                                                                                pcrL,
                                                                                                                                s_h,
                                                                                                                                ~n.3
                                                                                         ) ▶₀ #t2.10 )
                                                                                    case insertpolicyDigestshpcrLTPMCCPolicyPCRpL_0_111111111111111111111112111111
                                                                                    solve( (#t2.11 < #t2.16)  ∥
                                                                                           (#t2.11 = #t2.16) )
                                                                                      case case_1
                                                                                      by contradiction
                                                                                         /* from formulas */
                                                                                    next
                                                                                      case case_2
                                                                                      solve( (#t2.13 < #t2.15)  ∥
                                                                                             (#t2.13 =
                                                                                              #t2.15) )
                                                                                        case case_1
                                                                                        by contradiction
                                                                                           /* from formulas */
                                                                                      next
                                                                                        case case_2
                                                                                        solve( TPM_SendCommand( <
                                                                                                                 'TPM2_PolicyPCR', 
                                                                                                                 k_sh
                                                                                                                >
                                                                                               ) @ #t2.12 )
                                                                                          case eventTPMSendCommandTPMPolicyPCRtlssh_0_1111111111111211111111111
                                                                                          solve( state_1111111111111211111111111( ~RouterID.1,
                                                                                                                                  ~ServerID.1,
                                                                                                                                  ~ak_h.1,
                                                                                                                                  ~ak_sk.1,
                                                                                                                                  ~ssk_nms.1,
                                                                                                                                  ~tid.1,
                                                                                                                                  tls_h,
                                                                                                                                  k_sh,
                                                                                                                                  tls_spk
                                                                                                 ) ▶₀ #t2.12 )
                                                                                            case eventGenerateTLStidtlsspk_0_111111111111121111111111
                                                                                            solve( TPM_SendCommand( <
                                                                                                                     'TPM2_PolicyPCR', 
                                                                                                                     k_sh
                                                                                                                    >
                                                                                                   ) @ #t2.14 )
                                                                                              case eventTPMSendCommandTPMPolicyPCRtlssh_0_1111111111111211111111111
                                                                                              solve( state_1111111111111211111111111( ~RouterID.1,
                                                                                                                                      ~ServerID.1,
                                                                                                                                      ~ak_h.1,
                                                                                                                                      ~ak_sk.1,
                                                                                                                                      ~ssk_nms.1,
                                                                                                                                      ~tid.1,
                                                                                                                                      tls_h,
                                                                                                                                      k_sh,
                                                                                                                                      tls_spk
                                                                                                     ) ▶₀ #t2.13 )
                                                                                                case eventGenerateTLStidtlsspk_0_111111111111121111111111
                                                                                                solve( TPM_SendCommand( <
                                                                                                                         'TPM2_Create', 
                                                                                                                         <
                                                                                                                          swstate, 
                                                                                                                          nil
                                                                                                                         >, 
                                                                                                                         'TPM_CC_PolicyPCR', 
                                                                                                                         nil
                                                                                                                        >
                                                                                                       ) @ #t2.14 )
                                                                                                  case eventTPMSendCommandTPMCreateswstatenilTPMCCPolicyPCRnil_0_11111111111112111
                                                                                                  solve( state_11111111111112111( ~RouterID.1,
                                                                                                                                  ~ServerID.1,
                                                                                                                                  ~ak_h.1,
                                                                                                                                  ~ak_sk.1,
                                                                                                                                  ~ssk_nms.1,
                                                                                                                                  ~tid.1
                                                                                                         ) ▶₀ #t2.13 )
                                                                                                    case outTPMPCRExtendswstate_0_1111111111111211
                                                                                                    solve( TPM_SendCommand( <
                                                                                                                             'TPM2_Create', 
                                                                                                                             <
                                                                                                                              swstate, 
                                                                                                                              nil
                                                                                                                             >, 
                                                                                                                             'TPM_CC_PolicyPCR', 
                                                                                                                             nil
                                                                                                                            >
                                                                                                           ) @ #t2.14 )
                                                                                                      case eventTPMSendCommandTPMCreateswstatenilTPMCCPolicyPCRnil_0_11111111111112111
                                                                                                      solve( state_11111111111112111( ~RouterID.1,
                                                                                                                                      ~ServerID.1,
                                                                                                                                      ~ak_h.1,
                                                                                                                                      ~ak_sk.1,
                                                                                                                                      ~ssk_nms.1,
                                                                                                                                      ~tid.1
                                                                                                             ) ▶₀ #t2.13 )
                                                                                                        case outTPMPCRExtendswstate_0_1111111111111211
                                                                                                        by solve( !KU( ~ssk_nms
                                                                                                                  ) @ #vk.23 )
                                                                                                      qed
                                                                                                    qed
                                                                                                  qed
                                                                                                qed
                                                                                              qed
                                                                                            qed
                                                                                          qed
                                                                                        qed
                                                                                      qed
                                                                                    qed
                                                                                  qed
                                                                                qed
                                                                              qed
                                                                            qed
                                                                          qed
                                                                        qed
                                                                      qed
                                                                    qed
                                                                  qed
                                                                qed
                                                              qed
                                                            qed
                                                          qed
                                                        qed
                                                      qed
                                                    qed
                                                  qed
                                                qed
                                              next
                                                case unlockdevice_0_11111111111111111111211111112
                                                by solve( state_11111111111111111111211111112( ~RouterID.1,
                                                                                               ~ServerID.1,
                                                                                               ~ak_h.1,
                                                                                               ~ak_sk.1,
                                                                                               ~ssk_nms.1,
                                                                                               a_h, obj_ap,
                                                                                               obj_h, obj_pd,
                                                                                               obj_pk, obj_sh,
                                                                                               ~n.2
                                                          ) ▶₀ #t2.8 )
                                              qed
                                            next
                                              case case_3
                                              solve( Unlock_4( '4', ~n.2, 'device' ) @ #t2.9 )
                                                case unlockdevice_0_111111111111111111112111111111
                                                solve( state_111111111111111111112111111111( ~RouterID.1,
                                                                                             ~ServerID.1,
                                                                                             ~ak_h.1,
                                                                                             ~ak_sk.1,
                                                                                             ~ssk_nms.1, a_h,
                                                                                             a_sk, obj_ap,
                                                                                             obj_h, obj_pd,
                                                                                             obj_pk, obj_sh,
                                                                                             ~n.2
                                                       ) ▶₀ #t2.8 )
                                                  case outsignobjpkobjapask_0_11111111111111111111211111111
                                                  solve( (#t2.3 < #t2.15)  ∥ (#t2.3 = #t2.15) )
                                                    case case_1
                                                    by contradiction /* from formulas */
                                                  next
                                                    case case_2
                                                    solve( (#t2.6 < #t2.14)  ∥ (#t2.6 = #t2.14) )
                                                      case case_1
                                                      by contradiction /* from formulas */
                                                    next
                                                      case case_2
                                                      solve( (#t2.7 < #t2.13)  ∥ (#t2.7 = #t2.13) )
                                                        case case_1
                                                        by contradiction /* from formulas */
                                                      next
                                                        case case_2
                                                        solve( (#t2.10 < #t2.13)  ∥ (#t2.10 = #t2.13) )
                                                          case case_1
                                                          by contradiction /* from formulas */
                                                        next
                                                          case case_2
                                                          solve( TPM_SendCommand( <'TPM2_Create', 
                                                                                   <swstate, nil>, 
                                                                                   'TPM_CC_PolicyPCR', nil>
                                                                 ) @ #t2.11 )
                                                            case eventTPMSendCommandTPMCreateswstatenilTPMCCPolicyPCRnil_0_11111111111112111
                                                            solve( state_11111111111112111( ~RouterID.1,
                                                                                            ~ServerID.1,
                                                                                            ~ak_h.1, ~ak_sk.1,
                                                                                            ~ssk_nms.1, ~tid.1
                                                                   ) ▶₀ #t2.9 )
                                                              case outTPMPCRExtendswstate_0_1111111111111211
                                                              solve( TPM_SendCommand( <'TPM2_Certify', k_sh, 
                                                                                       ~k_h, ~ak_h>
                                                                     ) @ #t2.11 )
                                                                case eventTPMSendCommandTPMCertifytlsshtlshakh_0_111111111111121111111111111
                                                                solve( state_111111111111121111111111111( ~RouterID.1,
                                                                                                          ~ServerID.1,
                                                                                                          ~ak_h,
                                                                                                          ~ak_sk.1,
                                                                                                          ~ssk_nms.1,
                                                                                                          ~tid.1,
                                                                                                          ~k_h,
                                                                                                          k_sh,
                                                                                                          tls_spk
                                                                       ) ▶₀ #t2.9 )
                                                                  case outTPMPolicyPCRtlssh_0_11111111111112111111111111
                                                                  solve( TPM_SendCommand( <'TPM2_Create', 
                                                                                           <swstate, nil>, 
                                                                                           'TPM_CC_PolicyPCR', 
                                                                                           nil>
                                                                         ) @ #t2.11 )
                                                                    case eventTPMSendCommandTPMCreateswstatenilTPMCCPolicyPCRnil_0_11111111111112111
                                                                    solve( state_11111111111112111( ~RouterID.1,
                                                                                                    ~ServerID.1,
                                                                                                    ~ak_h.1,
                                                                                                    ~ak_sk.1,
                                                                                                    ~ssk_nms.1,
                                                                                                    ~tid.1
                                                                           ) ▶₀ #t2.9 )
                                                                      case outTPMPCRExtendswstate_0_1111111111111211
                                                                      solve( Insert( <'privatePart', ~k_h>,
                                                                                     k_sk.1
                                                                             ) @ #t2.2 )
                                                                        case insertprivatePartkhksk_0_111111111111111111111121111111
                                                                        solve( Insert( <'authPolicy', ~k_h>,
                                                                                       k_ap
                                                                               ) @ #t2.3 )
                                                                          case insertauthPolicykhauthPolicy_0_11111111111111111111112111111
                                                                          solve( Insert( <'policyDigest', k_sh
                                                                                         >,
                                                                                         <<swstate, nil>, 
                                                                                          'TPM_CC_PolicyPCR', 
                                                                                          nil>
                                                                                 ) @ #t2.9 )
                                                                            case insertpolicyDigestshpcrLTPMCCPolicyPCRpL_0_111111111111111111111112111111
                                                                            solve( state_111111111111111111111112111111( ~RouterID.1,
                                                                                                                         ~ServerID.1,
                                                                                                                         ~ak_h.1,
                                                                                                                         ~ak_sk.1,
                                                                                                                         ~ssk_nms.1,
                                                                                                                         nil,
                                                                                                                         <
                                                                                                                          swstate, 
                                                                                                                          nil
                                                                                                                         >,
                                                                                                                         k_sh,
                                                                                                                         lock
                                                                                   ) ▶₀ #t2.9 )
                                                                              case eventPolicyPCRshpL_0_11111111111111111111111211111
                                                                              solve( (#vr.81 < #vr.45)  ∥
                                                                                     (#t2 < #vr.81) )
                                                                                case case_1
                                                                                solve( (#t2.13 < #t2.11)  ∥
                                                                                       (#t2.13 = #t2.11)  ∥
                                                                                       (#vr.71 < #t2.13) )
                                                                                  case case_1
                                                                                  solve( (#vr.28 < #t2.14)  ∥
                                                                                         (#vr.28 = #t2.14) )
                                                                                    case case_1
                                                                                    solve( state_1111111111111111111111121111111( ~RouterID.1,
                                                                                                                                  ~ServerID.1,
                                                                                                                                  ~ak_h.1,
                                                                                                                                  ~ak_sk.1,
                                                                                                                                  ~ssk_nms.1,
                                                                                                                                  pL,
                                                                                                                                  pcrL,
                                                                                                                                  s_h,
                                                                                                                                  ~n.3
                                                                                           ) ▶₀ #t2.10 )
                                                                                      case insertpolicyDigestshpcrLTPMCCPolicyPCRpL_0_111111111111111111111112111111
                                                                                      by contradiction
                                                                                         /* cyclic */
                                                                                    qed
                                                                                  next
                                                                                    case case_2
                                                                                    solve( state_1111111111111111111111121111111( ~RouterID.1,
                                                                                                                                  ~ServerID.1,
                                                                                                                                  ~ak_h.1,
                                                                                                                                  ~ak_sk.1,
                                                                                                                                  ~ssk_nms.1,
                                                                                                                                  pL,
                                                                                                                                  pcrL,
                                                                                                                                  s_h,
                                                                                                                                  ~n.3
                                                                                           ) ▶₀ #t2.10 )
                                                                                      case insertpolicyDigestshpcrLTPMCCPolicyPCRpL_0_111111111111111111111112111111
                                                                                      by contradiction
                                                                                         /* cyclic */
                                                                                    qed
                                                                                  qed
                                                                                next
                                                                                  case case_2
                                                                                  solve( (#vr.28 < #t2.13)  ∥
                                                                                         (#vr.28 = #t2.13) )
                                                                                    case case_1
                                                                                    solve( state_1111111111111111111111121111111( ~RouterID.1,
                                                                                                                                  ~ServerID.1,
                                                                                                                                  ~ak_h.1,
                                                                                                                                  ~ak_sk.1,
                                                                                                                                  ~ssk_nms.1,
                                                                                                                                  pL,
                                                                                                                                  pcrL,
                                                                                                                                  s_h,
                                                                                                                                  ~n.3
                                                                                           ) ▶₀ #t2.10 )
                                                                                      case insertpolicyDigestshpcrLTPMCCPolicyPCRpL_0_111111111111111111111112111111
                                                                                      by contradiction
                                                                                         /* cyclic */
                                                                                    qed
                                                                                  next
                                                                                    case case_2
                                                                                    solve( state_1111111111111111111111121111111( ~RouterID.1,
                                                                                                                                  ~ServerID.1,
                                                                                                                                  ~ak_h.1,
                                                                                                                                  ~ak_sk.1,
                                                                                                                                  ~ssk_nms.1,
                                                                                                                                  pL,
                                                                                                                                  pcrL,
                                                                                                                                  s_h,
                                                                                                                                  ~n.3
                                                                                           ) ▶₀ #t2.10 )
                                                                                      case insertpolicyDigestshpcrLTPMCCPolicyPCRpL_0_111111111111111111111112111111
                                                                                      by contradiction
                                                                                         /* cyclic */
                                                                                    qed
                                                                                  qed
                                                                                next
                                                                                  case case_3
                                                                                  solve( (#vr.28 < #t2.14)  ∥
                                                                                         (#vr.28 = #t2.14) )
                                                                                    case case_1
                                                                                    solve( state_1111111111111111111111121111111( ~RouterID.1,
                                                                                                                                  ~ServerID.1,
                                                                                                                                  ~ak_h.1,
                                                                                                                                  ~ak_sk.1,
                                                                                                                                  ~ssk_nms.1,
                                                                                                                                  pL,
                                                                                                                                  pcrL,
                                                                                                                                  s_h,
                                                                                                                                  ~n.3
                                                                                           ) ▶₀ #t2.10 )
                                                                                      case insertpolicyDigestshpcrLTPMCCPolicyPCRpL_0_111111111111111111111112111111
                                                                                      by contradiction
                                                                                         /* cyclic */
                                                                                    qed
                                                                                  next
                                                                                    case case_2
                                                                                    solve( state_1111111111111111111111121111111( ~RouterID.1,
                                                                                                                                  ~ServerID.1,
                                                                                                                                  ~ak_h.1,
                                                                                                                                  ~ak_sk.1,
                                                                                                                                  ~ssk_nms.1,
                                                                                                                                  pL,
                                                                                                                                  pcrL,
                                                                                                                                  s_h,
                                                                                                                                  ~n.3
                                                                                           ) ▶₀ #t2.10 )
                                                                                      case insertpolicyDigestshpcrLTPMCCPolicyPCRpL_0_111111111111111111111112111111
                                                                                      by contradiction
                                                                                         /* cyclic */
                                                                                    qed
                                                                                  qed
                                                                                qed
                                                                              next
                                                                                case case_2
                                                                                solve( (#vr.81 < #vr.72)  ∥
                                                                                       (#t2.8 < #vr.81) )
                                                                                  case case_1
                                                                                  solve( (#t2.13 < #t2.11)  ∥
                                                                                         (#t2.13 = #t2.11)  ∥
                                                                                         (#vr.71 < #t2.13) )
                                                                                    case case_1
                                                                                    solve( (#vr.28 < #t2.14)  ∥
                                                                                           (#vr.28 = #t2.14) )
                                                                                      case case_1
                                                                                      solve( state_1111111111111111111111121111111( ~RouterID.1,
                                                                                                                                    ~ServerID.1,
                                                                                                                                    ~ak_h.1,
                                                                                                                                    ~ak_sk.1,
                                                                                                                                    ~ssk_nms.1,
                                                                                                                                    pL,
                                                                                                                                    pcrL,
                                                                                                                                    s_h,
                                                                                                                                    ~n.3
                                                                                             ) ▶₀ #t2.10 )
                                                                                        case insertpolicyDigestshpcrLTPMCCPolicyPCRpL_0_111111111111111111111112111111
                                                                                        by contradiction
                                                                                           /* cyclic */
                                                                                      qed
                                                                                    next
                                                                                      case case_2
                                                                                      solve( state_1111111111111111111111121111111( ~RouterID.1,
                                                                                                                                    ~ServerID.1,
                                                                                                                                    ~ak_h.1,
                                                                                                                                    ~ak_sk.1,
                                                                                                                                    ~ssk_nms.1,
                                                                                                                                    pL,
                                                                                                                                    pcrL,
                                                                                                                                    s_h,
                                                                                                                                    ~n.3
                                                                                             ) ▶₀ #t2.10 )
                                                                                        case insertpolicyDigestshpcrLTPMCCPolicyPCRpL_0_111111111111111111111112111111
                                                                                        by contradiction
                                                                                           /* cyclic */
                                                                                      qed
                                                                                    qed
                                                                                  next
                                                                                    case case_2
                                                                                    solve( (#vr.28 < #t2.13)  ∥
                                                                                           (#vr.28 = #t2.13) )
                                                                                      case case_1
                                                                                      solve( state_1111111111111111111111121111111( ~RouterID.1,
                                                                                                                                    ~ServerID.1,
                                                                                                                                    ~ak_h.1,
                                                                                                                                    ~ak_sk.1,
                                                                                                                                    ~ssk_nms.1,
                                                                                                                                    pL,
                                                                                                                                    pcrL,
                                                                                                                                    s_h,
                                                                                                                                    ~n.3
                                                                                             ) ▶₀ #t2.10 )
                                                                                        case insertpolicyDigestshpcrLTPMCCPolicyPCRpL_0_111111111111111111111112111111
                                                                                        by contradiction
                                                                                           /* cyclic */
                                                                                      qed
                                                                                    next
                                                                                      case case_2
                                                                                      solve( state_1111111111111111111111121111111( ~RouterID.1,
                                                                                                                                    ~ServerID.1,
                                                                                                                                    ~ak_h.1,
                                                                                                                                    ~ak_sk.1,
                                                                                                                                    ~ssk_nms.1,
                                                                                                                                    pL,
                                                                                                                                    pcrL,
                                                                                                                                    s_h,
                                                                                                                                    ~n.3
                                                                                             ) ▶₀ #t2.10 )
                                                                                        case insertpolicyDigestshpcrLTPMCCPolicyPCRpL_0_111111111111111111111112111111
                                                                                        by contradiction
                                                                                           /* cyclic */
                                                                                      qed
                                                                                    qed
                                                                                  next
                                                                                    case case_3
                                                                                    solve( (#vr.28 < #t2.14)  ∥
                                                                                           (#vr.28 = #t2.14) )
                                                                                      case case_1
                                                                                      solve( state_1111111111111111111111121111111( ~RouterID.1,
                                                                                                                                    ~ServerID.1,
                                                                                                                                    ~ak_h.1,
                                                                                                                                    ~ak_sk.1,
                                                                                                                                    ~ssk_nms.1,
                                                                                                                                    pL,
                                                                                                                                    pcrL,
                                                                                                                                    s_h,
                                                                                                                                    ~n.3
                                                                                             ) ▶₀ #t2.10 )
                                                                                        case insertpolicyDigestshpcrLTPMCCPolicyPCRpL_0_111111111111111111111112111111
                                                                                        by contradiction
                                                                                           /* cyclic */
                                                                                      qed
                                                                                    next
                                                                                      case case_2
                                                                                      solve( state_1111111111111111111111121111111( ~RouterID.1,
                                                                                                                                    ~ServerID.1,
                                                                                                                                    ~ak_h.1,
                                                                                                                                    ~ak_sk.1,
                                                                                                                                    ~ssk_nms.1,
                                                                                                                                    pL,
                                                                                                                                    pcrL,
                                                                                                                                    s_h,
                                                                                                                                    ~n.3
                                                                                             ) ▶₀ #t2.10 )
                                                                                        case insertpolicyDigestshpcrLTPMCCPolicyPCRpL_0_111111111111111111111112111111
                                                                                        by contradiction
                                                                                           /* cyclic */
                                                                                      qed
                                                                                    qed
                                                                                  qed
                                                                                next
                                                                                  case case_2
                                                                                  solve( ((#vr.17 < #vr.81) ∧
                                                                                          (∃ #t2.
                                                                                            (Unlock_5( '5',
                                                                                                       ~n.1,
                                                                                                       'device'
                                                                                             ) @ #t2)
                                                                                           ∧
                                                                                            (#vr.17 < #t2) ∧
                                                                                            (#t2 < #vr.81) ∧
                                                                                            (∀ #t0 pp.
                                                                                              (Unlock( pp,
                                                                                                       ~n.1,
                                                                                                       'device'
                                                                                               ) @ #t0)
                                                                                             ⇒
                                                                                              #t0 = #t2) ∧
                                                                                            (∀ pp lpp #t0.
                                                                                              (Lock( pp, lpp,
                                                                                                     'device'
                                                                                               ) @ #t0)
                                                                                             ⇒
                                                                                              ((#t0 < #vr.17) ∨
                                                                                               (#t0 =
                                                                                                #vr.17) ∨
                                                                                               (#t2 < #t0))) ∧
                                                                                            (∀ pp lpp #t0.
                                                                                              (Unlock( pp,
                                                                                                       lpp,
                                                                                                       'device'
                                                                                               ) @ #t0)
                                                                                             ⇒
                                                                                              ((#t0 < #vr.17) ∨
                                                                                               (#t2 < #t0) ∨
                                                                                               (#t2 =
                                                                                                #t0)))))  ∥
                                                                                         (#vr.81 < #vr.17) )
                                                                                    case case_1
                                                                                    solve( (#t2.12 < #t2.10)  ∥
                                                                                           (#t2.12 =
                                                                                            #t2.10)  ∥
                                                                                           (#vr.71 < #t2.12) )
                                                                                      case case_1
                                                                                      by contradiction
                                                                                         /* from formulas */
                                                                                    next
                                                                                      case case_2
                                                                                      solve( (#vr.28 < #t2.12)  ∥
                                                                                             (#vr.28 =
                                                                                              #t2.12) )
                                                                                        case case_1
                                                                                        solve( TPM_SendCommand( <
                                                                                                                 'TPM2_PolicyPCR', 
                                                                                                                 k_sh
                                                                                                                >
                                                                                               ) @ #t2.11 )
                                                                                          case eventTPMSendCommandTPMPolicyPCRtlssh_0_1111111111111211111111111
                                                                                          solve( state_1111111111111211111111111( ~RouterID.1,
                                                                                                                                  ~ServerID.1,
                                                                                                                                  ~ak_h.1,
                                                                                                                                  ~ak_sk.1,
                                                                                                                                  ~ssk_nms.1,
                                                                                                                                  ~tid.1,
                                                                                                                                  tls_h,
                                                                                                                                  k_sh,
                                                                                                                                  tls_spk
                                                                                                 ) ▶₀ #t2.10 )
                                                                                            case eventGenerateTLStidtlsspk_0_111111111111121111111111
                                                                                            solve( Unlock_5( '5',
                                                                                                             ~n.1,
                                                                                                             'device'
                                                                                                   ) @ #t2.13 )
                                                                                              case unlockdevice_0_1111111111111111111211111111
                                                                                              solve( state_1111111111111111111211111111( ~RouterID.1,
                                                                                                                                         ~ServerID.1,
                                                                                                                                         ~ak_h.1,
                                                                                                                                         ~ak_sk.1,
                                                                                                                                         ~ssk_nms.1,
                                                                                                                                         k_ap,
                                                                                                                                         k_h.1,
                                                                                                                                         k_pd,
                                                                                                                                         k_sh.1,
                                                                                                                                         k_sk.1,
                                                                                                                                         m,
                                                                                                                                         ~n.1
                                                                                                     ) ▶₀ #t2.11 )
                                                                                                case TpmSignOutsignmksk_0_111111111111111111121111111
                                                                                                by contradiction
                                                                                                   /* cyclic
                                                                                                   */
                                                                                              qed
                                                                                            next
                                                                                              case unlockdevice_0_111111111111111111121111112
                                                                                              by solve( state_111111111111111111121111112( ~RouterID.1,
                                                                                                                                           ~ServerID.1,
                                                                                                                                           ~ak_h.1,
                                                                                                                                           ~ak_sk.1,
                                                                                                                                           ~ssk_nms.1,
                                                                                                                                           k_ap,
                                                                                                                                           k_h.1,
                                                                                                                                           k_pd,
                                                                                                                                           k_sh.1,
                                                                                                                                           m,
                                                                                                                                           ~n.1
                                                                                                        ) ▶₀ #t2.11 )
                                                                                            qed
                                                                                          qed
                                                                                        qed
                                                                                      next
                                                                                        case case_2
                                                                                        solve( TPM_SendCommand( <
                                                                                                                 'TPM2_PolicyPCR', 
                                                                                                                 k_sh
                                                                                                                >
                                                                                               ) @ #t2.12 )
                                                                                          case eventTPMSendCommandTPMPolicyPCRtlssh_0_1111111111111211111111111
                                                                                          solve( state_1111111111111211111111111( ~RouterID.1,
                                                                                                                                  ~ServerID.1,
                                                                                                                                  ~ak_h.1,
                                                                                                                                  ~ak_sk.1,
                                                                                                                                  ~ssk_nms.1,
                                                                                                                                  ~tid.1,
                                                                                                                                  tls_h,
                                                                                                                                  k_sh,
                                                                                                                                  tls_spk
                                                                                                 ) ▶₀ #t2.11 )
                                                                                            case eventGenerateTLStidtlsspk_0_111111111111121111111111
                                                                                            solve( Unlock_5( '5',
                                                                                                             ~n.1,
                                                                                                             'device'
                                                                                                   ) @ #t2.13 )
                                                                                              case unlockdevice_0_1111111111111111111211111111
                                                                                              solve( state_1111111111111111111211111111( ~RouterID.1,
                                                                                                                                         ~ServerID.1,
                                                                                                                                         ~ak_h.1,
                                                                                                                                         ~ak_sk.1,
                                                                                                                                         ~ssk_nms.1,
                                                                                                                                         k_ap,
                                                                                                                                         k_h.1,
                                                                                                                                         k_pd,
                                                                                                                                         k_sh.1,
                                                                                                                                         k_sk.1,
                                                                                                                                         m,
                                                                                                                                         ~n.1
                                                                                                     ) ▶₀ #t2.12 )
                                                                                                case TpmSignOutsignmksk_0_111111111111111111121111111
                                                                                                by contradiction
                                                                                                   /* cyclic
                                                                                                   */
                                                                                              qed
                                                                                            next
                                                                                              case unlockdevice_0_111111111111111111121111112
                                                                                              by solve( state_111111111111111111121111112( ~RouterID.1,
                                                                                                                                           ~ServerID.1,
                                                                                                                                           ~ak_h.1,
                                                                                                                                           ~ak_sk.1,
                                                                                                                                           ~ssk_nms.1,
                                                                                                                                           k_ap,
                                                                                                                                           k_h.1,
                                                                                                                                           k_pd,
                                                                                                                                           k_sh.1,
                                                                                                                                           m,
                                                                                                                                           ~n.1
                                                                                                        ) ▶₀ #t2.12 )
                                                                                            qed
                                                                                          qed
                                                                                        qed
                                                                                      qed
                                                                                    next
                                                                                      case case_3
                                                                                      solve( (#vr.28 < #t2.13)  ∥
                                                                                             (#vr.28 =
                                                                                              #t2.13) )
                                                                                        case case_1
                                                                                        solve( TPM_SendCommand( <
                                                                                                                 'TPM2_PolicyPCR', 
                                                                                                                 k_sh
                                                                                                                >
                                                                                               ) @ #t2.11 )
                                                                                          case eventTPMSendCommandTPMPolicyPCRtlssh_0_1111111111111211111111111
                                                                                          solve( state_1111111111111211111111111( ~RouterID.1,
                                                                                                                                  ~ServerID.1,
                                                                                                                                  ~ak_h.1,
                                                                                                                                  ~ak_sk.1,
                                                                                                                                  ~ssk_nms.1,
                                                                                                                                  ~tid.1,
                                                                                                                                  tls_h,
                                                                                                                                  k_sh,
                                                                                                                                  tls_spk
                                                                                                 ) ▶₀ #t2.10 )
                                                                                            case eventGenerateTLStidtlsspk_0_111111111111121111111111
                                                                                            solve( Unlock_5( '5',
                                                                                                             ~n.1,
                                                                                                             'device'
                                                                                                   ) @ #t2.14 )
                                                                                              case unlockdevice_0_1111111111111111111211111111
                                                                                              solve( state_1111111111111111111211111111( ~RouterID.1,
                                                                                                                                         ~ServerID.1,
                                                                                                                                         ~ak_h.1,
                                                                                                                                         ~ak_sk.1,
                                                                                                                                         ~ssk_nms.1,
                                                                                                                                         k_ap,
                                                                                                                                         k_h.1,
                                                                                                                                         k_pd,
                                                                                                                                         k_sh.1,
                                                                                                                                         k_sk.1,
                                                                                                                                         m,
                                                                                                                                         ~n.1
                                                                                                     ) ▶₀ #t2.11 )
                                                                                                case TpmSignOutsignmksk_0_111111111111111111121111111
                                                                                                by contradiction
                                                                                                   /* cyclic
                                                                                                   */
                                                                                              qed
                                                                                            next
                                                                                              case unlockdevice_0_111111111111111111121111112
                                                                                              by solve( state_111111111111111111121111112( ~RouterID.1,
                                                                                                                                           ~ServerID.1,
                                                                                                                                           ~ak_h.1,
                                                                                                                                           ~ak_sk.1,
                                                                                                                                           ~ssk_nms.1,
                                                                                                                                           k_ap,
                                                                                                                                           k_h.1,
                                                                                                                                           k_pd,
                                                                                                                                           k_sh.1,
                                                                                                                                           m,
                                                                                                                                           ~n.1
                                                                                                        ) ▶₀ #t2.11 )
                                                                                            qed
                                                                                          qed
                                                                                        qed
                                                                                      next
                                                                                        case case_2
                                                                                        solve( TPM_SendCommand( <
                                                                                                                 'TPM2_PolicyPCR', 
                                                                                                                 k_sh
                                                                                                                >
                                                                                               ) @ #t2.12 )
                                                                                          case eventTPMSendCommandTPMPolicyPCRtlssh_0_1111111111111211111111111
                                                                                          solve( state_1111111111111211111111111( ~RouterID.1,
                                                                                                                                  ~ServerID.1,
                                                                                                                                  ~ak_h.1,
                                                                                                                                  ~ak_sk.1,
                                                                                                                                  ~ssk_nms.1,
                                                                                                                                  ~tid.1,
                                                                                                                                  tls_h,
                                                                                                                                  k_sh,
                                                                                                                                  tls_spk
                                                                                                 ) ▶₀ #t2.11 )
                                                                                            case eventGenerateTLStidtlsspk_0_111111111111121111111111
                                                                                            solve( Unlock_5( '5',
                                                                                                             ~n.1,
                                                                                                             'device'
                                                                                                   ) @ #t2.14 )
                                                                                              case unlockdevice_0_1111111111111111111211111111
                                                                                              solve( state_1111111111111111111211111111( ~RouterID.1,
                                                                                                                                         ~ServerID.1,
                                                                                                                                         ~ak_h.1,
                                                                                                                                         ~ak_sk.1,
                                                                                                                                         ~ssk_nms.1,
                                                                                                                                         k_ap,
                                                                                                                                         k_h.1,
                                                                                                                                         k_pd,
                                                                                                                                         k_sh.1,
                                                                                                                                         k_sk.1,
                                                                                                                                         m,
                                                                                                                                         ~n.1
                                                                                                     ) ▶₀ #t2.12 )
                                                                                                case TpmSignOutsignmksk_0_111111111111111111121111111
                                                                                                by contradiction
                                                                                                   /* cyclic
                                                                                                   */
                                                                                              qed
                                                                                            next
                                                                                              case unlockdevice_0_111111111111111111121111112
                                                                                              by solve( state_111111111111111111121111112( ~RouterID.1,
                                                                                                                                           ~ServerID.1,
                                                                                                                                           ~ak_h.1,
                                                                                                                                           ~ak_sk.1,
                                                                                                                                           ~ssk_nms.1,
                                                                                                                                           k_ap,
                                                                                                                                           k_h.1,
                                                                                                                                           k_pd,
                                                                                                                                           k_sh.1,
                                                                                                                                           m,
                                                                                                                                           ~n.1
                                                                                                        ) ▶₀ #t2.12 )
                                                                                            qed
                                                                                          qed
                                                                                        qed
                                                                                      qed
                                                                                    qed
                                                                                  next
                                                                                    case case_2
                                                                                    solve( (#t2.13 < #t2.11)  ∥
                                                                                           (#t2.13 =
                                                                                            #t2.11)  ∥
                                                                                           (#vr.71 < #t2.13) )
                                                                                      case case_1
                                                                                      by contradiction
                                                                                         /* from formulas */
                                                                                    next
                                                                                      case case_2
                                                                                      solve( (#vr.28 < #t2.13)  ∥
                                                                                             (#vr.28 =
                                                                                              #t2.13) )
                                                                                        case case_1
                                                                                        solve( state_1111111111111111111111121111111( ~RouterID.1,
                                                                                                                                      ~ServerID.1,
                                                                                                                                      ~ak_h.1,
                                                                                                                                      ~ak_sk.1,
                                                                                                                                      ~ssk_nms.1,
                                                                                                                                      pL,
                                                                                                                                      pcrL,
                                                                                                                                      s_h,
                                                                                                                                      ~n.3
                                                                                               ) ▶₀ #t2.10 )
                                                                                          case insertpolicyDigestshpcrLTPMCCPolicyPCRpL_0_111111111111111111111112111111
                                                                                          solve( (#vr.28 < #t2.16)  ∥
                                                                                                 (#vr.28 =
                                                                                                  #t2.16) )
                                                                                            case case_1
                                                                                            solve( (#t2.15 < #t2.11)  ∥
                                                                                                   (#t2.15 =
                                                                                                    #t2.11)  ∥
                                                                                                   (#vr.71 < #t2.15) )
                                                                                              case case_1
                                                                                              by contradiction
                                                                                                 /*
                                                                                                 from formulas
                                                                                                 */
                                                                                            next
                                                                                              case case_2
                                                                                              solve( (#t2.13 < #t2.15)  ∥
                                                                                                     (#t2.13 =
                                                                                                      #t2.15) )
                                                                                                case case_1
                                                                                                by contradiction
                                                                                                   /*
                                                                                                   from formulas
                                                                                                   */
                                                                                              next
                                                                                                case case_2
                                                                                                solve( TPM_SendCommand( <
                                                                                                                         'TPM2_PolicyPCR', 
                                                                                                                         k_sh
                                                                                                                        >
                                                                                                       ) @ #t2.12 )
                                                                                                  case eventTPMSendCommandTPMPolicyPCRtlssh_0_1111111111111211111111111
                                                                                                  solve( state_1111111111111211111111111( ~RouterID.1,
                                                                                                                                          ~ServerID.1,
                                                                                                                                          ~ak_h.1,
                                                                                                                                          ~ak_sk.1,
                                                                                                                                          ~ssk_nms.1,
                                                                                                                                          ~tid.1,
                                                                                                                                          tls_h,
                                                                                                                                          k_sh,
                                                                                                                                          tls_spk
                                                                                                         ) ▶₀ #t2.11 )
                                                                                                    case eventGenerateTLStidtlsspk_0_111111111111121111111111
                                                                                                    solve( TPM_SendCommand( <
                                                                                                                             'TPM2_PolicyPCR', 
                                                                                                                             k_sh
                                                                                                                            >
                                                                                                           ) @ #t2.14 )
                                                                                                      case eventTPMSendCommandTPMPolicyPCRtlssh_0_1111111111111211111111111
                                                                                                      solve( state_1111111111111211111111111( ~RouterID.1,
                                                                                                                                              ~ServerID.1,
                                                                                                                                              ~ak_h.1,
                                                                                                                                              ~ak_sk.1,
                                                                                                                                              ~ssk_nms.1,
                                                                                                                                              ~tid.1,
                                                                                                                                              tls_h,
                                                                                                                                              k_sh,
                                                                                                                                              tls_spk
                                                                                                             ) ▶₀ #t2.12 )
                                                                                                        case eventGenerateTLStidtlsspk_0_111111111111121111111111
                                                                                                        solve( TPM_SendCommand( <
                                                                                                                                 'TPM2_Create', 
                                                                                                                                 <
                                                                                                                                  swstate, 
                                                                                                                                  nil
                                                                                                                                 >, 
                                                                                                                                 'TPM_CC_PolicyPCR', 
                                                                                                                                 nil
                                                                                                                                >
                                                                                                               ) @ #t2.14 )
                                                                                                          case eventTPMSendCommandTPMCreateswstatenilTPMCCPolicyPCRnil_0_11111111111112111
                                                                                                          solve( state_11111111111112111( ~RouterID.1,
                                                                                                                                          ~ServerID.1,
                                                                                                                                          ~ak_h.1,
                                                                                                                                          ~ak_sk.1,
                                                                                                                                          ~ssk_nms.1,
                                                                                                                                          ~tid.1
                                                                                                                 ) ▶₀ #t2.12 )
                                                                                                            case outTPMPCRExtendswstate_0_1111111111111211
                                                                                                            solve( TPM_SendCommand( <
                                                                                                                                     'TPM2_Create', 
                                                                                                                                     <
                                                                                                                                      swstate, 
                                                                                                                                      nil
                                                                                                                                     >, 
                                                                                                                                     'TPM_CC_PolicyPCR', 
                                                                                                                                     nil
                                                                                                                                    >
                                                                                                                   ) @ #t2.14 )
                                                                                                              case eventTPMSendCommandTPMCreateswstatenilTPMCCPolicyPCRnil_0_11111111111112111
                                                                                                              solve( state_11111111111112111( ~RouterID.1,
                                                                                                                                              ~ServerID.1,
                                                                                                                                              ~ak_h.1,
                                                                                                                                              ~ak_sk.1,
                                                                                                                                              ~ssk_nms.1,
                                                                                                                                              ~tid.1
                                                                                                                     ) ▶₀ #t2.12 )
                                                                                                                case outTPMPCRExtendswstate_0_1111111111111211
                                                                                                                by solve( !KU( ~ssk_nms
                                                                                                                          ) @ #vk.23 )
                                                                                                              qed
                                                                                                            qed
                                                                                                          qed
                                                                                                        qed
                                                                                                      qed
                                                                                                    qed
                                                                                                  qed
                                                                                                qed
                                                                                              qed
                                                                                            next
                                                                                              case case_3
                                                                                              by contradiction
                                                                                                 /*
                                                                                                 from formulas
                                                                                                 */
                                                                                            qed
                                                                                          next
                                                                                            case case_2
                                                                                            by contradiction
                                                                                               /*
                                                                                               from formulas
                                                                                               */
                                                                                          qed
                                                                                        qed
                                                                                      next
                                                                                        case case_2
                                                                                        solve( state_1111111111111111111111121111111( ~RouterID.1,
                                                                                                                                      ~ServerID.1,
                                                                                                                                      ~ak_h.1,
                                                                                                                                      ~ak_sk.1,
                                                                                                                                      ~ssk_nms.1,
                                                                                                                                      pL,
                                                                                                                                      pcrL,
                                                                                                                                      s_h,
                                                                                                                                      ~n.3
                                                                                               ) ▶₀ #t2.10 )
                                                                                          case insertpolicyDigestshpcrLTPMCCPolicyPCRpL_0_111111111111111111111112111111
                                                                                          solve( (#t2.11 < #t2.16)  ∥
                                                                                                 (#t2.11 =
                                                                                                  #t2.16) )
                                                                                            case case_1
                                                                                            by contradiction
                                                                                               /*
                                                                                               from formulas
                                                                                               */
                                                                                          next
                                                                                            case case_2
                                                                                            solve( (#t2.15 < #t2.12)  ∥
                                                                                                   (#t2.15 =
                                                                                                    #t2.12)  ∥
                                                                                                   (#vr.70 < #t2.15) )
                                                                                              case case_1
                                                                                              by contradiction
                                                                                                 /*
                                                                                                 from formulas
                                                                                                 */
                                                                                            next
                                                                                              case case_2
                                                                                              solve( TPM_SendCommand( <
                                                                                                                       'TPM2_PolicyPCR', 
                                                                                                                       k_sh
                                                                                                                      >
                                                                                                     ) @ #t2.13 )
                                                                                                case eventTPMSendCommandTPMPolicyPCRtlssh_0_1111111111111211111111111
                                                                                                solve( state_1111111111111211111111111( ~RouterID.1,
                                                                                                                                        ~ServerID.1,
                                                                                                                                        ~ak_h.1,
                                                                                                                                        ~ak_sk.1,
                                                                                                                                        ~ssk_nms.1,
                                                                                                                                        ~tid.1,
                                                                                                                                        tls_h,
                                                                                                                                        k_sh,
                                                                                                                                        tls_spk
                                                                                                       ) ▶₀ #t2.12 )
                                                                                                  case eventGenerateTLStidtlsspk_0_111111111111121111111111
                                                                                                  solve( TPM_SendCommand( <
                                                                                                                           'TPM2_PolicyPCR', 
                                                                                                                           k_sh
                                                                                                                          >
                                                                                                         ) @ #t2.14 )
                                                                                                    case eventTPMSendCommandTPMPolicyPCRtlssh_0_1111111111111211111111111
                                                                                                    solve( state_1111111111111211111111111( ~RouterID.1,
                                                                                                                                            ~ServerID.1,
                                                                                                                                            ~ak_h.1,
                                                                                                                                            ~ak_sk.1,
                                                                                                                                            ~ssk_nms.1,
                                                                                                                                            ~tid.1,
                                                                                                                                            tls_h,
                                                                                                                                            k_sh,
                                                                                                                                            tls_spk
                                                                                                           ) ▶₀ #t2.13 )
                                                                                                      case eventGenerateTLStidtlsspk_0_111111111111121111111111
                                                                                                      solve( TPM_SendCommand( <
                                                                                                                               'TPM2_Create', 
                                                                                                                               <
                                                                                                                                swstate, 
                                                                                                                                nil
                                                                                                                               >, 
                                                                                                                               'TPM_CC_PolicyPCR', 
                                                                                                                               nil
                                                                                                                              >
                                                                                                             ) @ #t2.14 )
                                                                                                        case eventTPMSendCommandTPMCreateswstatenilTPMCCPolicyPCRnil_0_11111111111112111
                                                                                                        solve( state_11111111111112111( ~RouterID.1,
                                                                                                                                        ~ServerID.1,
                                                                                                                                        ~ak_h.1,
                                                                                                                                        ~ak_sk.1,
                                                                                                                                        ~ssk_nms.1,
                                                                                                                                        ~tid.1
                                                                                                               ) ▶₀ #t2.13 )
                                                                                                          case outTPMPCRExtendswstate_0_1111111111111211
                                                                                                          solve( TPM_SendCommand( <
                                                                                                                                   'TPM2_Create', 
                                                                                                                                   <
                                                                                                                                    swstate, 
                                                                                                                                    nil
                                                                                                                                   >, 
                                                                                                                                   'TPM_CC_PolicyPCR', 
                                                                                                                                   nil
                                                                                                                                  >
                                                                                                                 ) @ #t2.14 )
                                                                                                            case eventTPMSendCommandTPMCreateswstatenilTPMCCPolicyPCRnil_0_11111111111112111
                                                                                                            solve( state_11111111111112111( ~RouterID.1,
                                                                                                                                            ~ServerID.1,
                                                                                                                                            ~ak_h.1,
                                                                                                                                            ~ak_sk.1,
                                                                                                                                            ~ssk_nms.1,
                                                                                                                                            ~tid.1
                                                                                                                   ) ▶₀ #t2.13 )
                                                                                                              case outTPMPCRExtendswstate_0_1111111111111211
                                                                                                              by solve( !KU( ~ssk_nms
                                                                                                                        ) @ #vk.23 )
                                                                                                            qed
                                                                                                          qed
                                                                                                        qed
                                                                                                      qed
                                                                                                    qed
                                                                                                  qed
                                                                                                qed
                                                                                              qed
                                                                                            next
                                                                                              case case_3
                                                                                              by contradiction
                                                                                                 /*
                                                                                                 from formulas
                                                                                                 */
                                                                                            qed
                                                                                          qed
                                                                                        qed
                                                                                      qed
                                                                                    next
                                                                                      case case_3
                                                                                      solve( (#vr.28 < #t2.14)  ∥
                                                                                             (#vr.28 =
                                                                                              #t2.14) )
                                                                                        case case_1
                                                                                        solve( state_1111111111111111111111121111111( ~RouterID.1,
                                                                                                                                      ~ServerID.1,
                                                                                                                                      ~ak_h.1,
                                                                                                                                      ~ak_sk.1,
                                                                                                                                      ~ssk_nms.1,
                                                                                                                                      pL,
                                                                                                                                      pcrL,
                                                                                                                                      s_h,
                                                                                                                                      ~n.3
                                                                                               ) ▶₀ #t2.10 )
                                                                                          case insertpolicyDigestshpcrLTPMCCPolicyPCRpL_0_111111111111111111111112111111
                                                                                          solve( (#vr.28 < #t2.17)  ∥
                                                                                                 (#vr.28 =
                                                                                                  #t2.17) )
                                                                                            case case_1
                                                                                            solve( (#t2.16 < #t2.11)  ∥
                                                                                                   (#t2.16 =
                                                                                                    #t2.11)  ∥
                                                                                                   (#vr.71 < #t2.16) )
                                                                                              case case_1
                                                                                              by contradiction
                                                                                                 /*
                                                                                                 from formulas
                                                                                                 */
                                                                                            next
                                                                                              case case_2
                                                                                              by contradiction
                                                                                                 /*
                                                                                                 from formulas
                                                                                                 */
                                                                                            next
                                                                                              case case_3
                                                                                              solve( (#t2.14 < #t2.17)  ∥
                                                                                                     (#t2.14 =
                                                                                                      #t2.17) )
                                                                                                case case_1
                                                                                                by contradiction
                                                                                                   /*
                                                                                                   from formulas
                                                                                                   */
                                                                                              next
                                                                                                case case_2
                                                                                                solve( (#t2.13 < #t2.16)  ∥
                                                                                                       (#t2.13 =
                                                                                                        #t2.16) )
                                                                                                  case case_1
                                                                                                  by contradiction
                                                                                                     /*
                                                                                                     from formulas
                                                                                                     */
                                                                                                next
                                                                                                  case case_2
                                                                                                  solve( TPM_SendCommand( <
                                                                                                                           'TPM2_PolicyPCR', 
                                                                                                                           k_sh
                                                                                                                          >
                                                                                                         ) @ #t2.12 )
                                                                                                    case eventTPMSendCommandTPMPolicyPCRtlssh_0_1111111111111211111111111
                                                                                                    solve( state_1111111111111211111111111( ~RouterID.1,
                                                                                                                                            ~ServerID.1,
                                                                                                                                            ~ak_h.1,
                                                                                                                                            ~ak_sk.1,
                                                                                                                                            ~ssk_nms.1,
                                                                                                                                            ~tid.1,
                                                                                                                                            tls_h,
                                                                                                                                            k_sh,
                                                                                                                                            tls_spk
                                                                                                           ) ▶₀ #t2.11 )
                                                                                                      case eventGenerateTLStidtlsspk_0_111111111111121111111111
                                                                                                      solve( TPM_SendCommand( <
                                                                                                                               'TPM2_PolicyPCR', 
                                                                                                                               k_sh
                                                                                                                              >
                                                                                                             ) @ #t2.15 )
                                                                                                        case eventTPMSendCommandTPMPolicyPCRtlssh_0_1111111111111211111111111
                                                                                                        solve( state_1111111111111211111111111( ~RouterID.1,
                                                                                                                                                ~ServerID.1,
                                                                                                                                                ~ak_h.1,
                                                                                                                                                ~ak_sk.1,
                                                                                                                                                ~ssk_nms.1,
                                                                                                                                                ~tid.1,
                                                                                                                                                tls_h,
                                                                                                                                                k_sh,
                                                                                                                                                tls_spk
                                                                                                               ) ▶₀ #t2.12 )
                                                                                                          case eventGenerateTLStidtlsspk_0_111111111111121111111111
                                                                                                          solve( TPM_SendCommand( <
                                                                                                                                   'TPM2_Create', 
                                                                                                                                   <
                                                                                                                                    swstate, 
                                                                                                                                    nil
                                                                                                                                   >, 
                                                                                                                                   'TPM_CC_PolicyPCR', 
                                                                                                                                   nil
                                                                                                                                  >
                                                                                                                 ) @ #t2.15 )
                                                                                                            case eventTPMSendCommandTPMCreateswstatenilTPMCCPolicyPCRnil_0_11111111111112111
                                                                                                            solve( state_11111111111112111( ~RouterID.1,
                                                                                                                                            ~ServerID.1,
                                                                                                                                            ~ak_h.1,
                                                                                                                                            ~ak_sk.1,
                                                                                                                                            ~ssk_nms.1,
                                                                                                                                            ~tid.1
                                                                                                                   ) ▶₀ #t2.12 )
                                                                                                              case outTPMPCRExtendswstate_0_1111111111111211
                                                                                                              solve( TPM_SendCommand( <
                                                                                                                                       'TPM2_Create', 
                                                                                                                                       <
                                                                                                                                        swstate, 
                                                                                                                                        nil
                                                                                                                                       >, 
                                                                                                                                       'TPM_CC_PolicyPCR', 
                                                                                                                                       nil
                                                                                                                                      >
                                                                                                                     ) @ #t2.15 )
                                                                                                                case eventTPMSendCommandTPMCreateswstatenilTPMCCPolicyPCRnil_0_11111111111112111
                                                                                                                solve( state_11111111111112111( ~RouterID.1,
                                                                                                                                                ~ServerID.1,
                                                                                                                                                ~ak_h.1,
                                                                                                                                                ~ak_sk.1,
                                                                                                                                                ~ssk_nms.1,
                                                                                                                                                ~tid.1
                                                                                                                       ) ▶₀ #t2.12 )
                                                                                                                  case outTPMPCRExtendswstate_0_1111111111111211
                                                                                                                  by solve( !KU( ~ssk_nms
                                                                                                                            ) @ #vk.23 )
                                                                                                                qed
                                                                                                              qed
                                                                                                            qed
                                                                                                          qed
                                                                                                        qed
                                                                                                      qed
                                                                                                    qed
                                                                                                  qed
                                                                                                qed
                                                                                              qed
                                                                                            qed
                                                                                          next
                                                                                            case case_2
                                                                                            by contradiction
                                                                                               /*
                                                                                               from formulas
                                                                                               */
                                                                                          qed
                                                                                        qed
                                                                                      next
                                                                                        case case_2
                                                                                        solve( state_1111111111111111111111121111111( ~RouterID.1,
                                                                                                                                      ~ServerID.1,
                                                                                                                                      ~ak_h.1,
                                                                                                                                      ~ak_sk.1,
                                                                                                                                      ~ssk_nms.1,
                                                                                                                                      pL,
                                                                                                                                      pcrL,
                                                                                                                                      s_h,
                                                                                                                                      ~n.3
                                                                                               ) ▶₀ #t2.10 )
                                                                                          case insertpolicyDigestshpcrLTPMCCPolicyPCRpL_0_111111111111111111111112111111
                                                                                          solve( (#t2.11 < #t2.17)  ∥
                                                                                                 (#t2.11 =
                                                                                                  #t2.17) )
                                                                                            case case_1
                                                                                            by contradiction
                                                                                               /*
                                                                                               from formulas
                                                                                               */
                                                                                          next
                                                                                            case case_2
                                                                                            solve( (#t2.16 < #t2.12)  ∥
                                                                                                   (#t2.16 =
                                                                                                    #t2.12)  ∥
                                                                                                   (#vr.70 < #t2.16) )
                                                                                              case case_1
                                                                                              by contradiction
                                                                                                 /*
                                                                                                 from formulas
                                                                                                 */
                                                                                            next
                                                                                              case case_2
                                                                                              by contradiction
                                                                                                 /*
                                                                                                 from formulas
                                                                                                 */
                                                                                            next
                                                                                              case case_3
                                                                                              solve( (#t2.14 < #t2.16)  ∥
                                                                                                     (#t2.14 =
                                                                                                      #t2.16) )
                                                                                                case case_1
                                                                                                by contradiction
                                                                                                   /*
                                                                                                   from formulas
                                                                                                   */
                                                                                              next
                                                                                                case case_2
                                                                                                solve( TPM_SendCommand( <
                                                                                                                         'TPM2_PolicyPCR', 
                                                                                                                         k_sh
                                                                                                                        >
                                                                                                       ) @ #t2.13 )
                                                                                                  case eventTPMSendCommandTPMPolicyPCRtlssh_0_1111111111111211111111111
                                                                                                  solve( state_1111111111111211111111111( ~RouterID.1,
                                                                                                                                          ~ServerID.1,
                                                                                                                                          ~ak_h.1,
                                                                                                                                          ~ak_sk.1,
                                                                                                                                          ~ssk_nms.1,
                                                                                                                                          ~tid.1,
                                                                                                                                          tls_h,
                                                                                                                                          k_sh,
                                                                                                                                          tls_spk
                                                                                                         ) ▶₀ #t2.12 )
                                                                                                    case eventGenerateTLStidtlsspk_0_111111111111121111111111
                                                                                                    solve( TPM_SendCommand( <
                                                                                                                             'TPM2_PolicyPCR', 
                                                                                                                             k_sh
                                                                                                                            >
                                                                                                           ) @ #t2.15 )
                                                                                                      case eventTPMSendCommandTPMPolicyPCRtlssh_0_1111111111111211111111111
                                                                                                      solve( state_1111111111111211111111111( ~RouterID.1,
                                                                                                                                              ~ServerID.1,
                                                                                                                                              ~ak_h.1,
                                                                                                                                              ~ak_sk.1,
                                                                                                                                              ~ssk_nms.1,
                                                                                                                                              ~tid.1,
                                                                                                                                              tls_h,
                                                                                                                                              k_sh,
                                                                                                                                              tls_spk
                                                                                                             ) ▶₀ #t2.13 )
                                                                                                        case eventGenerateTLStidtlsspk_0_111111111111121111111111
                                                                                                        solve( TPM_SendCommand( <
                                                                                                                                 'TPM2_Create', 
                                                                                                                                 <
                                                                                                                                  swstate, 
                                                                                                                                  nil
                                                                                                                                 >, 
                                                                                                                                 'TPM_CC_PolicyPCR', 
                                                                                                                                 nil
                                                                                                                                >
                                                                                                               ) @ #t2.15 )
                                                                                                          case eventTPMSendCommandTPMCreateswstatenilTPMCCPolicyPCRnil_0_11111111111112111
                                                                                                          solve( state_11111111111112111( ~RouterID.1,
                                                                                                                                          ~ServerID.1,
                                                                                                                                          ~ak_h.1,
                                                                                                                                          ~ak_sk.1,
                                                                                                                                          ~ssk_nms.1,
                                                                                                                                          ~tid.1
                                                                                                                 ) ▶₀ #t2.13 )
                                                                                                            case outTPMPCRExtendswstate_0_1111111111111211
                                                                                                            solve( TPM_SendCommand( <
                                                                                                                                     'TPM2_Create', 
                                                                                                                                     <
                                                                                                                                      swstate, 
                                                                                                                                      nil
                                                                                                                                     >, 
                                                                                                                                     'TPM_CC_PolicyPCR', 
                                                                                                                                     nil
                                                                                                                                    >
                                                                                                                   ) @ #t2.15 )
                                                                                                              case eventTPMSendCommandTPMCreateswstatenilTPMCCPolicyPCRnil_0_11111111111112111
                                                                                                              solve( state_11111111111112111( ~RouterID.1,
                                                                                                                                              ~ServerID.1,
                                                                                                                                              ~ak_h.1,
                                                                                                                                              ~ak_sk.1,
                                                                                                                                              ~ssk_nms.1,
                                                                                                                                              ~tid.1
                                                                                                                     ) ▶₀ #t2.13 )
                                                                                                                case outTPMPCRExtendswstate_0_1111111111111211
                                                                                                                by solve( !KU( ~ssk_nms
                                                                                                                          ) @ #vk.23 )
                                                                                                              qed
                                                                                                            qed
                                                                                                          qed
                                                                                                        qed
                                                                                                      qed
                                                                                                    qed
                                                                                                  qed
                                                                                                qed
                                                                                              qed
                                                                                            qed
                                                                                          qed
                                                                                        qed
                                                                                      qed
                                                                                    qed
                                                                                  qed
                                                                                qed
                                                                              qed
                                                                            qed
                                                                          qed
                                                                        qed
                                                                      qed
                                                                    qed
                                                                  qed
                                                                qed
                                                              qed
                                                            qed
                                                          qed
                                                        qed
                                                      qed
                                                    qed
                                                  qed
                                                qed
                                              next
                                                case unlockdevice_0_11111111111111111111211111112
                                                by solve( state_11111111111111111111211111112( ~RouterID.1,
                                                                                               ~ServerID.1,
                                                                                               ~ak_h.1,
                                                                                               ~ak_sk.1,
                                                                                               ~ssk_nms.1,
                                                                                               a_h, obj_ap,
                                                                                               obj_h, obj_pd,
                                                                                               obj_pk, obj_sh,
                                                                                               ~n.2
                                                          ) ▶₀ #t2.8 )
                                              qed
                                            qed
                                          qed
                                        qed
                                      qed
                                    qed
                                  qed
                                qed
                              qed
                            next
                              case outtlsspksigntlsspkssknms_0_11111111111121111111111
                              by contradiction /* from formulas */
                            qed
                          qed
                        qed
                      qed
                    qed
                  qed
                qed
              qed
            qed
          qed
        qed
      qed
    qed
  qed
next
  case case_2
  solve( state_111111111111211111111( ~RouterID, ~ServerID, ~ak_h, ~ak_sk,
                                      ~ssk_nms, csr, skae, tls_spk
         ) ▶₀ #t1 )
    case eventHasKeyNMSServerIDpkssknms_0_11111111111121111111
    solve( !KU( sign(<pk(x), <swstate, nil>, 'TPM_CC_PolicyPCR', nil>,
                     ~ak_sk)
           ) @ #vk.3 )
      case c_sign
      solve( !KU( sign(<pk(x), 
                        sign(<pk(x), <swstate, nil>, 'TPM_CC_PolicyPCR', nil>, ~ak_sk)>,
                       x)
             ) @ #vk.5 )
        case c_sign
        by solve( !KU( ~ak_sk ) @ #vk.6 )
      next
        case outsignobjpkobjapask_0_11111111111111111111211111111
        solve( TPM_SendCommand( <'TPM2_Certify', obj_sh, obj_h, a_h> ) @ #t2 )
          case eventTPMSendCommandTPMCertifytlsshtlshakh_0_111111111111121111111111111
          solve( state_111111111111121111111111111( ~RouterID.1, ~ServerID.1,
                                                    ~ak_h.1, ~ak_sk.1, ~ssk_nms.1, ~tid, obj_h, obj_sh,
                                                    tls_spk
                 ) ▶₀ #t2 )
            case outTPMPolicyPCRtlssh_0_11111111111112111111111111
            solve( (#vr.52 < #t2.3)  ∥ (#vr.52 = #t2.3) )
              case case_1
              solve( (#vr.56 < #t2.4)  ∥ (#vr.56 = #t2.4) )
                case case_1
                solve( (#vr.38 < #t2.2)  ∥ (#vr.38 = #t2.2) )
                  case case_1
                  solve( state_111111111111111111111121111111111( ~RouterID.1, ~ServerID.1,
                                                                  ~ak_h.1, ~ak_sk.1, ~k_h.1, ~k_sk.1,
                                                                  ~ssk_nms.1, authPolicy, ~n
                         ) ▶₀ #t2.1 )
                    case TpmCreateOutkhpkksk_0_11111111111111111111112111111111
                    solve( TPM_SendCommand( <'TPM2_Create', authPolicy> ) @ #t2.6 )
                      case eventTPMSendCommandTPMCreateswstatenilTPMCCPolicyPCRnil_0_11111111111112111
                      solve( state_11111111111112111( ~RouterID.1, ~ServerID.1, ~ak_h.1,
                                                      ~ak_sk.1, ~ssk_nms.1, ~tid.1
                             ) ▶₀ #t2.2 )
                        case outTPMPCRExtendswstate_0_1111111111111211
                        solve( TPM_SendCommand( <'TPM2_Create', <swstate, nil>, 
                                                 'TPM_CC_PolicyPCR', nil>
                               ) @ #t2.7 )
                          case eventTPMSendCommandTPMCreateswstatenilTPMCCPolicyPCRnil_0_11111111111112111
                          solve( state_11111111111112111( ~RouterID.1, ~ServerID.1, ~ak_h.1,
                                                          ~ak_sk.1, ~ssk_nms.1, ~tid.1
                                 ) ▶₀ #t2.3 )
                            case outTPMPCRExtendswstate_0_1111111111111211
                            by solve( !KU( ~ak_sk ) @ #vk.6 )
                          qed
                        qed
                      qed
                    qed
                  qed
                next
                  case case_2
                  solve( state_111111111111111111111121111111111( ~RouterID.1, ~ServerID.1,
                                                                  ~ak_h.1, ~ak_sk.1, ~k_h.1, ~k_sk.1,
                                                                  ~ssk_nms.1, authPolicy, ~n
                         ) ▶₀ #t2.1 )
                    case TpmCreateOutkhpkksk_0_11111111111111111111112111111111
                    solve( TPM_SendCommand( <'TPM2_Create', authPolicy> ) @ #t2.6 )
                      case eventTPMSendCommandTPMCreateswstatenilTPMCCPolicyPCRnil_0_11111111111112111
                      solve( state_11111111111112111( ~RouterID.1, ~ServerID.1, ~ak_h.1,
                                                      ~ak_sk.1, ~ssk_nms.1, ~tid.1
                             ) ▶₀ #t2.3 )
                        case outTPMPCRExtendswstate_0_1111111111111211
                        solve( TPM_SendCommand( <'TPM2_Create', <swstate, nil>, 
                                                 'TPM_CC_PolicyPCR', nil>
                               ) @ #t2.7 )
                          case eventTPMSendCommandTPMCreateswstatenilTPMCCPolicyPCRnil_0_11111111111112111
                          solve( state_11111111111112111( ~RouterID.1, ~ServerID.1, ~ak_h.1,
                                                          ~ak_sk.1, ~ssk_nms.1, ~tid.1
                                 ) ▶₀ #t2.4 )
                            case outTPMPCRExtendswstate_0_1111111111111211
                            by solve( !KU( ~ak_sk ) @ #vk.6 )
                          qed
                        qed
                      qed
                    qed
                  qed
                qed
              next
                case case_2
                solve( (#vr.38 < #t2.3)  ∥ (#vr.38 = #t2.3) )
                  case case_1
                  solve( state_111111111111111111111121111111111( ~RouterID.1, ~ServerID.1,
                                                                  ~ak_h.1, ~ak_sk.1, ~k_h.1, ~k_sk.1,
                                                                  ~ssk_nms.1, authPolicy, ~n
                         ) ▶₀ #t2.1 )
                    case TpmCreateOutkhpkksk_0_11111111111111111111112111111111
                    solve( TPM_SendCommand( <'TPM2_Create', authPolicy> ) @ #t2.6 )
                      case eventTPMSendCommandTPMCreateswstatenilTPMCCPolicyPCRnil_0_11111111111112111
                      solve( state_11111111111112111( ~RouterID.1, ~ServerID.1, ~ak_h.1,
                                                      ~ak_sk.1, ~ssk_nms.1, ~tid.1
                             ) ▶₀ #t2.3 )
                        case outTPMPCRExtendswstate_0_1111111111111211
                        solve( TPM_SendCommand( <'TPM2_Create', <swstate, nil>, 
                                                 'TPM_CC_PolicyPCR', nil>
                               ) @ #t2.7 )
                          case eventTPMSendCommandTPMCreateswstatenilTPMCCPolicyPCRnil_0_11111111111112111
                          solve( state_11111111111112111( ~RouterID.1, ~ServerID.1, ~ak_h.1,
                                                          ~ak_sk.1, ~ssk_nms.1, ~tid.1
                                 ) ▶₀ #t2.4 )
                            case outTPMPCRExtendswstate_0_1111111111111211
                            by solve( !KU( ~ak_sk ) @ #vk.6 )
                          qed
                        qed
                      qed
                    qed
                  qed
                next
                  case case_2
                  solve( state_111111111111111111111121111111111( ~RouterID.1, ~ServerID.1,
                                                                  ~ak_h.1, ~ak_sk.1, ~k_h.1, ~k_sk.1,
                                                                  ~ssk_nms.1, authPolicy, ~n
                         ) ▶₀ #t2.1 )
                    case TpmCreateOutkhpkksk_0_11111111111111111111112111111111
                    solve( TPM_SendCommand( <'TPM2_Create', authPolicy> ) @ #t2.6 )
                      case eventTPMSendCommandTPMCreateswstatenilTPMCCPolicyPCRnil_0_11111111111112111
                      solve( state_11111111111112111( ~RouterID.1, ~ServerID.1, ~ak_h.1,
                                                      ~ak_sk.1, ~ssk_nms.1, ~tid.1
                             ) ▶₀ #t2.4 )
                        case outTPMPCRExtendswstate_0_1111111111111211
                        solve( TPM_SendCommand( <'TPM2_Create', <swstate, nil>, 
                                                 'TPM_CC_PolicyPCR', nil>
                               ) @ #t2.7 )
                          case eventTPMSendCommandTPMCreateswstatenilTPMCCPolicyPCRnil_0_11111111111112111
                          solve( state_11111111111112111( ~RouterID.1, ~ServerID.1, ~ak_h.1,
                                                          ~ak_sk.1, ~ssk_nms.1, ~tid.1
                                 ) ▶₀ #t2.5 )
                            case outTPMPCRExtendswstate_0_1111111111111211
                            by solve( !KU( ~ak_sk ) @ #vk.6 )
                          qed
                        qed
                      qed
                    qed
                  qed
                qed
              qed
            next
              case case_2
              solve( (#vr.55 < #t2.4)  ∥ (#vr.55 = #t2.4) )
                case case_1
                solve( (#vr.38 < #t2.3)  ∥ (#vr.38 = #t2.3) )
                  case case_1
                  solve( state_111111111111111111111121111111111( ~RouterID.1, ~ServerID.1,
                                                                  ~ak_h.1, ~ak_sk.1, ~k_h.1, ~k_sk.1,
                                                                  ~ssk_nms.1, authPolicy, ~n
                         ) ▶₀ #t2.1 )
                    case TpmCreateOutkhpkksk_0_11111111111111111111112111111111
                    solve( TPM_SendCommand( <'TPM2_Create', authPolicy> ) @ #t2.6 )
                      case eventTPMSendCommandTPMCreateswstatenilTPMCCPolicyPCRnil_0_11111111111112111
                      solve( state_11111111111112111( ~RouterID.1, ~ServerID.1, ~ak_h.1,
                                                      ~ak_sk.1, ~ssk_nms.1, ~tid.1
                             ) ▶₀ #t2.3 )
                        case outTPMPCRExtendswstate_0_1111111111111211
                        solve( TPM_SendCommand( <'TPM2_Create', <swstate, nil>, 
                                                 'TPM_CC_PolicyPCR', nil>
                               ) @ #t2.7 )
                          case eventTPMSendCommandTPMCreateswstatenilTPMCCPolicyPCRnil_0_11111111111112111
                          solve( state_11111111111112111( ~RouterID.1, ~ServerID.1, ~ak_h.1,
                                                          ~ak_sk.1, ~ssk_nms.1, ~tid.1
                                 ) ▶₀ #t2.4 )
                            case outTPMPCRExtendswstate_0_1111111111111211
                            by solve( !KU( ~ak_sk ) @ #vk.6 )
                          qed
                        qed
                      qed
                    qed
                  qed
                next
                  case case_2
                  solve( state_111111111111111111111121111111111( ~RouterID.1, ~ServerID.1,
                                                                  ~ak_h.1, ~ak_sk.1, ~k_h.1, ~k_sk.1,
                                                                  ~ssk_nms.1, authPolicy, ~n
                         ) ▶₀ #t2.1 )
                    case TpmCreateOutkhpkksk_0_11111111111111111111112111111111
                    solve( TPM_SendCommand( <'TPM2_Create', authPolicy> ) @ #t2.6 )
                      case eventTPMSendCommandTPMCreateswstatenilTPMCCPolicyPCRnil_0_11111111111112111
                      solve( state_11111111111112111( ~RouterID.1, ~ServerID.1, ~ak_h.1,
                                                      ~ak_sk.1, ~ssk_nms.1, ~tid.1
                             ) ▶₀ #t2.4 )
                        case outTPMPCRExtendswstate_0_1111111111111211
                        solve( TPM_SendCommand( <'TPM2_Create', <swstate, nil>, 
                                                 'TPM_CC_PolicyPCR', nil>
                               ) @ #t2.7 )
                          case eventTPMSendCommandTPMCreateswstatenilTPMCCPolicyPCRnil_0_11111111111112111
                          solve( state_11111111111112111( ~RouterID.1, ~ServerID.1, ~ak_h.1,
                                                          ~ak_sk.1, ~ssk_nms.1, ~tid.1
                                 ) ▶₀ #t2.5 )
                            case outTPMPCRExtendswstate_0_1111111111111211
                            by solve( !KU( ~ak_sk ) @ #vk.6 )
                          qed
                        qed
                      qed
                    qed
                  qed
                qed
              next
                case case_2
                solve( (#vr.38 < #t2.4)  ∥ (#vr.38 = #t2.4) )
                  case case_1
                  solve( state_111111111111111111111121111111111( ~RouterID.1, ~ServerID.1,
                                                                  ~ak_h.1, ~ak_sk.1, ~k_h.1, ~k_sk.1,
                                                                  ~ssk_nms.1, authPolicy, ~n
                         ) ▶₀ #t2.1 )
                    case TpmCreateOutkhpkksk_0_11111111111111111111112111111111
                    solve( TPM_SendCommand( <'TPM2_Create', authPolicy> ) @ #t2.6 )
                      case eventTPMSendCommandTPMCreateswstatenilTPMCCPolicyPCRnil_0_11111111111112111
                      solve( state_11111111111112111( ~RouterID.1, ~ServerID.1, ~ak_h.1,
                                                      ~ak_sk.1, ~ssk_nms.1, ~tid.1
                             ) ▶₀ #t2.4 )
                        case outTPMPCRExtendswstate_0_1111111111111211
                        solve( TPM_SendCommand( <'TPM2_Create', <swstate, nil>, 
                                                 'TPM_CC_PolicyPCR', nil>
                               ) @ #t2.7 )
                          case eventTPMSendCommandTPMCreateswstatenilTPMCCPolicyPCRnil_0_11111111111112111
                          solve( state_11111111111112111( ~RouterID.1, ~ServerID.1, ~ak_h.1,
                                                          ~ak_sk.1, ~ssk_nms.1, ~tid.1
                                 ) ▶₀ #t2.5 )
                            case outTPMPCRExtendswstate_0_1111111111111211
                            by solve( !KU( ~ak_sk ) @ #vk.6 )
                          qed
                        qed
                      qed
                    qed
                  qed
                next
                  case case_2
                  solve( state_111111111111111111111121111111111( ~RouterID.1, ~ServerID.1,
                                                                  ~ak_h.1, ~ak_sk.1, ~k_h.1, ~k_sk.1,
                                                                  ~ssk_nms.1, authPolicy, ~n
                         ) ▶₀ #t2.1 )
                    case TpmCreateOutkhpkksk_0_11111111111111111111112111111111
                    solve( TPM_SendCommand( <'TPM2_Create', authPolicy> ) @ #t2.6 )
                      case eventTPMSendCommandTPMCreateswstatenilTPMCCPolicyPCRnil_0_11111111111112111
                      solve( state_11111111111112111( ~RouterID.1, ~ServerID.1, ~ak_h.1,
                                                      ~ak_sk.1, ~ssk_nms.1, ~tid.1
                             ) ▶₀ #t2.5 )
                        case outTPMPCRExtendswstate_0_1111111111111211
                        solve( TPM_SendCommand( <'TPM2_Create', <swstate, nil>, 
                                                 'TPM_CC_PolicyPCR', nil>
                               ) @ #t2.7 )
                          case eventTPMSendCommandTPMCreateswstatenilTPMCCPolicyPCRnil_0_11111111111112111
                          solve( state_11111111111112111( ~RouterID.1, ~ServerID.1, ~ak_h.1,
                                                          ~ak_sk.1, ~ssk_nms.1, ~tid.1
                                 ) ▶₀ #t2.6 )
                            case outTPMPCRExtendswstate_0_1111111111111211
                            by solve( !KU( ~ak_sk ) @ #vk.6 )
                          qed
                        qed
                      qed
                    qed
                  qed
                qed
              qed
            qed
          qed
        qed
      next
        case outtlsspkskaecsr_0_11111111111112111111111111111111111111
        solve( ((#vr.39 < #vr.69) ∧
                (∃ #t2.
                  (Unlock_5( '5', ~n, 'device' ) @ #t2)
                 ∧
                  (#vr.39 < #t2) ∧
                  (#t2 < #vr.69) ∧
                  (∀ #t0 pp. (Unlock( pp, ~n, 'device' ) @ #t0) ⇒ #t0 = #t2) ∧
                  (∀ pp lpp #t0.
                    (Lock( pp, lpp, 'device' ) @ #t0)
                   ⇒
                    ((#t0 < #vr.39) ∨ (#t0 = #vr.39) ∨ (#t2 < #t0))) ∧
                  (∀ pp lpp #t0.
                    (Unlock( pp, lpp, 'device' ) @ #t0)
                   ⇒
                    ((#t0 < #vr.39) ∨ (#t2 < #t0) ∨ (#t2 = #t0)))))  ∥
               (#vr.69 < #vr.39) )
          case case_1
          solve( TPM_SendCommand( <'TPM2_Sign', k_sh, k_h, pk(x), 
                                   sign(<pk(x), <swstate, nil>, 'TPM_CC_PolicyPCR', nil>, ~ak_sk)>
                 ) @ #t2 )
            case eventTPMSendCommandTPMSigntlsshtlshtlsspkskae_0_111111111111121111111111111111111
            solve( state_111111111111121111111111111111111( ~RouterID.1, ~ServerID.1,
                                                            ~ak_h.1, ~ak_sk.1, ~ssk_nms.1, ~tid,
                                                            sign(<pk(x), <swstate, nil>, 'TPM_CC_PolicyPCR', 
                                                                  nil>,
                                                                 ~ak_sk),
                                                            k_h, k_sh, pk(x)
                   ) ▶₀ #t2 )
              case ifverifyskaetlsspkswstatenilTPMCCPolicyPCRnilpkaksktrue_0_11111111111112111111111111111111
              by contradiction /* cyclic */
            qed
          qed
        next
          case case_2
          solve( state_111111111111111111111121111111111( ~RouterID.1, ~ServerID.1,
                                                          ~ak_h.1, ~ak_sk.1, ~k_h.2, ~k_sk.1, ~ssk_nms.1,
                                                          authPolicy.1, ~n.1
                 ) ▶₀ #t2 )
            case TpmCreateOutkhpkksk_0_11111111111111111111112111111111
            solve( TPM_SendCommand( <'TPM2_Sign', k_sh, k_h.1, pk(x), 
                                     sign(<pk(x), <swstate, nil>, 'TPM_CC_PolicyPCR', nil>, ~ak_sk)>
                   ) @ #t2.1 )
              case eventTPMSendCommandTPMSigntlsshtlshtlsspkskae_0_111111111111121111111111111111111
              solve( state_111111111111121111111111111111111( ~RouterID.1, ~ServerID.1,
                                                              ~ak_h.1, ~ak_sk.1, ~ssk_nms.1, ~tid,
                                                              sign(<pk(x), <swstate, nil>, 
                                                                    'TPM_CC_PolicyPCR', nil>,
                                                                   ~ak_sk),
                                                              k_h.1, k_sh, pk(x)
                     ) ▶₀ #t2.1 )
                case ifverifyskaetlsspkswstatenilTPMCCPolicyPCRnilpkaksktrue_0_11111111111112111111111111111111
                by contradiction /* from formulas */
              qed
            qed
          qed
        qed
      qed
    next
      case outsignobjpkobjapask_0_11111111111111111111211111111
      solve( TPM_SendCommand( <'TPM2_Certify', obj_sh, obj_h, a_h> ) @ #t2 )
        case eventTPMSendCommandTPMCertifytlsshtlshakh_0_111111111111121111111111111
        solve( state_111111111111121111111111111( ~RouterID.1, ~ServerID.1,
                                                  ~ak_h.1, ~ak_sk.1, ~ssk_nms.1, ~tid, obj_h, obj_sh, tls_spk
               ) ▶₀ #t2 )
          case outTPMPolicyPCRtlssh_0_11111111111112111111111111
          solve( (#vr.52 < #t2.3)  ∥ (#vr.52 = #t2.3) )
            case case_1
            solve( (#vr.56 < #t2.4)  ∥ (#vr.56 = #t2.4) )
              case case_1
              solve( (#vr.38 < #t2.2)  ∥ (#vr.38 = #t2.2) )
                case case_1
                solve( state_111111111111111111111121111111111( ~RouterID.1, ~ServerID.1,
                                                                ~ak_h.1, ~ak_sk.1, ~k_h.1, ~k_sk.1,
                                                                ~ssk_nms.1, authPolicy, ~n
                       ) ▶₀ #t2.1 )
                  case TpmCreateOutkhpkksk_0_11111111111111111111112111111111
                  solve( TPM_SendCommand( <'TPM2_Create', authPolicy> ) @ #t2.6 )
                    case eventTPMSendCommandTPMCreateswstatenilTPMCCPolicyPCRnil_0_11111111111112111
                    solve( state_11111111111112111( ~RouterID.1, ~ServerID.1, ~ak_h.1,
                                                    ~ak_sk.1, ~ssk_nms.1, ~tid.1
                           ) ▶₀ #t2.2 )
                      case outTPMPCRExtendswstate_0_1111111111111211
                      solve( TPM_SendCommand( <'TPM2_Create', <swstate, nil>, 
                                               'TPM_CC_PolicyPCR', nil>
                             ) @ #t2.7 )
                        case eventTPMSendCommandTPMCreateswstatenilTPMCCPolicyPCRnil_0_11111111111112111
                        solve( state_11111111111112111( ~RouterID.1, ~ServerID.1, ~ak_h.1,
                                                        ~ak_sk.1, ~ssk_nms.1, ~tid.1
                               ) ▶₀ #t2.3 )
                          case outTPMPCRExtendswstate_0_1111111111111211
                          solve( !KU( sign(<pk(x), 
                                            sign(<pk(x), <swstate, nil>, 'TPM_CC_PolicyPCR', nil>, ~ak_sk)>,
                                           x)
                                 ) @ #vk.4 )
                            case c_sign
                            solve( Insert( <'privatePart', ~ak_h>, ~ak_sk ) @ #t2.3 )
                              case insertprivatePartakhaksk_0_111111111111111
                              solve( state_111111111111111( ~RouterID.1, ~ServerID.1, ~ak_h, ~ak_sk,
                                                            ~ssk_nms.1
                                     ) ▶₀ #t2.3 )
                                case insertauthPolicyakhnil_0_11111111111111
                                by contradiction /* cyclic */
                              qed
                            next
                              case insertprivatePartkhksk_0_111111111111111111111121111111
                              by solve( state_111111111111111111111121111111( ~RouterID.1, ~ServerID.1,
                                                                              ~ak_h.1, ~ak_sk.1, ~ak_h,
                                                                              ~ak_sk, ~ssk_nms.1, authPolicy,
                                                                              lock
                                        ) ▶₀ #t2.3 )
                            qed
                          next
                            case outsignobjpkobjapask_0_11111111111111111111211111111
                            solve( ((#vr.29 < #vr.74) ∧
                                    (∃ #t2.
                                      (Unlock_4( '4', ~n.1, 'device' ) @ #t2)
                                     ∧
                                      (#vr.29 < #t2) ∧
                                      (#t2 < #vr.74) ∧
                                      (∀ #t0 pp. (Unlock( pp, ~n.1, 'device' ) @ #t0) ⇒ #t0 = #t2) ∧
                                      (∀ pp lpp #t0.
                                        (Lock( pp, lpp, 'device' ) @ #t0)
                                       ⇒
                                        ((#t0 < #vr.29) ∨ (#t0 = #vr.29) ∨ (#t2 < #t0))) ∧
                                      (∀ pp lpp #t0.
                                        (Unlock( pp, lpp, 'device' ) @ #t0)
                                       ⇒
                                        ((#t0 < #vr.29) ∨ (#t2 < #t0) ∨ (#t2 = #t0)))))  ∥
                                   (#vr.74 < #vr.29)  ∥ (#vr.29 = #vr.74) )
                              case case_1
                              solve( TPM_SendCommand( <'TPM2_Certify', obj_sh.1, obj_h, a_h>
                                     ) @ #t2.7 )
                                case eventTPMSendCommandTPMCertifytlsshtlshakh_0_111111111111121111111111111
                                by solve( state_111111111111121111111111111( ~RouterID.1, ~ServerID.1,
                                                                             ~ak_h.1, ~ak_sk.1, ~ssk_nms.1,
                                                                             ~tid.1, obj_h, obj_sh.1, tls_spk
                                          ) ▶₀ #t2.3 )
                              qed
                            next
                              case case_2
                              solve( (#vr.74 < #vr.57)  ∥ (#t2.1 < #vr.74) )
                                case case_1
                                solve( TPM_SendCommand( <'TPM2_Certify', obj_sh.1, obj_h, a_h>
                                       ) @ #t2.7 )
                                  case eventTPMSendCommandTPMCertifytlsshtlshakh_0_111111111111121111111111111
                                  by solve( state_111111111111121111111111111( ~RouterID.1, ~ServerID.1,
                                                                               ~ak_h.1, ~ak_sk.1, ~ssk_nms.1,
                                                                               ~tid.1, obj_h, obj_sh.1,
                                                                               tls_spk
                                            ) ▶₀ #t2.3 )
                                qed
                              next
                                case case_2
                                solve( TPM_SendCommand( <'TPM2_Certify', obj_sh.1, obj_h, a_h>
                                       ) @ #t2.7 )
                                  case eventTPMSendCommandTPMCertifytlsshtlshakh_0_111111111111121111111111111
                                  by solve( state_111111111111121111111111111( ~RouterID.1, ~ServerID.1,
                                                                               ~ak_h.1, ~ak_sk.1, ~ssk_nms.1,
                                                                               ~tid.1, obj_h, obj_sh.1,
                                                                               tls_spk
                                            ) ▶₀ #t2.3 )
                                qed
                              qed
                            qed
                          next
                            case outtlsspkskaecsr_0_11111111111112111111111111111111111111
                            solve( TPM_SendCommand( <'TPM2_Sign', k_sh, k_h.1, pk(x), 
                                                     sign(<pk(x), <swstate, nil>, 'TPM_CC_PolicyPCR', nil>,
                                                          ~ak_sk)
                                                    >
                                   ) @ #t2.8 )
                              case eventTPMSendCommandTPMSigntlsshtlshtlsspkskae_0_111111111111121111111111111111111
                              solve( state_111111111111121111111111111111111( ~RouterID.1, ~ServerID.1,
                                                                              ~ak_h.1, ~ak_sk.1, ~ssk_nms.1,
                                                                              ~tid.1,
                                                                              sign(<pk(x), <swstate, nil>, 
                                                                                    'TPM_CC_PolicyPCR', nil>,
                                                                                   ~ak_sk),
                                                                              k_h.1, k_sh, pk(x)
                                     ) ▶₀ #t2.3 )
                                case ifverifyskaetlsspkswstatenilTPMCCPolicyPCRnilpkaksktrue_0_11111111111112111111111111111111
                                by contradiction /* from formulas */
                              qed
                            qed
                          qed
                        qed
                      qed
                    qed
                  qed
                qed
              next
                case case_2
                solve( state_111111111111111111111121111111111( ~RouterID.1, ~ServerID.1,
                                                                ~ak_h.1, ~ak_sk.1, ~k_h.1, ~k_sk.1,
                                                                ~ssk_nms.1, authPolicy, ~n
                       ) ▶₀ #t2.1 )
                  case TpmCreateOutkhpkksk_0_11111111111111111111112111111111
                  solve( TPM_SendCommand( <'TPM2_Create', authPolicy> ) @ #t2.6 )
                    case eventTPMSendCommandTPMCreateswstatenilTPMCCPolicyPCRnil_0_11111111111112111
                    solve( state_11111111111112111( ~RouterID.1, ~ServerID.1, ~ak_h.1,
                                                    ~ak_sk.1, ~ssk_nms.1, ~tid.1
                           ) ▶₀ #t2.3 )
                      case outTPMPCRExtendswstate_0_1111111111111211
                      solve( TPM_SendCommand( <'TPM2_Create', <swstate, nil>, 
                                               'TPM_CC_PolicyPCR', nil>
                             ) @ #t2.7 )
                        case eventTPMSendCommandTPMCreateswstatenilTPMCCPolicyPCRnil_0_11111111111112111
                        solve( state_11111111111112111( ~RouterID.1, ~ServerID.1, ~ak_h.1,
                                                        ~ak_sk.1, ~ssk_nms.1, ~tid.1
                               ) ▶₀ #t2.4 )
                          case outTPMPCRExtendswstate_0_1111111111111211
                          solve( !KU( sign(<pk(x), 
                                            sign(<pk(x), <swstate, nil>, 'TPM_CC_PolicyPCR', nil>, ~ak_sk)>,
                                           x)
                                 ) @ #vk.4 )
                            case c_sign
                            solve( Insert( <'privatePart', ~ak_h>, ~ak_sk ) @ #t2.2 )
                              case insertprivatePartakhaksk_0_111111111111111
                              solve( Insert( <'publicPart', ~k_h>, pk(x) ) @ #t2.4 )
                                case insertpublicPartakhpkaksk_0_1111111111111111
                                by solve( state_1111111111111111( ~RouterID.1, ~ServerID.1, ~k_h,
                                                                  ~ak_sk.1, ~ssk_nms.1
                                          ) ▶₀ #t2.4 )
                              next
                                case insertpublicPartkhpkksk_0_1111111111111111111111211111111
                                solve( state_1111111111111111111111211111111( ~RouterID.1, ~ServerID.1,
                                                                              ~ak_h.1, ~ak_sk.1, ~k_h, ~k_sk,
                                                                              ~ssk_nms.1, authPolicy, lock
                                       ) ▶₀ #t2.4 )
                                  case insertprivatePartkhksk_0_111111111111111111111121111111
                                  by contradiction /* cyclic */
                                qed
                              qed
                            qed
                          next
                            case outsignobjpkobjapask_0_11111111111111111111211111111
                            solve( ((#vr.29 < #vr.73) ∧
                                    (∃ #t2.
                                      (Unlock_4( '4', ~n.1, 'device' ) @ #t2)
                                     ∧
                                      (#vr.29 < #t2) ∧
                                      (#t2 < #vr.73) ∧
                                      (∀ #t0 pp. (Unlock( pp, ~n.1, 'device' ) @ #t0) ⇒ #t0 = #t2) ∧
                                      (∀ pp lpp #t0.
                                        (Lock( pp, lpp, 'device' ) @ #t0)
                                       ⇒
                                        ((#t0 < #vr.29) ∨ (#t0 = #vr.29) ∨ (#t2 < #t0))) ∧
                                      (∀ pp lpp #t0.
                                        (Unlock( pp, lpp, 'device' ) @ #t0)
                                       ⇒
                                        ((#t0 < #vr.29) ∨ (#t2 < #t0) ∨ (#t2 = #t0)))))  ∥
                                   (#vr.73 < #vr.29)  ∥ (#vr.29 = #vr.73) )
                              case case_1
                              solve( TPM_SendCommand( <'TPM2_Certify', obj_sh.1, obj_h, a_h>
                                     ) @ #t2.7 )
                                case eventTPMSendCommandTPMCertifytlsshtlshakh_0_111111111111121111111111111
                                by solve( state_111111111111121111111111111( ~RouterID.1, ~ServerID.1,
                                                                             ~ak_h.1, ~ak_sk.1, ~ssk_nms.1,
                                                                             ~tid.1, obj_h, obj_sh.1, tls_spk
                                          ) ▶₀ #t2.4 )
                              qed
                            next
                              case case_2
                              solve( (#vr.73 < #vr.56)  ∥ (#t2.1 < #vr.73) )
                                case case_1
                                solve( TPM_SendCommand( <'TPM2_Certify', obj_sh.1, obj_h, a_h>
                                       ) @ #t2.7 )
                                  case eventTPMSendCommandTPMCertifytlsshtlshakh_0_111111111111121111111111111
                                  by solve( state_111111111111121111111111111( ~RouterID.1, ~ServerID.1,
                                                                               ~ak_h.1, ~ak_sk.1, ~ssk_nms.1,
                                                                               ~tid.1, obj_h, obj_sh.1,
                                                                               tls_spk
                                            ) ▶₀ #t2.4 )
                                qed
                              next
                                case case_2
                                solve( TPM_SendCommand( <'TPM2_Certify', obj_sh.1, obj_h, a_h>
                                       ) @ #t2.7 )
                                  case eventTPMSendCommandTPMCertifytlsshtlshakh_0_111111111111121111111111111
                                  by solve( state_111111111111121111111111111( ~RouterID.1, ~ServerID.1,
                                                                               ~ak_h.1, ~ak_sk.1, ~ssk_nms.1,
                                                                               ~tid.1, obj_h, obj_sh.1,
                                                                               tls_spk
                                            ) ▶₀ #t2.4 )
                                qed
                              qed
                            qed
                          next
                            case outtlsspkskaecsr_0_11111111111112111111111111111111111111
                            solve( TPM_SendCommand( <'TPM2_Sign', k_sh, k_h.1, pk(x), 
                                                     sign(<pk(x), <swstate, nil>, 'TPM_CC_PolicyPCR', nil>,
                                                          ~ak_sk)
                                                    >
                                   ) @ #t2.8 )
                              case eventTPMSendCommandTPMSigntlsshtlshtlsspkskae_0_111111111111121111111111111111111
                              solve( state_111111111111121111111111111111111( ~RouterID.1, ~ServerID.1,
                                                                              ~ak_h.1, ~ak_sk.1, ~ssk_nms.1,
                                                                              ~tid.1,
                                                                              sign(<pk(x), <swstate, nil>, 
                                                                                    'TPM_CC_PolicyPCR', nil>,
                                                                                   ~ak_sk),
                                                                              k_h.1, k_sh, pk(x)
                                     ) ▶₀ #t2.4 )
                                case ifverifyskaetlsspkswstatenilTPMCCPolicyPCRnilpkaksktrue_0_11111111111112111111111111111111
                                by contradiction /* from formulas */
                              qed
                            qed
                          qed
                        qed
                      qed
                    qed
                  qed
                qed
              qed
            next
              case case_2
              solve( (#vr.38 < #t2.3)  ∥ (#vr.38 = #t2.3) )
                case case_1
                solve( state_111111111111111111111121111111111( ~RouterID.1, ~ServerID.1,
                                                                ~ak_h.1, ~ak_sk.1, ~k_h.1, ~k_sk.1,
                                                                ~ssk_nms.1, authPolicy, ~n
                       ) ▶₀ #t2.1 )
                  case TpmCreateOutkhpkksk_0_11111111111111111111112111111111
                  solve( TPM_SendCommand( <'TPM2_Create', authPolicy> ) @ #t2.6 )
                    case eventTPMSendCommandTPMCreateswstatenilTPMCCPolicyPCRnil_0_11111111111112111
                    solve( state_11111111111112111( ~RouterID.1, ~ServerID.1, ~ak_h.1,
                                                    ~ak_sk.1, ~ssk_nms.1, ~tid.1
                           ) ▶₀ #t2.3 )
                      case outTPMPCRExtendswstate_0_1111111111111211
                      solve( TPM_SendCommand( <'TPM2_Create', <swstate, nil>, 
                                               'TPM_CC_PolicyPCR', nil>
                             ) @ #t2.7 )
                        case eventTPMSendCommandTPMCreateswstatenilTPMCCPolicyPCRnil_0_11111111111112111
                        solve( state_11111111111112111( ~RouterID.1, ~ServerID.1, ~ak_h.1,
                                                        ~ak_sk.1, ~ssk_nms.1, ~tid.1
                               ) ▶₀ #t2.4 )
                          case outTPMPCRExtendswstate_0_1111111111111211
                          solve( !KU( sign(<pk(x), 
                                            sign(<pk(x), <swstate, nil>, 'TPM_CC_PolicyPCR', nil>, ~ak_sk)>,
                                           x)
                                 ) @ #vk.4 )
                            case c_sign
                            solve( Insert( <'privatePart', ~ak_h>, ~ak_sk ) @ #t2.4 )
                              case insertprivatePartakhaksk_0_111111111111111
                              solve( state_111111111111111( ~RouterID.1, ~ServerID.1, ~ak_h, ~ak_sk,
                                                            ~ssk_nms.1
                                     ) ▶₀ #t2.4 )
                                case insertauthPolicyakhnil_0_11111111111111
                                by contradiction /* cyclic */
                              qed
                            next
                              case insertprivatePartkhksk_0_111111111111111111111121111111
                              by solve( state_111111111111111111111121111111( ~RouterID.1, ~ServerID.1,
                                                                              ~ak_h.1, ~ak_sk.1, ~ak_h,
                                                                              ~ak_sk, ~ssk_nms.1, authPolicy,
                                                                              lock
                                        ) ▶₀ #t2.4 )
                            qed
                          next
                            case outsignobjpkobjapask_0_11111111111111111111211111111
                            solve( ((#vr.29 < #vr.73) ∧
                                    (∃ #t2.
                                      (Unlock_4( '4', ~n.1, 'device' ) @ #t2)
                                     ∧
                                      (#vr.29 < #t2) ∧
                                      (#t2 < #vr.73) ∧
                                      (∀ #t0 pp. (Unlock( pp, ~n.1, 'device' ) @ #t0) ⇒ #t0 = #t2) ∧
                                      (∀ pp lpp #t0.
                                        (Lock( pp, lpp, 'device' ) @ #t0)
                                       ⇒
                                        ((#t0 < #vr.29) ∨ (#t0 = #vr.29) ∨ (#t2 < #t0))) ∧
                                      (∀ pp lpp #t0.
                                        (Unlock( pp, lpp, 'device' ) @ #t0)
                                       ⇒
                                        ((#t0 < #vr.29) ∨ (#t2 < #t0) ∨ (#t2 = #t0)))))  ∥
                                   (#vr.73 < #vr.29)  ∥ (#vr.29 = #vr.73) )
                              case case_1
                              solve( TPM_SendCommand( <'TPM2_Certify', obj_sh.1, obj_h, a_h>
                                     ) @ #t2.7 )
                                case eventTPMSendCommandTPMCertifytlsshtlshakh_0_111111111111121111111111111
                                by solve( state_111111111111121111111111111( ~RouterID.1, ~ServerID.1,
                                                                             ~ak_h.1, ~ak_sk.1, ~ssk_nms.1,
                                                                             ~tid.1, obj_h, obj_sh.1, tls_spk
                                          ) ▶₀ #t2.4 )
                              qed
                            next
                              case case_2
                              solve( (#vr.73 < #vr.56)  ∥ (#t2.1 < #vr.73) )
                                case case_1
                                solve( TPM_SendCommand( <'TPM2_Certify', obj_sh.1, obj_h, a_h>
                                       ) @ #t2.7 )
                                  case eventTPMSendCommandTPMCertifytlsshtlshakh_0_111111111111121111111111111
                                  by solve( state_111111111111121111111111111( ~RouterID.1, ~ServerID.1,
                                                                               ~ak_h.1, ~ak_sk.1, ~ssk_nms.1,
                                                                               ~tid.1, obj_h, obj_sh.1,
                                                                               tls_spk
                                            ) ▶₀ #t2.4 )
                                qed
                              next
                                case case_2
                                solve( TPM_SendCommand( <'TPM2_Certify', obj_sh.1, obj_h, a_h>
                                       ) @ #t2.7 )
                                  case eventTPMSendCommandTPMCertifytlsshtlshakh_0_111111111111121111111111111
                                  by solve( state_111111111111121111111111111( ~RouterID.1, ~ServerID.1,
                                                                               ~ak_h.1, ~ak_sk.1, ~ssk_nms.1,
                                                                               ~tid.1, obj_h, obj_sh.1,
                                                                               tls_spk
                                            ) ▶₀ #t2.4 )
                                qed
                              qed
                            qed
                          next
                            case outtlsspkskaecsr_0_11111111111112111111111111111111111111
                            solve( TPM_SendCommand( <'TPM2_Sign', k_sh, k_h.1, pk(x), 
                                                     sign(<pk(x), <swstate, nil>, 'TPM_CC_PolicyPCR', nil>,
                                                          ~ak_sk)
                                                    >
                                   ) @ #t2.8 )
                              case eventTPMSendCommandTPMSigntlsshtlshtlsspkskae_0_111111111111121111111111111111111
                              solve( state_111111111111121111111111111111111( ~RouterID.1, ~ServerID.1,
                                                                              ~ak_h.1, ~ak_sk.1, ~ssk_nms.1,
                                                                              ~tid.1,
                                                                              sign(<pk(x), <swstate, nil>, 
                                                                                    'TPM_CC_PolicyPCR', nil>,
                                                                                   ~ak_sk),
                                                                              k_h.1, k_sh, pk(x)
                                     ) ▶₀ #t2.4 )
                                case ifverifyskaetlsspkswstatenilTPMCCPolicyPCRnilpkaksktrue_0_11111111111112111111111111111111
                                by contradiction /* from formulas */
                              qed
                            qed
                          qed
                        qed
                      qed
                    qed
                  qed
                qed
              next
                case case_2
                solve( state_111111111111111111111121111111111( ~RouterID.1, ~ServerID.1,
                                                                ~ak_h.1, ~ak_sk.1, ~k_h.1, ~k_sk.1,
                                                                ~ssk_nms.1, authPolicy, ~n
                       ) ▶₀ #t2.1 )
                  case TpmCreateOutkhpkksk_0_11111111111111111111112111111111
                  solve( TPM_SendCommand( <'TPM2_Create', authPolicy> ) @ #t2.6 )
                    case eventTPMSendCommandTPMCreateswstatenilTPMCCPolicyPCRnil_0_11111111111112111
                    solve( state_11111111111112111( ~RouterID.1, ~ServerID.1, ~ak_h.1,
                                                    ~ak_sk.1, ~ssk_nms.1, ~tid.1
                           ) ▶₀ #t2.4 )
                      case outTPMPCRExtendswstate_0_1111111111111211
                      solve( TPM_SendCommand( <'TPM2_Create', <swstate, nil>, 
                                               'TPM_CC_PolicyPCR', nil>
                             ) @ #t2.7 )
                        case eventTPMSendCommandTPMCreateswstatenilTPMCCPolicyPCRnil_0_11111111111112111
                        solve( state_11111111111112111( ~RouterID.1, ~ServerID.1, ~ak_h.1,
                                                        ~ak_sk.1, ~ssk_nms.1, ~tid.1
                               ) ▶₀ #t2.5 )
                          case outTPMPCRExtendswstate_0_1111111111111211
                          solve( !KU( sign(<pk(x), 
                                            sign(<pk(x), <swstate, nil>, 'TPM_CC_PolicyPCR', nil>, ~ak_sk)>,
                                           x)
                                 ) @ #vk.4 )
                            case c_sign
                            solve( Insert( <'privatePart', ~ak_h>, ~ak_sk ) @ #t2.3 )
                              case insertprivatePartakhaksk_0_111111111111111
                              solve( Insert( <'publicPart', ~k_h>, pk(x) ) @ #t2.5 )
                                case insertpublicPartakhpkaksk_0_1111111111111111
                                by solve( state_1111111111111111( ~RouterID.1, ~ServerID.1, ~k_h,
                                                                  ~ak_sk.1, ~ssk_nms.1
                                          ) ▶₀ #t2.5 )
                              next
                                case insertpublicPartkhpkksk_0_1111111111111111111111211111111
                                solve( state_1111111111111111111111211111111( ~RouterID.1, ~ServerID.1,
                                                                              ~ak_h.1, ~ak_sk.1, ~k_h, ~k_sk,
                                                                              ~ssk_nms.1, authPolicy, lock
                                       ) ▶₀ #t2.5 )
                                  case insertprivatePartkhksk_0_111111111111111111111121111111
                                  by contradiction /* cyclic */
                                qed
                              qed
                            qed
                          next
                            case outsignobjpkobjapask_0_11111111111111111111211111111
                            solve( ((#vr.29 < #vr.72) ∧
                                    (∃ #t2.
                                      (Unlock_4( '4', ~n.1, 'device' ) @ #t2)
                                     ∧
                                      (#vr.29 < #t2) ∧
                                      (#t2 < #vr.72) ∧
                                      (∀ #t0 pp. (Unlock( pp, ~n.1, 'device' ) @ #t0) ⇒ #t0 = #t2) ∧
                                      (∀ pp lpp #t0.
                                        (Lock( pp, lpp, 'device' ) @ #t0)
                                       ⇒
                                        ((#t0 < #vr.29) ∨ (#t0 = #vr.29) ∨ (#t2 < #t0))) ∧
                                      (∀ pp lpp #t0.
                                        (Unlock( pp, lpp, 'device' ) @ #t0)
                                       ⇒
                                        ((#t0 < #vr.29) ∨ (#t2 < #t0) ∨ (#t2 = #t0)))))  ∥
                                   (#vr.72 < #vr.29)  ∥ (#vr.29 = #vr.72) )
                              case case_1
                              solve( TPM_SendCommand( <'TPM2_Certify', obj_sh.1, obj_h, a_h>
                                     ) @ #t2.7 )
                                case eventTPMSendCommandTPMCertifytlsshtlshakh_0_111111111111121111111111111
                                by solve( state_111111111111121111111111111( ~RouterID.1, ~ServerID.1,
                                                                             ~ak_h.1, ~ak_sk.1, ~ssk_nms.1,
                                                                             ~tid.1, obj_h, obj_sh.1, tls_spk
                                          ) ▶₀ #t2.5 )
                              qed
                            next
                              case case_2
                              solve( (#vr.72 < #vr.55)  ∥ (#t2.1 < #vr.72) )
                                case case_1
                                solve( TPM_SendCommand( <'TPM2_Certify', obj_sh.1, obj_h, a_h>
                                       ) @ #t2.7 )
                                  case eventTPMSendCommandTPMCertifytlsshtlshakh_0_111111111111121111111111111
                                  by solve( state_111111111111121111111111111( ~RouterID.1, ~ServerID.1,
                                                                               ~ak_h.1, ~ak_sk.1, ~ssk_nms.1,
                                                                               ~tid.1, obj_h, obj_sh.1,
                                                                               tls_spk
                                            ) ▶₀ #t2.5 )
                                qed
                              next
                                case case_2
                                solve( TPM_SendCommand( <'TPM2_Certify', obj_sh.1, obj_h, a_h>
                                       ) @ #t2.7 )
                                  case eventTPMSendCommandTPMCertifytlsshtlshakh_0_111111111111121111111111111
                                  by solve( state_111111111111121111111111111( ~RouterID.1, ~ServerID.1,
                                                                               ~ak_h.1, ~ak_sk.1, ~ssk_nms.1,
                                                                               ~tid.1, obj_h, obj_sh.1,
                                                                               tls_spk
                                            ) ▶₀ #t2.5 )
                                qed
                              qed
                            qed
                          next
                            case outtlsspkskaecsr_0_11111111111112111111111111111111111111
                            solve( TPM_SendCommand( <'TPM2_Sign', k_sh, k_h.1, pk(x), 
                                                     sign(<pk(x), <swstate, nil>, 'TPM_CC_PolicyPCR', nil>,
                                                          ~ak_sk)
                                                    >
                                   ) @ #t2.8 )
                              case eventTPMSendCommandTPMSigntlsshtlshtlsspkskae_0_111111111111121111111111111111111
                              solve( state_111111111111121111111111111111111( ~RouterID.1, ~ServerID.1,
                                                                              ~ak_h.1, ~ak_sk.1, ~ssk_nms.1,
                                                                              ~tid.1,
                                                                              sign(<pk(x), <swstate, nil>, 
                                                                                    'TPM_CC_PolicyPCR', nil>,
                                                                                   ~ak_sk),
                                                                              k_h.1, k_sh, pk(x)
                                     ) ▶₀ #t2.5 )
                                case ifverifyskaetlsspkswstatenilTPMCCPolicyPCRnilpkaksktrue_0_11111111111112111111111111111111
                                by contradiction /* from formulas */
                              qed
                            qed
                          qed
                        qed
                      qed
                    qed
                  qed
                qed
              qed
            qed
          next
            case case_2
            solve( (#vr.55 < #t2.4)  ∥ (#vr.55 = #t2.4) )
              case case_1
              solve( (#vr.38 < #t2.3)  ∥ (#vr.38 = #t2.3) )
                case case_1
                solve( state_111111111111111111111121111111111( ~RouterID.1, ~ServerID.1,
                                                                ~ak_h.1, ~ak_sk.1, ~k_h.1, ~k_sk.1,
                                                                ~ssk_nms.1, authPolicy, ~n
                       ) ▶₀ #t2.1 )
                  case TpmCreateOutkhpkksk_0_11111111111111111111112111111111
                  solve( TPM_SendCommand( <'TPM2_Create', authPolicy> ) @ #t2.6 )
                    case eventTPMSendCommandTPMCreateswstatenilTPMCCPolicyPCRnil_0_11111111111112111
                    solve( state_11111111111112111( ~RouterID.1, ~ServerID.1, ~ak_h.1,
                                                    ~ak_sk.1, ~ssk_nms.1, ~tid.1
                           ) ▶₀ #t2.3 )
                      case outTPMPCRExtendswstate_0_1111111111111211
                      solve( TPM_SendCommand( <'TPM2_Create', <swstate, nil>, 
                                               'TPM_CC_PolicyPCR', nil>
                             ) @ #t2.7 )
                        case eventTPMSendCommandTPMCreateswstatenilTPMCCPolicyPCRnil_0_11111111111112111
                        solve( state_11111111111112111( ~RouterID.1, ~ServerID.1, ~ak_h.1,
                                                        ~ak_sk.1, ~ssk_nms.1, ~tid.1
                               ) ▶₀ #t2.4 )
                          case outTPMPCRExtendswstate_0_1111111111111211
                          solve( !KU( sign(<pk(x), 
                                            sign(<pk(x), <swstate, nil>, 'TPM_CC_PolicyPCR', nil>, ~ak_sk)>,
                                           x)
                                 ) @ #vk.4 )
                            case c_sign
                            solve( Insert( <'privatePart', ~ak_h>, ~ak_sk ) @ #t2.4 )
                              case insertprivatePartakhaksk_0_111111111111111
                              solve( state_111111111111111( ~RouterID.1, ~ServerID.1, ~ak_h, ~ak_sk,
                                                            ~ssk_nms.1
                                     ) ▶₀ #t2.4 )
                                case insertauthPolicyakhnil_0_11111111111111
                                by contradiction /* cyclic */
                              qed
                            next
                              case insertprivatePartkhksk_0_111111111111111111111121111111
                              by solve( state_111111111111111111111121111111( ~RouterID.1, ~ServerID.1,
                                                                              ~ak_h.1, ~ak_sk.1, ~ak_h,
                                                                              ~ak_sk, ~ssk_nms.1, authPolicy,
                                                                              lock
                                        ) ▶₀ #t2.4 )
                            qed
                          next
                            case outsignobjpkobjapask_0_11111111111111111111211111111
                            solve( ((#vr.29 < #vr.73) ∧
                                    (∃ #t2.
                                      (Unlock_4( '4', ~n.1, 'device' ) @ #t2)
                                     ∧
                                      (#vr.29 < #t2) ∧
                                      (#t2 < #vr.73) ∧
                                      (∀ #t0 pp. (Unlock( pp, ~n.1, 'device' ) @ #t0) ⇒ #t0 = #t2) ∧
                                      (∀ pp lpp #t0.
                                        (Lock( pp, lpp, 'device' ) @ #t0)
                                       ⇒
                                        ((#t0 < #vr.29) ∨ (#t0 = #vr.29) ∨ (#t2 < #t0))) ∧
                                      (∀ pp lpp #t0.
                                        (Unlock( pp, lpp, 'device' ) @ #t0)
                                       ⇒
                                        ((#t0 < #vr.29) ∨ (#t2 < #t0) ∨ (#t2 = #t0)))))  ∥
                                   (#vr.73 < #vr.29)  ∥ (#vr.29 = #vr.73) )
                              case case_1
                              solve( TPM_SendCommand( <'TPM2_Certify', obj_sh.1, obj_h, a_h>
                                     ) @ #t2.7 )
                                case eventTPMSendCommandTPMCertifytlsshtlshakh_0_111111111111121111111111111
                                by solve( state_111111111111121111111111111( ~RouterID.1, ~ServerID.1,
                                                                             ~ak_h.1, ~ak_sk.1, ~ssk_nms.1,
                                                                             ~tid.1, obj_h, obj_sh.1, tls_spk
                                          ) ▶₀ #t2.4 )
                              qed
                            next
                              case case_2
                              solve( (#vr.73 < #vr.56)  ∥ (#t2.1 < #vr.73) )
                                case case_1
                                solve( TPM_SendCommand( <'TPM2_Certify', obj_sh.1, obj_h, a_h>
                                       ) @ #t2.7 )
                                  case eventTPMSendCommandTPMCertifytlsshtlshakh_0_111111111111121111111111111
                                  by solve( state_111111111111121111111111111( ~RouterID.1, ~ServerID.1,
                                                                               ~ak_h.1, ~ak_sk.1, ~ssk_nms.1,
                                                                               ~tid.1, obj_h, obj_sh.1,
                                                                               tls_spk
                                            ) ▶₀ #t2.4 )
                                qed
                              next
                                case case_2
                                solve( TPM_SendCommand( <'TPM2_Certify', obj_sh.1, obj_h, a_h>
                                       ) @ #t2.7 )
                                  case eventTPMSendCommandTPMCertifytlsshtlshakh_0_111111111111121111111111111
                                  by solve( state_111111111111121111111111111( ~RouterID.1, ~ServerID.1,
                                                                               ~ak_h.1, ~ak_sk.1, ~ssk_nms.1,
                                                                               ~tid.1, obj_h, obj_sh.1,
                                                                               tls_spk
                                            ) ▶₀ #t2.4 )
                                qed
                              qed
                            qed
                          next
                            case outtlsspkskaecsr_0_11111111111112111111111111111111111111
                            solve( TPM_SendCommand( <'TPM2_Sign', k_sh, k_h.1, pk(x), 
                                                     sign(<pk(x), <swstate, nil>, 'TPM_CC_PolicyPCR', nil>,
                                                          ~ak_sk)
                                                    >
                                   ) @ #t2.8 )
                              case eventTPMSendCommandTPMSigntlsshtlshtlsspkskae_0_111111111111121111111111111111111
                              solve( state_111111111111121111111111111111111( ~RouterID.1, ~ServerID.1,
                                                                              ~ak_h.1, ~ak_sk.1, ~ssk_nms.1,
                                                                              ~tid.1,
                                                                              sign(<pk(x), <swstate, nil>, 
                                                                                    'TPM_CC_PolicyPCR', nil>,
                                                                                   ~ak_sk),
                                                                              k_h.1, k_sh, pk(x)
                                     ) ▶₀ #t2.4 )
                                case ifverifyskaetlsspkswstatenilTPMCCPolicyPCRnilpkaksktrue_0_11111111111112111111111111111111
                                by contradiction /* from formulas */
                              qed
                            qed
                          qed
                        qed
                      qed
                    qed
                  qed
                qed
              next
                case case_2
                solve( state_111111111111111111111121111111111( ~RouterID.1, ~ServerID.1,
                                                                ~ak_h.1, ~ak_sk.1, ~k_h.1, ~k_sk.1,
                                                                ~ssk_nms.1, authPolicy, ~n
                       ) ▶₀ #t2.1 )
                  case TpmCreateOutkhpkksk_0_11111111111111111111112111111111
                  solve( TPM_SendCommand( <'TPM2_Create', authPolicy> ) @ #t2.6 )
                    case eventTPMSendCommandTPMCreateswstatenilTPMCCPolicyPCRnil_0_11111111111112111
                    solve( state_11111111111112111( ~RouterID.1, ~ServerID.1, ~ak_h.1,
                                                    ~ak_sk.1, ~ssk_nms.1, ~tid.1
                           ) ▶₀ #t2.4 )
                      case outTPMPCRExtendswstate_0_1111111111111211
                      solve( TPM_SendCommand( <'TPM2_Create', <swstate, nil>, 
                                               'TPM_CC_PolicyPCR', nil>
                             ) @ #t2.7 )
                        case eventTPMSendCommandTPMCreateswstatenilTPMCCPolicyPCRnil_0_11111111111112111
                        solve( state_11111111111112111( ~RouterID.1, ~ServerID.1, ~ak_h.1,
                                                        ~ak_sk.1, ~ssk_nms.1, ~tid.1
                               ) ▶₀ #t2.5 )
                          case outTPMPCRExtendswstate_0_1111111111111211
                          solve( !KU( sign(<pk(x), 
                                            sign(<pk(x), <swstate, nil>, 'TPM_CC_PolicyPCR', nil>, ~ak_sk)>,
                                           x)
                                 ) @ #vk.4 )
                            case c_sign
                            solve( Insert( <'privatePart', ~ak_h>, ~ak_sk ) @ #t2.3 )
                              case insertprivatePartakhaksk_0_111111111111111
                              solve( Insert( <'publicPart', ~k_h>, pk(x) ) @ #t2.2 )
                                case insertpublicPartkhpkksk_0_1111111111111111111111211111111
                                solve( !KU( pk(~k_sk) ) @ #vk.4 )
                                  case c_pk
                                  solve( Insert( <'authPolicy', ~k_h>,
                                                 <<swstate, nil>, 'TPM_CC_PolicyPCR', nil>
                                         ) @ #t2.5 )
                                    case insertauthPolicykhauthPolicy_0_11111111111111111111112111111
                                    solve( state_11111111111111111111112111111( ~RouterID.1, ~ServerID.1,
                                                                                ~ak_h.1, ~ak_sk.1, ~k_h,
                                                                                ~k_sk.1, ~ssk_nms.1,
                                                                                <<swstate, nil>, 
                                                                                 'TPM_CC_PolicyPCR', nil>,
                                                                                lock
                                           ) ▶₀ #t2.5 )
                                      case lockdevice_0_1111111111111111111111211111
                                      by contradiction /* cyclic */
                                    qed
                                  qed
                                next
                                  case outTPMSigntlsshtlshtlsspkskae_0_1111111111111211111111111111111111
                                  solve( TPM_SendCommand( <'TPM2_Create', <swstate, nil>, 
                                                           'TPM_CC_PolicyPCR', nil>
                                         ) @ #t2.7 )
                                    case eventTPMSendCommandTPMCreateswstatenilTPMCCPolicyPCRnil_0_11111111111112111
                                    solve( state_11111111111112111( ~RouterID.1, ~ServerID.1, ~ak_h.1,
                                                                    ~ak_sk.1, ~ssk_nms.1, ~tid.1
                                           ) ▶₀ #t2.5 )
                                      case outTPMPCRExtendswstate_0_1111111111111211
                                      solve( Insert( <'authPolicy', ~k_h>,
                                                     <<swstate, nil>, 'TPM_CC_PolicyPCR', nil>
                                             ) @ #t2.5 )
                                        case insertauthPolicykhauthPolicy_0_11111111111111111111112111111
                                        solve( state_11111111111111111111112111111( ~RouterID.1, ~ServerID.1,
                                                                                    ~ak_h.1, ~ak_sk.1, ~k_h,
                                                                                    ~k_sk.1, ~ssk_nms.1,
                                                                                    <<swstate, nil>, 
                                                                                     'TPM_CC_PolicyPCR', nil>,
                                                                                    lock
                                               ) ▶₀ #t2.5 )
                                          case lockdevice_0_1111111111111111111111211111
                                          by contradiction /* cyclic */
                                        qed
                                      qed
                                    qed
                                  qed
                                next
                                  case outtlsspkskaecsr_0_11111111111112111111111111111111111111
                                  by contradiction /* from formulas */
                                qed
                              qed
                            qed
                          next
                            case outsignobjpkobjapask_0_11111111111111111111211111111
                            solve( ((#vr.29 < #vr.72) ∧
                                    (∃ #t2.
                                      (Unlock_4( '4', ~n.1, 'device' ) @ #t2)
                                     ∧
                                      (#vr.29 < #t2) ∧
                                      (#t2 < #vr.72) ∧
                                      (∀ #t0 pp. (Unlock( pp, ~n.1, 'device' ) @ #t0) ⇒ #t0 = #t2) ∧
                                      (∀ pp lpp #t0.
                                        (Lock( pp, lpp, 'device' ) @ #t0)
                                       ⇒
                                        ((#t0 < #vr.29) ∨ (#t0 = #vr.29) ∨ (#t2 < #t0))) ∧
                                      (∀ pp lpp #t0.
                                        (Unlock( pp, lpp, 'device' ) @ #t0)
                                       ⇒
                                        ((#t0 < #vr.29) ∨ (#t2 < #t0) ∨ (#t2 = #t0)))))  ∥
                                   (#vr.72 < #vr.29)  ∥ (#vr.29 = #vr.72) )
                              case case_1
                              solve( TPM_SendCommand( <'TPM2_Certify', obj_sh.1, obj_h, a_h>
                                     ) @ #t2.7 )
                                case eventTPMSendCommandTPMCertifytlsshtlshakh_0_111111111111121111111111111
                                by solve( state_111111111111121111111111111( ~RouterID.1, ~ServerID.1,
                                                                             ~ak_h.1, ~ak_sk.1, ~ssk_nms.1,
                                                                             ~tid.1, obj_h, obj_sh.1, tls_spk
                                          ) ▶₀ #t2.5 )
                              qed
                            next
                              case case_2
                              solve( (#vr.72 < #vr.55)  ∥ (#t2.1 < #vr.72) )
                                case case_1
                                solve( TPM_SendCommand( <'TPM2_Certify', obj_sh.1, obj_h, a_h>
                                       ) @ #t2.7 )
                                  case eventTPMSendCommandTPMCertifytlsshtlshakh_0_111111111111121111111111111
                                  by solve( state_111111111111121111111111111( ~RouterID.1, ~ServerID.1,
                                                                               ~ak_h.1, ~ak_sk.1, ~ssk_nms.1,
                                                                               ~tid.1, obj_h, obj_sh.1,
                                                                               tls_spk
                                            ) ▶₀ #t2.5 )
                                qed
                              next
                                case case_2
                                solve( TPM_SendCommand( <'TPM2_Certify', obj_sh.1, obj_h, a_h>
                                       ) @ #t2.7 )
                                  case eventTPMSendCommandTPMCertifytlsshtlshakh_0_111111111111121111111111111
                                  by solve( state_111111111111121111111111111( ~RouterID.1, ~ServerID.1,
                                                                               ~ak_h.1, ~ak_sk.1, ~ssk_nms.1,
                                                                               ~tid.1, obj_h, obj_sh.1,
                                                                               tls_spk
                                            ) ▶₀ #t2.5 )
                                qed
                              qed
                            qed
                          next
                            case outtlsspkskaecsr_0_11111111111112111111111111111111111111
                            solve( TPM_SendCommand( <'TPM2_Sign', k_sh, k_h.1, pk(x), 
                                                     sign(<pk(x), <swstate, nil>, 'TPM_CC_PolicyPCR', nil>,
                                                          ~ak_sk)
                                                    >
                                   ) @ #t2.8 )
                              case eventTPMSendCommandTPMSigntlsshtlshtlsspkskae_0_111111111111121111111111111111111
                              solve( state_111111111111121111111111111111111( ~RouterID.1, ~ServerID.1,
                                                                              ~ak_h.1, ~ak_sk.1, ~ssk_nms.1,
                                                                              ~tid.1,
                                                                              sign(<pk(x), <swstate, nil>, 
                                                                                    'TPM_CC_PolicyPCR', nil>,
                                                                                   ~ak_sk),
                                                                              k_h.1, k_sh, pk(x)
                                     ) ▶₀ #t2.5 )
                                case ifverifyskaetlsspkswstatenilTPMCCPolicyPCRnilpkaksktrue_0_11111111111112111111111111111111
                                by contradiction /* from formulas */
                              qed
                            qed
                          qed
                        qed
                      qed
                    qed
                  qed
                qed
              qed
            next
              case case_2
              solve( (#vr.38 < #t2.4)  ∥ (#vr.38 = #t2.4) )
                case case_1
                solve( state_111111111111111111111121111111111( ~RouterID.1, ~ServerID.1,
                                                                ~ak_h.1, ~ak_sk.1, ~k_h.1, ~k_sk.1,
                                                                ~ssk_nms.1, authPolicy, ~n
                       ) ▶₀ #t2.1 )
                  case TpmCreateOutkhpkksk_0_11111111111111111111112111111111
                  solve( TPM_SendCommand( <'TPM2_Create', authPolicy> ) @ #t2.6 )
                    case eventTPMSendCommandTPMCreateswstatenilTPMCCPolicyPCRnil_0_11111111111112111
                    solve( state_11111111111112111( ~RouterID.1, ~ServerID.1, ~ak_h.1,
                                                    ~ak_sk.1, ~ssk_nms.1, ~tid.1
                           ) ▶₀ #t2.4 )
                      case outTPMPCRExtendswstate_0_1111111111111211
                      solve( TPM_SendCommand( <'TPM2_Create', <swstate, nil>, 
                                               'TPM_CC_PolicyPCR', nil>
                             ) @ #t2.7 )
                        case eventTPMSendCommandTPMCreateswstatenilTPMCCPolicyPCRnil_0_11111111111112111
                        solve( state_11111111111112111( ~RouterID.1, ~ServerID.1, ~ak_h.1,
                                                        ~ak_sk.1, ~ssk_nms.1, ~tid.1
                               ) ▶₀ #t2.5 )
                          case outTPMPCRExtendswstate_0_1111111111111211
                          solve( !KU( sign(<pk(x), 
                                            sign(<pk(x), <swstate, nil>, 'TPM_CC_PolicyPCR', nil>, ~ak_sk)>,
                                           x)
                                 ) @ #vk.4 )
                            case c_sign
                            solve( Insert( <'privatePart', ~ak_h>, ~ak_sk ) @ #t2.5 )
                              case insertprivatePartakhaksk_0_111111111111111
                              solve( state_111111111111111( ~RouterID.1, ~ServerID.1, ~ak_h, ~ak_sk,
                                                            ~ssk_nms.1
                                     ) ▶₀ #t2.5 )
                                case insertauthPolicyakhnil_0_11111111111111
                                by contradiction /* cyclic */
                              qed
                            next
                              case insertprivatePartkhksk_0_111111111111111111111121111111
                              by solve( state_111111111111111111111121111111( ~RouterID.1, ~ServerID.1,
                                                                              ~ak_h.1, ~ak_sk.1, ~ak_h,
                                                                              ~ak_sk, ~ssk_nms.1, authPolicy,
                                                                              lock
                                        ) ▶₀ #t2.5 )
                            qed
                          next
                            case outsignobjpkobjapask_0_11111111111111111111211111111
                            solve( ((#vr.29 < #vr.72) ∧
                                    (∃ #t2.
                                      (Unlock_4( '4', ~n.1, 'device' ) @ #t2)
                                     ∧
                                      (#vr.29 < #t2) ∧
                                      (#t2 < #vr.72) ∧
                                      (∀ #t0 pp. (Unlock( pp, ~n.1, 'device' ) @ #t0) ⇒ #t0 = #t2) ∧
                                      (∀ pp lpp #t0.
                                        (Lock( pp, lpp, 'device' ) @ #t0)
                                       ⇒
                                        ((#t0 < #vr.29) ∨ (#t0 = #vr.29) ∨ (#t2 < #t0))) ∧
                                      (∀ pp lpp #t0.
                                        (Unlock( pp, lpp, 'device' ) @ #t0)
                                       ⇒
                                        ((#t0 < #vr.29) ∨ (#t2 < #t0) ∨ (#t2 = #t0)))))  ∥
                                   (#vr.72 < #vr.29)  ∥ (#vr.29 = #vr.72) )
                              case case_1
                              solve( TPM_SendCommand( <'TPM2_Certify', obj_sh.1, obj_h, a_h>
                                     ) @ #t2.7 )
                                case eventTPMSendCommandTPMCertifytlsshtlshakh_0_111111111111121111111111111
                                by solve( state_111111111111121111111111111( ~RouterID.1, ~ServerID.1,
                                                                             ~ak_h.1, ~ak_sk.1, ~ssk_nms.1,
                                                                             ~tid.1, obj_h, obj_sh.1, tls_spk
                                          ) ▶₀ #t2.5 )
                              qed
                            next
                              case case_2
                              solve( (#vr.72 < #vr.55)  ∥ (#t2.1 < #vr.72) )
                                case case_1
                                solve( TPM_SendCommand( <'TPM2_Certify', obj_sh.1, obj_h, a_h>
                                       ) @ #t2.7 )
                                  case eventTPMSendCommandTPMCertifytlsshtlshakh_0_111111111111121111111111111
                                  by solve( state_111111111111121111111111111( ~RouterID.1, ~ServerID.1,
                                                                               ~ak_h.1, ~ak_sk.1, ~ssk_nms.1,
                                                                               ~tid.1, obj_h, obj_sh.1,
                                                                               tls_spk
                                            ) ▶₀ #t2.5 )
                                qed
                              next
                                case case_2
                                solve( TPM_SendCommand( <'TPM2_Certify', obj_sh.1, obj_h, a_h>
                                       ) @ #t2.7 )
                                  case eventTPMSendCommandTPMCertifytlsshtlshakh_0_111111111111121111111111111
                                  by solve( state_111111111111121111111111111( ~RouterID.1, ~ServerID.1,
                                                                               ~ak_h.1, ~ak_sk.1, ~ssk_nms.1,
                                                                               ~tid.1, obj_h, obj_sh.1,
                                                                               tls_spk
                                            ) ▶₀ #t2.5 )
                                qed
                              qed
                            qed
                          next
                            case outtlsspkskaecsr_0_11111111111112111111111111111111111111
                            solve( TPM_SendCommand( <'TPM2_Sign', k_sh, k_h.1, pk(x), 
                                                     sign(<pk(x), <swstate, nil>, 'TPM_CC_PolicyPCR', nil>,
                                                          ~ak_sk)
                                                    >
                                   ) @ #t2.8 )
                              case eventTPMSendCommandTPMSigntlsshtlshtlsspkskae_0_111111111111121111111111111111111
                              solve( state_111111111111121111111111111111111( ~RouterID.1, ~ServerID.1,
                                                                              ~ak_h.1, ~ak_sk.1, ~ssk_nms.1,
                                                                              ~tid.1,
                                                                              sign(<pk(x), <swstate, nil>, 
                                                                                    'TPM_CC_PolicyPCR', nil>,
                                                                                   ~ak_sk),
                                                                              k_h.1, k_sh, pk(x)
                                     ) ▶₀ #t2.5 )
                                case ifverifyskaetlsspkswstatenilTPMCCPolicyPCRnilpkaksktrue_0_11111111111112111111111111111111
                                by contradiction /* from formulas */
                              qed
                            qed
                          qed
                        qed
                      qed
                    qed
                  qed
                qed
              next
                case case_2
                solve( state_111111111111111111111121111111111( ~RouterID.1, ~ServerID.1,
                                                                ~ak_h.1, ~ak_sk.1, ~k_h.1, ~k_sk.1,
                                                                ~ssk_nms.1, authPolicy, ~n
                       ) ▶₀ #t2.1 )
                  case TpmCreateOutkhpkksk_0_11111111111111111111112111111111
                  solve( TPM_SendCommand( <'TPM2_Create', authPolicy> ) @ #t2.6 )
                    case eventTPMSendCommandTPMCreateswstatenilTPMCCPolicyPCRnil_0_11111111111112111
                    solve( state_11111111111112111( ~RouterID.1, ~ServerID.1, ~ak_h.1,
                                                    ~ak_sk.1, ~ssk_nms.1, ~tid.1
                           ) ▶₀ #t2.5 )
                      case outTPMPCRExtendswstate_0_1111111111111211
                      solve( TPM_SendCommand( <'TPM2_Create', <swstate, nil>, 
                                               'TPM_CC_PolicyPCR', nil>
                             ) @ #t2.7 )
                        case eventTPMSendCommandTPMCreateswstatenilTPMCCPolicyPCRnil_0_11111111111112111
                        solve( state_11111111111112111( ~RouterID.1, ~ServerID.1, ~ak_h.1,
                                                        ~ak_sk.1, ~ssk_nms.1, ~tid.1
                               ) ▶₀ #t2.6 )
                          case outTPMPCRExtendswstate_0_1111111111111211
                          solve( !KU( sign(<pk(x), 
                                            sign(<pk(x), <swstate, nil>, 'TPM_CC_PolicyPCR', nil>, ~ak_sk)>,
                                           x)
                                 ) @ #vk.4 )
                            case c_sign
                            solve( Insert( <'privatePart', ~ak_h>, ~ak_sk ) @ #t2.4 )
                              case insertprivatePartakhaksk_0_111111111111111
                              solve( Insert( <'publicPart', ~k_h>, pk(x) ) @ #t2.2 )
                                case insertpublicPartkhpkksk_0_1111111111111111111111211111111
                                solve( !KU( pk(~k_sk) ) @ #vk.4 )
                                  case c_pk
                                  solve( Insert( <'authPolicy', ~k_h>,
                                                 <<swstate, nil>, 'TPM_CC_PolicyPCR', nil>
                                         ) @ #t2.3 )
                                    case insertauthPolicykhauthPolicy_0_11111111111111111111112111111
                                    solve( Insert( <'policyDigest', obj_sh>,
                                                   <<swstate, nil>, 'TPM_CC_PolicyPCR', nil>
                                           ) @ #t2.6 )
                                      case insertpolicyDigestshpcrLTPMCCPolicyPCRpL_0_111111111111111111111112111111
                                      solve( state_111111111111111111111112111111( ~RouterID.1, ~ServerID.1,
                                                                                   ~ak_h.1, ~ak_sk.1,
                                                                                   ~ssk_nms.1, nil,
                                                                                   <swstate, nil>, obj_sh,
                                                                                   lock
                                             ) ▶₀ #t2.6 )
                                        case eventPolicyPCRshpL_0_11111111111111111111111211111
                                        solve( (#vr.68 < #vr.54)  ∥ (#t2.1 < #vr.68) )
                                          case case_1
                                          solve( (#vr.36 < #t2.10)  ∥ (#vr.36 = #t2.10) )
                                            case case_1
                                            solve( state_1111111111111111111111121111111( ~RouterID.1,
                                                                                          ~ServerID.1,
                                                                                          ~ak_h.1, ~ak_sk.1,
                                                                                          ~ssk_nms.1, pL,
                                                                                          pcrL, s_h, ~n.1
                                                   ) ▶₀ #t2.7 )
                                              case insertpolicyDigestshpcrLTPMCCPolicyPCRpL_0_111111111111111111111112111111
                                              solve( (#vr.36 < #t2.13)  ∥ (#vr.36 = #t2.13) )
                                                case case_1
                                                solve( (#t2.10 < #t2.13)  ∥ (#t2.10 = #t2.13) )
                                                  case case_1
                                                  by contradiction /* from formulas */
                                                next
                                                  case case_2
                                                  solve( (#t2.9 < #t2.12)  ∥ (#t2.9 = #t2.12) )
                                                    case case_1
                                                    by contradiction /* from formulas */
                                                  next
                                                    case case_2
                                                    solve( TPM_SendCommand( <'TPM2_PolicyPCR', obj_sh>
                                                           ) @ #t2.8 )
                                                      case eventTPMSendCommandTPMPolicyPCRtlssh_0_1111111111111211111111111
                                                      solve( state_1111111111111211111111111( ~RouterID.1,
                                                                                              ~ServerID.1,
                                                                                              ~ak_h.1,
                                                                                              ~ak_sk.1,
                                                                                              ~ssk_nms.1,
                                                                                              ~tid.1, tls_h,
                                                                                              obj_sh, tls_spk
                                                             ) ▶₀ #t2.8 )
                                                        case eventGenerateTLStidtlsspk_0_111111111111121111111111
                                                        by contradiction /* cyclic */
                                                      qed
                                                    qed
                                                  qed
                                                qed
                                              next
                                                case case_2
                                                by contradiction /* from formulas */
                                              qed
                                            qed
                                          next
                                            case case_2
                                            solve( state_1111111111111111111111121111111( ~RouterID.1,
                                                                                          ~ServerID.1,
                                                                                          ~ak_h.1, ~ak_sk.1,
                                                                                          ~ssk_nms.1, pL,
                                                                                          pcrL, s_h, ~n.1
                                                   ) ▶₀ #t2.7 )
                                              case insertpolicyDigestshpcrLTPMCCPolicyPCRpL_0_111111111111111111111112111111
                                              solve( (#t2.8 < #t2.13)  ∥ (#t2.8 = #t2.13) )
                                                case case_1
                                                by contradiction /* from formulas */
                                              next
                                                case case_2
                                                solve( (#t2.10 < #t2.12)  ∥ (#t2.10 = #t2.12) )
                                                  case case_1
                                                  by contradiction /* from formulas */
                                                next
                                                  case case_2
                                                  solve( TPM_SendCommand( <'TPM2_PolicyPCR', obj_sh>
                                                         ) @ #t2.9 )
                                                    case eventTPMSendCommandTPMPolicyPCRtlssh_0_1111111111111211111111111
                                                    solve( state_1111111111111211111111111( ~RouterID.1,
                                                                                            ~ServerID.1,
                                                                                            ~ak_h.1, ~ak_sk.1,
                                                                                            ~ssk_nms.1,
                                                                                            ~tid.1, tls_h,
                                                                                            obj_sh, tls_spk
                                                           ) ▶₀ #t2.9 )
                                                      case eventGenerateTLStidtlsspk_0_111111111111121111111111
                                                      by contradiction /* cyclic */
                                                    qed
                                                  qed
                                                qed
                                              qed
                                            qed
                                          qed
                                        next
                                          case case_2
                                          solve( ((#vr.29 < #vr.68) ∧
                                                  (∃ #t2.
                                                    (Unlock_4( '4', ~n.2, 'device' ) @ #t2)
                                                   ∧
                                                    (#vr.29 < #t2) ∧
                                                    (#t2 < #vr.68) ∧
                                                    (∀ #t0 pp.
                                                      (Unlock( pp, ~n.2, 'device' ) @ #t0) ⇒ #t0 = #t2) ∧
                                                    (∀ pp lpp #t0.
                                                      (Lock( pp, lpp, 'device' ) @ #t0)
                                                     ⇒
                                                      ((#t0 < #vr.29) ∨ (#t0 = #vr.29) ∨ (#t2 < #t0))) ∧
                                                    (∀ pp lpp #t0.
                                                      (Unlock( pp, lpp, 'device' ) @ #t0)
                                                     ⇒
                                                      ((#t0 < #vr.29) ∨ (#t2 < #t0) ∨ (#t2 = #t0)))))  ∥
                                                 (#vr.68 < #vr.29) )
                                            case case_1
                                            solve( (#vr.36 < #t2.9)  ∥ (#vr.36 = #t2.9) )
                                              case case_1
                                              solve( TPM_SendCommand( <'TPM2_PolicyPCR', obj_sh> ) @ #t2.7 )
                                                case eventTPMSendCommandTPMPolicyPCRtlssh_0_1111111111111211111111111
                                                solve( state_1111111111111211111111111( ~RouterID.1,
                                                                                        ~ServerID.1, ~ak_h.1,
                                                                                        ~ak_sk.1, ~ssk_nms.1,
                                                                                        ~tid.1, tls_h, obj_sh,
                                                                                        tls_spk
                                                       ) ▶₀ #t2.7 )
                                                  case eventGenerateTLStidtlsspk_0_111111111111121111111111
                                                  solve( Unlock_4( '4', ~n.2, 'device' ) @ #t2.10 )
                                                    case unlockdevice_0_111111111111111111112111111111
                                                    solve( state_111111111111111111112111111111( ~RouterID.1,
                                                                                                 ~ServerID.1,
                                                                                                 ~ak_h.1,
                                                                                                 ~ak_sk.1,
                                                                                                 ~ssk_nms.1,
                                                                                                 a_h, a_sk,
                                                                                                 obj_ap,
                                                                                                 obj_h,
                                                                                                 obj_pd,
                                                                                                 obj_pk,
                                                                                                 obj_sh.1,
                                                                                                 ~n.2
                                                           ) ▶₀ #t2.8 )
                                                      case outsignobjpkobjapask_0_11111111111111111111211111111
                                                      by contradiction /* cyclic */
                                                    qed
                                                  next
                                                    case unlockdevice_0_11111111111111111111211111112
                                                    by solve( state_11111111111111111111211111112( ~RouterID.1,
                                                                                                   ~ServerID.1,
                                                                                                   ~ak_h.1,
                                                                                                   ~ak_sk.1,
                                                                                                   ~ssk_nms.1,
                                                                                                   a_h,
                                                                                                   obj_ap,
                                                                                                   obj_h,
                                                                                                   obj_pd,
                                                                                                   obj_pk,
                                                                                                   obj_sh.1,
                                                                                                   ~n.2
                                                              ) ▶₀ #t2.8 )
                                                  qed
                                                qed
                                              qed
                                            next
                                              case case_2
                                              solve( TPM_SendCommand( <'TPM2_PolicyPCR', obj_sh> ) @ #t2.8 )
                                                case eventTPMSendCommandTPMPolicyPCRtlssh_0_1111111111111211111111111
                                                solve( state_1111111111111211111111111( ~RouterID.1,
                                                                                        ~ServerID.1, ~ak_h.1,
                                                                                        ~ak_sk.1, ~ssk_nms.1,
                                                                                        ~tid.1, tls_h, obj_sh,
                                                                                        tls_spk
                                                       ) ▶₀ #t2.8 )
                                                  case eventGenerateTLStidtlsspk_0_111111111111121111111111
                                                  solve( Unlock_4( '4', ~n.2, 'device' ) @ #t2.10 )
                                                    case unlockdevice_0_111111111111111111112111111111
                                                    solve( state_111111111111111111112111111111( ~RouterID.1,
                                                                                                 ~ServerID.1,
                                                                                                 ~ak_h.1,
                                                                                                 ~ak_sk.1,
                                                                                                 ~ssk_nms.1,
                                                                                                 a_h, a_sk,
                                                                                                 obj_ap,
                                                                                                 obj_h,
                                                                                                 obj_pd,
                                                                                                 obj_pk,
                                                                                                 obj_sh.1,
                                                                                                 ~n.2
                                                           ) ▶₀ #t2.9 )
                                                      case outsignobjpkobjapask_0_11111111111111111111211111111
                                                      by contradiction /* cyclic */
                                                    qed
                                                  next
                                                    case unlockdevice_0_11111111111111111111211111112
                                                    by solve( state_11111111111111111111211111112( ~RouterID.1,
                                                                                                   ~ServerID.1,
                                                                                                   ~ak_h.1,
                                                                                                   ~ak_sk.1,
                                                                                                   ~ssk_nms.1,
                                                                                                   a_h,
                                                                                                   obj_ap,
                                                                                                   obj_h,
                                                                                                   obj_pd,
                                                                                                   obj_pk,
                                                                                                   obj_sh.1,
                                                                                                   ~n.2
                                                              ) ▶₀ #t2.9 )
                                                  qed
                                                qed
                                              qed
                                            qed
                                          next
                                            case case_2
                                            solve( (#vr.36 < #t2.10)  ∥ (#vr.36 = #t2.10) )
                                              case case_1
                                              solve( state_1111111111111111111111121111111( ~RouterID.1,
                                                                                            ~ServerID.1,
                                                                                            ~ak_h.1, ~ak_sk.1,
                                                                                            ~ssk_nms.1, pL,
                                                                                            pcrL, s_h, ~n.1
                                                     ) ▶₀ #t2.7 )
                                                case insertpolicyDigestshpcrLTPMCCPolicyPCRpL_0_111111111111111111111112111111
                                                solve( (#vr.36 < #t2.13)  ∥ (#vr.36 = #t2.13) )
                                                  case case_1
                                                  solve( (#t2.10 < #t2.13)  ∥ (#t2.10 = #t2.13) )
                                                    case case_1
                                                    by contradiction /* from formulas */
                                                  next
                                                    case case_2
                                                    solve( (#t2.9 < #t2.12)  ∥ (#t2.9 = #t2.12) )
                                                      case case_1
                                                      by contradiction /* from formulas */
                                                    next
                                                      case case_2
                                                      solve( TPM_SendCommand( <'TPM2_PolicyPCR', obj_sh>
                                                             ) @ #t2.8 )
                                                        case eventTPMSendCommandTPMPolicyPCRtlssh_0_1111111111111211111111111
                                                        solve( state_1111111111111211111111111( ~RouterID.1,
                                                                                                ~ServerID.1,
                                                                                                ~ak_h.1,
                                                                                                ~ak_sk.1,
                                                                                                ~ssk_nms.1,
                                                                                                ~tid.1, tls_h,
                                                                                                obj_sh,
                                                                                                tls_spk
                                                               ) ▶₀ #t2.8 )
                                                          case eventGenerateTLStidtlsspk_0_111111111111121111111111
                                                          solve( TPM_SendCommand( <'TPM2_PolicyPCR', obj_sh>
                                                                 ) @ #t2.11 )
                                                            case eventTPMSendCommandTPMPolicyPCRtlssh_0_1111111111111211111111111
                                                            solve( state_1111111111111211111111111( ~RouterID.1,
                                                                                                    ~ServerID.1,
                                                                                                    ~ak_h.1,
                                                                                                    ~ak_sk.1,
                                                                                                    ~ssk_nms.1,
                                                                                                    ~tid.1,
                                                                                                    tls_h,
                                                                                                    obj_sh,
                                                                                                    tls_spk
                                                                   ) ▶₀ #t2.9 )
                                                              case eventGenerateTLStidtlsspk_0_111111111111121111111111
                                                              solve( TPM_SendCommand( <'TPM2_Create', 
                                                                                       <swstate, nil>, 
                                                                                       'TPM_CC_PolicyPCR', nil
                                                                                      >
                                                                     ) @ #t2.11 )
                                                                case eventTPMSendCommandTPMCreateswstatenilTPMCCPolicyPCRnil_0_11111111111112111
                                                                solve( state_11111111111112111( ~RouterID.1,
                                                                                                ~ServerID.1,
                                                                                                ~ak_h.1,
                                                                                                ~ak_sk.1,
                                                                                                ~ssk_nms.1,
                                                                                                ~tid.1
                                                                       ) ▶₀ #t2.9 )
                                                                  case outTPMPCRExtendswstate_0_1111111111111211
                                                                  solve( TPM_SendCommand( <'TPM2_Create', 
                                                                                           <swstate, nil>, 
                                                                                           'TPM_CC_PolicyPCR', 
                                                                                           nil>
                                                                         ) @ #t2.11 )
                                                                    case eventTPMSendCommandTPMCreateswstatenilTPMCCPolicyPCRnil_0_11111111111112111
                                                                    solve( state_11111111111112111( ~RouterID.1,
                                                                                                    ~ServerID.1,
                                                                                                    ~ak_h.1,
                                                                                                    ~ak_sk.1,
                                                                                                    ~ssk_nms.1,
                                                                                                    ~tid.1
                                                                           ) ▶₀ #t2.9 )
                                                                      case outTPMPCRExtendswstate_0_1111111111111211
                                                                      solve( !KU( ~k_h ) @ #vk.11 )
                                                                        case outTPMCertifytlsshtlshakh_0_1111111111111211111111111111
                                                                        solve( TPM_SendCommand( <
                                                                                                 'TPM2_Create', 
                                                                                                 <swstate, nil
                                                                                                 >, 
                                                                                                 'TPM_CC_PolicyPCR', 
                                                                                                 nil>
                                                                               ) @ #t2.11 )
                                                                          case eventTPMSendCommandTPMCreateswstatenilTPMCCPolicyPCRnil_0_11111111111112111
                                                                          solve( state_11111111111112111( ~RouterID.1,
                                                                                                          ~ServerID.1,
                                                                                                          ~ak_h.1,
                                                                                                          ~ak_sk.1,
                                                                                                          ~ssk_nms.1,
                                                                                                          ~tid.1
                                                                                 ) ▶₀ #t2.9 )
                                                                            case outTPMPCRExtendswstate_0_1111111111111211
                                                                            by solve( !KU( ~k_sk ) @ #vk.21 )
                                                                          qed
                                                                        qed
                                                                      next
                                                                        case outTPMSigntlsshtlshtlsspkskae_0_1111111111111211111111111111111111
                                                                        by contradiction /* cyclic */
                                                                      qed
                                                                    qed
                                                                  qed
                                                                qed
                                                              qed
                                                            qed
                                                          qed
                                                        qed
                                                      qed
                                                    qed
                                                  qed
                                                next
                                                  case case_2
                                                  by contradiction /* from formulas */
                                                qed
                                              qed
                                            next
                                              case case_2
                                              solve( state_1111111111111111111111121111111( ~RouterID.1,
                                                                                            ~ServerID.1,
                                                                                            ~ak_h.1, ~ak_sk.1,
                                                                                            ~ssk_nms.1, pL,
                                                                                            pcrL, s_h, ~n.1
                                                     ) ▶₀ #t2.7 )
                                                case insertpolicyDigestshpcrLTPMCCPolicyPCRpL_0_111111111111111111111112111111
                                                solve( (#t2.8 < #t2.13)  ∥ (#t2.8 = #t2.13) )
                                                  case case_1
                                                  by contradiction /* from formulas */
                                                next
                                                  case case_2
                                                  solve( (#t2.10 < #t2.12)  ∥ (#t2.10 = #t2.12) )
                                                    case case_1
                                                    by contradiction /* from formulas */
                                                  next
                                                    case case_2
                                                    solve( TPM_SendCommand( <'TPM2_PolicyPCR', obj_sh>
                                                           ) @ #t2.9 )
                                                      case eventTPMSendCommandTPMPolicyPCRtlssh_0_1111111111111211111111111
                                                      solve( state_1111111111111211111111111( ~RouterID.1,
                                                                                              ~ServerID.1,
                                                                                              ~ak_h.1,
                                                                                              ~ak_sk.1,
                                                                                              ~ssk_nms.1,
                                                                                              ~tid.1, tls_h,
                                                                                              obj_sh, tls_spk
                                                             ) ▶₀ #t2.9 )
                                                        case eventGenerateTLStidtlsspk_0_111111111111121111111111
                                                        solve( TPM_SendCommand( <'TPM2_PolicyPCR', obj_sh>
                                                               ) @ #t2.11 )
                                                          case eventTPMSendCommandTPMPolicyPCRtlssh_0_1111111111111211111111111
                                                          solve( state_1111111111111211111111111( ~RouterID.1,
                                                                                                  ~ServerID.1,
                                                                                                  ~ak_h.1,
                                                                                                  ~ak_sk.1,
                                                                                                  ~ssk_nms.1,
                                                                                                  ~tid.1,
                                                                                                  tls_h,
                                                                                                  obj_sh,
                                                                                                  tls_spk
                                                                 ) ▶₀ #t2.10 )
                                                            case eventGenerateTLStidtlsspk_0_111111111111121111111111
                                                            solve( TPM_SendCommand( <'TPM2_Create', 
                                                                                     <swstate, nil>, 
                                                                                     'TPM_CC_PolicyPCR', nil>
                                                                   ) @ #t2.11 )
                                                              case eventTPMSendCommandTPMCreateswstatenilTPMCCPolicyPCRnil_0_11111111111112111
                                                              solve( state_11111111111112111( ~RouterID.1,
                                                                                              ~ServerID.1,
                                                                                              ~ak_h.1,
                                                                                              ~ak_sk.1,
                                                                                              ~ssk_nms.1,
                                                                                              ~tid.1
                                                                     ) ▶₀ #t2.10 )
                                                                case outTPMPCRExtendswstate_0_1111111111111211
                                                                solve( TPM_SendCommand( <'TPM2_Create', 
                                                                                         <swstate, nil>, 
                                                                                         'TPM_CC_PolicyPCR', 
                                                                                         nil>
                                                                       ) @ #t2.11 )
                                                                  case eventTPMSendCommandTPMCreateswstatenilTPMCCPolicyPCRnil_0_11111111111112111
                                                                  solve( state_11111111111112111( ~RouterID.1,
                                                                                                  ~ServerID.1,
                                                                                                  ~ak_h.1,
                                                                                                  ~ak_sk.1,
                                                                                                  ~ssk_nms.1,
                                                                                                  ~tid.1
                                                                         ) ▶₀ #t2.10 )
                                                                    case outTPMPCRExtendswstate_0_1111111111111211
                                                                    solve( !KU( ~k_h ) @ #vk.11 )
                                                                      case outTPMCertifytlsshtlshakh_0_1111111111111211111111111111
                                                                      solve( TPM_SendCommand( <'TPM2_Create', 
                                                                                               <swstate, nil
                                                                                               >, 
                                                                                               'TPM_CC_PolicyPCR', 
                                                                                               nil>
                                                                             ) @ #t2.11 )
                                                                        case eventTPMSendCommandTPMCreateswstatenilTPMCCPolicyPCRnil_0_11111111111112111
                                                                        solve( state_11111111111112111( ~RouterID.1,
                                                                                                        ~ServerID.1,
                                                                                                        ~ak_h.1,
                                                                                                        ~ak_sk.1,
                                                                                                        ~ssk_nms.1,
                                                                                                        ~tid.1
                                                                               ) ▶₀ #t2.10 )
                                                                          case outTPMPCRExtendswstate_0_1111111111111211
                                                                          by solve( !KU( ~k_sk ) @ #vk.21 )
                                                                        qed
                                                                      qed
                                                                    next
                                                                      case outTPMSigntlsshtlshtlsspkskae_0_1111111111111211111111111111111111
                                                                      by contradiction /* cyclic */
                                                                    qed
                                                                  qed
                                                                qed
                                                              qed
                                                            qed
                                                          qed
                                                        qed
                                                      qed
                                                    qed
                                                  qed
                                                qed
                                              qed
                                            qed
                                          qed
                                        qed
                                      qed
                                    qed
                                  qed
                                next
                                  case outTPMSigntlsshtlshtlsspkskae_0_1111111111111211111111111111111111
                                  solve( TPM_SendCommand( <'TPM2_Create', <swstate, nil>, 
                                                           'TPM_CC_PolicyPCR', nil>
                                         ) @ #t2.7 )
                                    case eventTPMSendCommandTPMCreateswstatenilTPMCCPolicyPCRnil_0_11111111111112111
                                    solve( state_11111111111112111( ~RouterID.1, ~ServerID.1, ~ak_h.1,
                                                                    ~ak_sk.1, ~ssk_nms.1, ~tid.1
                                           ) ▶₀ #t2.6 )
                                      case outTPMPCRExtendswstate_0_1111111111111211
                                      solve( Insert( <'authPolicy', ~k_h>,
                                                     <<swstate, nil>, 'TPM_CC_PolicyPCR', nil>
                                             ) @ #t2.3 )
                                        case insertauthPolicykhauthPolicy_0_11111111111111111111112111111
                                        solve( Insert( <'policyDigest', obj_sh>,
                                                       <<swstate, nil>, 'TPM_CC_PolicyPCR', nil>
                                               ) @ #t2.6 )
                                          case insertpolicyDigestshpcrLTPMCCPolicyPCRpL_0_111111111111111111111112111111
                                          solve( state_111111111111111111111112111111( ~RouterID.1,
                                                                                       ~ServerID.1, ~ak_h.1,
                                                                                       ~ak_sk.1, ~ssk_nms.1,
                                                                                       nil, <swstate, nil>,
                                                                                       obj_sh, lock
                                                 ) ▶₀ #t2.6 )
                                            case eventPolicyPCRshpL_0_11111111111111111111111211111
                                            solve( (#vr.79 < #vr.54)  ∥ (#t2.1 < #vr.79) )
                                              case case_1
                                              solve( (#vr.36 < #t2.10)  ∥ (#vr.36 = #t2.10) )
                                                case case_1
                                                solve( state_1111111111111111111111121111111( ~RouterID.1,
                                                                                              ~ServerID.1,
                                                                                              ~ak_h.1,
                                                                                              ~ak_sk.1,
                                                                                              ~ssk_nms.1, pL,
                                                                                              pcrL, s_h, ~n.1
                                                       ) ▶₀ #t2.7 )
                                                  case insertpolicyDigestshpcrLTPMCCPolicyPCRpL_0_111111111111111111111112111111
                                                  solve( (#vr.36 < #t2.13)  ∥ (#vr.36 = #t2.13) )
                                                    case case_1
                                                    solve( (#t2.10 < #t2.13)  ∥ (#t2.10 = #t2.13) )
                                                      case case_1
                                                      by contradiction /* from formulas */
                                                    next
                                                      case case_2
                                                      solve( (#t2.9 < #t2.12)  ∥ (#t2.9 = #t2.12) )
                                                        case case_1
                                                        by contradiction /* from formulas */
                                                      next
                                                        case case_2
                                                        solve( TPM_SendCommand( <'TPM2_PolicyPCR', obj_sh>
                                                               ) @ #t2.8 )
                                                          case eventTPMSendCommandTPMPolicyPCRtlssh_0_1111111111111211111111111
                                                          solve( state_1111111111111211111111111( ~RouterID.1,
                                                                                                  ~ServerID.1,
                                                                                                  ~ak_h.1,
                                                                                                  ~ak_sk.1,
                                                                                                  ~ssk_nms.1,
                                                                                                  ~tid.1,
                                                                                                  tls_h,
                                                                                                  obj_sh,
                                                                                                  tls_spk
                                                                 ) ▶₀ #t2.8 )
                                                            case eventGenerateTLStidtlsspk_0_111111111111121111111111
                                                            by contradiction /* cyclic */
                                                          qed
                                                        qed
                                                      qed
                                                    qed
                                                  next
                                                    case case_2
                                                    by contradiction /* from formulas */
                                                  qed
                                                qed
                                              next
                                                case case_2
                                                solve( state_1111111111111111111111121111111( ~RouterID.1,
                                                                                              ~ServerID.1,
                                                                                              ~ak_h.1,
                                                                                              ~ak_sk.1,
                                                                                              ~ssk_nms.1, pL,
                                                                                              pcrL, s_h, ~n.1
                                                       ) ▶₀ #t2.7 )
                                                  case insertpolicyDigestshpcrLTPMCCPolicyPCRpL_0_111111111111111111111112111111
                                                  solve( (#t2.8 < #t2.13)  ∥ (#t2.8 = #t2.13) )
                                                    case case_1
                                                    by contradiction /* from formulas */
                                                  next
                                                    case case_2
                                                    solve( (#t2.10 < #t2.12)  ∥ (#t2.10 = #t2.12) )
                                                      case case_1
                                                      by contradiction /* from formulas */
                                                    next
                                                      case case_2
                                                      solve( TPM_SendCommand( <'TPM2_PolicyPCR', obj_sh>
                                                             ) @ #t2.9 )
                                                        case eventTPMSendCommandTPMPolicyPCRtlssh_0_1111111111111211111111111
                                                        solve( state_1111111111111211111111111( ~RouterID.1,
                                                                                                ~ServerID.1,
                                                                                                ~ak_h.1,
                                                                                                ~ak_sk.1,
                                                                                                ~ssk_nms.1,
                                                                                                ~tid.1, tls_h,
                                                                                                obj_sh,
                                                                                                tls_spk
                                                               ) ▶₀ #t2.9 )
                                                          case eventGenerateTLStidtlsspk_0_111111111111121111111111
                                                          by contradiction /* cyclic */
                                                        qed
                                                      qed
                                                    qed
                                                  qed
                                                qed
                                              qed
                                            next
                                              case case_2
                                              solve( ((#vr.29 < #vr.79) ∧
                                                      (∃ #t2.
                                                        (Unlock_4( '4', ~n.2, 'device' ) @ #t2)
                                                       ∧
                                                        (#vr.29 < #t2) ∧
                                                        (#t2 < #vr.79) ∧
                                                        (∀ #t0 pp.
                                                          (Unlock( pp, ~n.2, 'device' ) @ #t0) ⇒ #t0 = #t2) ∧
                                                        (∀ pp lpp #t0.
                                                          (Lock( pp, lpp, 'device' ) @ #t0)
                                                         ⇒
                                                          ((#t0 < #vr.29) ∨ (#t0 = #vr.29) ∨ (#t2 < #t0))) ∧
                                                        (∀ pp lpp #t0.
                                                          (Unlock( pp, lpp, 'device' ) @ #t0)
                                                         ⇒
                                                          ((#t0 < #vr.29) ∨ (#t2 < #t0) ∨ (#t2 = #t0)))))  ∥
                                                     (#vr.79 < #vr.29) )
                                                case case_1
                                                solve( (#vr.36 < #t2.9)  ∥ (#vr.36 = #t2.9) )
                                                  case case_1
                                                  solve( TPM_SendCommand( <'TPM2_PolicyPCR', obj_sh>
                                                         ) @ #t2.7 )
                                                    case eventTPMSendCommandTPMPolicyPCRtlssh_0_1111111111111211111111111
                                                    solve( state_1111111111111211111111111( ~RouterID.1,
                                                                                            ~ServerID.1,
                                                                                            ~ak_h.1, ~ak_sk.1,
                                                                                            ~ssk_nms.1,
                                                                                            ~tid.1, tls_h,
                                                                                            obj_sh, tls_spk
                                                           ) ▶₀ #t2.7 )
                                                      case eventGenerateTLStidtlsspk_0_111111111111121111111111
                                                      solve( Unlock_4( '4', ~n.2, 'device' ) @ #t2.10 )
                                                        case unlockdevice_0_111111111111111111112111111111
                                                        solve( state_111111111111111111112111111111( ~RouterID.1,
                                                                                                     ~ServerID.1,
                                                                                                     ~ak_h.1,
                                                                                                     ~ak_sk.1,
                                                                                                     ~ssk_nms.1,
                                                                                                     a_h,
                                                                                                     a_sk,
                                                                                                     obj_ap,
                                                                                                     obj_h,
                                                                                                     obj_pd,
                                                                                                     obj_pk,
                                                                                                     obj_sh.1,
                                                                                                     ~n.2
                                                               ) ▶₀ #t2.8 )
                                                          case outsignobjpkobjapask_0_11111111111111111111211111111
                                                          by contradiction /* cyclic */
                                                        qed
                                                      next
                                                        case unlockdevice_0_11111111111111111111211111112
                                                        by solve( state_11111111111111111111211111112( ~RouterID.1,
                                                                                                       ~ServerID.1,
                                                                                                       ~ak_h.1,
                                                                                                       ~ak_sk.1,
                                                                                                       ~ssk_nms.1,
                                                                                                       a_h,
                                                                                                       obj_ap,
                                                                                                       obj_h,
                                                                                                       obj_pd,
                                                                                                       obj_pk,
                                                                                                       obj_sh.1,
                                                                                                       ~n.2
                                                                  ) ▶₀ #t2.8 )
                                                      qed
                                                    qed
                                                  qed
                                                next
                                                  case case_2
                                                  solve( TPM_SendCommand( <'TPM2_PolicyPCR', obj_sh>
                                                         ) @ #t2.8 )
                                                    case eventTPMSendCommandTPMPolicyPCRtlssh_0_1111111111111211111111111
                                                    solve( state_1111111111111211111111111( ~RouterID.1,
                                                                                            ~ServerID.1,
                                                                                            ~ak_h.1, ~ak_sk.1,
                                                                                            ~ssk_nms.1,
                                                                                            ~tid.1, tls_h,
                                                                                            obj_sh, tls_spk
                                                           ) ▶₀ #t2.8 )
                                                      case eventGenerateTLStidtlsspk_0_111111111111121111111111
                                                      solve( Unlock_4( '4', ~n.2, 'device' ) @ #t2.10 )
                                                        case unlockdevice_0_111111111111111111112111111111
                                                        solve( state_111111111111111111112111111111( ~RouterID.1,
                                                                                                     ~ServerID.1,
                                                                                                     ~ak_h.1,
                                                                                                     ~ak_sk.1,
                                                                                                     ~ssk_nms.1,
                                                                                                     a_h,
                                                                                                     a_sk,
                                                                                                     obj_ap,
                                                                                                     obj_h,
                                                                                                     obj_pd,
                                                                                                     obj_pk,
                                                                                                     obj_sh.1,
                                                                                                     ~n.2
                                                               ) ▶₀ #t2.9 )
                                                          case outsignobjpkobjapask_0_11111111111111111111211111111
                                                          by contradiction /* cyclic */
                                                        qed
                                                      next
                                                        case unlockdevice_0_11111111111111111111211111112
                                                        by solve( state_11111111111111111111211111112( ~RouterID.1,
                                                                                                       ~ServerID.1,
                                                                                                       ~ak_h.1,
                                                                                                       ~ak_sk.1,
                                                                                                       ~ssk_nms.1,
                                                                                                       a_h,
                                                                                                       obj_ap,
                                                                                                       obj_h,
                                                                                                       obj_pd,
                                                                                                       obj_pk,
                                                                                                       obj_sh.1,
                                                                                                       ~n.2
                                                                  ) ▶₀ #t2.9 )
                                                      qed
                                                    qed
                                                  qed
                                                qed
                                              next
                                                case case_2
                                                solve( (#vr.36 < #t2.10)  ∥ (#vr.36 = #t2.10) )
                                                  case case_1
                                                  solve( state_1111111111111111111111121111111( ~RouterID.1,
                                                                                                ~ServerID.1,
                                                                                                ~ak_h.1,
                                                                                                ~ak_sk.1,
                                                                                                ~ssk_nms.1,
                                                                                                pL, pcrL, s_h,
                                                                                                ~n.1
                                                         ) ▶₀ #t2.7 )
                                                    case insertpolicyDigestshpcrLTPMCCPolicyPCRpL_0_111111111111111111111112111111
                                                    solve( (#vr.36 < #t2.13)  ∥ (#vr.36 = #t2.13) )
                                                      case case_1
                                                      solve( (#t2.10 < #t2.13)  ∥ (#t2.10 = #t2.13) )
                                                        case case_1
                                                        by contradiction /* from formulas */
                                                      next
                                                        case case_2
                                                        solve( (#t2.9 < #t2.12)  ∥ (#t2.9 = #t2.12) )
                                                          case case_1
                                                          by contradiction /* from formulas */
                                                        next
                                                          case case_2
                                                          solve( TPM_SendCommand( <'TPM2_PolicyPCR', obj_sh>
                                                                 ) @ #t2.8 )
                                                            case eventTPMSendCommandTPMPolicyPCRtlssh_0_1111111111111211111111111
                                                            solve( state_1111111111111211111111111( ~RouterID.1,
                                                                                                    ~ServerID.1,
                                                                                                    ~ak_h.1,
                                                                                                    ~ak_sk.1,
                                                                                                    ~ssk_nms.1,
                                                                                                    ~tid.1,
                                                                                                    tls_h,
                                                                                                    obj_sh,
                                                                                                    tls_spk
                                                                   ) ▶₀ #t2.8 )
                                                              case eventGenerateTLStidtlsspk_0_111111111111121111111111
                                                              solve( TPM_SendCommand( <'TPM2_PolicyPCR', 
                                                                                       obj_sh>
                                                                     ) @ #t2.11 )
                                                                case eventTPMSendCommandTPMPolicyPCRtlssh_0_1111111111111211111111111
                                                                solve( state_1111111111111211111111111( ~RouterID.1,
                                                                                                        ~ServerID.1,
                                                                                                        ~ak_h.1,
                                                                                                        ~ak_sk.1,
                                                                                                        ~ssk_nms.1,
                                                                                                        ~tid.1,
                                                                                                        tls_h,
                                                                                                        obj_sh,
                                                                                                        tls_spk
                                                                       ) ▶₀ #t2.9 )
                                                                  case eventGenerateTLStidtlsspk_0_111111111111121111111111
                                                                  solve( TPM_SendCommand( <'TPM2_Create', 
                                                                                           <swstate, nil>, 
                                                                                           'TPM_CC_PolicyPCR', 
                                                                                           nil>
                                                                         ) @ #t2.11 )
                                                                    case eventTPMSendCommandTPMCreateswstatenilTPMCCPolicyPCRnil_0_11111111111112111
                                                                    solve( state_11111111111112111( ~RouterID.1,
                                                                                                    ~ServerID.1,
                                                                                                    ~ak_h.1,
                                                                                                    ~ak_sk.1,
                                                                                                    ~ssk_nms.1,
                                                                                                    ~tid.1
                                                                           ) ▶₀ #t2.9 )
                                                                      case outTPMPCRExtendswstate_0_1111111111111211
                                                                      solve( TPM_SendCommand( <'TPM2_Create', 
                                                                                               <swstate, nil
                                                                                               >, 
                                                                                               'TPM_CC_PolicyPCR', 
                                                                                               nil>
                                                                             ) @ #t2.11 )
                                                                        case eventTPMSendCommandTPMCreateswstatenilTPMCCPolicyPCRnil_0_11111111111112111
                                                                        solve( state_11111111111112111( ~RouterID.1,
                                                                                                        ~ServerID.1,
                                                                                                        ~ak_h.1,
                                                                                                        ~ak_sk.1,
                                                                                                        ~ssk_nms.1,
                                                                                                        ~tid.1
                                                                               ) ▶₀ #t2.9 )
                                                                          case outTPMPCRExtendswstate_0_1111111111111211
                                                                          by solve( !KU( ~k_sk ) @ #vk.21 )
                                                                        qed
                                                                      qed
                                                                    qed
                                                                  qed
                                                                qed
                                                              qed
                                                            qed
                                                          qed
                                                        qed
                                                      qed
                                                    next
                                                      case case_2
                                                      by contradiction /* from formulas */
                                                    qed
                                                  qed
                                                next
                                                  case case_2
                                                  solve( state_1111111111111111111111121111111( ~RouterID.1,
                                                                                                ~ServerID.1,
                                                                                                ~ak_h.1,
                                                                                                ~ak_sk.1,
                                                                                                ~ssk_nms.1,
                                                                                                pL, pcrL, s_h,
                                                                                                ~n.1
                                                         ) ▶₀ #t2.7 )
                                                    case insertpolicyDigestshpcrLTPMCCPolicyPCRpL_0_111111111111111111111112111111
                                                    solve( (#t2.8 < #t2.13)  ∥ (#t2.8 = #t2.13) )
                                                      case case_1
                                                      by contradiction /* from formulas */
                                                    next
                                                      case case_2
                                                      solve( (#t2.10 < #t2.12)  ∥ (#t2.10 = #t2.12) )
                                                        case case_1
                                                        by contradiction /* from formulas */
                                                      next
                                                        case case_2
                                                        solve( TPM_SendCommand( <'TPM2_PolicyPCR', obj_sh>
                                                               ) @ #t2.9 )
                                                          case eventTPMSendCommandTPMPolicyPCRtlssh_0_1111111111111211111111111
                                                          solve( state_1111111111111211111111111( ~RouterID.1,
                                                                                                  ~ServerID.1,
                                                                                                  ~ak_h.1,
                                                                                                  ~ak_sk.1,
                                                                                                  ~ssk_nms.1,
                                                                                                  ~tid.1,
                                                                                                  tls_h,
                                                                                                  obj_sh,
                                                                                                  tls_spk
                                                                 ) ▶₀ #t2.9 )
                                                            case eventGenerateTLStidtlsspk_0_111111111111121111111111
                                                            solve( TPM_SendCommand( <'TPM2_PolicyPCR', obj_sh>
                                                                   ) @ #t2.11 )
                                                              case eventTPMSendCommandTPMPolicyPCRtlssh_0_1111111111111211111111111
                                                              solve( state_1111111111111211111111111( ~RouterID.1,
                                                                                                      ~ServerID.1,
                                                                                                      ~ak_h.1,
                                                                                                      ~ak_sk.1,
                                                                                                      ~ssk_nms.1,
                                                                                                      ~tid.1,
                                                                                                      tls_h,
                                                                                                      obj_sh,
                                                                                                      tls_spk
                                                                     ) ▶₀ #t2.10 )
                                                                case eventGenerateTLStidtlsspk_0_111111111111121111111111
                                                                solve( TPM_SendCommand( <'TPM2_Create', 
                                                                                         <swstate, nil>, 
                                                                                         'TPM_CC_PolicyPCR', 
                                                                                         nil>
                                                                       ) @ #t2.11 )
                                                                  case eventTPMSendCommandTPMCreateswstatenilTPMCCPolicyPCRnil_0_11111111111112111
                                                                  solve( state_11111111111112111( ~RouterID.1,
                                                                                                  ~ServerID.1,
                                                                                                  ~ak_h.1,
                                                                                                  ~ak_sk.1,
                                                                                                  ~ssk_nms.1,
                                                                                                  ~tid.1
                                                                         ) ▶₀ #t2.10 )
                                                                    case outTPMPCRExtendswstate_0_1111111111111211
                                                                    solve( TPM_SendCommand( <'TPM2_Create', 
                                                                                             <swstate, nil>, 
                                                                                             'TPM_CC_PolicyPCR', 
                                                                                             nil>
                                                                           ) @ #t2.11 )
                                                                      case eventTPMSendCommandTPMCreateswstatenilTPMCCPolicyPCRnil_0_11111111111112111
                                                                      solve( state_11111111111112111( ~RouterID.1,
                                                                                                      ~ServerID.1,
                                                                                                      ~ak_h.1,
                                                                                                      ~ak_sk.1,
                                                                                                      ~ssk_nms.1,
                                                                                                      ~tid.1
                                                                             ) ▶₀ #t2.10 )
                                                                        case outTPMPCRExtendswstate_0_1111111111111211
                                                                        by solve( !KU( ~k_sk ) @ #vk.21 )
                                                                      qed
                                                                    qed
                                                                  qed
                                                                qed
                                                              qed
                                                            qed
                                                          qed
                                                        qed
                                                      qed
                                                    qed
                                                  qed
                                                qed
                                              qed
                                            qed
                                          qed
                                        qed
                                      qed
                                    qed
                                  qed
                                next
                                  case outtlsspkskaecsr_0_11111111111112111111111111111111111111
                                  by contradiction /* from formulas */
                                qed
                              qed
                            qed
                          next
                            case outsignobjpkobjapask_0_11111111111111111111211111111
                            solve( ((#vr.29 < #vr.71) ∧
                                    (∃ #t2.
                                      (Unlock_4( '4', ~n.1, 'device' ) @ #t2)
                                     ∧
                                      (#vr.29 < #t2) ∧
                                      (#t2 < #vr.71) ∧
                                      (∀ #t0 pp. (Unlock( pp, ~n.1, 'device' ) @ #t0) ⇒ #t0 = #t2) ∧
                                      (∀ pp lpp #t0.
                                        (Lock( pp, lpp, 'device' ) @ #t0)
                                       ⇒
                                        ((#t0 < #vr.29) ∨ (#t0 = #vr.29) ∨ (#t2 < #t0))) ∧
                                      (∀ pp lpp #t0.
                                        (Unlock( pp, lpp, 'device' ) @ #t0)
                                       ⇒
                                        ((#t0 < #vr.29) ∨ (#t2 < #t0) ∨ (#t2 = #t0)))))  ∥
                                   (#vr.71 < #vr.29)  ∥ (#vr.29 = #vr.71) )
                              case case_1
                              solve( TPM_SendCommand( <'TPM2_Certify', obj_sh.1, obj_h, a_h>
                                     ) @ #t2.7 )
                                case eventTPMSendCommandTPMCertifytlsshtlshakh_0_111111111111121111111111111
                                by solve( state_111111111111121111111111111( ~RouterID.1, ~ServerID.1,
                                                                             ~ak_h.1, ~ak_sk.1, ~ssk_nms.1,
                                                                             ~tid.1, obj_h, obj_sh.1, tls_spk
                                          ) ▶₀ #t2.6 )
                              qed
                            next
                              case case_2
                              solve( (#vr.71 < #vr.54)  ∥ (#t2.1 < #vr.71) )
                                case case_1
                                solve( TPM_SendCommand( <'TPM2_Certify', obj_sh.1, obj_h, a_h>
                                       ) @ #t2.7 )
                                  case eventTPMSendCommandTPMCertifytlsshtlshakh_0_111111111111121111111111111
                                  by solve( state_111111111111121111111111111( ~RouterID.1, ~ServerID.1,
                                                                               ~ak_h.1, ~ak_sk.1, ~ssk_nms.1,
                                                                               ~tid.1, obj_h, obj_sh.1,
                                                                               tls_spk
                                            ) ▶₀ #t2.6 )
                                qed
                              next
                                case case_2
                                solve( TPM_SendCommand( <'TPM2_Certify', obj_sh.1, obj_h, a_h>
                                       ) @ #t2.7 )
                                  case eventTPMSendCommandTPMCertifytlsshtlshakh_0_111111111111121111111111111
                                  by solve( state_111111111111121111111111111( ~RouterID.1, ~ServerID.1,
                                                                               ~ak_h.1, ~ak_sk.1, ~ssk_nms.1,
                                                                               ~tid.1, obj_h, obj_sh.1,
                                                                               tls_spk
                                            ) ▶₀ #t2.6 )
                                qed
                              qed
                            qed
                          next
                            case outtlsspkskaecsr_0_11111111111112111111111111111111111111
                            solve( TPM_SendCommand( <'TPM2_Sign', k_sh, k_h.1, pk(x), 
                                                     sign(<pk(x), <swstate, nil>, 'TPM_CC_PolicyPCR', nil>,
                                                          ~ak_sk)
                                                    >
                                   ) @ #t2.8 )
                              case eventTPMSendCommandTPMSigntlsshtlshtlsspkskae_0_111111111111121111111111111111111
                              solve( state_111111111111121111111111111111111( ~RouterID.1, ~ServerID.1,
                                                                              ~ak_h.1, ~ak_sk.1, ~ssk_nms.1,
                                                                              ~tid.1,
                                                                              sign(<pk(x), <swstate, nil>, 
                                                                                    'TPM_CC_PolicyPCR', nil>,
                                                                                   ~ak_sk),
                                                                              k_h.1, k_sh, pk(x)
                                     ) ▶₀ #t2.6 )
                                case ifverifyskaetlsspkswstatenilTPMCCPolicyPCRnilpkaksktrue_0_11111111111112111111111111111111
                                by contradiction /* from formulas */
                              qed
                            qed
                          qed
                        qed
                      qed
                    qed
                  qed
                qed
              qed
            qed
          qed
        qed
      qed
    next
      case outtlsspkskaecsr_0_11111111111112111111111111111111111111
      solve( ((#vr.39 < #vr.69) ∧
              (∃ #t2.
                (Unlock_5( '5', ~n, 'device' ) @ #t2)
               ∧
                (#vr.39 < #t2) ∧
                (#t2 < #vr.69) ∧
                (∀ #t0 pp. (Unlock( pp, ~n, 'device' ) @ #t0) ⇒ #t0 = #t2) ∧
                (∀ pp lpp #t0.
                  (Lock( pp, lpp, 'device' ) @ #t0)
                 ⇒
                  ((#t0 < #vr.39) ∨ (#t0 = #vr.39) ∨ (#t2 < #t0))) ∧
                (∀ pp lpp #t0.
                  (Unlock( pp, lpp, 'device' ) @ #t0)
                 ⇒
                  ((#t0 < #vr.39) ∨ (#t2 < #t0) ∨ (#t2 = #t0)))))  ∥
             (#vr.69 < #vr.39) )
        case case_1
        solve( TPM_SendCommand( <'TPM2_Sign', k_sh, k_h, pk(x), <swstate, nil>, 
                                 'TPM_CC_PolicyPCR', nil>
               ) @ #t2 )
          case eventTPMSendCommandTPMSigntlsshtlshtlsspkskae_0_111111111111121111111111111111111
          by solve( state_111111111111121111111111111111111( ~RouterID.1,
                                                             ~ServerID.1, ~ak_h.1, ~ak_sk.1, ~ssk_nms.1, ~tid,
                                                             <<swstate, nil>, 'TPM_CC_PolicyPCR', nil>, k_h,
                                                             k_sh, pk(x)
                    ) ▶₀ #t2 )
        qed
      next
        case case_2
        solve( state_111111111111111111111121111111111( ~RouterID.1, ~ServerID.1,
                                                        ~ak_h.1, ~ak_sk.1, ~k_h.2, ~k_sk.1, ~ssk_nms.1,
                                                        authPolicy.1, ~n.1
               ) ▶₀ #t2 )
          case TpmCreateOutkhpkksk_0_11111111111111111111112111111111
          solve( TPM_SendCommand( <'TPM2_Sign', k_sh, k_h.1, pk(x), 
                                   <swstate, nil>, 'TPM_CC_PolicyPCR', nil>
                 ) @ #t2.1 )
            case eventTPMSendCommandTPMSigntlsshtlshtlsspkskae_0_111111111111121111111111111111111
            by solve( state_111111111111121111111111111111111( ~RouterID.1,
                                                               ~ServerID.1, ~ak_h.1, ~ak_sk.1, ~ssk_nms.1,
                                                               ~tid,
                                                               <<swstate, nil>, 'TPM_CC_PolicyPCR', nil>,
                                                               k_h.1, k_sh, pk(x)
                      ) ▶₀ #t2.1 )
          qed
        qed
      qed
    qed
  qed
qed

rule (modulo E) Init[color=#ffffff process=new ~ak_sk;]:
   [ ] --[ Init( ) ]-> [ state_( ) ]

  /* has exactly the trivial AC variant */

rule (modulo E) newaksk_0_[color=#ffffff process=new ~ak_sk;]:
   [ state_( ), Fr( ~ak_sk ) ] --> [ state_1( ~ak_sk ) ]

  /* has exactly the trivial AC variant */

rule (modulo E) outpkaksk_0_1[color=#ffffff process=out(pk(~ak_sk));]:
   [ state_1( ~ak_sk ) ] --> [ state_11( ~ak_sk ), Out( pk(~ak_sk) ) ]

  /* has exactly the trivial AC variant */

rule (modulo E) eventSecretKeyAKaksk_0_11[color=#ffffff process=event SecretKey( 'AK', ~ak_sk );]:
   [ state_11( ~ak_sk ) ]
  --[ SecretKey( 'AK', ~ak_sk ) ]->
   [ state_111( ~ak_sk ) ]

  /* has exactly the trivial AC variant */

rule (modulo E) newakh_0_111[color=#ffffff process=new ~ak_h;]:
   [ state_111( ~ak_sk ), Fr( ~ak_h ) ] --> [ state_1111( ~ak_h, ~ak_sk ) ]

  /* has exactly the trivial AC variant */

rule (modulo E) outakh_0_1111[color=#ffffff process=out(~ak_h);]:
   [ state_1111( ~ak_h, ~ak_sk ) ]
  -->
   [ state_11111( ~ak_h, ~ak_sk ), Out( ~ak_h ) ]

  /* has exactly the trivial AC variant */

rule (modulo E) newRouterID_0_11111[color=#ffffff process=new ~RouterID;]:
   [ state_11111( ~ak_h, ~ak_sk ), Fr( ~RouterID ) ]
  -->
   [ state_111111( ~RouterID, ~ak_h, ~ak_sk ) ]

  /* has exactly the trivial AC variant */

rule (modulo E) outRouterID_0_111111[color=#ffffff process=out(~RouterID);]:
   [ state_111111( ~RouterID, ~ak_h, ~ak_sk ) ]
  -->
   [ state_1111111( ~RouterID, ~ak_h, ~ak_sk ), Out( ~RouterID ) ]

  /* has exactly the trivial AC variant */

rule (modulo E) newServerID_0_1111111[color=#ffffff process=new ~ServerID;]:
   [ state_1111111( ~RouterID, ~ak_h, ~ak_sk ), Fr( ~ServerID ) ]
  -->
   [ state_11111111( ~RouterID, ~ServerID, ~ak_h, ~ak_sk ) ]

  /* has exactly the trivial AC variant */

rule (modulo E) outServerID_0_11111111[color=#ffffff process=out(~ServerID);]:
   [ state_11111111( ~RouterID, ~ServerID, ~ak_h, ~ak_sk ) ]
  -->
   [
   state_111111111( ~RouterID, ~ServerID, ~ak_h, ~ak_sk ), Out( ~ServerID )
   ]

  /* has exactly the trivial AC variant */

rule (modulo E) newssknms_0_111111111[color=#ffffff process=new ~ssk_nms;]:
   [ state_111111111( ~RouterID, ~ServerID, ~ak_h, ~ak_sk ), Fr( ~ssk_nms )
   ]
  -->
   [ state_1111111111( ~RouterID, ~ServerID, ~ak_h, ~ak_sk, ~ssk_nms ) ]

  /* has exactly the trivial AC variant */

rule (modulo E) outpkssknms_0_1111111111[color=#ffffff process=out(pk(~ssk_nms));]:
   [ state_1111111111( ~RouterID, ~ServerID, ~ak_h, ~ak_sk, ~ssk_nms ) ]
  -->
   [
   state_11111111111( ~RouterID, ~ServerID, ~ak_h, ~ak_sk, ~ssk_nms ),
   Out( pk(~ssk_nms) )
   ]

  /* has exactly the trivial AC variant */

rule (modulo E) eventSecretKeyNMSssknms_0_11111111111[color=#ffffff process=event SecretKey( 'NMS', ~ssk_nms );]:
   [ state_11111111111( ~RouterID, ~ServerID, ~ak_h, ~ak_sk, ~ssk_nms ) ]
  --[ SecretKey( 'NMS', ~ssk_nms ) ]->
   [ state_111111111111( ~RouterID, ~ServerID, ~ak_h, ~ak_sk, ~ssk_nms ) ]

  /* has exactly the trivial AC variant */

rule (modulo E) __0_111111111111[color=#807f40 process=|]:
   [ state_111111111111( ~RouterID, ~ServerID, ~ak_h, ~ak_sk, ~ssk_nms ) ]
  -->
   [
   state_1111111111111( ~RouterID, ~ServerID, ~ak_h, ~ak_sk, ~ssk_nms ),
   state_1111111111112( ~RouterID, ~ServerID, ~ak_h, ~ak_sk, ~ssk_nms )
   ]

  /* has exactly the trivial AC variant */

rule (modulo E) __0_1111111111111[color=#807f40 process=|]:
   [ state_1111111111111( ~RouterID, ~ServerID, ~ak_h, ~ak_sk, ~ssk_nms ) ]
  -->
   [
   state_11111111111111( ~RouterID, ~ServerID, ~ak_h, ~ak_sk, ~ssk_nms ),
   state_11111111111112( ~RouterID, ~ServerID, ~ak_h, ~ak_sk, ~ssk_nms )
   ]

  /* has exactly the trivial AC variant */

rule (modulo E) insertauthPolicyakhnil_0_11111111111111[color=#7b4080 process=insert <'authPolicy', ~ak_h>,nil;]:
   [ state_11111111111111( ~RouterID, ~ServerID, ~ak_h, ~ak_sk, ~ssk_nms ) ]
  --[ Insert( <'authPolicy', ~ak_h>, nil ) ]->
   [ state_111111111111111( ~RouterID, ~ServerID, ~ak_h, ~ak_sk, ~ssk_nms )
   ]

  /* has exactly the trivial AC variant */

rule (modulo E) insertprivatePartakhaksk_0_111111111111111[color=#7b4080 process=insert <'privatePart', ~ak_h>,~ak_sk;]:
   [ state_111111111111111( ~RouterID, ~ServerID, ~ak_h, ~ak_sk, ~ssk_nms )
   ]
  --[ Insert( <'privatePart', ~ak_h>, ~ak_sk ) ]->
   [ state_1111111111111111( ~RouterID, ~ServerID, ~ak_h, ~ak_sk, ~ssk_nms )
   ]

  /* has exactly the trivial AC variant */

rule (modulo E) insertpublicPartakhpkaksk_0_1111111111111111[color=#7b4080 process=insert <'publicPart', ~ak_h>,pk(~ak_sk);]:
   [ state_1111111111111111( ~RouterID, ~ServerID, ~ak_h, ~ak_sk, ~ssk_nms )
   ]
  --[ Insert( <'publicPart', ~ak_h>, pk(~ak_sk) ) ]->
   [
   state_11111111111111111( ~RouterID, ~ServerID, ~ak_h, ~ak_sk, ~ssk_nms )
   ]

  /* has exactly the trivial AC variant */

rule (modulo E) insertPCRnil_0_11111111111111111[color=#7b4080 process=insert 'PCR',nil;]:
   [
   state_11111111111111111( ~RouterID, ~ServerID, ~ak_h, ~ak_sk, ~ssk_nms )
   ]
  --[ Insert( 'PCR', nil ) ]->
   [
   state_111111111111111111( ~RouterID, ~ServerID, ~ak_h, ~ak_sk, ~ssk_nms )
   ]

  /* has exactly the trivial AC variant */

rule (modulo E) __0_111111111111111111[color=#7b4080 process=!]:
   [
   state_111111111111111111( ~RouterID, ~ServerID, ~ak_h, ~ak_sk, ~ssk_nms )
   ]
  -->
   [
   !semistate_1111111111111111111( ~RouterID, ~ServerID, ~ak_h, ~ak_sk,
                                   ~ssk_nms
   )
   ]

  /* has exactly the trivial AC variant */

rule (modulo E) __1_111111111111111111[color=#7b4080 process=!]:
   [
   !semistate_1111111111111111111( ~RouterID, ~ServerID, ~ak_h, ~ak_sk,
                                   ~ssk_nms
   )
   ]
  -->
   [
   state_1111111111111111111( ~RouterID, ~ServerID, ~ak_h, ~ak_sk, ~ssk_nms
   )
   ]

  /* has exactly the trivial AC variant */

rule (modulo E) __0_1111111111111111111[color=#7b4080 process=|]:
   [
   state_1111111111111111111( ~RouterID, ~ServerID, ~ak_h, ~ak_sk, ~ssk_nms
   )
   ]
  -->
   [
   state_11111111111111111111( ~RouterID, ~ServerID, ~ak_h, ~ak_sk, ~ssk_nms
   ),
   state_11111111111111111112( ~RouterID, ~ServerID, ~ak_h, ~ak_sk, ~ssk_nms
   )
   ]

  /* has exactly the trivial AC variant */

rule (modulo E) __0_11111111111111111111[color=#7b4080 process=|]:
   [
   state_11111111111111111111( ~RouterID, ~ServerID, ~ak_h, ~ak_sk, ~ssk_nms
   )
   ]
  -->
   [
   state_111111111111111111111( ~RouterID, ~ServerID, ~ak_h, ~ak_sk,
                                ~ssk_nms
   ),
   state_111111111111111111112( ~RouterID, ~ServerID, ~ak_h, ~ak_sk,
                                ~ssk_nms
   )
   ]

  /* has exactly the trivial AC variant */

rule (modulo E) __0_111111111111111111111[color=#7b4080 process=|]:
   [
   state_111111111111111111111( ~RouterID, ~ServerID, ~ak_h, ~ak_sk,
                                ~ssk_nms
   )
   ]
  -->
   [
   state_1111111111111111111111( ~RouterID, ~ServerID, ~ak_h, ~ak_sk,
                                 ~ssk_nms
   ),
   state_1111111111111111111112( ~RouterID, ~ServerID, ~ak_h, ~ak_sk,
                                 ~ssk_nms
   )
   ]

  /* has exactly the trivial AC variant */

rule (modulo E) __0_1111111111111111111111[color=#7b4080 process=|]:
   [
   state_1111111111111111111111( ~RouterID, ~ServerID, ~ak_h, ~ak_sk,
                                 ~ssk_nms
   )
   ]
  -->
   [
   state_11111111111111111111111( ~RouterID, ~ServerID, ~ak_h, ~ak_sk,
                                  ~ssk_nms
   ),
   state_11111111111111111111112( ~RouterID, ~ServerID, ~ak_h, ~ak_sk,
                                  ~ssk_nms
   )
   ]

  /* has exactly the trivial AC variant */

rule (modulo E) __0_11111111111111111111111[color=#7b4080 process=|]:
   [
   state_11111111111111111111111( ~RouterID, ~ServerID, ~ak_h, ~ak_sk,
                                  ~ssk_nms
   )
   ]
  -->
   [
   state_111111111111111111111111( ~RouterID, ~ServerID, ~ak_h, ~ak_sk,
                                   ~ssk_nms
   ),
   state_111111111111111111111112( ~RouterID, ~ServerID, ~ak_h, ~ak_sk,
                                   ~ssk_nms
   )
   ]

  /* has exactly the trivial AC variant */

rule (modulo E) inTPMPCRExtendvalue_0_111111111111111111111111[color=#7b4080 process=in(<'TPM2_PCR_Extend', value>);]:
   [
   state_111111111111111111111111( ~RouterID, ~ServerID, ~ak_h, ~ak_sk,
                                   ~ssk_nms
   ),
   In( <'TPM2_PCR_Extend', value> )
   ]
  -->
   [
   state_1111111111111111111111111( ~RouterID, ~ServerID, ~ak_h, ~ak_sk,
                                    ~ssk_nms, value
   )
   ]

  /* has exactly the trivial AC variant */

rule (modulo E) eventTPMReceiveCommandTPMPCRExtendvalue_0_1111111111111111111111111[color=#7b4080 process=event TPM_ReceiveCommand( <'TPM2_PCR_Extend', value> );]:
   [
   state_1111111111111111111111111( ~RouterID, ~ServerID, ~ak_h, ~ak_sk,
                                    ~ssk_nms, value
   )
   ]
  --[ TPM_ReceiveCommand( <'TPM2_PCR_Extend', value> ) ]->
   [
   state_11111111111111111111111111( ~RouterID, ~ServerID, ~ak_h, ~ak_sk,
                                     ~ssk_nms, value
   )
   ]

  /* has exactly the trivial AC variant */

rule (modulo E) lockdevice_0_11111111111111111111111111[color=#7b4080 process=lock 'device';]:
   [
   state_11111111111111111111111111( ~RouterID, ~ServerID, ~ak_h, ~ak_sk,
                                     ~ssk_nms, value
   ),
   Fr( lock )
   ]
  --[ Lock_0( '0', lock, 'device' ), Lock( '0', lock, 'device' ) ]->
   [
   state_111111111111111111111111111( ~RouterID, ~ServerID, ~ak_h, ~ak_sk,
                                      ~ssk_nms, lock, value
   )
   ]

  /* has exactly the trivial AC variant */

rule (modulo E) lookupPCRaspcr_0_111111111111111111111111111[color=#7b4080 process=lookup 'PCR' as pcr]:
   [
   state_111111111111111111111111111( ~RouterID, ~ServerID, ~ak_h, ~ak_sk,
                                      ~ssk_nms, lock, value
   )
   ]
  --[ IsIn( 'PCR', pcr ) ]->
   [
   state_1111111111111111111111111111( ~RouterID, ~ServerID, ~ak_h, ~ak_sk,
                                       ~ssk_nms, lock, pcr, value
   )
   ]

  /* has exactly the trivial AC variant */

rule (modulo E) lookupPCRaspcr_1_111111111111111111111111111[color=#7b4080 process=lookup 'PCR' as pcr]:
   [
   state_111111111111111111111111111( ~RouterID, ~ServerID, ~ak_h, ~ak_sk,
                                      ~ssk_nms, lock, value
   )
   ]
  --[ IsNotSet( 'PCR' ) ]->
   [
   state_1111111111111111111111111112( ~RouterID, ~ServerID, ~ak_h, ~ak_sk,
                                       ~ssk_nms, lock, value
   )
   ]

  /* has exactly the trivial AC variant */

rule (modulo E) insertPCRvaluepcr_0_1111111111111111111111111111[color=#7b4080 process=insert 'PCR',<value, pcr>;]:
   [
   state_1111111111111111111111111111( ~RouterID, ~ServerID, ~ak_h, ~ak_sk,
                                       ~ssk_nms, lock, pcr, value
   )
   ]
  --[ Insert( 'PCR', <value, pcr> ) ]->
   [
   state_11111111111111111111111111111( ~RouterID, ~ServerID, ~ak_h, ~ak_sk,
                                        ~ssk_nms, lock, pcr, value
   )
   ]

  /* has exactly the trivial AC variant */

rule (modulo E) unlockdevice_0_11111111111111111111111111111[color=#7b4080 process=unlock 'device';]:
   [
   state_11111111111111111111111111111( ~RouterID, ~ServerID, ~ak_h, ~ak_sk,
                                        ~ssk_nms, lock, pcr, value
   )
   ]
  --[ Unlock_0( '0', lock, 'device' ), Unlock( '0', lock, 'device' ) ]->
   [
   state_111111111111111111111111111111( ~RouterID, ~ServerID, ~ak_h,
                                         ~ak_sk, ~ssk_nms, lock, pcr, value
   )
   ]

  /* has exactly the trivial AC variant */

rule (modulo E) __0_111111111111111111111111111111[color=#7b4080 process=0]:
   [
   state_111111111111111111111111111111( ~RouterID, ~ServerID, ~ak_h,
                                         ~ak_sk, ~ssk_nms, lock, pcr, value
   )
   ]
  -->
   [ ]

  /* has exactly the trivial AC variant */

rule (modulo E) __0_1111111111111111111111111112[color=#7b4080 process=0]:
   [
   state_1111111111111111111111111112( ~RouterID, ~ServerID, ~ak_h, ~ak_sk,
                                       ~ssk_nms, lock, value
   )
   ]
  -->
   [ ]

  /* has exactly the trivial AC variant */

rule (modulo E) inTPMPolicyPCRsh_0_111111111111111111111112[color=#7b4080 process=in(<'TPM2_PolicyPCR', s_h>);]:
   [
   state_111111111111111111111112( ~RouterID, ~ServerID, ~ak_h, ~ak_sk,
                                   ~ssk_nms
   ),
   In( <'TPM2_PolicyPCR', s_h> )
   ]
  -->
   [
   state_1111111111111111111111121( ~RouterID, ~ServerID, ~ak_h, ~ak_sk,
                                    ~ssk_nms, s_h
   )
   ]

  /* has exactly the trivial AC variant */

rule (modulo E) eventTPMReceiveCommandTPMPolicyPCRsh_0_1111111111111111111111121[color=#7b4080 process=event TPM_ReceiveCommand( <'TPM2_PolicyPCR', s_h> );]:
   [
   state_1111111111111111111111121( ~RouterID, ~ServerID, ~ak_h, ~ak_sk,
                                    ~ssk_nms, s_h
   )
   ]
  --[ TPM_ReceiveCommand( <'TPM2_PolicyPCR', s_h> ) ]->
   [
   state_11111111111111111111111211( ~RouterID, ~ServerID, ~ak_h, ~ak_sk,
                                     ~ssk_nms, s_h
   )
   ]

  /* has exactly the trivial AC variant */

rule (modulo E) lockdevice_0_11111111111111111111111211[color=#7b4080 process=lock 'device';]:
   [
   state_11111111111111111111111211( ~RouterID, ~ServerID, ~ak_h, ~ak_sk,
                                     ~ssk_nms, s_h
   ),
   Fr( lock.1 )
   ]
  --[ Lock_1( '1', lock.1, 'device' ), Lock( '1', lock.1, 'device' ) ]->
   [
   state_111111111111111111111112111( ~RouterID, ~ServerID, ~ak_h, ~ak_sk,
                                      ~ssk_nms, s_h, lock.1
   )
   ]

  /*
  rule (modulo AC) lockdevice_0_11111111111111111111111211[color=#7b4080 process=lock 'device';]:
     [
     state_11111111111111111111111211( ~RouterID, ~ServerID, ~ak_h, ~ak_sk,
                                       ~ssk_nms, s_h
     ),
     Fr( lock )
     ]
    --[ Lock_1( '1', lock, 'device' ), Lock( '1', lock, 'device' ) ]->
     [
     state_111111111111111111111112111( ~RouterID, ~ServerID, ~ak_h, ~ak_sk,
                                        ~ssk_nms, s_h, lock
     )
     ]
  */

rule (modulo E) lookupPCRaspcrL_0_111111111111111111111112111[color=#7b4080 process=lookup 'PCR' as pcrL]:
   [
   state_111111111111111111111112111( ~RouterID, ~ServerID, ~ak_h, ~ak_sk,
                                      ~ssk_nms, s_h, lock.1
   )
   ]
  --[ IsIn( 'PCR', pcrL ) ]->
   [
   state_1111111111111111111111121111( ~RouterID, ~ServerID, ~ak_h, ~ak_sk,
                                       ~ssk_nms, pcrL, s_h, lock.1
   )
   ]

  /*
  rule (modulo AC) lookupPCRaspcrL_0_111111111111111111111112111[color=#7b4080 process=lookup 'PCR' as pcrL]:
     [
     state_111111111111111111111112111( ~RouterID, ~ServerID, ~ak_h, ~ak_sk,
                                        ~ssk_nms, s_h, lock
     )
     ]
    --[ IsIn( 'PCR', pcrL ) ]->
     [
     state_1111111111111111111111121111( ~RouterID, ~ServerID, ~ak_h, ~ak_sk,
                                         ~ssk_nms, pcrL, s_h, lock
     )
     ]
  */

rule (modulo E) lookupPCRaspcrL_1_111111111111111111111112111[color=#7b4080 process=lookup 'PCR' as pcrL]:
   [
   state_111111111111111111111112111( ~RouterID, ~ServerID, ~ak_h, ~ak_sk,
                                      ~ssk_nms, s_h, lock.1
   )
   ]
  --[ IsNotSet( 'PCR' ) ]->
   [
   state_1111111111111111111111121112( ~RouterID, ~ServerID, ~ak_h, ~ak_sk,
                                       ~ssk_nms, s_h, lock.1
   )
   ]

  /*
  rule (modulo AC) lookupPCRaspcrL_1_111111111111111111111112111[color=#7b4080 process=lookup 'PCR' as pcrL]:
     [
     state_111111111111111111111112111( ~RouterID, ~ServerID, ~ak_h, ~ak_sk,
                                        ~ssk_nms, s_h, lock
     )
     ]
    --[ IsNotSet( 'PCR' ) ]->
     [
     state_1111111111111111111111121112( ~RouterID, ~ServerID, ~ak_h, ~ak_sk,
                                         ~ssk_nms, s_h, lock
     )
     ]
  */

rule (modulo E) lookuppolicyDigestshaspL_0_1111111111111111111111121111[color=#7b4080 process=lookup <'policyDigest', s_h> as pL]:
   [
   state_1111111111111111111111121111( ~RouterID, ~ServerID, ~ak_h, ~ak_sk,
                                       ~ssk_nms, pcrL, s_h, lock.1
   )
   ]
  --[ IsIn( <'policyDigest', s_h>, pL ) ]->
   [
   state_11111111111111111111111211111( ~RouterID, ~ServerID, ~ak_h, ~ak_sk,
                                        ~ssk_nms, pL, pcrL, s_h, lock.1
   )
   ]

  /*
  rule (modulo AC) lookuppolicyDigestshaspL_0_1111111111111111111111121111[color=#7b4080 process=lookup <'policyDigest', s_h> as pL]:
     [
     state_1111111111111111111111121111( ~RouterID, ~ServerID, ~ak_h, ~ak_sk,
                                         ~ssk_nms, pcrL, s_h, lock
     )
     ]
    --[ IsIn( <'policyDigest', s_h>, pL ) ]->
     [
     state_11111111111111111111111211111( ~RouterID, ~ServerID, ~ak_h, ~ak_sk,
                                          ~ssk_nms, pL, pcrL, s_h, lock
     )
     ]
  */

rule (modulo E) lookuppolicyDigestshaspL_1_1111111111111111111111121111[color=#7b4080 process=lookup <'policyDigest', s_h> as pL]:
   [
   state_1111111111111111111111121111( ~RouterID, ~ServerID, ~ak_h, ~ak_sk,
                                       ~ssk_nms, pcrL, s_h, lock.1
   )
   ]
  --[ IsNotSet( <'policyDigest', s_h> ) ]->
   [
   state_11111111111111111111111211112( ~RouterID, ~ServerID, ~ak_h, ~ak_sk,
                                        ~ssk_nms, pcrL, s_h, lock.1
   )
   ]

  /*
  rule (modulo AC) lookuppolicyDigestshaspL_1_1111111111111111111111121111[color=#7b4080 process=lookup <'policyDigest', s_h> as pL]:
     [
     state_1111111111111111111111121111( ~RouterID, ~ServerID, ~ak_h, ~ak_sk,
                                         ~ssk_nms, pcrL, s_h, lock
     )
     ]
    --[ IsNotSet( <'policyDigest', s_h> ) ]->
     [
     state_11111111111111111111111211112( ~RouterID, ~ServerID, ~ak_h, ~ak_sk,
                                          ~ssk_nms, pcrL, s_h, lock
     )
     ]
  */

rule (modulo E) eventPolicyPCRshpL_0_11111111111111111111111211111[color=#7b4080 process=event PolicyPCR( s_h, pL );]:
   [
   state_11111111111111111111111211111( ~RouterID, ~ServerID, ~ak_h, ~ak_sk,
                                        ~ssk_nms, pL, pcrL, s_h, lock.1
   )
   ]
  --[ PolicyPCR( s_h, pL ) ]->
   [
   state_111111111111111111111112111111( ~RouterID, ~ServerID, ~ak_h,
                                         ~ak_sk, ~ssk_nms, pL, pcrL, s_h, lock.1
   )
   ]

  /*
  rule (modulo AC) eventPolicyPCRshpL_0_11111111111111111111111211111[color=#7b4080 process=event PolicyPCR( s_h, pL );]:
     [
     state_11111111111111111111111211111( ~RouterID, ~ServerID, ~ak_h, ~ak_sk,
                                          ~ssk_nms, pL, pcrL, s_h, lock
     )
     ]
    --[ PolicyPCR( s_h, pL ) ]->
     [
     state_111111111111111111111112111111( ~RouterID, ~ServerID, ~ak_h,
                                           ~ak_sk, ~ssk_nms, pL, pcrL, s_h, lock
     )
     ]
  */

rule (modulo E) insertpolicyDigestshpcrLTPMCCPolicyPCRpL_0_111111111111111111111112111111[color=#7b4080 process=insert <'policyDigest', s_h>,<pcrL, 'TPM_CC_PolicyPCR', pL>;]:
   [
   state_111111111111111111111112111111( ~RouterID, ~ServerID, ~ak_h,
                                         ~ak_sk, ~ssk_nms, pL, pcrL, s_h, lock.1
   )
   ]
  --[ Insert( <'policyDigest', s_h>, <pcrL, 'TPM_CC_PolicyPCR', pL> ) ]->
   [
   state_1111111111111111111111121111111( ~RouterID, ~ServerID, ~ak_h,
                                          ~ak_sk, ~ssk_nms, pL, pcrL, s_h, lock.1
   )
   ]

  /*
  rule (modulo AC) insertpolicyDigestshpcrLTPMCCPolicyPCRpL_0_111111111111111111111112111111[color=#7b4080 process=insert <'policyDigest', s_h>,<pcrL, 'TPM_CC_PolicyPCR', pL>;]:
     [
     state_111111111111111111111112111111( ~RouterID, ~ServerID, ~ak_h,
                                           ~ak_sk, ~ssk_nms, pL, pcrL, s_h, lock
     )
     ]
    --[ Insert( <'policyDigest', s_h>, <pcrL, 'TPM_CC_PolicyPCR', pL> ) ]->
     [
     state_1111111111111111111111121111111( ~RouterID, ~ServerID, ~ak_h,
                                            ~ak_sk, ~ssk_nms, pL, pcrL, s_h, lock
     )
     ]
  */

rule (modulo E) unlockdevice_0_1111111111111111111111121111111[color=#7b4080 process=unlock 'device';]:
   [
   state_1111111111111111111111121111111( ~RouterID, ~ServerID, ~ak_h,
                                          ~ak_sk, ~ssk_nms, pL, pcrL, s_h, lock.1
   )
   ]
  --[ Unlock_1( '1', lock.1, 'device' ), Unlock( '1', lock.1, 'device' )
  ]->
   [
   state_11111111111111111111111211111111( ~RouterID, ~ServerID, ~ak_h,
                                           ~ak_sk, ~ssk_nms, pL, pcrL, s_h, lock.1
   )
   ]

  /*
  rule (modulo AC) unlockdevice_0_1111111111111111111111121111111[color=#7b4080 process=unlock 'device';]:
     [
     state_1111111111111111111111121111111( ~RouterID, ~ServerID, ~ak_h,
                                            ~ak_sk, ~ssk_nms, pL, pcrL, s_h, lock
     )
     ]
    --[ Unlock_1( '1', lock, 'device' ), Unlock( '1', lock, 'device' ) ]->
     [
     state_11111111111111111111111211111111( ~RouterID, ~ServerID, ~ak_h,
                                             ~ak_sk, ~ssk_nms, pL, pcrL, s_h, lock
     )
     ]
  */

rule (modulo E) __0_11111111111111111111111211111111[color=#7b4080 process=0]:
   [
   state_11111111111111111111111211111111( ~RouterID, ~ServerID, ~ak_h,
                                           ~ak_sk, ~ssk_nms, pL, pcrL, s_h, lock.1
   )
   ]
  -->
   [ ]

  /*
  rule (modulo AC) __0_11111111111111111111111211111111[color=#7b4080 process=0]:
     [
     state_11111111111111111111111211111111( ~RouterID, ~ServerID, ~ak_h,
                                             ~ak_sk, ~ssk_nms, pL, pcrL, s_h, lock
     )
     ]
    -->
     [ ]
  */

rule (modulo E) __0_11111111111111111111111211112[color=#7b4080 process=0]:
   [
   state_11111111111111111111111211112( ~RouterID, ~ServerID, ~ak_h, ~ak_sk,
                                        ~ssk_nms, pcrL, s_h, lock.1
   )
   ]
  -->
   [ ]

  /*
  rule (modulo AC) __0_11111111111111111111111211112[color=#7b4080 process=0]:
     [
     state_11111111111111111111111211112( ~RouterID, ~ServerID, ~ak_h, ~ak_sk,
                                          ~ssk_nms, pcrL, s_h, lock
     )
     ]
    -->
     [ ]
  */

rule (modulo E) __0_1111111111111111111111121112[color=#7b4080 process=0]:
   [
   state_1111111111111111111111121112( ~RouterID, ~ServerID, ~ak_h, ~ak_sk,
                                       ~ssk_nms, s_h, lock.1
   )
   ]
  -->
   [ ]

  /*
  rule (modulo AC) __0_1111111111111111111111121112[color=#7b4080 process=0]:
     [
     state_1111111111111111111111121112( ~RouterID, ~ServerID, ~ak_h, ~ak_sk,
                                         ~ssk_nms, s_h, lock
     )
     ]
    -->
     [ ]
  */

rule (modulo E) inTPMCreateauthPolicy_0_11111111111111111111112[color=#7b4080 process=in(<'TPM2_Create', authPolicy>);]:
   [
   state_11111111111111111111112( ~RouterID, ~ServerID, ~ak_h, ~ak_sk,
                                  ~ssk_nms
   ),
   In( <'TPM2_Create', authPolicy> )
   ]
  -->
   [
   state_111111111111111111111121( ~RouterID, ~ServerID, ~ak_h, ~ak_sk,
                                   ~ssk_nms, authPolicy
   )
   ]

  /* has exactly the trivial AC variant */

rule (modulo E) eventTPMReceiveCommandTPMCreateauthPolicy_0_111111111111111111111121[color=#7b4080 process=event TPM_ReceiveCommand( <'TPM2_Create', authPolicy> );]:
   [
   state_111111111111111111111121( ~RouterID, ~ServerID, ~ak_h, ~ak_sk,
                                   ~ssk_nms, authPolicy
   )
   ]
  --[ TPM_ReceiveCommand( <'TPM2_Create', authPolicy> ) ]->
   [
   state_1111111111111111111111211( ~RouterID, ~ServerID, ~ak_h, ~ak_sk,
                                    ~ssk_nms, authPolicy
   )
   ]

  /* has exactly the trivial AC variant */

rule (modulo E) newkh_0_1111111111111111111111211[color=#7b4080 process=new ~k_h;]:
   [
   state_1111111111111111111111211( ~RouterID, ~ServerID, ~ak_h, ~ak_sk,
                                    ~ssk_nms, authPolicy
   ),
   Fr( ~k_h )
   ]
  -->
   [
   state_11111111111111111111112111( ~RouterID, ~ServerID, ~ak_h, ~ak_sk,
                                     ~k_h, ~ssk_nms, authPolicy
   )
   ]

  /* has exactly the trivial AC variant */

rule (modulo E) newksk_0_11111111111111111111112111[color=#7b4080 process=new ~k_sk;]:
   [
   state_11111111111111111111112111( ~RouterID, ~ServerID, ~ak_h, ~ak_sk,
                                     ~k_h, ~ssk_nms, authPolicy
   ),
   Fr( ~k_sk )
   ]
  -->
   [
   state_111111111111111111111121111( ~RouterID, ~ServerID, ~ak_h, ~ak_sk,
                                      ~k_h, ~k_sk, ~ssk_nms, authPolicy
   )
   ]

  /* has exactly the trivial AC variant */

rule (modulo E) eventSecretKeyTLSksk_0_111111111111111111111121111[color=#7b4080 process=event SecretKey( 'TLS', ~k_sk );]:
   [
   state_111111111111111111111121111( ~RouterID, ~ServerID, ~ak_h, ~ak_sk,
                                      ~k_h, ~k_sk, ~ssk_nms, authPolicy
   )
   ]
  --[ SecretKey( 'TLS', ~k_sk ) ]->
   [
   state_1111111111111111111111211111( ~RouterID, ~ServerID, ~ak_h, ~ak_sk,
                                       ~k_h, ~k_sk, ~ssk_nms, authPolicy
   )
   ]

  /* has exactly the trivial AC variant */

rule (modulo E) lockdevice_0_1111111111111111111111211111[color=#7b4080 process=lock 'device';]:
   [
   state_1111111111111111111111211111( ~RouterID, ~ServerID, ~ak_h, ~ak_sk,
                                       ~k_h, ~k_sk, ~ssk_nms, authPolicy
   ),
   Fr( lock.2 )
   ]
  --[ Lock_2( '2', lock.2, 'device' ), Lock( '2', lock.2, 'device' ) ]->
   [
   state_11111111111111111111112111111( ~RouterID, ~ServerID, ~ak_h, ~ak_sk,
                                        ~k_h, ~k_sk, ~ssk_nms, authPolicy, lock.2
   )
   ]

  /*
  rule (modulo AC) lockdevice_0_1111111111111111111111211111[color=#7b4080 process=lock 'device';]:
     [
     state_1111111111111111111111211111( ~RouterID, ~ServerID, ~ak_h, ~ak_sk,
                                         ~k_h, ~k_sk, ~ssk_nms, authPolicy
     ),
     Fr( lock )
     ]
    --[ Lock_2( '2', lock, 'device' ), Lock( '2', lock, 'device' ) ]->
     [
     state_11111111111111111111112111111( ~RouterID, ~ServerID, ~ak_h, ~ak_sk,
                                          ~k_h, ~k_sk, ~ssk_nms, authPolicy, lock
     )
     ]
  */

rule (modulo E) insertauthPolicykhauthPolicy_0_11111111111111111111112111111[color=#7b4080 process=insert <'authPolicy', ~k_h>,authPolicy;]:
   [
   state_11111111111111111111112111111( ~RouterID, ~ServerID, ~ak_h, ~ak_sk,
                                        ~k_h, ~k_sk, ~ssk_nms, authPolicy, lock.2
   )
   ]
  --[ Insert( <'authPolicy', ~k_h>, authPolicy ) ]->
   [
   state_111111111111111111111121111111( ~RouterID, ~ServerID, ~ak_h,
                                         ~ak_sk, ~k_h, ~k_sk, ~ssk_nms, authPolicy, lock.2
   )
   ]

  /*
  rule (modulo AC) insertauthPolicykhauthPolicy_0_11111111111111111111112111111[color=#7b4080 process=insert <'authPolicy', ~k_h>,authPolicy;]:
     [
     state_11111111111111111111112111111( ~RouterID, ~ServerID, ~ak_h, ~ak_sk,
                                          ~k_h, ~k_sk, ~ssk_nms, authPolicy, lock
     )
     ]
    --[ Insert( <'authPolicy', ~k_h>, authPolicy ) ]->
     [
     state_111111111111111111111121111111( ~RouterID, ~ServerID, ~ak_h,
                                           ~ak_sk, ~k_h, ~k_sk, ~ssk_nms, authPolicy, lock
     )
     ]
  */

rule (modulo E) insertprivatePartkhksk_0_111111111111111111111121111111[color=#7b4080 process=insert <'privatePart', ~k_h>,~k_sk;]:
   [
   state_111111111111111111111121111111( ~RouterID, ~ServerID, ~ak_h,
                                         ~ak_sk, ~k_h, ~k_sk, ~ssk_nms, authPolicy, lock.2
   )
   ]
  --[ Insert( <'privatePart', ~k_h>, ~k_sk ) ]->
   [
   state_1111111111111111111111211111111( ~RouterID, ~ServerID, ~ak_h,
                                          ~ak_sk, ~k_h, ~k_sk, ~ssk_nms, authPolicy, lock.2
   )
   ]

  /*
  rule (modulo AC) insertprivatePartkhksk_0_111111111111111111111121111111[color=#7b4080 process=insert <'privatePart', ~k_h>,~k_sk;]:
     [
     state_111111111111111111111121111111( ~RouterID, ~ServerID, ~ak_h,
                                           ~ak_sk, ~k_h, ~k_sk, ~ssk_nms, authPolicy, lock
     )
     ]
    --[ Insert( <'privatePart', ~k_h>, ~k_sk ) ]->
     [
     state_1111111111111111111111211111111( ~RouterID, ~ServerID, ~ak_h,
                                            ~ak_sk, ~k_h, ~k_sk, ~ssk_nms, authPolicy, lock
     )
     ]
  */

rule (modulo E) insertpublicPartkhpkksk_0_1111111111111111111111211111111[color=#7b4080 process=insert <'publicPart', ~k_h>,pk(~k_sk);]:
   [
   state_1111111111111111111111211111111( ~RouterID, ~ServerID, ~ak_h,
                                          ~ak_sk, ~k_h, ~k_sk, ~ssk_nms, authPolicy, lock.2
   )
   ]
  --[ Insert( <'publicPart', ~k_h>, pk(~k_sk) ) ]->
   [
   state_11111111111111111111112111111111( ~RouterID, ~ServerID, ~ak_h,
                                           ~ak_sk, ~k_h, ~k_sk, ~ssk_nms, authPolicy, lock.2
   )
   ]

  /*
  rule (modulo AC) insertpublicPartkhpkksk_0_1111111111111111111111211111111[color=#7b4080 process=insert <'publicPart', ~k_h>,pk(~k_sk);]:
     [
     state_1111111111111111111111211111111( ~RouterID, ~ServerID, ~ak_h,
                                            ~ak_sk, ~k_h, ~k_sk, ~ssk_nms, authPolicy, lock
     )
     ]
    --[ Insert( <'publicPart', ~k_h>, pk(~k_sk) ) ]->
     [
     state_11111111111111111111112111111111( ~RouterID, ~ServerID, ~ak_h,
                                             ~ak_sk, ~k_h, ~k_sk, ~ssk_nms, authPolicy, lock
     )
     ]
  */

rule (modulo E) TpmCreateOutkhpkksk_0_11111111111111111111112111111111[color=#7b4080 process= [ ] --> [ Tpm2CreateOut( <~k_h, pk(~k_sk)> ) ];]:
   [
   state_11111111111111111111112111111111( ~RouterID, ~ServerID, ~ak_h,
                                           ~ak_sk, ~k_h, ~k_sk, ~ssk_nms, authPolicy, lock.2
   )
   ]
  -->
   [
   state_111111111111111111111121111111111( ~RouterID, ~ServerID, ~ak_h,
                                            ~ak_sk, ~k_h, ~k_sk, ~ssk_nms, authPolicy, lock.2
   ),
   Tpm2CreateOut( <~k_h, pk(~k_sk)> )
   ]

  /*
  rule (modulo AC) TpmCreateOutkhpkksk_0_11111111111111111111112111111111[color=#7b4080 process= [ ] --> [ Tpm2CreateOut( <~k_h, pk(~k_sk)> ) ];]:
     [
     state_11111111111111111111112111111111( ~RouterID, ~ServerID, ~ak_h,
                                             ~ak_sk, ~k_h, ~k_sk, ~ssk_nms, authPolicy, lock
     )
     ]
    -->
     [
     state_111111111111111111111121111111111( ~RouterID, ~ServerID, ~ak_h,
                                              ~ak_sk, ~k_h, ~k_sk, ~ssk_nms, authPolicy, lock
     ),
     Tpm2CreateOut( <~k_h, pk(~k_sk)> )
     ]
  */

rule (modulo E) unlockdevice_0_111111111111111111111121111111111[color=#7b4080 process=unlock 'device';]:
   [
   state_111111111111111111111121111111111( ~RouterID, ~ServerID, ~ak_h,
                                            ~ak_sk, ~k_h, ~k_sk, ~ssk_nms, authPolicy, lock.2
   )
   ]
  --[ Unlock_2( '2', lock.2, 'device' ), Unlock( '2', lock.2, 'device' )
  ]->
   [
   state_1111111111111111111111211111111111( ~RouterID, ~ServerID, ~ak_h,
                                             ~ak_sk, ~k_h, ~k_sk, ~ssk_nms, authPolicy, lock.2
   )
   ]

  /*
  rule (modulo AC) unlockdevice_0_111111111111111111111121111111111[color=#7b4080 process=unlock 'device';]:
     [
     state_111111111111111111111121111111111( ~RouterID, ~ServerID, ~ak_h,
                                              ~ak_sk, ~k_h, ~k_sk, ~ssk_nms, authPolicy, lock
     )
     ]
    --[ Unlock_2( '2', lock, 'device' ), Unlock( '2', lock, 'device' ) ]->
     [
     state_1111111111111111111111211111111111( ~RouterID, ~ServerID, ~ak_h,
                                               ~ak_sk, ~k_h, ~k_sk, ~ssk_nms, authPolicy, lock
     )
     ]
  */

rule (modulo E) __0_1111111111111111111111211111111111[color=#7b4080 process=0]:
   [
   state_1111111111111111111111211111111111( ~RouterID, ~ServerID, ~ak_h,
                                             ~ak_sk, ~k_h, ~k_sk, ~ssk_nms, authPolicy, lock.2
   )
   ]
  -->
   [ ]

  /*
  rule (modulo AC) __0_1111111111111111111111211111111111[color=#7b4080 process=0]:
     [
     state_1111111111111111111111211111111111( ~RouterID, ~ServerID, ~ak_h,
                                               ~ak_sk, ~k_h, ~k_sk, ~ssk_nms, authPolicy, lock
     )
     ]
    -->
     [ ]
  */

rule (modulo E) inTPMStartAuthSession_0_1111111111111111111112[color=#7b4080 process=in('TPM2_StartAuthSession');]:
   [
   state_1111111111111111111112( ~RouterID, ~ServerID, ~ak_h, ~ak_sk,
                                 ~ssk_nms
   ),
   In( 'TPM2_StartAuthSession' )
   ]
  -->
   [
   state_11111111111111111111121( ~RouterID, ~ServerID, ~ak_h, ~ak_sk,
                                  ~ssk_nms
   )
   ]

  /* has exactly the trivial AC variant */

rule (modulo E) eventTPMReceiveCommandTPMStartAuthSession_0_11111111111111111111121[color=#7b4080 process=event TPM_ReceiveCommand( 'TPM2_StartAuthSession' );]:
   [
   state_11111111111111111111121( ~RouterID, ~ServerID, ~ak_h, ~ak_sk,
                                  ~ssk_nms
   )
   ]
  --[ TPM_ReceiveCommand( 'TPM2_StartAuthSession' ) ]->
   [
   state_111111111111111111111211( ~RouterID, ~ServerID, ~ak_h, ~ak_sk,
                                   ~ssk_nms
   )
   ]

  /* has exactly the trivial AC variant */

rule (modulo E) newsh_0_111111111111111111111211[color=#7b4080 process=new ~s_h;]:
   [
   state_111111111111111111111211( ~RouterID, ~ServerID, ~ak_h, ~ak_sk,
                                   ~ssk_nms
   ),
   Fr( ~s_h )
   ]
  -->
   [
   state_1111111111111111111112111( ~RouterID, ~ServerID, ~ak_h, ~ak_sk,
                                    ~s_h, ~ssk_nms
   )
   ]

  /* has exactly the trivial AC variant */

rule (modulo E) lockdevice_0_1111111111111111111112111[color=#7b4080 process=lock 'device';]:
   [
   state_1111111111111111111112111( ~RouterID, ~ServerID, ~ak_h, ~ak_sk,
                                    ~s_h, ~ssk_nms
   ),
   Fr( lock.3 )
   ]
  --[ Lock_3( '3', lock.3, 'device' ), Lock( '3', lock.3, 'device' ) ]->
   [
   state_11111111111111111111121111( ~RouterID, ~ServerID, ~ak_h, ~ak_sk,
                                     ~s_h, ~ssk_nms, lock.3
   )
   ]

  /*
  rule (modulo AC) lockdevice_0_1111111111111111111112111[color=#7b4080 process=lock 'device';]:
     [
     state_1111111111111111111112111( ~RouterID, ~ServerID, ~ak_h, ~ak_sk,
                                      ~s_h, ~ssk_nms
     ),
     Fr( lock )
     ]
    --[ Lock_3( '3', lock, 'device' ), Lock( '3', lock, 'device' ) ]->
     [
     state_11111111111111111111121111( ~RouterID, ~ServerID, ~ak_h, ~ak_sk,
                                       ~s_h, ~ssk_nms, lock
     )
     ]
  */

rule (modulo E) insertpolicyDigestshnil_0_11111111111111111111121111[color=#7b4080 process=insert <'policyDigest', ~s_h>,nil;]:
   [
   state_11111111111111111111121111( ~RouterID, ~ServerID, ~ak_h, ~ak_sk,
                                     ~s_h, ~ssk_nms, lock.3
   )
   ]
  --[ Insert( <'policyDigest', ~s_h>, nil ) ]->
   [
   state_111111111111111111111211111( ~RouterID, ~ServerID, ~ak_h, ~ak_sk,
                                      ~s_h, ~ssk_nms, lock.3
   )
   ]

  /*
  rule (modulo AC) insertpolicyDigestshnil_0_11111111111111111111121111[color=#7b4080 process=insert <'policyDigest', ~s_h>,nil;]:
     [
     state_11111111111111111111121111( ~RouterID, ~ServerID, ~ak_h, ~ak_sk,
                                       ~s_h, ~ssk_nms, lock
     )
     ]
    --[ Insert( <'policyDigest', ~s_h>, nil ) ]->
     [
     state_111111111111111111111211111( ~RouterID, ~ServerID, ~ak_h, ~ak_sk,
                                        ~s_h, ~ssk_nms, lock
     )
     ]
  */

rule (modulo E) eventCreateHandlesh_0_111111111111111111111211111[color=#7b4080 process=event CreateHandle( ~s_h );]:
   [
   state_111111111111111111111211111( ~RouterID, ~ServerID, ~ak_h, ~ak_sk,
                                      ~s_h, ~ssk_nms, lock.3
   )
   ]
  --[ CreateHandle( ~s_h ) ]->
   [
   state_1111111111111111111112111111( ~RouterID, ~ServerID, ~ak_h, ~ak_sk,
                                       ~s_h, ~ssk_nms, lock.3
   )
   ]

  /*
  rule (modulo AC) eventCreateHandlesh_0_111111111111111111111211111[color=#7b4080 process=event CreateHandle( ~s_h );]:
     [
     state_111111111111111111111211111( ~RouterID, ~ServerID, ~ak_h, ~ak_sk,
                                        ~s_h, ~ssk_nms, lock
     )
     ]
    --[ CreateHandle( ~s_h ) ]->
     [
     state_1111111111111111111112111111( ~RouterID, ~ServerID, ~ak_h, ~ak_sk,
                                         ~s_h, ~ssk_nms, lock
     )
     ]
  */

rule (modulo E) outsh_0_1111111111111111111112111111[color=#7b4080 process=out(~s_h);]:
   [
   state_1111111111111111111112111111( ~RouterID, ~ServerID, ~ak_h, ~ak_sk,
                                       ~s_h, ~ssk_nms, lock.3
   )
   ]
  -->
   [
   state_11111111111111111111121111111( ~RouterID, ~ServerID, ~ak_h, ~ak_sk,
                                        ~s_h, ~ssk_nms, lock.3
   ),
   Out( ~s_h )
   ]

  /*
  rule (modulo AC) outsh_0_1111111111111111111112111111[color=#7b4080 process=out(~s_h);]:
     [
     state_1111111111111111111112111111( ~RouterID, ~ServerID, ~ak_h, ~ak_sk,
                                         ~s_h, ~ssk_nms, lock
     )
     ]
    -->
     [
     state_11111111111111111111121111111( ~RouterID, ~ServerID, ~ak_h, ~ak_sk,
                                          ~s_h, ~ssk_nms, lock
     ),
     Out( ~s_h )
     ]
  */

rule (modulo E) unlockdevice_0_11111111111111111111121111111[color=#7b4080 process=unlock 'device';]:
   [
   state_11111111111111111111121111111( ~RouterID, ~ServerID, ~ak_h, ~ak_sk,
                                        ~s_h, ~ssk_nms, lock.3
   )
   ]
  --[ Unlock_3( '3', lock.3, 'device' ), Unlock( '3', lock.3, 'device' )
  ]->
   [
   state_111111111111111111111211111111( ~RouterID, ~ServerID, ~ak_h,
                                         ~ak_sk, ~s_h, ~ssk_nms, lock.3
   )
   ]

  /*
  rule (modulo AC) unlockdevice_0_11111111111111111111121111111[color=#7b4080 process=unlock 'device';]:
     [
     state_11111111111111111111121111111( ~RouterID, ~ServerID, ~ak_h, ~ak_sk,
                                          ~s_h, ~ssk_nms, lock
     )
     ]
    --[ Unlock_3( '3', lock, 'device' ), Unlock( '3', lock, 'device' ) ]->
     [
     state_111111111111111111111211111111( ~RouterID, ~ServerID, ~ak_h,
                                           ~ak_sk, ~s_h, ~ssk_nms, lock
     )
     ]
  */

rule (modulo E) __0_111111111111111111111211111111[color=#7b4080 process=0]:
   [
   state_111111111111111111111211111111( ~RouterID, ~ServerID, ~ak_h,
                                         ~ak_sk, ~s_h, ~ssk_nms, lock.3
   )
   ]
  -->
   [ ]

  /*
  rule (modulo AC) __0_111111111111111111111211111111[color=#7b4080 process=0]:
     [
     state_111111111111111111111211111111( ~RouterID, ~ServerID, ~ak_h,
                                           ~ak_sk, ~s_h, ~ssk_nms, lock
     )
     ]
    -->
     [ ]
  */

rule (modulo E) inTPMCertifyobjshobjhah_0_111111111111111111112[color=#7b4080 process=in(<'TPM2_Certify', obj_sh, obj_h, a_h>);]:
   [
   state_111111111111111111112( ~RouterID, ~ServerID, ~ak_h, ~ak_sk,
                                ~ssk_nms
   ),
   In( <'TPM2_Certify', obj_sh, obj_h, a_h> )
   ]
  -->
   [
   state_1111111111111111111121( ~RouterID, ~ServerID, ~ak_h, ~ak_sk,
                                 ~ssk_nms, a_h, obj_h, obj_sh
   )
   ]

  /* has exactly the trivial AC variant */

rule (modulo E) eventTPMReceiveCommandTPMCertifyobjshobjhah_0_1111111111111111111121[color=#7b4080 process=event TPM_ReceiveCommand( <'TPM2_Certify', obj_sh, obj_h, a_h> );]:
   [
   state_1111111111111111111121( ~RouterID, ~ServerID, ~ak_h, ~ak_sk,
                                 ~ssk_nms, a_h, obj_h, obj_sh
   )
   ]
  --[ TPM_ReceiveCommand( <'TPM2_Certify', obj_sh, obj_h, a_h> ) ]->
   [
   state_11111111111111111111211( ~RouterID, ~ServerID, ~ak_h, ~ak_sk,
                                  ~ssk_nms, a_h, obj_h, obj_sh
   )
   ]

  /* has exactly the trivial AC variant */

rule (modulo E) lockdevice_0_11111111111111111111211[color=#7b4080 process=lock 'device';]:
   [
   state_11111111111111111111211( ~RouterID, ~ServerID, ~ak_h, ~ak_sk,
                                  ~ssk_nms, a_h, obj_h, obj_sh
   ),
   Fr( lock.4 )
   ]
  --[ Lock_4( '4', lock.4, 'device' ), Lock( '4', lock.4, 'device' ) ]->
   [
   state_111111111111111111112111( ~RouterID, ~ServerID, ~ak_h, ~ak_sk,
                                   ~ssk_nms, a_h, obj_h, obj_sh, lock.4
   )
   ]

  /*
  rule (modulo AC) lockdevice_0_11111111111111111111211[color=#7b4080 process=lock 'device';]:
     [
     state_11111111111111111111211( ~RouterID, ~ServerID, ~ak_h, ~ak_sk,
                                    ~ssk_nms, a_h, obj_h, obj_sh
     ),
     Fr( lock )
     ]
    --[ Lock_4( '4', lock, 'device' ), Lock( '4', lock, 'device' ) ]->
     [
     state_111111111111111111112111( ~RouterID, ~ServerID, ~ak_h, ~ak_sk,
                                     ~ssk_nms, a_h, obj_h, obj_sh, lock
     )
     ]
  */

rule (modulo E) lookuppolicyDigestobjshasobjpd_0_111111111111111111112111[color=#7b4080 process=lookup <'policyDigest', obj_sh> as obj_pd]:
   [
   state_111111111111111111112111( ~RouterID, ~ServerID, ~ak_h, ~ak_sk,
                                   ~ssk_nms, a_h, obj_h, obj_sh, lock.4
   )
   ]
  --[ IsIn( <'policyDigest', obj_sh>, obj_pd ) ]->
   [
   state_1111111111111111111121111( ~RouterID, ~ServerID, ~ak_h, ~ak_sk,
                                    ~ssk_nms, a_h, obj_h, obj_pd, obj_sh, lock.4
   )
   ]

  /*
  rule (modulo AC) lookuppolicyDigestobjshasobjpd_0_111111111111111111112111[color=#7b4080 process=lookup <'policyDigest', obj_sh> as obj_pd]:
     [
     state_111111111111111111112111( ~RouterID, ~ServerID, ~ak_h, ~ak_sk,
                                     ~ssk_nms, a_h, obj_h, obj_sh, lock
     )
     ]
    --[ IsIn( <'policyDigest', obj_sh>, obj_pd ) ]->
     [
     state_1111111111111111111121111( ~RouterID, ~ServerID, ~ak_h, ~ak_sk,
                                      ~ssk_nms, a_h, obj_h, obj_pd, obj_sh, lock
     )
     ]
  */

rule (modulo E) lookuppolicyDigestobjshasobjpd_1_111111111111111111112111[color=#7b4080 process=lookup <'policyDigest', obj_sh> as obj_pd]:
   [
   state_111111111111111111112111( ~RouterID, ~ServerID, ~ak_h, ~ak_sk,
                                   ~ssk_nms, a_h, obj_h, obj_sh, lock.4
   )
   ]
  --[ IsNotSet( <'policyDigest', obj_sh> ) ]->
   [
   state_1111111111111111111121112( ~RouterID, ~ServerID, ~ak_h, ~ak_sk,
                                    ~ssk_nms, a_h, obj_h, obj_sh, lock.4
   )
   ]

  /*
  rule (modulo AC) lookuppolicyDigestobjshasobjpd_1_111111111111111111112111[color=#7b4080 process=lookup <'policyDigest', obj_sh> as obj_pd]:
     [
     state_111111111111111111112111( ~RouterID, ~ServerID, ~ak_h, ~ak_sk,
                                     ~ssk_nms, a_h, obj_h, obj_sh, lock
     )
     ]
    --[ IsNotSet( <'policyDigest', obj_sh> ) ]->
     [
     state_1111111111111111111121112( ~RouterID, ~ServerID, ~ak_h, ~ak_sk,
                                      ~ssk_nms, a_h, obj_h, obj_sh, lock
     )
     ]
  */

rule (modulo E) lookupauthPolicyobjhasobjap_0_1111111111111111111121111[color=#7b4080 process=lookup <'authPolicy', obj_h> as obj_ap]:
   [
   state_1111111111111111111121111( ~RouterID, ~ServerID, ~ak_h, ~ak_sk,
                                    ~ssk_nms, a_h, obj_h, obj_pd, obj_sh, lock.4
   )
   ]
  --[ IsIn( <'authPolicy', obj_h>, obj_ap ) ]->
   [
   state_11111111111111111111211111( ~RouterID, ~ServerID, ~ak_h, ~ak_sk,
                                     ~ssk_nms, a_h, obj_ap, obj_h, obj_pd, obj_sh, lock.4
   )
   ]

  /*
  rule (modulo AC) lookupauthPolicyobjhasobjap_0_1111111111111111111121111[color=#7b4080 process=lookup <'authPolicy', obj_h> as obj_ap]:
     [
     state_1111111111111111111121111( ~RouterID, ~ServerID, ~ak_h, ~ak_sk,
                                      ~ssk_nms, a_h, obj_h, obj_pd, obj_sh, lock
     )
     ]
    --[ IsIn( <'authPolicy', obj_h>, obj_ap ) ]->
     [
     state_11111111111111111111211111( ~RouterID, ~ServerID, ~ak_h, ~ak_sk,
                                       ~ssk_nms, a_h, obj_ap, obj_h, obj_pd, obj_sh, lock
     )
     ]
  */

rule (modulo E) lookupauthPolicyobjhasobjap_1_1111111111111111111121111[color=#7b4080 process=lookup <'authPolicy', obj_h> as obj_ap]:
   [
   state_1111111111111111111121111( ~RouterID, ~ServerID, ~ak_h, ~ak_sk,
                                    ~ssk_nms, a_h, obj_h, obj_pd, obj_sh, lock.4
   )
   ]
  --[ IsNotSet( <'authPolicy', obj_h> ) ]->
   [
   state_11111111111111111111211112( ~RouterID, ~ServerID, ~ak_h, ~ak_sk,
                                     ~ssk_nms, a_h, obj_h, obj_pd, obj_sh, lock.4
   )
   ]

  /*
  rule (modulo AC) lookupauthPolicyobjhasobjap_1_1111111111111111111121111[color=#7b4080 process=lookup <'authPolicy', obj_h> as obj_ap]:
     [
     state_1111111111111111111121111( ~RouterID, ~ServerID, ~ak_h, ~ak_sk,
                                      ~ssk_nms, a_h, obj_h, obj_pd, obj_sh, lock
     )
     ]
    --[ IsNotSet( <'authPolicy', obj_h> ) ]->
     [
     state_11111111111111111111211112( ~RouterID, ~ServerID, ~ak_h, ~ak_sk,
                                       ~ssk_nms, a_h, obj_h, obj_pd, obj_sh, lock
     )
     ]
  */

rule (modulo E) ifobjpdobjap_0_11111111111111111111211111[color=#7b4080 process=if obj_pd=obj_ap]:
   [
   state_11111111111111111111211111( ~RouterID, ~ServerID, ~ak_h, ~ak_sk,
                                     ~ssk_nms, a_h, obj_ap, obj_h, obj_pd, obj_sh, lock.4
   )
   ]
  --[ Pred_Eq( obj_pd, obj_ap ) ]->
   [
   state_111111111111111111112111111( ~RouterID, ~ServerID, ~ak_h, ~ak_sk,
                                      ~ssk_nms, a_h, obj_ap, obj_h, obj_pd, obj_sh, lock.4
   )
   ]

  /*
  rule (modulo AC) ifobjpdobjap_0_11111111111111111111211111[color=#7b4080 process=if obj_pd=obj_ap]:
     [
     state_11111111111111111111211111( ~RouterID, ~ServerID, ~ak_h, ~ak_sk,
                                       ~ssk_nms, a_h, obj_ap, obj_h, obj_pd, obj_sh, lock
     )
     ]
    --[ Pred_Eq( obj_pd, obj_ap ) ]->
     [
     state_111111111111111111112111111( ~RouterID, ~ServerID, ~ak_h, ~ak_sk,
                                        ~ssk_nms, a_h, obj_ap, obj_h, obj_pd, obj_sh, lock
     )
     ]
  */

rule (modulo E) ifobjpdobjap_1_11111111111111111111211111[color=#7b4080 process=if obj_pd=obj_ap]:
   [
   state_11111111111111111111211111( ~RouterID, ~ServerID, ~ak_h, ~ak_sk,
                                     ~ssk_nms, a_h, obj_ap, obj_h, obj_pd, obj_sh, lock.4
   )
   ]
  --[ Pred_Not_Eq( obj_pd, obj_ap ) ]->
   [
   state_111111111111111111112111112( ~RouterID, ~ServerID, ~ak_h, ~ak_sk,
                                      ~ssk_nms, a_h, obj_ap, obj_h, obj_pd, obj_sh, lock.4
   )
   ]

  /*
  rule (modulo AC) ifobjpdobjap_1_11111111111111111111211111[color=#7b4080 process=if obj_pd=obj_ap]:
     [
     state_11111111111111111111211111( ~RouterID, ~ServerID, ~ak_h, ~ak_sk,
                                       ~ssk_nms, a_h, obj_ap, obj_h, obj_pd, obj_sh, lock
     )
     ]
    --[ Pred_Not_Eq( obj_pd, obj_ap ) ]->
     [
     state_111111111111111111112111112( ~RouterID, ~ServerID, ~ak_h, ~ak_sk,
                                        ~ssk_nms, a_h, obj_ap, obj_h, obj_pd, obj_sh, lock
     )
     ]
  */

rule (modulo E) lookuppublicPartobjhasobjpk_0_111111111111111111112111111[color=#7b4080 process=lookup <'publicPart', obj_h> as obj_pk]:
   [
   state_111111111111111111112111111( ~RouterID, ~ServerID, ~ak_h, ~ak_sk,
                                      ~ssk_nms, a_h, obj_ap, obj_h, obj_pd, obj_sh, lock.4
   )
   ]
  --[ IsIn( <'publicPart', obj_h>, obj_pk ) ]->
   [
   state_1111111111111111111121111111( ~RouterID, ~ServerID, ~ak_h, ~ak_sk,
                                       ~ssk_nms, a_h, obj_ap, obj_h, obj_pd, obj_pk, obj_sh, lock.4
   )
   ]

  /*
  rule (modulo AC) lookuppublicPartobjhasobjpk_0_111111111111111111112111111[color=#7b4080 process=lookup <'publicPart', obj_h> as obj_pk]:
     [
     state_111111111111111111112111111( ~RouterID, ~ServerID, ~ak_h, ~ak_sk,
                                        ~ssk_nms, a_h, obj_ap, obj_h, obj_pd, obj_sh, lock
     )
     ]
    --[ IsIn( <'publicPart', obj_h>, obj_pk ) ]->
     [
     state_1111111111111111111121111111( ~RouterID, ~ServerID, ~ak_h, ~ak_sk,
                                         ~ssk_nms, a_h, obj_ap, obj_h, obj_pd, obj_pk, obj_sh, lock
     )
     ]
  */

rule (modulo E) lookuppublicPartobjhasobjpk_1_111111111111111111112111111[color=#7b4080 process=lookup <'publicPart', obj_h> as obj_pk]:
   [
   state_111111111111111111112111111( ~RouterID, ~ServerID, ~ak_h, ~ak_sk,
                                      ~ssk_nms, a_h, obj_ap, obj_h, obj_pd, obj_sh, lock.4
   )
   ]
  --[ IsNotSet( <'publicPart', obj_h> ) ]->
   [
   state_1111111111111111111121111112( ~RouterID, ~ServerID, ~ak_h, ~ak_sk,
                                       ~ssk_nms, a_h, obj_ap, obj_h, obj_pd, obj_sh, lock.4
   )
   ]

  /*
  rule (modulo AC) lookuppublicPartobjhasobjpk_1_111111111111111111112111111[color=#7b4080 process=lookup <'publicPart', obj_h> as obj_pk]:
     [
     state_111111111111111111112111111( ~RouterID, ~ServerID, ~ak_h, ~ak_sk,
                                        ~ssk_nms, a_h, obj_ap, obj_h, obj_pd, obj_sh, lock
     )
     ]
    --[ IsNotSet( <'publicPart', obj_h> ) ]->
     [
     state_1111111111111111111121111112( ~RouterID, ~ServerID, ~ak_h, ~ak_sk,
                                         ~ssk_nms, a_h, obj_ap, obj_h, obj_pd, obj_sh, lock
     )
     ]
  */

rule (modulo E) lookupprivatePartahasask_0_1111111111111111111121111111[color=#7b4080 process=lookup <'privatePart', a_h> as a_sk]:
   [
   state_1111111111111111111121111111( ~RouterID, ~ServerID, ~ak_h, ~ak_sk,
                                       ~ssk_nms, a_h, obj_ap, obj_h, obj_pd, obj_pk, obj_sh, lock.4
   )
   ]
  --[ IsIn( <'privatePart', a_h>, a_sk ) ]->
   [
   state_11111111111111111111211111111( ~RouterID, ~ServerID, ~ak_h, ~ak_sk,
                                        ~ssk_nms, a_h, a_sk, obj_ap, obj_h, obj_pd, obj_pk, obj_sh, lock.4
   )
   ]

  /*
  rule (modulo AC) lookupprivatePartahasask_0_1111111111111111111121111111[color=#7b4080 process=lookup <'privatePart', a_h> as a_sk]:
     [
     state_1111111111111111111121111111( ~RouterID, ~ServerID, ~ak_h, ~ak_sk,
                                         ~ssk_nms, a_h, obj_ap, obj_h, obj_pd, obj_pk, obj_sh, lock
     )
     ]
    --[ IsIn( <'privatePart', a_h>, a_sk ) ]->
     [
     state_11111111111111111111211111111( ~RouterID, ~ServerID, ~ak_h, ~ak_sk,
                                          ~ssk_nms, a_h, a_sk, obj_ap, obj_h, obj_pd, obj_pk, obj_sh, lock
     )
     ]
  */

rule (modulo E) lookupprivatePartahasask_1_1111111111111111111121111111[color=#7b4080 process=lookup <'privatePart', a_h> as a_sk]:
   [
   state_1111111111111111111121111111( ~RouterID, ~ServerID, ~ak_h, ~ak_sk,
                                       ~ssk_nms, a_h, obj_ap, obj_h, obj_pd, obj_pk, obj_sh, lock.4
   )
   ]
  --[ IsNotSet( <'privatePart', a_h> ) ]->
   [
   state_11111111111111111111211111112( ~RouterID, ~ServerID, ~ak_h, ~ak_sk,
                                        ~ssk_nms, a_h, obj_ap, obj_h, obj_pd, obj_pk, obj_sh, lock.4
   )
   ]

  /*
  rule (modulo AC) lookupprivatePartahasask_1_1111111111111111111121111111[color=#7b4080 process=lookup <'privatePart', a_h> as a_sk]:
     [
     state_1111111111111111111121111111( ~RouterID, ~ServerID, ~ak_h, ~ak_sk,
                                         ~ssk_nms, a_h, obj_ap, obj_h, obj_pd, obj_pk, obj_sh, lock
     )
     ]
    --[ IsNotSet( <'privatePart', a_h> ) ]->
     [
     state_11111111111111111111211111112( ~RouterID, ~ServerID, ~ak_h, ~ak_sk,
                                          ~ssk_nms, a_h, obj_ap, obj_h, obj_pd, obj_pk, obj_sh, lock
     )
     ]
  */

rule (modulo E) outsignobjpkobjapask_0_11111111111111111111211111111[color=#7b4080 process=out(sign(<obj_pk, obj_ap>, a_sk));]:
   [
   state_11111111111111111111211111111( ~RouterID, ~ServerID, ~ak_h, ~ak_sk,
                                        ~ssk_nms, a_h, a_sk, obj_ap, obj_h, obj_pd, obj_pk, obj_sh, lock.4
   )
   ]
  -->
   [
   state_111111111111111111112111111111( ~RouterID, ~ServerID, ~ak_h,
                                         ~ak_sk, ~ssk_nms, a_h, a_sk, obj_ap, obj_h, obj_pd, obj_pk, obj_sh,
                                         lock.4
   ),
   Out( sign(<obj_pk, obj_ap>, a_sk) )
   ]

  /*
  rule (modulo AC) outsignobjpkobjapask_0_11111111111111111111211111111[color=#7b4080 process=out(sign(<obj_pk, obj_ap>, a_sk));]:
     [
     state_11111111111111111111211111111( ~RouterID, ~ServerID, ~ak_h, ~ak_sk,
                                          ~ssk_nms, a_h, a_sk, obj_ap, obj_h, obj_pd, obj_pk, obj_sh, lock
     )
     ]
    -->
     [
     state_111111111111111111112111111111( ~RouterID, ~ServerID, ~ak_h,
                                           ~ak_sk, ~ssk_nms, a_h, a_sk, obj_ap, obj_h, obj_pd, obj_pk, obj_sh,
                                           lock
     ),
     Out( sign(<obj_pk, obj_ap>, a_sk) )
     ]
  */

rule (modulo E) unlockdevice_0_111111111111111111112111111111[color=#7b4080 process=unlock 'device';]:
   [
   state_111111111111111111112111111111( ~RouterID, ~ServerID, ~ak_h,
                                         ~ak_sk, ~ssk_nms, a_h, a_sk, obj_ap, obj_h, obj_pd, obj_pk, obj_sh,
                                         lock.4
   )
   ]
  --[ Unlock_4( '4', lock.4, 'device' ), Unlock( '4', lock.4, 'device' )
  ]->
   [
   state_1111111111111111111121111111111( ~RouterID, ~ServerID, ~ak_h,
                                          ~ak_sk, ~ssk_nms, a_h, a_sk, obj_ap, obj_h, obj_pd, obj_pk, obj_sh,
                                          lock.4
   )
   ]

  /*
  rule (modulo AC) unlockdevice_0_111111111111111111112111111111[color=#7b4080 process=unlock 'device';]:
     [
     state_111111111111111111112111111111( ~RouterID, ~ServerID, ~ak_h,
                                           ~ak_sk, ~ssk_nms, a_h, a_sk, obj_ap, obj_h, obj_pd, obj_pk, obj_sh,
                                           lock
     )
     ]
    --[ Unlock_4( '4', lock, 'device' ), Unlock( '4', lock, 'device' ) ]->
     [
     state_1111111111111111111121111111111( ~RouterID, ~ServerID, ~ak_h,
                                            ~ak_sk, ~ssk_nms, a_h, a_sk, obj_ap, obj_h, obj_pd, obj_pk,
                                            obj_sh, lock
     )
     ]
  */

rule (modulo E) __0_1111111111111111111121111111111[color=#7b4080 process=0]:
   [
   state_1111111111111111111121111111111( ~RouterID, ~ServerID, ~ak_h,
                                          ~ak_sk, ~ssk_nms, a_h, a_sk, obj_ap, obj_h, obj_pd, obj_pk, obj_sh,
                                          lock.4
   )
   ]
  -->
   [ ]

  /*
  rule (modulo AC) __0_1111111111111111111121111111111[color=#7b4080 process=0]:
     [
     state_1111111111111111111121111111111( ~RouterID, ~ServerID, ~ak_h,
                                            ~ak_sk, ~ssk_nms, a_h, a_sk, obj_ap, obj_h, obj_pd, obj_pk,
                                            obj_sh, lock
     )
     ]
    -->
     [ ]
  */

rule (modulo E) unlockdevice_0_11111111111111111111211111112[color=#7b4080 process=unlock 'device';]:
   [
   state_11111111111111111111211111112( ~RouterID, ~ServerID, ~ak_h, ~ak_sk,
                                        ~ssk_nms, a_h, obj_ap, obj_h, obj_pd, obj_pk, obj_sh, lock.4
   )
   ]
  --[ Unlock_4( '4', lock.4, 'device' ), Unlock( '4', lock.4, 'device' )
  ]->
   [
   state_111111111111111111112111111121( ~RouterID, ~ServerID, ~ak_h,
                                         ~ak_sk, ~ssk_nms, a_h, obj_ap, obj_h, obj_pd, obj_pk, obj_sh, lock.4
   )
   ]

  /*
  rule (modulo AC) unlockdevice_0_11111111111111111111211111112[color=#7b4080 process=unlock 'device';]:
     [
     state_11111111111111111111211111112( ~RouterID, ~ServerID, ~ak_h, ~ak_sk,
                                          ~ssk_nms, a_h, obj_ap, obj_h, obj_pd, obj_pk, obj_sh, lock
     )
     ]
    --[ Unlock_4( '4', lock, 'device' ), Unlock( '4', lock, 'device' ) ]->
     [
     state_111111111111111111112111111121( ~RouterID, ~ServerID, ~ak_h,
                                           ~ak_sk, ~ssk_nms, a_h, obj_ap, obj_h, obj_pd, obj_pk, obj_sh, lock
     )
     ]
  */

rule (modulo E) __0_111111111111111111112111111121[color=#7b4080 process=0]:
   [
   state_111111111111111111112111111121( ~RouterID, ~ServerID, ~ak_h,
                                         ~ak_sk, ~ssk_nms, a_h, obj_ap, obj_h, obj_pd, obj_pk, obj_sh, lock.4
   )
   ]
  -->
   [ ]

  /*
  rule (modulo AC) __0_111111111111111111112111111121[color=#7b4080 process=0]:
     [
     state_111111111111111111112111111121( ~RouterID, ~ServerID, ~ak_h,
                                           ~ak_sk, ~ssk_nms, a_h, obj_ap, obj_h, obj_pd, obj_pk, obj_sh, lock
     )
     ]
    -->
     [ ]
  */

rule (modulo E) __0_1111111111111111111121111112[color=#7b4080 process=0]:
   [
   state_1111111111111111111121111112( ~RouterID, ~ServerID, ~ak_h, ~ak_sk,
                                       ~ssk_nms, a_h, obj_ap, obj_h, obj_pd, obj_sh, lock.4
   )
   ]
  -->
   [ ]

  /*
  rule (modulo AC) __0_1111111111111111111121111112[color=#7b4080 process=0]:
     [
     state_1111111111111111111121111112( ~RouterID, ~ServerID, ~ak_h, ~ak_sk,
                                         ~ssk_nms, a_h, obj_ap, obj_h, obj_pd, obj_sh, lock
     )
     ]
    -->
     [ ]
  */

rule (modulo E) __0_111111111111111111112111112[color=#7b4080 process=0]:
   [
   state_111111111111111111112111112( ~RouterID, ~ServerID, ~ak_h, ~ak_sk,
                                      ~ssk_nms, a_h, obj_ap, obj_h, obj_pd, obj_sh, lock.4
   )
   ]
  -->
   [ ]

  /*
  rule (modulo AC) __0_111111111111111111112111112[color=#7b4080 process=0]:
     [
     state_111111111111111111112111112( ~RouterID, ~ServerID, ~ak_h, ~ak_sk,
                                        ~ssk_nms, a_h, obj_ap, obj_h, obj_pd, obj_sh, lock
     )
     ]
    -->
     [ ]
  */

rule (modulo E) __0_11111111111111111111211112[color=#7b4080 process=0]:
   [
   state_11111111111111111111211112( ~RouterID, ~ServerID, ~ak_h, ~ak_sk,
                                     ~ssk_nms, a_h, obj_h, obj_pd, obj_sh, lock.4
   )
   ]
  -->
   [ ]

  /*
  rule (modulo AC) __0_11111111111111111111211112[color=#7b4080 process=0]:
     [
     state_11111111111111111111211112( ~RouterID, ~ServerID, ~ak_h, ~ak_sk,
                                       ~ssk_nms, a_h, obj_h, obj_pd, obj_sh, lock
     )
     ]
    -->
     [ ]
  */

rule (modulo E) __0_1111111111111111111121112[color=#7b4080 process=0]:
   [
   state_1111111111111111111121112( ~RouterID, ~ServerID, ~ak_h, ~ak_sk,
                                    ~ssk_nms, a_h, obj_h, obj_sh, lock.4
   )
   ]
  -->
   [ ]

  /*
  rule (modulo AC) __0_1111111111111111111121112[color=#7b4080 process=0]:
     [
     state_1111111111111111111121112( ~RouterID, ~ServerID, ~ak_h, ~ak_sk,
                                      ~ssk_nms, a_h, obj_h, obj_sh, lock
     )
     ]
    -->
     [ ]
  */

rule (modulo E) inTPMSignkshkhm_0_11111111111111111112[color=#7b4080 process=in(<'TPM2_Sign', k_sh, k_h, m>);]:
   [
   state_11111111111111111112( ~RouterID, ~ServerID, ~ak_h, ~ak_sk, ~ssk_nms
   ),
   In( <'TPM2_Sign', k_sh, k_h, m> )
   ]
  -->
   [
   state_111111111111111111121( ~RouterID, ~ServerID, ~ak_h, ~ak_sk,
                                ~ssk_nms, k_h, k_sh, m
   )
   ]

  /* has exactly the trivial AC variant */

rule (modulo E) eventTPMReceiveCommandTPMSignkshkhm_0_111111111111111111121[color=#7b4080 process=event TPM_ReceiveCommand( <'TPM2_Sign', k_sh, k_h, m> );]:
   [
   state_111111111111111111121( ~RouterID, ~ServerID, ~ak_h, ~ak_sk,
                                ~ssk_nms, k_h, k_sh, m
   )
   ]
  --[ TPM_ReceiveCommand( <'TPM2_Sign', k_sh, k_h, m> ) ]->
   [
   state_1111111111111111111211( ~RouterID, ~ServerID, ~ak_h, ~ak_sk,
                                 ~ssk_nms, k_h, k_sh, m
   )
   ]

  /* has exactly the trivial AC variant */

rule (modulo E) lockdevice_0_1111111111111111111211[color=#7b4080 process=lock 'device';]:
   [
   state_1111111111111111111211( ~RouterID, ~ServerID, ~ak_h, ~ak_sk,
                                 ~ssk_nms, k_h, k_sh, m
   ),
   Fr( lock.5 )
   ]
  --[ Lock_5( '5', lock.5, 'device' ), Lock( '5', lock.5, 'device' ) ]->
   [
   state_11111111111111111112111( ~RouterID, ~ServerID, ~ak_h, ~ak_sk,
                                  ~ssk_nms, k_h, k_sh, m, lock.5
   )
   ]

  /*
  rule (modulo AC) lockdevice_0_1111111111111111111211[color=#7b4080 process=lock 'device';]:
     [
     state_1111111111111111111211( ~RouterID, ~ServerID, ~ak_h, ~ak_sk,
                                   ~ssk_nms, k_h, k_sh, m
     ),
     Fr( lock )
     ]
    --[ Lock_5( '5', lock, 'device' ), Lock( '5', lock, 'device' ) ]->
     [
     state_11111111111111111112111( ~RouterID, ~ServerID, ~ak_h, ~ak_sk,
                                    ~ssk_nms, k_h, k_sh, m, lock
     )
     ]
  */

rule (modulo E) lookuppolicyDigestkshaskpd_0_11111111111111111112111[color=#7b4080 process=lookup <'policyDigest', k_sh> as k_pd]:
   [
   state_11111111111111111112111( ~RouterID, ~ServerID, ~ak_h, ~ak_sk,
                                  ~ssk_nms, k_h, k_sh, m, lock.5
   )
   ]
  --[ IsIn( <'policyDigest', k_sh>, k_pd ) ]->
   [
   state_111111111111111111121111( ~RouterID, ~ServerID, ~ak_h, ~ak_sk,
                                   ~ssk_nms, k_h, k_pd, k_sh, m, lock.5
   )
   ]

  /*
  rule (modulo AC) lookuppolicyDigestkshaskpd_0_11111111111111111112111[color=#7b4080 process=lookup <'policyDigest', k_sh> as k_pd]:
     [
     state_11111111111111111112111( ~RouterID, ~ServerID, ~ak_h, ~ak_sk,
                                    ~ssk_nms, k_h, k_sh, m, lock
     )
     ]
    --[ IsIn( <'policyDigest', k_sh>, k_pd ) ]->
     [
     state_111111111111111111121111( ~RouterID, ~ServerID, ~ak_h, ~ak_sk,
                                     ~ssk_nms, k_h, k_pd, k_sh, m, lock
     )
     ]
  */

rule (modulo E) lookuppolicyDigestkshaskpd_1_11111111111111111112111[color=#7b4080 process=lookup <'policyDigest', k_sh> as k_pd]:
   [
   state_11111111111111111112111( ~RouterID, ~ServerID, ~ak_h, ~ak_sk,
                                  ~ssk_nms, k_h, k_sh, m, lock.5
   )
   ]
  --[ IsNotSet( <'policyDigest', k_sh> ) ]->
   [
   state_111111111111111111121112( ~RouterID, ~ServerID, ~ak_h, ~ak_sk,
                                   ~ssk_nms, k_h, k_sh, m, lock.5
   )
   ]

  /*
  rule (modulo AC) lookuppolicyDigestkshaskpd_1_11111111111111111112111[color=#7b4080 process=lookup <'policyDigest', k_sh> as k_pd]:
     [
     state_11111111111111111112111( ~RouterID, ~ServerID, ~ak_h, ~ak_sk,
                                    ~ssk_nms, k_h, k_sh, m, lock
     )
     ]
    --[ IsNotSet( <'policyDigest', k_sh> ) ]->
     [
     state_111111111111111111121112( ~RouterID, ~ServerID, ~ak_h, ~ak_sk,
                                     ~ssk_nms, k_h, k_sh, m, lock
     )
     ]
  */

rule (modulo E) lookupauthPolicykhaskap_0_111111111111111111121111[color=#7b4080 process=lookup <'authPolicy', k_h> as k_ap]:
   [
   state_111111111111111111121111( ~RouterID, ~ServerID, ~ak_h, ~ak_sk,
                                   ~ssk_nms, k_h, k_pd, k_sh, m, lock.5
   )
   ]
  --[ IsIn( <'authPolicy', k_h>, k_ap ) ]->
   [
   state_1111111111111111111211111( ~RouterID, ~ServerID, ~ak_h, ~ak_sk,
                                    ~ssk_nms, k_ap, k_h, k_pd, k_sh, m, lock.5
   )
   ]

  /*
  rule (modulo AC) lookupauthPolicykhaskap_0_111111111111111111121111[color=#7b4080 process=lookup <'authPolicy', k_h> as k_ap]:
     [
     state_111111111111111111121111( ~RouterID, ~ServerID, ~ak_h, ~ak_sk,
                                     ~ssk_nms, k_h, k_pd, k_sh, m, lock
     )
     ]
    --[ IsIn( <'authPolicy', k_h>, k_ap ) ]->
     [
     state_1111111111111111111211111( ~RouterID, ~ServerID, ~ak_h, ~ak_sk,
                                      ~ssk_nms, k_ap, k_h, k_pd, k_sh, m, lock
     )
     ]
  */

rule (modulo E) lookupauthPolicykhaskap_1_111111111111111111121111[color=#7b4080 process=lookup <'authPolicy', k_h> as k_ap]:
   [
   state_111111111111111111121111( ~RouterID, ~ServerID, ~ak_h, ~ak_sk,
                                   ~ssk_nms, k_h, k_pd, k_sh, m, lock.5
   )
   ]
  --[ IsNotSet( <'authPolicy', k_h> ) ]->
   [
   state_1111111111111111111211112( ~RouterID, ~ServerID, ~ak_h, ~ak_sk,
                                    ~ssk_nms, k_h, k_pd, k_sh, m, lock.5
   )
   ]

  /*
  rule (modulo AC) lookupauthPolicykhaskap_1_111111111111111111121111[color=#7b4080 process=lookup <'authPolicy', k_h> as k_ap]:
     [
     state_111111111111111111121111( ~RouterID, ~ServerID, ~ak_h, ~ak_sk,
                                     ~ssk_nms, k_h, k_pd, k_sh, m, lock
     )
     ]
    --[ IsNotSet( <'authPolicy', k_h> ) ]->
     [
     state_1111111111111111111211112( ~RouterID, ~ServerID, ~ak_h, ~ak_sk,
                                      ~ssk_nms, k_h, k_pd, k_sh, m, lock
     )
     ]
  */

rule (modulo E) ifkpdkap_0_1111111111111111111211111[color=#7b4080 process=if k_pd=k_ap]:
   [
   state_1111111111111111111211111( ~RouterID, ~ServerID, ~ak_h, ~ak_sk,
                                    ~ssk_nms, k_ap, k_h, k_pd, k_sh, m, lock.5
   )
   ]
  --[ Pred_Eq( k_pd, k_ap ) ]->
   [
   state_11111111111111111112111111( ~RouterID, ~ServerID, ~ak_h, ~ak_sk,
                                     ~ssk_nms, k_ap, k_h, k_pd, k_sh, m, lock.5
   )
   ]

  /*
  rule (modulo AC) ifkpdkap_0_1111111111111111111211111[color=#7b4080 process=if k_pd=k_ap]:
     [
     state_1111111111111111111211111( ~RouterID, ~ServerID, ~ak_h, ~ak_sk,
                                      ~ssk_nms, k_ap, k_h, k_pd, k_sh, m, lock
     )
     ]
    --[ Pred_Eq( k_pd, k_ap ) ]->
     [
     state_11111111111111111112111111( ~RouterID, ~ServerID, ~ak_h, ~ak_sk,
                                       ~ssk_nms, k_ap, k_h, k_pd, k_sh, m, lock
     )
     ]
  */

rule (modulo E) ifkpdkap_1_1111111111111111111211111[color=#7b4080 process=if k_pd=k_ap]:
   [
   state_1111111111111111111211111( ~RouterID, ~ServerID, ~ak_h, ~ak_sk,
                                    ~ssk_nms, k_ap, k_h, k_pd, k_sh, m, lock.5
   )
   ]
  --[ Pred_Not_Eq( k_pd, k_ap ) ]->
   [
   state_11111111111111111112111112( ~RouterID, ~ServerID, ~ak_h, ~ak_sk,
                                     ~ssk_nms, k_ap, k_h, k_pd, k_sh, m, lock.5
   )
   ]

  /*
  rule (modulo AC) ifkpdkap_1_1111111111111111111211111[color=#7b4080 process=if k_pd=k_ap]:
     [
     state_1111111111111111111211111( ~RouterID, ~ServerID, ~ak_h, ~ak_sk,
                                      ~ssk_nms, k_ap, k_h, k_pd, k_sh, m, lock
     )
     ]
    --[ Pred_Not_Eq( k_pd, k_ap ) ]->
     [
     state_11111111111111111112111112( ~RouterID, ~ServerID, ~ak_h, ~ak_sk,
                                       ~ssk_nms, k_ap, k_h, k_pd, k_sh, m, lock
     )
     ]
  */

rule (modulo E) lookupprivatePartkhasksk_0_11111111111111111112111111[color=#7b4080 process=lookup <'privatePart', k_h> as k_sk]:
   [
   state_11111111111111111112111111( ~RouterID, ~ServerID, ~ak_h, ~ak_sk,
                                     ~ssk_nms, k_ap, k_h, k_pd, k_sh, m, lock.5
   )
   ]
  --[ IsIn( <'privatePart', k_h>, k_sk ) ]->
   [
   state_111111111111111111121111111( ~RouterID, ~ServerID, ~ak_h, ~ak_sk,
                                      ~ssk_nms, k_ap, k_h, k_pd, k_sh, k_sk, m, lock.5
   )
   ]

  /*
  rule (modulo AC) lookupprivatePartkhasksk_0_11111111111111111112111111[color=#7b4080 process=lookup <'privatePart', k_h> as k_sk]:
     [
     state_11111111111111111112111111( ~RouterID, ~ServerID, ~ak_h, ~ak_sk,
                                       ~ssk_nms, k_ap, k_h, k_pd, k_sh, m, lock
     )
     ]
    --[ IsIn( <'privatePart', k_h>, k_sk ) ]->
     [
     state_111111111111111111121111111( ~RouterID, ~ServerID, ~ak_h, ~ak_sk,
                                        ~ssk_nms, k_ap, k_h, k_pd, k_sh, k_sk, m, lock
     )
     ]
  */

rule (modulo E) lookupprivatePartkhasksk_1_11111111111111111112111111[color=#7b4080 process=lookup <'privatePart', k_h> as k_sk]:
   [
   state_11111111111111111112111111( ~RouterID, ~ServerID, ~ak_h, ~ak_sk,
                                     ~ssk_nms, k_ap, k_h, k_pd, k_sh, m, lock.5
   )
   ]
  --[ IsNotSet( <'privatePart', k_h> ) ]->
   [
   state_111111111111111111121111112( ~RouterID, ~ServerID, ~ak_h, ~ak_sk,
                                      ~ssk_nms, k_ap, k_h, k_pd, k_sh, m, lock.5
   )
   ]

  /*
  rule (modulo AC) lookupprivatePartkhasksk_1_11111111111111111112111111[color=#7b4080 process=lookup <'privatePart', k_h> as k_sk]:
     [
     state_11111111111111111112111111( ~RouterID, ~ServerID, ~ak_h, ~ak_sk,
                                       ~ssk_nms, k_ap, k_h, k_pd, k_sh, m, lock
     )
     ]
    --[ IsNotSet( <'privatePart', k_h> ) ]->
     [
     state_111111111111111111121111112( ~RouterID, ~ServerID, ~ak_h, ~ak_sk,
                                        ~ssk_nms, k_ap, k_h, k_pd, k_sh, m, lock
     )
     ]
  */

rule (modulo E) TpmSignOutsignmksk_0_111111111111111111121111111[color=#7b4080 process= [ ] --> [ Tpm2SignOut( sign(m, k_sk) ) ];]:
   [
   state_111111111111111111121111111( ~RouterID, ~ServerID, ~ak_h, ~ak_sk,
                                      ~ssk_nms, k_ap, k_h, k_pd, k_sh, k_sk, m, lock.5
   )
   ]
  -->
   [
   state_1111111111111111111211111111( ~RouterID, ~ServerID, ~ak_h, ~ak_sk,
                                       ~ssk_nms, k_ap, k_h, k_pd, k_sh, k_sk, m, lock.5
   ),
   Tpm2SignOut( sign(m, k_sk) )
   ]

  /*
  rule (modulo AC) TpmSignOutsignmksk_0_111111111111111111121111111[color=#7b4080 process= [ ] --> [ Tpm2SignOut( sign(m, k_sk) ) ];]:
     [
     state_111111111111111111121111111( ~RouterID, ~ServerID, ~ak_h, ~ak_sk,
                                        ~ssk_nms, k_ap, k_h, k_pd, k_sh, k_sk, m, lock
     )
     ]
    -->
     [
     state_1111111111111111111211111111( ~RouterID, ~ServerID, ~ak_h, ~ak_sk,
                                         ~ssk_nms, k_ap, k_h, k_pd, k_sh, k_sk, m, lock
     ),
     Tpm2SignOut( sign(m, k_sk) )
     ]
  */

rule (modulo E) unlockdevice_0_1111111111111111111211111111[color=#7b4080 process=unlock 'device';]:
   [
   state_1111111111111111111211111111( ~RouterID, ~ServerID, ~ak_h, ~ak_sk,
                                       ~ssk_nms, k_ap, k_h, k_pd, k_sh, k_sk, m, lock.5
   )
   ]
  --[ Unlock_5( '5', lock.5, 'device' ), Unlock( '5', lock.5, 'device' )
  ]->
   [
   state_11111111111111111112111111111( ~RouterID, ~ServerID, ~ak_h, ~ak_sk,
                                        ~ssk_nms, k_ap, k_h, k_pd, k_sh, k_sk, m, lock.5
   )
   ]

  /*
  rule (modulo AC) unlockdevice_0_1111111111111111111211111111[color=#7b4080 process=unlock 'device';]:
     [
     state_1111111111111111111211111111( ~RouterID, ~ServerID, ~ak_h, ~ak_sk,
                                         ~ssk_nms, k_ap, k_h, k_pd, k_sh, k_sk, m, lock
     )
     ]
    --[ Unlock_5( '5', lock, 'device' ), Unlock( '5', lock, 'device' ) ]->
     [
     state_11111111111111111112111111111( ~RouterID, ~ServerID, ~ak_h, ~ak_sk,
                                          ~ssk_nms, k_ap, k_h, k_pd, k_sh, k_sk, m, lock
     )
     ]
  */

rule (modulo E) __0_11111111111111111112111111111[color=#7b4080 process=0]:
   [
   state_11111111111111111112111111111( ~RouterID, ~ServerID, ~ak_h, ~ak_sk,
                                        ~ssk_nms, k_ap, k_h, k_pd, k_sh, k_sk, m, lock.5
   )
   ]
  -->
   [ ]

  /*
  rule (modulo AC) __0_11111111111111111112111111111[color=#7b4080 process=0]:
     [
     state_11111111111111111112111111111( ~RouterID, ~ServerID, ~ak_h, ~ak_sk,
                                          ~ssk_nms, k_ap, k_h, k_pd, k_sh, k_sk, m, lock
     )
     ]
    -->
     [ ]
  */

rule (modulo E) unlockdevice_0_111111111111111111121111112[color=#7b4080 process=unlock 'device';]:
   [
   state_111111111111111111121111112( ~RouterID, ~ServerID, ~ak_h, ~ak_sk,
                                      ~ssk_nms, k_ap, k_h, k_pd, k_sh, m, lock.5
   )
   ]
  --[ Unlock_5( '5', lock.5, 'device' ), Unlock( '5', lock.5, 'device' )
  ]->
   [
   state_1111111111111111111211111121( ~RouterID, ~ServerID, ~ak_h, ~ak_sk,
                                       ~ssk_nms, k_ap, k_h, k_pd, k_sh, m, lock.5
   )
   ]

  /*
  rule (modulo AC) unlockdevice_0_111111111111111111121111112[color=#7b4080 process=unlock 'device';]:
     [
     state_111111111111111111121111112( ~RouterID, ~ServerID, ~ak_h, ~ak_sk,
                                        ~ssk_nms, k_ap, k_h, k_pd, k_sh, m, lock
     )
     ]
    --[ Unlock_5( '5', lock, 'device' ), Unlock( '5', lock, 'device' ) ]->
     [
     state_1111111111111111111211111121( ~RouterID, ~ServerID, ~ak_h, ~ak_sk,
                                         ~ssk_nms, k_ap, k_h, k_pd, k_sh, m, lock
     )
     ]
  */

rule (modulo E) __0_1111111111111111111211111121[color=#7b4080 process=0]:
   [
   state_1111111111111111111211111121( ~RouterID, ~ServerID, ~ak_h, ~ak_sk,
                                       ~ssk_nms, k_ap, k_h, k_pd, k_sh, m, lock.5
   )
   ]
  -->
   [ ]

  /*
  rule (modulo AC) __0_1111111111111111111211111121[color=#7b4080 process=0]:
     [
     state_1111111111111111111211111121( ~RouterID, ~ServerID, ~ak_h, ~ak_sk,
                                         ~ssk_nms, k_ap, k_h, k_pd, k_sh, m, lock
     )
     ]
    -->
     [ ]
  */

rule (modulo E) __0_11111111111111111112111112[color=#7b4080 process=0]:
   [
   state_11111111111111111112111112( ~RouterID, ~ServerID, ~ak_h, ~ak_sk,
                                     ~ssk_nms, k_ap, k_h, k_pd, k_sh, m, lock.5
   )
   ]
  -->
   [ ]

  /*
  rule (modulo AC) __0_11111111111111111112111112[color=#7b4080 process=0]:
     [
     state_11111111111111111112111112( ~RouterID, ~ServerID, ~ak_h, ~ak_sk,
                                       ~ssk_nms, k_ap, k_h, k_pd, k_sh, m, lock
     )
     ]
    -->
     [ ]
  */

rule (modulo E) __0_1111111111111111111211112[color=#7b4080 process=0]:
   [
   state_1111111111111111111211112( ~RouterID, ~ServerID, ~ak_h, ~ak_sk,
                                    ~ssk_nms, k_h, k_pd, k_sh, m, lock.5
   )
   ]
  -->
   [ ]

  /*
  rule (modulo AC) __0_1111111111111111111211112[color=#7b4080 process=0]:
     [
     state_1111111111111111111211112( ~RouterID, ~ServerID, ~ak_h, ~ak_sk,
                                      ~ssk_nms, k_h, k_pd, k_sh, m, lock
     )
     ]
    -->
     [ ]
  */

rule (modulo E) __0_111111111111111111121112[color=#7b4080 process=0]:
   [
   state_111111111111111111121112( ~RouterID, ~ServerID, ~ak_h, ~ak_sk,
                                   ~ssk_nms, k_h, k_sh, m, lock.5
   )
   ]
  -->
   [ ]

  /*
  rule (modulo AC) __0_111111111111111111121112[color=#7b4080 process=0]:
     [
     state_111111111111111111121112( ~RouterID, ~ServerID, ~ak_h, ~ak_sk,
                                     ~ssk_nms, k_h, k_sh, m, lock
     )
     ]
    -->
     [ ]
  */

rule (modulo E) newtid_0_11111111111112[color=#454080 process=new ~tid;]:
   [
   state_11111111111112( ~RouterID, ~ServerID, ~ak_h, ~ak_sk, ~ssk_nms ),
   Fr( ~tid )
   ]
  -->
   [
   state_111111111111121( ~RouterID, ~ServerID, ~ak_h, ~ak_sk, ~ssk_nms,
                          ~tid
   )
   ]

  /* has exactly the trivial AC variant */

rule (modulo E) eventTPMSendCommandTPMPCRExtendswstate_0_111111111111121[color=#454080 process=event TPM_SendCommand( <'TPM2_PCR_Extend', swstate> );]:
   [
   state_111111111111121( ~RouterID, ~ServerID, ~ak_h, ~ak_sk, ~ssk_nms,
                          ~tid
   )
   ]
  --[ TPM_SendCommand( <'TPM2_PCR_Extend', swstate> ) ]->
   [
   state_1111111111111211( ~RouterID, ~ServerID, ~ak_h, ~ak_sk, ~ssk_nms,
                           ~tid
   )
   ]

  /* has exactly the trivial AC variant */

rule (modulo E) outTPMPCRExtendswstate_0_1111111111111211[color=#454080 process=out(<'TPM2_PCR_Extend', swstate>);]:
   [
   state_1111111111111211( ~RouterID, ~ServerID, ~ak_h, ~ak_sk, ~ssk_nms,
                           ~tid
   )
   ]
  -->
   [
   state_11111111111112111( ~RouterID, ~ServerID, ~ak_h, ~ak_sk, ~ssk_nms,
                            ~tid
   ),
   Out( <'TPM2_PCR_Extend', swstate> )
   ]

  /* has exactly the trivial AC variant */

rule (modulo E) eventTPMSendCommandTPMCreateswstatenilTPMCCPolicyPCRnil_0_11111111111112111[color=#454080 process=event TPM_SendCommand( <'TPM2_Create', <swstate, nil>, 
                  'TPM_CC_PolicyPCR', nil>
);]:
   [
   state_11111111111112111( ~RouterID, ~ServerID, ~ak_h, ~ak_sk, ~ssk_nms,
                            ~tid
   )
   ]
  --[
  TPM_SendCommand( <'TPM2_Create', <swstate, nil>, 'TPM_CC_PolicyPCR', nil>
  )
  ]->
   [
   state_111111111111121111( ~RouterID, ~ServerID, ~ak_h, ~ak_sk, ~ssk_nms,
                             ~tid
   )
   ]

  /* has exactly the trivial AC variant */

rule (modulo E) outTPMCreateswstatenilTPMCCPolicyPCRnil_0_111111111111121111[color=#454080 process=out(<'TPM2_Create', <swstate, nil>, 'TPM_CC_PolicyPCR', nil>);]:
   [
   state_111111111111121111( ~RouterID, ~ServerID, ~ak_h, ~ak_sk, ~ssk_nms,
                             ~tid
   )
   ]
  -->
   [
   state_1111111111111211111( ~RouterID, ~ServerID, ~ak_h, ~ak_sk, ~ssk_nms,
                              ~tid
   ),
   Out( <'TPM2_Create', <swstate, nil>, 'TPM_CC_PolicyPCR', nil> )
   ]

  /* has exactly the trivial AC variant */

rule (modulo E) TpmCreateOuttlshtlsspk_0_1111111111111211111[color=#454080 process= [ Tpm2CreateOut( <tls_h, tls_spk> ) ] --> [ ];]:
   [
   state_1111111111111211111( ~RouterID, ~ServerID, ~ak_h, ~ak_sk, ~ssk_nms,
                              ~tid
   ),
   Tpm2CreateOut( <tls_h, tls_spk> )
   ]
  -->
   [
   state_11111111111112111111( ~RouterID, ~ServerID, ~ak_h, ~ak_sk,
                               ~ssk_nms, ~tid, tls_h, tls_spk
   )
   ]

  /* has exactly the trivial AC variant */

rule (modulo E) eventHasKeyTLSRouterIDtlsspk_0_11111111111112111111[color=#454080 process=event HasKey( 'TLS', ~RouterID, tls_spk );]:
   [
   state_11111111111112111111( ~RouterID, ~ServerID, ~ak_h, ~ak_sk,
                               ~ssk_nms, ~tid, tls_h, tls_spk
   )
   ]
  --[ HasKey( 'TLS', ~RouterID, tls_spk ) ]->
   [
   state_111111111111121111111( ~RouterID, ~ServerID, ~ak_h, ~ak_sk,
                                ~ssk_nms, ~tid, tls_h, tls_spk
   )
   ]

  /* has exactly the trivial AC variant */

rule (modulo E) eventTPMSendCommandTPMStartAuthSession_0_111111111111121111111[color=#454080 process=event TPM_SendCommand( 'TPM2_StartAuthSession' );]:
   [
   state_111111111111121111111( ~RouterID, ~ServerID, ~ak_h, ~ak_sk,
                                ~ssk_nms, ~tid, tls_h, tls_spk
   )
   ]
  --[ TPM_SendCommand( 'TPM2_StartAuthSession' ) ]->
   [
   state_1111111111111211111111( ~RouterID, ~ServerID, ~ak_h, ~ak_sk,
                                 ~ssk_nms, ~tid, tls_h, tls_spk
   )
   ]

  /* has exactly the trivial AC variant */

rule (modulo E) outTPMStartAuthSession_0_1111111111111211111111[color=#454080 process=out('TPM2_StartAuthSession');]:
   [
   state_1111111111111211111111( ~RouterID, ~ServerID, ~ak_h, ~ak_sk,
                                 ~ssk_nms, ~tid, tls_h, tls_spk
   )
   ]
  -->
   [
   state_11111111111112111111111( ~RouterID, ~ServerID, ~ak_h, ~ak_sk,
                                  ~ssk_nms, ~tid, tls_h, tls_spk
   ),
   Out( 'TPM2_StartAuthSession' )
   ]

  /* has exactly the trivial AC variant */

rule (modulo E) intlssh_0_11111111111112111111111[color=#454080 process=in(tls_sh);]:
   [
   state_11111111111112111111111( ~RouterID, ~ServerID, ~ak_h, ~ak_sk,
                                  ~ssk_nms, ~tid, tls_h, tls_spk
   ),
   In( tls_sh )
   ]
  -->
   [
   state_111111111111121111111111( ~RouterID, ~ServerID, ~ak_h, ~ak_sk,
                                   ~ssk_nms, ~tid, tls_h, tls_sh, tls_spk
   )
   ]

  /* has exactly the trivial AC variant */

rule (modulo E) eventGenerateTLStidtlsspk_0_111111111111121111111111[color=#454080 process=event GenerateTLS( ~tid, tls_spk );]:
   [
   state_111111111111121111111111( ~RouterID, ~ServerID, ~ak_h, ~ak_sk,
                                   ~ssk_nms, ~tid, tls_h, tls_sh, tls_spk
   )
   ]
  --[ GenerateTLS( ~tid, tls_spk ) ]->
   [
   state_1111111111111211111111111( ~RouterID, ~ServerID, ~ak_h, ~ak_sk,
                                    ~ssk_nms, ~tid, tls_h, tls_sh, tls_spk
   )
   ]

  /* has exactly the trivial AC variant */

rule (modulo E) eventTPMSendCommandTPMPolicyPCRtlssh_0_1111111111111211111111111[color=#454080 process=event TPM_SendCommand( <'TPM2_PolicyPCR', tls_sh> );]:
   [
   state_1111111111111211111111111( ~RouterID, ~ServerID, ~ak_h, ~ak_sk,
                                    ~ssk_nms, ~tid, tls_h, tls_sh, tls_spk
   )
   ]
  --[ TPM_SendCommand( <'TPM2_PolicyPCR', tls_sh> ) ]->
   [
   state_11111111111112111111111111( ~RouterID, ~ServerID, ~ak_h, ~ak_sk,
                                     ~ssk_nms, ~tid, tls_h, tls_sh, tls_spk
   )
   ]

  /* has exactly the trivial AC variant */

rule (modulo E) outTPMPolicyPCRtlssh_0_11111111111112111111111111[color=#454080 process=out(<'TPM2_PolicyPCR', tls_sh>);]:
   [
   state_11111111111112111111111111( ~RouterID, ~ServerID, ~ak_h, ~ak_sk,
                                     ~ssk_nms, ~tid, tls_h, tls_sh, tls_spk
   )
   ]
  -->
   [
   state_111111111111121111111111111( ~RouterID, ~ServerID, ~ak_h, ~ak_sk,
                                      ~ssk_nms, ~tid, tls_h, tls_sh, tls_spk
   ),
   Out( <'TPM2_PolicyPCR', tls_sh> )
   ]

  /* has exactly the trivial AC variant */

rule (modulo E) eventTPMSendCommandTPMCertifytlsshtlshakh_0_111111111111121111111111111[color=#454080 process=event TPM_SendCommand( <'TPM2_Certify', tls_sh, tls_h, ~ak_h> );]:
   [
   state_111111111111121111111111111( ~RouterID, ~ServerID, ~ak_h, ~ak_sk,
                                      ~ssk_nms, ~tid, tls_h, tls_sh, tls_spk
   )
   ]
  --[ TPM_SendCommand( <'TPM2_Certify', tls_sh, tls_h, ~ak_h> ) ]->
   [
   state_1111111111111211111111111111( ~RouterID, ~ServerID, ~ak_h, ~ak_sk,
                                       ~ssk_nms, ~tid, tls_h, tls_sh, tls_spk
   )
   ]

  /* has exactly the trivial AC variant */

rule (modulo E) outTPMCertifytlsshtlshakh_0_1111111111111211111111111111[color=#454080 process=out(<'TPM2_Certify', tls_sh, tls_h, ~ak_h>);]:
   [
   state_1111111111111211111111111111( ~RouterID, ~ServerID, ~ak_h, ~ak_sk,
                                       ~ssk_nms, ~tid, tls_h, tls_sh, tls_spk
   )
   ]
  -->
   [
   state_11111111111112111111111111111( ~RouterID, ~ServerID, ~ak_h, ~ak_sk,
                                        ~ssk_nms, ~tid, tls_h, tls_sh, tls_spk
   ),
   Out( <'TPM2_Certify', tls_sh, tls_h, ~ak_h> )
   ]

  /* has exactly the trivial AC variant */

rule (modulo E) inskae_0_11111111111112111111111111111[color=#454080 process=in(skae);]:
   [
   state_11111111111112111111111111111( ~RouterID, ~ServerID, ~ak_h, ~ak_sk,
                                        ~ssk_nms, ~tid, tls_h, tls_sh, tls_spk
   ),
   In( skae )
   ]
  -->
   [
   state_111111111111121111111111111111( ~RouterID, ~ServerID, ~ak_h,
                                         ~ak_sk, ~ssk_nms, ~tid, skae, tls_h, tls_sh, tls_spk
   )
   ]

  /* has exactly the trivial AC variant */

rule (modulo E) eventRouterUseTLStlsspk_0_111111111111121111111111111111[color=#454080 process=event RouterUseTLS( tls_spk );]:
   [
   state_111111111111121111111111111111( ~RouterID, ~ServerID, ~ak_h,
                                         ~ak_sk, ~ssk_nms, ~tid, skae, tls_h, tls_sh, tls_spk
   )
   ]
  --[ RouterUseTLS( tls_spk ) ]->
   [
   state_1111111111111211111111111111111( ~RouterID, ~ServerID, ~ak_h,
                                          ~ak_sk, ~ssk_nms, ~tid, skae, tls_h, tls_sh, tls_spk
   )
   ]

  /* has exactly the trivial AC variant */

rule (modulo E) eventHasKeyAKRouterIDpkaksk_0_1111111111111211111111111111111[color=#454080 process=event HasKey( 'AK', ~RouterID, pk(~ak_sk) );]:
   [
   state_1111111111111211111111111111111( ~RouterID, ~ServerID, ~ak_h,
                                          ~ak_sk, ~ssk_nms, ~tid, skae, tls_h, tls_sh, tls_spk
   )
   ]
  --[ HasKey( 'AK', ~RouterID, pk(~ak_sk) ) ]->
   [
   state_11111111111112111111111111111111( ~RouterID, ~ServerID, ~ak_h,
                                           ~ak_sk, ~ssk_nms, ~tid, skae, tls_h, tls_sh, tls_spk
   )
   ]

  /* has exactly the trivial AC variant */

rule (modulo E) ifverifyskaetlsspkswstatenilTPMCCPolicyPCRnilpkaksktrue_0_11111111111112111111111111111111[color=#454080 process=if verify(skae, <tls_spk, <swstate, nil>, 'TPM_CC_PolicyPCR', nil>,
       pk(~ak_sk))=true]:
   [
   state_11111111111112111111111111111111( ~RouterID, ~ServerID, ~ak_h,
                                           ~ak_sk, ~ssk_nms, ~tid, skae, tls_h, tls_sh, tls_spk
   )
   ]
  --[
  Pred_Eq( verify(skae, <tls_spk, <swstate, nil>, 'TPM_CC_PolicyPCR', nil>,
                  pk(~ak_sk)),
           true
  )
  ]->
   [
   state_111111111111121111111111111111111( ~RouterID, ~ServerID, ~ak_h,
                                            ~ak_sk, ~ssk_nms, ~tid, skae, tls_h, tls_sh, tls_spk
   )
   ]

  /*
  rule (modulo AC) ifverifyskaetlsspkswstatenilTPMCCPolicyPCRnilpkaksktrue_0_11111111111112111111111111111111[color=#454080 process=if verify(skae, <tls_spk, <swstate, nil>, 'TPM_CC_PolicyPCR', nil>,
       pk(~ak_sk))=true]:
     [
     state_11111111111112111111111111111111( ~RouterID, ~ServerID, ~ak_h,
                                             ~ak_sk, ~ssk_nms, ~tid, skae, tls_h, tls_sh, tls_spk
     )
     ]
    --[ Pred_Eq( z, true ) ]->
     [
     state_111111111111121111111111111111111( ~RouterID, ~ServerID, ~ak_h,
                                              ~ak_sk, ~ssk_nms, ~tid, skae, tls_h, tls_sh, tls_spk
     )
     ]
    variants (modulo AC)
    1. ~ak_sk
             = ~ak_sk.12
       skae  = skae.12
       tls_spk
             = tls_spk.12
       z     = verify(skae.12,
                      <tls_spk.12, <swstate, nil>, 'TPM_CC_PolicyPCR', nil>, pk(~ak_sk.12))
    
    2. ~ak_sk
             = ~x.12
       skae  = sign(<x.15, <swstate, nil>, 'TPM_CC_PolicyPCR', nil>, ~x.12)
       tls_spk
             = x.15
       z     = true
  */

rule (modulo E) ifverifyskaetlsspkswstatenilTPMCCPolicyPCRnilpkaksktrue_1_11111111111112111111111111111111[color=#454080 process=if verify(skae, <tls_spk, <swstate, nil>, 'TPM_CC_PolicyPCR', nil>,
       pk(~ak_sk))=true]:
   [
   state_11111111111112111111111111111111( ~RouterID, ~ServerID, ~ak_h,
                                           ~ak_sk, ~ssk_nms, ~tid, skae, tls_h, tls_sh, tls_spk
   )
   ]
  --[
  Pred_Not_Eq( verify(skae,
                      <tls_spk, <swstate, nil>, 'TPM_CC_PolicyPCR', nil>, pk(~ak_sk)),
               true
  )
  ]->
   [
   state_111111111111121111111111111111112( ~RouterID, ~ServerID, ~ak_h,
                                            ~ak_sk, ~ssk_nms, ~tid, skae, tls_h, tls_sh, tls_spk
   )
   ]

  /*
  rule (modulo AC) ifverifyskaetlsspkswstatenilTPMCCPolicyPCRnilpkaksktrue_1_11111111111112111111111111111111[color=#454080 process=if verify(skae, <tls_spk, <swstate, nil>, 'TPM_CC_PolicyPCR', nil>,
       pk(~ak_sk))=true]:
     [
     state_11111111111112111111111111111111( ~RouterID, ~ServerID, ~ak_h,
                                             ~ak_sk, ~ssk_nms, ~tid, skae, tls_h, tls_sh, tls_spk
     )
     ]
    --[ Pred_Not_Eq( z, true ) ]->
     [
     state_111111111111121111111111111111112( ~RouterID, ~ServerID, ~ak_h,
                                              ~ak_sk, ~ssk_nms, ~tid, skae, tls_h, tls_sh, tls_spk
     )
     ]
    variants (modulo AC)
    1. ~ak_sk
             = ~ak_sk.12
       skae  = skae.12
       tls_spk
             = tls_spk.12
       z     = verify(skae.12,
                      <tls_spk.12, <swstate, nil>, 'TPM_CC_PolicyPCR', nil>, pk(~ak_sk.12))
    
    2. ~ak_sk
             = ~x.12
       skae  = sign(<x.15, <swstate, nil>, 'TPM_CC_PolicyPCR', nil>, ~x.12)
       tls_spk
             = x.15
       z     = true
  */

rule (modulo E) eventTPMSendCommandTPMSigntlsshtlshtlsspkskae_0_111111111111121111111111111111111[color=#454080 process=event TPM_SendCommand( <'TPM2_Sign', tls_sh, tls_h, tls_spk, skae> );]:
   [
   state_111111111111121111111111111111111( ~RouterID, ~ServerID, ~ak_h,
                                            ~ak_sk, ~ssk_nms, ~tid, skae, tls_h, tls_sh, tls_spk
   )
   ]
  --[ TPM_SendCommand( <'TPM2_Sign', tls_sh, tls_h, tls_spk, skae> ) ]->
   [
   state_1111111111111211111111111111111111( ~RouterID, ~ServerID, ~ak_h,
                                             ~ak_sk, ~ssk_nms, ~tid, skae, tls_h, tls_sh, tls_spk
   )
   ]

  /* has exactly the trivial AC variant */

rule (modulo E) outTPMSigntlsshtlshtlsspkskae_0_1111111111111211111111111111111111[color=#454080 process=out(<'TPM2_Sign', tls_sh, tls_h, tls_spk, skae>);]:
   [
   state_1111111111111211111111111111111111( ~RouterID, ~ServerID, ~ak_h,
                                             ~ak_sk, ~ssk_nms, ~tid, skae, tls_h, tls_sh, tls_spk
   )
   ]
  -->
   [
   state_11111111111112111111111111111111111( ~RouterID, ~ServerID, ~ak_h,
                                              ~ak_sk, ~ssk_nms, ~tid, skae, tls_h, tls_sh, tls_spk
   ),
   Out( <'TPM2_Sign', tls_sh, tls_h, tls_spk, skae> )
   ]

  /* has exactly the trivial AC variant */

rule (modulo E) TpmSignOutcsr_0_11111111111112111111111111111111111[color=#454080 process= [ Tpm2SignOut( csr ) ] --> [ ];]:
   [
   state_11111111111112111111111111111111111( ~RouterID, ~ServerID, ~ak_h,
                                              ~ak_sk, ~ssk_nms, ~tid, skae, tls_h, tls_sh, tls_spk
   ),
   Tpm2SignOut( csr )
   ]
  -->
   [
   state_111111111111121111111111111111111111( ~RouterID, ~ServerID, ~ak_h,
                                               ~ak_sk, ~ssk_nms, ~tid, csr, skae, tls_h, tls_sh, tls_spk
   )
   ]

  /* has exactly the trivial AC variant */

rule (modulo E) eventGenerateValueCSRRouterIDcsr_0_111111111111121111111111111111111111[color=#454080 process=event GenerateValue( 'CSR', ~RouterID, csr );]:
   [
   state_111111111111121111111111111111111111( ~RouterID, ~ServerID, ~ak_h,
                                               ~ak_sk, ~ssk_nms, ~tid, csr, skae, tls_h, tls_sh, tls_spk
   )
   ]
  --[ GenerateValue( 'CSR', ~RouterID, csr ) ]->
   [
   state_1111111111111211111111111111111111111( ~RouterID, ~ServerID, ~ak_h,
                                                ~ak_sk, ~ssk_nms, ~tid, csr, skae, tls_h, tls_sh, tls_spk
   )
   ]

  /* has exactly the trivial AC variant */

rule (modulo E) eventRouterRunningRouterIDServerIDtlsspkswstatepkaksk_0_1111111111111211111111111111111111111[color=#454080 process=event RouterRunning( ~RouterID, ~ServerID, <tls_spk, swstate, pk(~ak_sk)>
);]:
   [
   state_1111111111111211111111111111111111111( ~RouterID, ~ServerID, ~ak_h,
                                                ~ak_sk, ~ssk_nms, ~tid, csr, skae, tls_h, tls_sh, tls_spk
   )
   ]
  --[ RouterRunning( ~RouterID, ~ServerID, <tls_spk, swstate, pk(~ak_sk)> )
  ]->
   [
   state_11111111111112111111111111111111111111( ~RouterID, ~ServerID,
                                                 ~ak_h, ~ak_sk, ~ssk_nms, ~tid, csr, skae, tls_h, tls_sh,
                                                 tls_spk
   )
   ]

  /* has exactly the trivial AC variant */

rule (modulo E) outtlsspkskaecsr_0_11111111111112111111111111111111111111[color=#454080 process=out(<<tls_spk, skae>, csr>);]:
   [
   state_11111111111112111111111111111111111111( ~RouterID, ~ServerID,
                                                 ~ak_h, ~ak_sk, ~ssk_nms, ~tid, csr, skae, tls_h, tls_sh,
                                                 tls_spk
   )
   ]
  -->
   [
   state_111111111111121111111111111111111111111( ~RouterID, ~ServerID,
                                                  ~ak_h, ~ak_sk, ~ssk_nms, ~tid, csr, skae, tls_h, tls_sh,
                                                  tls_spk
   ),
   Out( <<tls_spk, skae>, csr> )
   ]

  /* has exactly the trivial AC variant */

rule (modulo E) eventHasKeyNMSRouterIDpkssknms_0_111111111111121111111111111111111111111[color=#454080 process=event HasKey( 'NMS', ~RouterID, pk(~ssk_nms) );]:
   [
   state_111111111111121111111111111111111111111( ~RouterID, ~ServerID,
                                                  ~ak_h, ~ak_sk, ~ssk_nms, ~tid, csr, skae, tls_h, tls_sh,
                                                  tls_spk
   )
   ]
  --[ HasKey( 'NMS', ~RouterID, pk(~ssk_nms) ) ]->
   [
   state_1111111111111211111111111111111111111111( ~RouterID, ~ServerID,
                                                   ~ak_h, ~ak_sk, ~ssk_nms, ~tid, csr, skae, tls_h, tls_sh,
                                                   tls_spk
   )
   ]

  /* has exactly the trivial AC variant */

rule (modulo E) intlsspksignaturecerttls_0_1111111111111211111111111111111111111111[color=#454080 process=in(<tls_spk, signature_cert_tls>);]:
   [
   state_1111111111111211111111111111111111111111( ~RouterID, ~ServerID,
                                                   ~ak_h, ~ak_sk, ~ssk_nms, ~tid, csr, skae, tls_h, tls_sh,
                                                   tls_spk
   ),
   In( <tls_spk, signature_cert_tls> )
   ]
  -->
   [
   state_11111111111112111111111111111111111111111( ~RouterID, ~ServerID,
                                                    ~ak_h, ~ak_sk, ~ssk_nms, ~tid, csr, signature_cert_tls,
                                                    skae, tls_h, tls_sh, tls_spk
   )
   ]

  /* has exactly the trivial AC variant */

rule (modulo E) ifverifysignaturecerttlstlsspkpkssknmstrue_0_11111111111112111111111111111111111111111[color=#454080 process=if verify(signature_cert_tls, tls_spk, pk(~ssk_nms))=true]:
   [
   state_11111111111112111111111111111111111111111( ~RouterID, ~ServerID,
                                                    ~ak_h, ~ak_sk, ~ssk_nms, ~tid, csr, signature_cert_tls,
                                                    skae, tls_h, tls_sh, tls_spk
   )
   ]
  --[ Pred_Eq( verify(signature_cert_tls, tls_spk, pk(~ssk_nms)), true )
  ]->
   [
   state_111111111111121111111111111111111111111111( ~RouterID, ~ServerID,
                                                     ~ak_h, ~ak_sk, ~ssk_nms, ~tid, csr, signature_cert_tls,
                                                     skae, tls_h, tls_sh, tls_spk
   )
   ]

  /*
  rule (modulo AC) ifverifysignaturecerttlstlsspkpkssknmstrue_0_11111111111112111111111111111111111111111[color=#454080 process=if verify(signature_cert_tls, tls_spk, pk(~ssk_nms))=true]:
     [
     state_11111111111112111111111111111111111111111( ~RouterID, ~ServerID,
                                                      ~ak_h, ~ak_sk, ~ssk_nms, ~tid, csr, signature_cert_tls,
                                                      skae, tls_h, tls_sh, tls_spk
     )
     ]
    --[ Pred_Eq( z, true ) ]->
     [
     state_111111111111121111111111111111111111111111( ~RouterID, ~ServerID,
                                                       ~ak_h, ~ak_sk, ~ssk_nms, ~tid, csr, signature_cert_tls,
                                                       skae, tls_h, tls_sh, tls_spk
     )
     ]
    variants (modulo AC)
    1. ~ssk_nms
             = ~ssk_nms.14
       signature_cert_tls
             = signature_cert_tls.14
       tls_spk
             = tls_spk.14
       z     = verify(signature_cert_tls.14, tls_spk.14, pk(~ssk_nms.14))
    
    2. ~ssk_nms
             = ~x.14
       signature_cert_tls
             = sign(x.17, ~x.14)
       tls_spk
             = x.17
       z     = true
  */

rule (modulo E) ifverifysignaturecerttlstlsspkpkssknmstrue_1_11111111111112111111111111111111111111111[color=#454080 process=if verify(signature_cert_tls, tls_spk, pk(~ssk_nms))=true]:
   [
   state_11111111111112111111111111111111111111111( ~RouterID, ~ServerID,
                                                    ~ak_h, ~ak_sk, ~ssk_nms, ~tid, csr, signature_cert_tls,
                                                    skae, tls_h, tls_sh, tls_spk
   )
   ]
  --[
  Pred_Not_Eq( verify(signature_cert_tls, tls_spk, pk(~ssk_nms)), true )
  ]->
   [
   state_111111111111121111111111111111111111111112( ~RouterID, ~ServerID,
                                                     ~ak_h, ~ak_sk, ~ssk_nms, ~tid, csr, signature_cert_tls,
                                                     skae, tls_h, tls_sh, tls_spk
   )
   ]

  /*
  rule (modulo AC) ifverifysignaturecerttlstlsspkpkssknmstrue_1_11111111111112111111111111111111111111111[color=#454080 process=if verify(signature_cert_tls, tls_spk, pk(~ssk_nms))=true]:
     [
     state_11111111111112111111111111111111111111111( ~RouterID, ~ServerID,
                                                      ~ak_h, ~ak_sk, ~ssk_nms, ~tid, csr, signature_cert_tls,
                                                      skae, tls_h, tls_sh, tls_spk
     )
     ]
    --[ Pred_Not_Eq( z, true ) ]->
     [
     state_111111111111121111111111111111111111111112( ~RouterID, ~ServerID,
                                                       ~ak_h, ~ak_sk, ~ssk_nms, ~tid, csr, signature_cert_tls,
                                                       skae, tls_h, tls_sh, tls_spk
     )
     ]
    variants (modulo AC)
    1. ~ssk_nms
             = ~ssk_nms.14
       signature_cert_tls
             = signature_cert_tls.14
       tls_spk
             = tls_spk.14
       z     = verify(signature_cert_tls.14, tls_spk.14, pk(~ssk_nms.14))
    
    2. ~ssk_nms
             = ~x.14
       signature_cert_tls
             = sign(x.17, ~x.14)
       tls_spk
             = x.17
       z     = true
  */

rule (modulo E) eventRouterCommitRouterIDServerIDtlsspksignaturecerttls_0_111111111111121111111111111111111111111111[color=#454080 process=event RouterCommit( ~RouterID, ~ServerID, <tls_spk, signature_cert_tls> );]:
   [
   state_111111111111121111111111111111111111111111( ~RouterID, ~ServerID,
                                                     ~ak_h, ~ak_sk, ~ssk_nms, ~tid, csr, signature_cert_tls,
                                                     skae, tls_h, tls_sh, tls_spk
   )
   ]
  --[ RouterCommit( ~RouterID, ~ServerID, <tls_spk, signature_cert_tls> )
  ]->
   [
   state_1111111111111211111111111111111111111111111( ~RouterID, ~ServerID,
                                                      ~ak_h, ~ak_sk, ~ssk_nms, ~tid, csr, signature_cert_tls,
                                                      skae, tls_h, tls_sh, tls_spk
   )
   ]

  /* has exactly the trivial AC variant */

rule (modulo E) eventRouterFinish_0_1111111111111211111111111111111111111111111[color=#454080 process=event RouterFinish( );]:
   [
   state_1111111111111211111111111111111111111111111( ~RouterID, ~ServerID,
                                                      ~ak_h, ~ak_sk, ~ssk_nms, ~tid, csr, signature_cert_tls,
                                                      skae, tls_h, tls_sh, tls_spk
   )
   ]
  --[ RouterFinish( ) ]->
   [
   state_11111111111112111111111111111111111111111111( ~RouterID, ~ServerID,
                                                       ~ak_h, ~ak_sk, ~ssk_nms, ~tid, csr, signature_cert_tls,
                                                       skae, tls_h, tls_sh, tls_spk
   )
   ]

  /* has exactly the trivial AC variant */

rule (modulo E) __0_11111111111112111111111111111111111111111111[color=#454080 process=0]:
   [
   state_11111111111112111111111111111111111111111111( ~RouterID, ~ServerID,
                                                       ~ak_h, ~ak_sk, ~ssk_nms, ~tid, csr, signature_cert_tls,
                                                       skae, tls_h, tls_sh, tls_spk
   )
   ]
  -->
   [ ]

  /* has exactly the trivial AC variant */

rule (modulo E) __0_111111111111121111111111111111111111111112[color=#454080 process=0]:
   [
   state_111111111111121111111111111111111111111112( ~RouterID, ~ServerID,
                                                     ~ak_h, ~ak_sk, ~ssk_nms, ~tid, csr, signature_cert_tls,
                                                     skae, tls_h, tls_sh, tls_spk
   )
   ]
  -->
   [ ]

  /* has exactly the trivial AC variant */

rule (modulo E) __0_111111111111121111111111111111112[color=#454080 process=0]:
   [
   state_111111111111121111111111111111112( ~RouterID, ~ServerID, ~ak_h,
                                            ~ak_sk, ~ssk_nms, ~tid, skae, tls_h, tls_sh, tls_spk
   )
   ]
  -->
   [ ]

  /* has exactly the trivial AC variant */

rule (modulo E) __0_1111111111112[color=#464080 process=!]:
   [ state_1111111111112( ~RouterID, ~ServerID, ~ak_h, ~ak_sk, ~ssk_nms ) ]
  -->
   [
   !semistate_11111111111121( ~RouterID, ~ServerID, ~ak_h, ~ak_sk, ~ssk_nms
   )
   ]

  /* has exactly the trivial AC variant */

rule (modulo E) __1_1111111111112[color=#464080 process=!]:
   [
   !semistate_11111111111121( ~RouterID, ~ServerID, ~ak_h, ~ak_sk, ~ssk_nms
   )
   ]
  -->
   [ state_11111111111121( ~RouterID, ~ServerID, ~ak_h, ~ak_sk, ~ssk_nms ) ]

  /* has exactly the trivial AC variant */

rule (modulo E) intlsspkskaecsr_0_11111111111121[color=#464080 process=in(<<tls_spk, skae>, csr>);]:
   [
   state_11111111111121( ~RouterID, ~ServerID, ~ak_h, ~ak_sk, ~ssk_nms ),
   In( <<tls_spk, skae>, csr> )
   ]
  -->
   [
   state_111111111111211( ~RouterID, ~ServerID, ~ak_h, ~ak_sk, ~ssk_nms,
                          csr, skae, tls_spk
   )
   ]

  /* has exactly the trivial AC variant */

rule (modulo E) ifverifyskaetlsspkswstatenilTPMCCPolicyPCRnilpkaksktrue_0_111111111111211[color=#464080 process=if verify(skae, <tls_spk, <swstate, nil>, 'TPM_CC_PolicyPCR', nil>,
       pk(~ak_sk))=true]:
   [
   state_111111111111211( ~RouterID, ~ServerID, ~ak_h, ~ak_sk, ~ssk_nms,
                          csr, skae, tls_spk
   )
   ]
  --[
  Pred_Eq( verify(skae, <tls_spk, <swstate, nil>, 'TPM_CC_PolicyPCR', nil>,
                  pk(~ak_sk)),
           true
  )
  ]->
   [
   state_1111111111112111( ~RouterID, ~ServerID, ~ak_h, ~ak_sk, ~ssk_nms,
                           csr, skae, tls_spk
   )
   ]

  /*
  rule (modulo AC) ifverifyskaetlsspkswstatenilTPMCCPolicyPCRnilpkaksktrue_0_111111111111211[color=#464080 process=if verify(skae, <tls_spk, <swstate, nil>, 'TPM_CC_PolicyPCR', nil>,
       pk(~ak_sk))=true]:
     [
     state_111111111111211( ~RouterID, ~ServerID, ~ak_h, ~ak_sk, ~ssk_nms,
                            csr, skae, tls_spk
     )
     ]
    --[ Pred_Eq( z, true ) ]->
     [
     state_1111111111112111( ~RouterID, ~ServerID, ~ak_h, ~ak_sk, ~ssk_nms,
                             csr, skae, tls_spk
     )
     ]
    variants (modulo AC)
    1. ~ak_sk
             = ~ak_sk.10
       skae  = skae.10
       tls_spk
             = tls_spk.10
       z     = verify(skae.10,
                      <tls_spk.10, <swstate, nil>, 'TPM_CC_PolicyPCR', nil>, pk(~ak_sk.10))
    
    2. ~ak_sk
             = ~x.10
       skae  = sign(<x.13, <swstate, nil>, 'TPM_CC_PolicyPCR', nil>, ~x.10)
       tls_spk
             = x.13
       z     = true
  */

rule (modulo E) ifverifyskaetlsspkswstatenilTPMCCPolicyPCRnilpkaksktrue_1_111111111111211[color=#464080 process=if verify(skae, <tls_spk, <swstate, nil>, 'TPM_CC_PolicyPCR', nil>,
       pk(~ak_sk))=true]:
   [
   state_111111111111211( ~RouterID, ~ServerID, ~ak_h, ~ak_sk, ~ssk_nms,
                          csr, skae, tls_spk
   )
   ]
  --[
  Pred_Not_Eq( verify(skae,
                      <tls_spk, <swstate, nil>, 'TPM_CC_PolicyPCR', nil>, pk(~ak_sk)),
               true
  )
  ]->
   [
   state_1111111111112112( ~RouterID, ~ServerID, ~ak_h, ~ak_sk, ~ssk_nms,
                           csr, skae, tls_spk
   )
   ]

  /*
  rule (modulo AC) ifverifyskaetlsspkswstatenilTPMCCPolicyPCRnilpkaksktrue_1_111111111111211[color=#464080 process=if verify(skae, <tls_spk, <swstate, nil>, 'TPM_CC_PolicyPCR', nil>,
       pk(~ak_sk))=true]:
     [
     state_111111111111211( ~RouterID, ~ServerID, ~ak_h, ~ak_sk, ~ssk_nms,
                            csr, skae, tls_spk
     )
     ]
    --[ Pred_Not_Eq( z, true ) ]->
     [
     state_1111111111112112( ~RouterID, ~ServerID, ~ak_h, ~ak_sk, ~ssk_nms,
                             csr, skae, tls_spk
     )
     ]
    variants (modulo AC)
    1. ~ak_sk
             = ~ak_sk.10
       skae  = skae.10
       tls_spk
             = tls_spk.10
       z     = verify(skae.10,
                      <tls_spk.10, <swstate, nil>, 'TPM_CC_PolicyPCR', nil>, pk(~ak_sk.10))
    
    2. ~ak_sk
             = ~x.10
       skae  = sign(<x.13, <swstate, nil>, 'TPM_CC_PolicyPCR', nil>, ~x.10)
       tls_spk
             = x.13
       z     = true
  */

rule (modulo E) ifverifycsrtlsspkskaetlsspktrue_0_1111111111112111[color=#464080 process=if verify(csr, <tls_spk, skae>, tls_spk)=true]:
   [
   state_1111111111112111( ~RouterID, ~ServerID, ~ak_h, ~ak_sk, ~ssk_nms,
                           csr, skae, tls_spk
   )
   ]
  --[ Pred_Eq( verify(csr, <tls_spk, skae>, tls_spk), true ) ]->
   [
   state_11111111111121111( ~RouterID, ~ServerID, ~ak_h, ~ak_sk, ~ssk_nms,
                            csr, skae, tls_spk
   )
   ]

  /*
  rule (modulo AC) ifverifycsrtlsspkskaetlsspktrue_0_1111111111112111[color=#464080 process=if verify(csr, <tls_spk, skae>, tls_spk)=true]:
     [
     state_1111111111112111( ~RouterID, ~ServerID, ~ak_h, ~ak_sk, ~ssk_nms,
                             csr, skae, tls_spk
     )
     ]
    --[ Pred_Eq( z, true ) ]->
     [
     state_11111111111121111( ~RouterID, ~ServerID, ~ak_h, ~ak_sk, ~ssk_nms,
                              csr, skae, tls_spk
     )
     ]
    variants (modulo AC)
    1. csr   = csr.10
       skae  = skae.10
       tls_spk
             = tls_spk.10
       z     = verify(csr.10, <tls_spk.10, skae.10>, tls_spk.10)
    
    2. csr   = sign(<pk(x.10), x.11>, x.10)
       skae  = x.11
       tls_spk
             = pk(x.10)
       z     = true
  */

rule (modulo E) ifverifycsrtlsspkskaetlsspktrue_1_1111111111112111[color=#464080 process=if verify(csr, <tls_spk, skae>, tls_spk)=true]:
   [
   state_1111111111112111( ~RouterID, ~ServerID, ~ak_h, ~ak_sk, ~ssk_nms,
                           csr, skae, tls_spk
   )
   ]
  --[ Pred_Not_Eq( verify(csr, <tls_spk, skae>, tls_spk), true ) ]->
   [
   state_11111111111121112( ~RouterID, ~ServerID, ~ak_h, ~ak_sk, ~ssk_nms,
                            csr, skae, tls_spk
   )
   ]

  /*
  rule (modulo AC) ifverifycsrtlsspkskaetlsspktrue_1_1111111111112111[color=#464080 process=if verify(csr, <tls_spk, skae>, tls_spk)=true]:
     [
     state_1111111111112111( ~RouterID, ~ServerID, ~ak_h, ~ak_sk, ~ssk_nms,
                             csr, skae, tls_spk
     )
     ]
    --[ Pred_Not_Eq( z, true ) ]->
     [
     state_11111111111121112( ~RouterID, ~ServerID, ~ak_h, ~ak_sk, ~ssk_nms,
                              csr, skae, tls_spk
     )
     ]
    variants (modulo AC)
    1. csr   = csr.10
       skae  = skae.10
       tls_spk
             = tls_spk.10
       z     = verify(csr.10, <tls_spk.10, skae.10>, tls_spk.10)
    
    2. csr   = sign(<pk(x.10), x.11>, x.10)
       skae  = x.11
       tls_spk
             = pk(x.10)
       z     = true
  */

rule (modulo E) eventReceiveValueCSRServerIDcsr_0_11111111111121111[color=#464080 process=event ReceiveValue( 'CSR', ~ServerID, csr );]:
   [
   state_11111111111121111( ~RouterID, ~ServerID, ~ak_h, ~ak_sk, ~ssk_nms,
                            csr, skae, tls_spk
   )
   ]
  --[ ReceiveValue( 'CSR', ~ServerID, csr ) ]->
   [
   state_111111111111211111( ~RouterID, ~ServerID, ~ak_h, ~ak_sk, ~ssk_nms,
                             csr, skae, tls_spk
   )
   ]

  /* has exactly the trivial AC variant */

rule (modulo E) eventHasKeyTLSServerIDtlsspk_0_111111111111211111[color=#464080 process=event HasKey( 'TLS', ~ServerID, tls_spk );]:
   [
   state_111111111111211111( ~RouterID, ~ServerID, ~ak_h, ~ak_sk, ~ssk_nms,
                             csr, skae, tls_spk
   )
   ]
  --[ HasKey( 'TLS', ~ServerID, tls_spk ) ]->
   [
   state_1111111111112111111( ~RouterID, ~ServerID, ~ak_h, ~ak_sk, ~ssk_nms,
                              csr, skae, tls_spk
   )
   ]

  /* has exactly the trivial AC variant */

rule (modulo E) eventHasKeyAKServerIDpkaksk_0_1111111111112111111[color=#464080 process=event HasKey( 'AK', ~ServerID, pk(~ak_sk) );]:
   [
   state_1111111111112111111( ~RouterID, ~ServerID, ~ak_h, ~ak_sk, ~ssk_nms,
                              csr, skae, tls_spk
   )
   ]
  --[ HasKey( 'AK', ~ServerID, pk(~ak_sk) ) ]->
   [
   state_11111111111121111111( ~RouterID, ~ServerID, ~ak_h, ~ak_sk,
                               ~ssk_nms, csr, skae, tls_spk
   )
   ]

  /* has exactly the trivial AC variant */

rule (modulo E) eventHasKeyNMSServerIDpkssknms_0_11111111111121111111[color=#464080 process=event HasKey( 'NMS', ~ServerID, pk(~ssk_nms) );]:
   [
   state_11111111111121111111( ~RouterID, ~ServerID, ~ak_h, ~ak_sk,
                               ~ssk_nms, csr, skae, tls_spk
   )
   ]
  --[ HasKey( 'NMS', ~ServerID, pk(~ssk_nms) ) ]->
   [
   state_111111111111211111111( ~RouterID, ~ServerID, ~ak_h, ~ak_sk,
                                ~ssk_nms, csr, skae, tls_spk
   )
   ]

  /* has exactly the trivial AC variant */

rule (modulo E) eventServerCommitServerIDRouterIDtlsspkswstatepkaksk_0_111111111111211111111[color=#464080 process=event ServerCommit( ~ServerID, ~RouterID, <tls_spk, swstate, pk(~ak_sk)>
);]:
   [
   state_111111111111211111111( ~RouterID, ~ServerID, ~ak_h, ~ak_sk,
                                ~ssk_nms, csr, skae, tls_spk
   )
   ]
  --[ ServerCommit( ~ServerID, ~RouterID, <tls_spk, swstate, pk(~ak_sk)> )
  ]->
   [
   state_1111111111112111111111( ~RouterID, ~ServerID, ~ak_h, ~ak_sk,
                                 ~ssk_nms, csr, skae, tls_spk
   )
   ]

  /* has exactly the trivial AC variant */

rule (modulo E) eventServerRunningServerIDRouterIDtlsspksigntlsspkssknms_0_1111111111112111111111[color=#464080 process=event ServerRunning( ~ServerID, ~RouterID,
               <tls_spk, sign(tls_spk, ~ssk_nms)>
);]:
   [
   state_1111111111112111111111( ~RouterID, ~ServerID, ~ak_h, ~ak_sk,
                                 ~ssk_nms, csr, skae, tls_spk
   )
   ]
  --[
  ServerRunning( ~ServerID, ~RouterID, <tls_spk, sign(tls_spk, ~ssk_nms)> )
  ]->
   [
   state_11111111111121111111111( ~RouterID, ~ServerID, ~ak_h, ~ak_sk,
                                  ~ssk_nms, csr, skae, tls_spk
   )
   ]

  /* has exactly the trivial AC variant */

rule (modulo E) outtlsspksigntlsspkssknms_0_11111111111121111111111[color=#464080 process=out(<tls_spk, sign(tls_spk, ~ssk_nms)>);]:
   [
   state_11111111111121111111111( ~RouterID, ~ServerID, ~ak_h, ~ak_sk,
                                  ~ssk_nms, csr, skae, tls_spk
   )
   ]
  -->
   [
   state_111111111111211111111111( ~RouterID, ~ServerID, ~ak_h, ~ak_sk,
                                   ~ssk_nms, csr, skae, tls_spk
   ),
   Out( <tls_spk, sign(tls_spk, ~ssk_nms)> )
   ]

  /* has exactly the trivial AC variant */

rule (modulo E) eventServerFinish_0_111111111111211111111111[color=#464080 process=event ServerFinish( );]:
   [
   state_111111111111211111111111( ~RouterID, ~ServerID, ~ak_h, ~ak_sk,
                                   ~ssk_nms, csr, skae, tls_spk
   )
   ]
  --[ ServerFinish( ) ]->
   [
   state_1111111111112111111111111( ~RouterID, ~ServerID, ~ak_h, ~ak_sk,
                                    ~ssk_nms, csr, skae, tls_spk
   )
   ]

  /* has exactly the trivial AC variant */

rule (modulo E) __0_1111111111112111111111111[color=#464080 process=0]:
   [
   state_1111111111112111111111111( ~RouterID, ~ServerID, ~ak_h, ~ak_sk,
                                    ~ssk_nms, csr, skae, tls_spk
   )
   ]
  -->
   [ ]

  /* has exactly the trivial AC variant */

rule (modulo E) __0_11111111111121112[color=#464080 process=0]:
   [
   state_11111111111121112( ~RouterID, ~ServerID, ~ak_h, ~ak_sk, ~ssk_nms,
                            csr, skae, tls_spk
   )
   ]
  -->
   [ ]

  /* has exactly the trivial AC variant */

rule (modulo E) __0_1111111111112112[color=#464080 process=0]:
   [
   state_1111111111112112( ~RouterID, ~ServerID, ~ak_h, ~ak_sk, ~ssk_nms,
                           csr, skae, tls_spk
   )
   ]
  -->
   [ ]

  /* has exactly the trivial AC variant */

restriction set_in:
  "∀ x y #t3.
    (IsIn( x, y ) @ #t3) ⇒
    (∃ #t2.
      ((Insert( x, y ) @ #t2) ∧ (#t2 < #t3)) ∧
      (∀ #t1 yp.
        (Insert( x, yp ) @ #t1) ⇒ (((#t1 < #t2) ∨ (#t1 = #t2)) ∨ (#t3 < #t1))))"

restriction set_notin:
  "∀ x #t3.
    (IsNotSet( x ) @ #t3) ⇒ (∀ #t1 y. (Insert( x, y ) @ #t1) ⇒ (#t3 < #t1))"
  // safety formula

restriction predicate_eq:
  "∀ #i a b. (Pred_Eq( a, b ) @ #i) ⇒ (a = b)"
  // safety formula

restriction predicate_not_eq:
  "∀ #i a b. (Pred_Not_Eq( a, b ) @ #i) ⇒ (¬(a = b))"
  // safety formula

restriction single_session:
  "∀ #i #j. ((Init( ) @ #i) ∧ (Init( ) @ #j)) ⇒ (#i = #j)"
  // safety formula

restriction locking_0:
  "∀ p pp l x lp #t1 #t3.
    ((Lock_0( p, l, x ) @ #t1) ∧ (Lock( pp, lp, x ) @ #t3)) ⇒
    ((((#t1 < #t3) ∧
       (∃ #t2.
         (((((Unlock_0( p, l, x ) @ #t2) ∧ (#t1 < #t2)) ∧ (#t2 < #t3)) ∧
           (∀ #t0 pp.1. (Unlock( pp.1, l, x ) @ #t0) ⇒ (#t0 = #t2))) ∧
          (∀ pp.1 lpp #t0.
            (Lock( pp.1, lpp, x ) @ #t0) ⇒
            (((#t0 < #t1) ∨ (#t0 = #t1)) ∨ (#t2 < #t0)))) ∧
         (∀ pp.1 lpp #t0.
           (Unlock( pp.1, lpp, x ) @ #t0) ⇒
           (((#t0 < #t1) ∨ (#t2 < #t0)) ∨ (#t2 = #t0))))) ∨
      (#t3 < #t1)) ∨
     (#t1 = #t3))"

restriction locking_1:
  "∀ p pp l x lp #t1 #t3.
    ((Lock_1( p, l, x ) @ #t1) ∧ (Lock( pp, lp, x ) @ #t3)) ⇒
    ((((#t1 < #t3) ∧
       (∃ #t2.
         (((((Unlock_1( p, l, x ) @ #t2) ∧ (#t1 < #t2)) ∧ (#t2 < #t3)) ∧
           (∀ #t0 pp.1. (Unlock( pp.1, l, x ) @ #t0) ⇒ (#t0 = #t2))) ∧
          (∀ pp.1 lpp #t0.
            (Lock( pp.1, lpp, x ) @ #t0) ⇒
            (((#t0 < #t1) ∨ (#t0 = #t1)) ∨ (#t2 < #t0)))) ∧
         (∀ pp.1 lpp #t0.
           (Unlock( pp.1, lpp, x ) @ #t0) ⇒
           (((#t0 < #t1) ∨ (#t2 < #t0)) ∨ (#t2 = #t0))))) ∨
      (#t3 < #t1)) ∨
     (#t1 = #t3))"

restriction locking_2:
  "∀ p pp l x lp #t1 #t3.
    ((Lock_2( p, l, x ) @ #t1) ∧ (Lock( pp, lp, x ) @ #t3)) ⇒
    ((((#t1 < #t3) ∧
       (∃ #t2.
         (((((Unlock_2( p, l, x ) @ #t2) ∧ (#t1 < #t2)) ∧ (#t2 < #t3)) ∧
           (∀ #t0 pp.1. (Unlock( pp.1, l, x ) @ #t0) ⇒ (#t0 = #t2))) ∧
          (∀ pp.1 lpp #t0.
            (Lock( pp.1, lpp, x ) @ #t0) ⇒
            (((#t0 < #t1) ∨ (#t0 = #t1)) ∨ (#t2 < #t0)))) ∧
         (∀ pp.1 lpp #t0.
           (Unlock( pp.1, lpp, x ) @ #t0) ⇒
           (((#t0 < #t1) ∨ (#t2 < #t0)) ∨ (#t2 = #t0))))) ∨
      (#t3 < #t1)) ∨
     (#t1 = #t3))"

restriction locking_3:
  "∀ p pp l x lp #t1 #t3.
    ((Lock_3( p, l, x ) @ #t1) ∧ (Lock( pp, lp, x ) @ #t3)) ⇒
    ((((#t1 < #t3) ∧
       (∃ #t2.
         (((((Unlock_3( p, l, x ) @ #t2) ∧ (#t1 < #t2)) ∧ (#t2 < #t3)) ∧
           (∀ #t0 pp.1. (Unlock( pp.1, l, x ) @ #t0) ⇒ (#t0 = #t2))) ∧
          (∀ pp.1 lpp #t0.
            (Lock( pp.1, lpp, x ) @ #t0) ⇒
            (((#t0 < #t1) ∨ (#t0 = #t1)) ∨ (#t2 < #t0)))) ∧
         (∀ pp.1 lpp #t0.
           (Unlock( pp.1, lpp, x ) @ #t0) ⇒
           (((#t0 < #t1) ∨ (#t2 < #t0)) ∨ (#t2 = #t0))))) ∨
      (#t3 < #t1)) ∨
     (#t1 = #t3))"

restriction locking_4:
  "∀ p pp l x lp #t1 #t3.
    ((Lock_4( p, l, x ) @ #t1) ∧ (Lock( pp, lp, x ) @ #t3)) ⇒
    ((((#t1 < #t3) ∧
       (∃ #t2.
         (((((Unlock_4( p, l, x ) @ #t2) ∧ (#t1 < #t2)) ∧ (#t2 < #t3)) ∧
           (∀ #t0 pp.1. (Unlock( pp.1, l, x ) @ #t0) ⇒ (#t0 = #t2))) ∧
          (∀ pp.1 lpp #t0.
            (Lock( pp.1, lpp, x ) @ #t0) ⇒
            (((#t0 < #t1) ∨ (#t0 = #t1)) ∨ (#t2 < #t0)))) ∧
         (∀ pp.1 lpp #t0.
           (Unlock( pp.1, lpp, x ) @ #t0) ⇒
           (((#t0 < #t1) ∨ (#t2 < #t0)) ∨ (#t2 = #t0))))) ∨
      (#t3 < #t1)) ∨
     (#t1 = #t3))"

restriction locking_5:
  "∀ p pp l x lp #t1 #t3.
    ((Lock_5( p, l, x ) @ #t1) ∧ (Lock( pp, lp, x ) @ #t3)) ⇒
    ((((#t1 < #t3) ∧
       (∃ #t2.
         (((((Unlock_5( p, l, x ) @ #t2) ∧ (#t1 < #t2)) ∧ (#t2 < #t3)) ∧
           (∀ #t0 pp.1. (Unlock( pp.1, l, x ) @ #t0) ⇒ (#t0 = #t2))) ∧
          (∀ pp.1 lpp #t0.
            (Lock( pp.1, lpp, x ) @ #t0) ⇒
            (((#t0 < #t1) ∨ (#t0 = #t1)) ∨ (#t2 < #t0)))) ∧
         (∀ pp.1 lpp #t0.
           (Unlock( pp.1, lpp, x ) @ #t0) ⇒
           (((#t0 < #t1) ∨ (#t2 < #t0)) ∨ (#t2 = #t0))))) ∨
      (#t3 < #t1)) ∨
     (#t1 = #t3))"

/* All well-formedness checks were successful. */

end